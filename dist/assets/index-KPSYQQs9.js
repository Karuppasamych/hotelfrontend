var VS=Object.defineProperty;var GS=(e,t,r)=>t in e?VS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ul=(e,t,r)=>GS(e,typeof t!="symbol"?t+"":t,r);import{r as x,j as E,R as WS,a as he,b as xv,c as zS}from"./radix-B-lCQ48C.js";import{a as US,r as jS}from"./vendor-CRB3T2We.js";import{t as $S,c as KS}from"./utils-CJM1tISp.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=r(i);fetch(i.href,n)}})();var dl={},sp;function qS(){if(sp)return dl;sp=1;var e=US();return dl.createRoot=e.createRoot,dl.hydrateRoot=e.hydrateRoot,dl}var XS=qS();/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ip="popstate";function YS(e={}){function t(s,i){let{pathname:n,search:o,hash:a}=s.location;return Xd("",{pathname:n,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(s,i){return typeof i=="string"?i:ha(i)}return ZS(t,r,null,e)}function gt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ur(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function JS(){return Math.random().toString(36).substring(2,10)}function np(e,t){return{usr:e.state,key:e.key,idx:t}}function Xd(e,t,r=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?wo(t):t,state:r,key:t&&t.key||s||JS()}}function ha({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function wo(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function ZS(e,t,r,s={}){let{window:i=document.defaultView,v5Compat:n=!1}=s,o=i.history,a="POP",l=null,c=u();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function d(){a="POP";let m=u(),v=m==null?null:m-c;c=m,l&&l({action:a,location:g.location,delta:v})}function h(m,v){a="PUSH";let w=Xd(g.location,m,v);c=u()+1;let C=np(w,c),y=g.createHref(w);try{o.pushState(C,"",y)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(y)}n&&l&&l({action:a,location:g.location,delta:1})}function f(m,v){a="REPLACE";let w=Xd(g.location,m,v);c=u();let C=np(w,c),y=g.createHref(w);o.replaceState(C,"",y),n&&l&&l({action:a,location:g.location,delta:0})}function p(m){return QS(m)}let g={get action(){return a},get location(){return e(i,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(ip,d),l=m,()=>{i.removeEventListener(ip,d),l=null}},createHref(m){return t(i,m)},createURL:p,encodeLocation(m){let v=p(m);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:f,go(m){return o.go(m)}};return g}function QS(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),gt(r,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:ha(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=r+s),new URL(s,r)}function yv(e,t,r="/"){return eb(e,t,r,!1)}function eb(e,t,r,s){let i=typeof t=="string"?wo(t):t,n=Ks(i.pathname||"/",r);if(n==null)return null;let o=Sv(e);tb(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=hb(n);a=ub(o[l],c,s)}return a}function Sv(e,t=[],r=[],s="",i=!1){let n=(o,a,l=i,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(s)&&l)return;gt(u.relativePath.startsWith(s),`Absolute route path "${u.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(s.length)}let d=Bs([s,u.relativePath]),h=r.concat(u);o.children&&o.children.length>0&&(gt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),Sv(o.children,t,h,d,l)),!(o.path==null&&!o.index)&&t.push({path:d,score:lb(d,o.index),routesMeta:h})};return e.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))n(o,a);else for(let c of bv(o.path))n(o,a,!0,c)}),t}function bv(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,i=r.endsWith("?"),n=r.replace(/\?$/,"");if(s.length===0)return i?[n,""]:[n];let o=bv(s.join("/")),a=[];return a.push(...o.map(l=>l===""?n:[n,l].join("/"))),i&&a.push(...o),a.map(l=>e.startsWith("/")&&l===""?"/":l)}function tb(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:cb(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}var rb=/^:[\w-]+$/,sb=3,ib=2,nb=1,ob=10,ab=-2,op=e=>e==="*";function lb(e,t){let r=e.split("/"),s=r.length;return r.some(op)&&(s+=ab),t&&(s+=ib),r.filter(i=>!op(i)).reduce((i,n)=>i+(rb.test(n)?sb:n===""?nb:ob),s)}function cb(e,t){return e.length===t.length&&e.slice(0,-1).every((s,i)=>s===t[i])?e[e.length-1]-t[t.length-1]:0}function ub(e,t,r=!1){let{routesMeta:s}=e,i={},n="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=n==="/"?t:t.slice(n.length)||"/",d=uc({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&r&&!s[s.length-1].route.index&&(d=uc({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:Bs([n,d.pathname]),pathnameBase:mb(Bs([n,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(n=Bs([n,d.pathnameBase]))}return o}function uc(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=db(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let n=i[0],o=n.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:s.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let p=a[h]||"";o=n.slice(0,n.length-p.length).replace(/(.)\/+$/,"$1")}const f=a[h];return d&&!f?c[u]=void 0:c[u]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:n,pathnameBase:o,pattern:e}}function db(e,t=!1,r=!0){Ur(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),s]}function hb(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ur(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Ks(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}var Fv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fb=e=>Fv.test(e);function gb(e,t="/"){let{pathname:r,search:s="",hash:i=""}=typeof e=="string"?wo(e):e,n;if(r)if(fb(r))n=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Ur(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${r}`)}r.startsWith("/")?n=ap(r.substring(1),"/"):n=ap(r,t)}else n=t;return{pathname:n,search:vb(s),hash:Cb(i)}}function ap(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function zu(e,t,r,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function pb(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Zh(e){let t=pb(e);return t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase)}function Qh(e,t,r,s=!1){let i;typeof e=="string"?i=wo(e):(i={...e},gt(!i.pathname||!i.pathname.includes("?"),zu("?","pathname","search",i)),gt(!i.pathname||!i.pathname.includes("#"),zu("#","pathname","hash",i)),gt(!i.search||!i.search.includes("#"),zu("#","search","hash",i)));let n=e===""||i.pathname==="",o=n?"/":i.pathname,a;if(o==null)a=r;else{let d=t.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?t[d]:"/"}let l=gb(i,a),c=o&&o!=="/"&&o.endsWith("/"),u=(n||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Bs=e=>e.join("/").replace(/\/\/+/g,"/"),mb=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),vb=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Cb=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,wb=class{constructor(e,t,r,s=!1){this.status=e,this.statusText=t||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function xb(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function yb(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Rv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ev(e,t){let r=e;if(typeof r!="string"||!Fv.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let s=r,i=!1;if(Rv)try{let n=new URL(window.location.href),o=r.startsWith("//")?new URL(n.protocol+r):new URL(r),a=Ks(o.pathname,t);o.origin===n.origin&&a!=null?r=a+o.search+o.hash:i=!0}catch{Ur(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:i,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Tv=["POST","PUT","PATCH","DELETE"];new Set(Tv);var Sb=["GET",...Tv];new Set(Sb);var xo=x.createContext(null);xo.displayName="DataRouter";var ou=x.createContext(null);ou.displayName="DataRouterState";var bb=x.createContext(!1),kv=x.createContext({isTransitioning:!1});kv.displayName="ViewTransition";var Fb=x.createContext(new Map);Fb.displayName="Fetchers";var Rb=x.createContext(null);Rb.displayName="Await";var Dr=x.createContext(null);Dr.displayName="Navigation";var za=x.createContext(null);za.displayName="Location";var Ps=x.createContext({outlet:null,matches:[],isDataRoute:!1});Ps.displayName="Route";var ef=x.createContext(null);ef.displayName="RouteError";var Pv="REACT_ROUTER_ERROR",Eb="REDIRECT",Tb="ROUTE_ERROR_RESPONSE";function kb(e){if(e.startsWith(`${Pv}:${Eb}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function Pb(e){if(e.startsWith(`${Pv}:${Tb}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new wb(t.status,t.statusText,t.data)}catch{}}function Db(e,{relative:t}={}){gt(yo(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:s}=x.useContext(Dr),{hash:i,pathname:n,search:o}=Ua(e,{relative:t}),a=n;return r!=="/"&&(a=n==="/"?r:Bs([r,n])),s.createHref({pathname:a,search:o,hash:i})}function yo(){return x.useContext(za)!=null}function Zs(){return gt(yo(),"useLocation() may be used only in the context of a <Router> component."),x.useContext(za).location}var Dv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Av(e){x.useContext(Dr).static||x.useLayoutEffect(e)}function au(){let{isDataRoute:e}=x.useContext(Ps);return e?zb():Ab()}function Ab(){gt(yo(),"useNavigate() may be used only in the context of a <Router> component.");let e=x.useContext(xo),{basename:t,navigator:r}=x.useContext(Dr),{matches:s}=x.useContext(Ps),{pathname:i}=Zs(),n=JSON.stringify(Zh(s)),o=x.useRef(!1);return Av(()=>{o.current=!0}),x.useCallback((l,c={})=>{if(Ur(o.current,Dv),!o.current)return;if(typeof l=="number"){r.go(l);return}let u=Qh(l,JSON.parse(n),i,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Bs([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,n,i,e])}x.createContext(null);function Ua(e,{relative:t}={}){let{matches:r}=x.useContext(Ps),{pathname:s}=Zs(),i=JSON.stringify(Zh(r));return x.useMemo(()=>Qh(e,JSON.parse(i),s,t==="path"),[e,i,s,t])}function Ib(e,t){return Iv(e,t)}function Iv(e,t,r,s,i){var w;gt(yo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=x.useContext(Dr),{matches:o}=x.useContext(Ps),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let C=d&&d.path||"";_v(c,!d||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let h=Zs(),f;if(t){let C=typeof t=="string"?wo(t):t;gt(u==="/"||((w=C.pathname)==null?void 0:w.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${C.pathname}" was given in the \`location\` prop.`),f=C}else f=h;let p=f.pathname||"/",g=p;if(u!=="/"){let C=u.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(C.length).join("/")}let m=yv(e,{pathname:g});Ur(d||m!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Ur(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=Nb(m&&m.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:Bs([u,n.encodeLocation?n.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?u:Bs([u,n.encodeLocation?n.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,r,s,i);return t&&v?x.createElement(za.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},v):v}function Mb(){let e=Wb(),t=xb(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},n={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=x.createElement(x.Fragment,null,x.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),x.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",x.createElement("code",{style:n},"ErrorBoundary")," or"," ",x.createElement("code",{style:n},"errorElement")," prop on your route.")),x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:i},r):null,o)}var _b=x.createElement(Mb,null),Mv=class extends x.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=Pb(e.digest);r&&(e=r)}let t=e!==void 0?x.createElement(Ps.Provider,{value:this.props.routeContext},x.createElement(ef.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?x.createElement(Lb,{error:e},t):t}};Mv.contextType=bb;var Uu=new WeakMap;function Lb({children:e,error:t}){let{basename:r}=x.useContext(Dr);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let s=kb(t.digest);if(s){let i=Uu.get(t);if(i)throw i;let n=Ev(s.location,r);if(Rv&&!Uu.get(t))if(n.isExternal||s.reloadDocument)window.location.href=n.absoluteURL||n.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(n.to,{replace:s.replace}));throw Uu.set(t,o),o}return x.createElement("meta",{httpEquiv:"refresh",content:`0;url=${n.absoluteURL||n.to}`})}}return e}function Ob({routeContext:e,match:t,children:r}){let s=x.useContext(xo);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),x.createElement(Ps.Provider,{value:e},r)}function Nb(e,t=[],r=null,s=null,i=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let n=e,o=r==null?void 0:r.errors;if(o!=null){let u=n.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);gt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),n=n.slice(0,Math.min(n.length,u+1))}let a=!1,l=-1;if(r)for(let u=0;u<n.length;u++){let d=n[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:h,errors:f}=r,p=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){a=!0,l>=0?n=n.slice(0,l+1):n=[n[0]];break}}}let c=r&&s?(u,d)=>{var h,f;s(u,{location:r.location,params:((f=(h=r.matches)==null?void 0:h[0])==null?void 0:f.params)??{},unstable_pattern:yb(r.matches),errorInfo:d})}:void 0;return n.reduceRight((u,d,h)=>{let f,p=!1,g=null,m=null;r&&(f=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||_b,a&&(l<0&&h===0?(_v("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,m=null):l===h&&(p=!0,m=d.route.hydrateFallbackElement||null)));let v=t.concat(n.slice(0,h+1)),w=()=>{let C;return f?C=g:p?C=m:d.route.Component?C=x.createElement(d.route.Component,null):d.route.element?C=d.route.element:C=u,x.createElement(Ob,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:C})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?x.createElement(Mv,{location:r.location,revalidation:r.revalidation,component:g,error:f,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0},onError:c}):w()},null)}function tf(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bb(e){let t=x.useContext(xo);return gt(t,tf(e)),t}function Hb(e){let t=x.useContext(ou);return gt(t,tf(e)),t}function Vb(e){let t=x.useContext(Ps);return gt(t,tf(e)),t}function rf(e){let t=Vb(e),r=t.matches[t.matches.length-1];return gt(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Gb(){return rf("useRouteId")}function Wb(){var s;let e=x.useContext(ef),t=Hb("useRouteError"),r=rf("useRouteError");return e!==void 0?e:(s=t.errors)==null?void 0:s[r]}function zb(){let{router:e}=Bb("useNavigate"),t=rf("useNavigate"),r=x.useRef(!1);return Av(()=>{r.current=!0}),x.useCallback(async(i,n={})=>{Ur(r.current,Dv),r.current&&(typeof i=="number"?await e.navigate(i):await e.navigate(i,{fromRouteId:t,...n}))},[e,t])}var lp={};function _v(e,t,r){!t&&!lp[e]&&(lp[e]=!0,Ur(!1,r))}x.memo(Ub);function Ub({routes:e,future:t,state:r,onError:s}){return Iv(e,void 0,r,s,t)}function Lv({to:e,replace:t,state:r,relative:s}){gt(yo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=x.useContext(Dr);Ur(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:n}=x.useContext(Ps),{pathname:o}=Zs(),a=au(),l=Qh(e,Zh(n),o,s==="path"),c=JSON.stringify(l);return x.useEffect(()=>{a(JSON.parse(c),{replace:t,state:r,relative:s})},[a,c,s,t,r]),null}function hs(e){gt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function jb({basename:e="/",children:t=null,location:r,navigationType:s="POP",navigator:i,static:n=!1,unstable_useTransitions:o}){gt(!yo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),l=x.useMemo(()=>({basename:a,navigator:i,static:n,unstable_useTransitions:o,future:{}}),[a,i,n,o]);typeof r=="string"&&(r=wo(r));let{pathname:c="/",search:u="",hash:d="",state:h=null,key:f="default"}=r,p=x.useMemo(()=>{let g=Ks(c,a);return g==null?null:{location:{pathname:g,search:u,hash:d,state:h,key:f},navigationType:s}},[a,c,u,d,h,f,s]);return Ur(p!=null,`<Router basename="${a}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:x.createElement(Dr.Provider,{value:l},x.createElement(za.Provider,{children:t,value:p}))}function $b({children:e,location:t}){return Ib(Yd(e),t)}function Yd(e,t=[]){let r=[];return x.Children.forEach(e,(s,i)=>{if(!x.isValidElement(s))return;let n=[...t,i];if(s.type===x.Fragment){r.push.apply(r,Yd(s.props.children,n));return}gt(s.type===hs,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||n.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Yd(s.props.children,n)),r.push(o)}),r}var Hl="get",Vl="application/x-www-form-urlencoded";function lu(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function Kb(e){return lu(e)&&e.tagName.toLowerCase()==="button"}function qb(e){return lu(e)&&e.tagName.toLowerCase()==="form"}function Xb(e){return lu(e)&&e.tagName.toLowerCase()==="input"}function Yb(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Jb(e,t){return e.button===0&&(!t||t==="_self")&&!Yb(e)}var hl=null;function Zb(){if(hl===null)try{new FormData(document.createElement("form"),0),hl=!1}catch{hl=!0}return hl}var Qb=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ju(e){return e!=null&&!Qb.has(e)?(Ur(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vl}"`),null):e}function eF(e,t){let r,s,i,n,o;if(qb(e)){let a=e.getAttribute("action");s=a?Ks(a,t):null,r=e.getAttribute("method")||Hl,i=ju(e.getAttribute("enctype"))||Vl,n=new FormData(e)}else if(Kb(e)||Xb(e)&&(e.type==="submit"||e.type==="image")){let a=e.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||a.getAttribute("action");if(s=l?Ks(l,t):null,r=e.getAttribute("formmethod")||a.getAttribute("method")||Hl,i=ju(e.getAttribute("formenctype"))||ju(a.getAttribute("enctype"))||Vl,n=new FormData(a,e),!Zb()){let{name:c,type:u,value:d}=e;if(u==="image"){let h=c?`${c}.`:"";n.append(`${h}x`,"0"),n.append(`${h}y`,"0")}else c&&n.append(c,d)}}else{if(lu(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Hl,s=null,i=Vl,o=e}return n&&i==="text/plain"&&(o=n,n=void 0),{action:s,method:r.toLowerCase(),encType:i,formData:n,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sf(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function tF(e,t,r){let s=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return s.pathname==="/"?s.pathname=`_root.${r}`:t&&Ks(s.pathname,t)==="/"?s.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${r}`,s}async function rF(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function sF(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function iF(e,t,r){let s=await Promise.all(e.map(async i=>{let n=t.routes[i.route.id];if(n){let o=await rF(n,r);return o.links?o.links():[]}return[]}));return lF(s.flat(1).filter(sF).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function cp(e,t,r,s,i,n){let o=(l,c)=>r[c]?l.route.id!==r[c].route.id:!0,a=(l,c)=>{var u;return r[c].pathname!==l.pathname||((u=r[c].route.path)==null?void 0:u.endsWith("*"))&&r[c].params["*"]!==l.params["*"]};return n==="assets"?t.filter((l,c)=>o(l,c)||a(l,c)):n==="data"?t.filter((l,c)=>{var d;let u=s.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((d=r[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function nF(e,t,{includeHydrateFallback:r}={}){return oF(e.map(s=>{let i=t.routes[s.route.id];if(!i)return[];let n=[i.module];return i.clientActionModule&&(n=n.concat(i.clientActionModule)),i.clientLoaderModule&&(n=n.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(n=n.concat(i.hydrateFallbackModule)),i.imports&&(n=n.concat(i.imports)),n}).flat(1))}function oF(e){return[...new Set(e)]}function aF(e){let t={},r=Object.keys(e).sort();for(let s of r)t[s]=e[s];return t}function lF(e,t){let r=new Set;return new Set(t),e.reduce((s,i)=>{let n=JSON.stringify(aF(i));return r.has(n)||(r.add(n),s.push({key:n,link:i})),s},[])}function Ov(){let e=x.useContext(xo);return sf(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function cF(){let e=x.useContext(ou);return sf(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var nf=x.createContext(void 0);nf.displayName="FrameworkContext";function Nv(){let e=x.useContext(nf);return sf(e,"You must render this element inside a <HydratedRouter> element"),e}function uF(e,t){let r=x.useContext(nf),[s,i]=x.useState(!1),[n,o]=x.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=t,h=x.useRef(null);x.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let g=v=>{v.forEach(w=>{o(w.isIntersecting)})},m=new IntersectionObserver(g,{threshold:.5});return h.current&&m.observe(h.current),()=>{m.disconnect()}}},[e]),x.useEffect(()=>{if(s){let g=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(g)}}},[s]);let f=()=>{i(!0)},p=()=>{i(!1),o(!1)};return r?e!=="intent"?[n,h,{}]:[n,h,{onFocus:_o(a,f),onBlur:_o(l,p),onMouseEnter:_o(c,f),onMouseLeave:_o(u,p),onTouchStart:_o(d,f)}]:[!1,h,{}]}function _o(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function dF({page:e,...t}){let{router:r}=Ov(),s=x.useMemo(()=>yv(r.routes,e,r.basename),[r.routes,e,r.basename]);return s?x.createElement(fF,{page:e,matches:s,...t}):null}function hF(e){let{manifest:t,routeModules:r}=Nv(),[s,i]=x.useState([]);return x.useEffect(()=>{let n=!1;return iF(e,t,r).then(o=>{n||i(o)}),()=>{n=!0}},[e,t,r]),s}function fF({page:e,matches:t,...r}){let s=Zs(),{manifest:i,routeModules:n}=Nv(),{basename:o}=Ov(),{loaderData:a,matches:l}=cF(),c=x.useMemo(()=>cp(e,t,l,i,s,"data"),[e,t,l,i,s]),u=x.useMemo(()=>cp(e,t,l,i,s,"assets"),[e,t,l,i,s]),d=x.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let p=new Set,g=!1;if(t.forEach(v=>{var C;let w=i.routes[v.route.id];!w||!w.hasLoader||(!c.some(y=>y.route.id===v.route.id)&&v.route.id in a&&((C=n[v.route.id])!=null&&C.shouldRevalidate)||w.hasClientLoader?g=!0:p.add(v.route.id))}),p.size===0)return[];let m=tF(e,o,"data");return g&&p.size>0&&m.searchParams.set("_routes",t.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[m.pathname+m.search]},[o,a,s,i,c,t,e,n]),h=x.useMemo(()=>nF(u,i),[u,i]),f=hF(u);return x.createElement(x.Fragment,null,d.map(p=>x.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...r})),h.map(p=>x.createElement("link",{key:p,rel:"modulepreload",href:p,...r})),f.map(({key:p,link:g})=>x.createElement("link",{key:p,nonce:r.nonce,...g})))}function gF(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var pF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{pF&&(window.__reactRouterVersion="7.11.0")}catch{}function mF({basename:e,children:t,unstable_useTransitions:r,window:s}){let i=x.useRef();i.current==null&&(i.current=YS({window:s,v5Compat:!0}));let n=i.current,[o,a]=x.useState({action:n.action,location:n.location}),l=x.useCallback(c=>{r===!1?a(c):x.startTransition(()=>a(c))},[r]);return x.useLayoutEffect(()=>n.listen(l),[n,l]),x.createElement(jb,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:n,unstable_useTransitions:r})}var Bv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,of=x.forwardRef(function({onClick:t,discover:r="render",prefetch:s="none",relative:i,reloadDocument:n,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:h,...f},p){let{basename:g,unstable_useTransitions:m}=x.useContext(Dr),v=typeof c=="string"&&Bv.test(c),w=Ev(c,g);c=w.to;let C=Db(c,{relative:i}),[y,b,F]=uF(s,f),S=xF(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:d,unstable_defaultShouldRevalidate:h,unstable_useTransitions:m});function D(V){t&&t(V),V.defaultPrevented||S(V)}let T=x.createElement("a",{...f,...F,href:w.absoluteURL||C,onClick:w.isExternal||n?t:D,ref:gF(p,b),target:l,"data-discover":!v&&r==="render"?"true":void 0});return y&&!v?x.createElement(x.Fragment,null,T,x.createElement(dF,{page:C})):T});of.displayName="Link";var vF=x.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:s="",end:i=!1,style:n,to:o,viewTransition:a,children:l,...c},u){let d=Ua(o,{relative:c.relative}),h=Zs(),f=x.useContext(ou),{navigator:p,basename:g}=x.useContext(Dr),m=f!=null&&RF(d)&&a===!0,v=p.encodeLocation?p.encodeLocation(d).pathname:d.pathname,w=h.pathname,C=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;r||(w=w.toLowerCase(),C=C?C.toLowerCase():null,v=v.toLowerCase()),C&&g&&(C=Ks(C,g)||C);const y=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let b=w===v||!i&&w.startsWith(v)&&w.charAt(y)==="/",F=C!=null&&(C===v||!i&&C.startsWith(v)&&C.charAt(v.length)==="/"),S={isActive:b,isPending:F,isTransitioning:m},D=b?t:void 0,T;typeof s=="function"?T=s(S):T=[s,b?"active":null,F?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let V=typeof n=="function"?n(S):n;return x.createElement(of,{...c,"aria-current":D,className:T,ref:u,style:V,to:o,viewTransition:a},typeof l=="function"?l(S):l)});vF.displayName="NavLink";var CF=x.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:s,replace:i,state:n,method:o=Hl,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:h,...f},p)=>{let{unstable_useTransitions:g}=x.useContext(Dr),m=bF(),v=FF(a,{relative:c}),w=o.toLowerCase()==="get"?"get":"post",C=typeof a=="string"&&Bv.test(a),y=b=>{if(l&&l(b),b.defaultPrevented)return;b.preventDefault();let F=b.nativeEvent.submitter,S=(F==null?void 0:F.getAttribute("formmethod"))||o,D=()=>m(F||b.currentTarget,{fetcherKey:t,method:S,navigate:r,replace:i,state:n,relative:c,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:h});g&&r!==!1?x.startTransition(()=>D()):D()};return x.createElement("form",{ref:p,method:w,action:v,onSubmit:s?l:y,...f,"data-discover":!C&&e==="render"?"true":void 0})});CF.displayName="Form";function wF(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Hv(e){let t=x.useContext(xo);return gt(t,wF(e)),t}function xF(e,{target:t,replace:r,state:s,preventScrollReset:i,relative:n,viewTransition:o,unstable_defaultShouldRevalidate:a,unstable_useTransitions:l}={}){let c=au(),u=Zs(),d=Ua(e,{relative:n});return x.useCallback(h=>{if(Jb(h,t)){h.preventDefault();let f=r!==void 0?r:ha(u)===ha(d),p=()=>c(e,{replace:f,state:s,preventScrollReset:i,relative:n,viewTransition:o,unstable_defaultShouldRevalidate:a});l?x.startTransition(()=>p()):p()}},[u,c,d,r,s,t,e,i,n,o,a,l])}var yF=0,SF=()=>`__${String(++yF)}__`;function bF(){let{router:e}=Hv("useSubmit"),{basename:t}=x.useContext(Dr),r=Gb(),s=e.fetch,i=e.navigate;return x.useCallback(async(n,o={})=>{let{action:a,method:l,encType:c,formData:u,body:d}=eF(n,t);if(o.navigate===!1){let h=o.fetcherKey||SF();await s(h,r,o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||l,formEncType:o.encType||c,flushSync:o.flushSync})}else await i(o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||l,formEncType:o.encType||c,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,i,t,r])}function FF(e,{relative:t}={}){let{basename:r}=x.useContext(Dr),s=x.useContext(Ps);gt(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),n={...Ua(e||".",{relative:t})},o=Zs();if(e==null){n.search=o.search;let a=new URLSearchParams(n.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();n.search=u?`?${u}`:""}}return(!e||e===".")&&i.route.index&&(n.search=n.search?n.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(n.pathname=n.pathname==="/"?r:Bs([r,n.pathname])),ha(n)}function RF(e,{relative:t}={}){let r=x.useContext(kv);gt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Hv("useViewTransitionState"),i=Ua(e,{relative:t});if(!r.isTransitioning)return!1;let n=Ks(r.currentLocation.pathname,s)||r.currentLocation.pathname,o=Ks(r.nextLocation.pathname,s)||r.nextLocation.pathname;return uc(i.pathname,o)!=null||uc(i.pathname,n)!=null}var $u={exports:{}},Ku={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var up;function EF(){if(up)return Ku;up=1;var e=jS();function t(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,i=e.useRef,n=e.useEffect,o=e.useMemo,a=e.useDebugValue;return Ku.useSyncExternalStoreWithSelector=function(l,c,u,d,h){var f=i(null);if(f.current===null){var p={hasValue:!1,value:null};f.current=p}else p=f.current;f=o(function(){function m(b){if(!v){if(v=!0,w=b,b=d(b),h!==void 0&&p.hasValue){var F=p.value;if(h(F,b))return C=F}return C=b}if(F=C,r(w,b))return F;var S=d(b);return h!==void 0&&h(F,S)?(w=b,F):(w=b,C=S)}var v=!1,w,C,y=u===void 0?null:u;return[function(){return m(c())},y===null?void 0:function(){return m(y())}]},[c,u,d,h]);var g=s(l,f[0],f[1]);return n(function(){p.hasValue=!0,p.value=g},[g]),a(g),g},Ku}var dp;function TF(){return dp||(dp=1,$u.exports=EF()),$u.exports}var kF=TF();function PF(e){e()}function DF(){let e=null,t=null;return{clear(){e=null,t=null},notify(){PF(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!s||e===null||(s=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var hp={notify(){},get:()=>[]};function AF(e,t){let r,s=hp,i=0,n=!1;function o(g){u();const m=s.subscribe(g);let v=!1;return()=>{v||(v=!0,m(),d())}}function a(){s.notify()}function l(){p.onStateChange&&p.onStateChange()}function c(){return n}function u(){i++,r||(r=e.subscribe(l),s=DF())}function d(){i--,r&&i===0&&(r(),r=void 0,s.clear(),s=hp)}function h(){n||(n=!0,u())}function f(){n&&(n=!1,d())}const p={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:h,tryUnsubscribe:f,getListeners:()=>s};return p}var IF=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MF=IF(),_F=()=>typeof navigator<"u"&&navigator.product==="ReactNative",LF=_F(),OF=()=>MF||LF?x.useLayoutEffect:x.useEffect,NF=OF(),qu=Symbol.for("react-redux-context"),Xu=typeof globalThis<"u"?globalThis:{};function BF(){if(!x.createContext)return{};const e=Xu[qu]??(Xu[qu]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var mi=BF();function HF(e){const{children:t,context:r,serverState:s,store:i}=e,n=x.useMemo(()=>{const l=AF(i);return{store:i,subscription:l,getServerState:s?()=>s:void 0}},[i,s]),o=x.useMemo(()=>i.getState(),[i]);NF(()=>{const{subscription:l}=n;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[n,o]);const a=r||mi;return x.createElement(a.Provider,{value:n},t)}var VF=HF;function af(e=mi){return function(){return x.useContext(e)}}var Vv=af();function Gv(e=mi){const t=e===mi?Vv:af(e),r=()=>{const{store:s}=t();return s};return Object.assign(r,{withTypes:()=>r}),r}var GF=Gv();function WF(e=mi){const t=e===mi?GF:Gv(e),r=()=>t().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var zF=WF(),UF=(e,t)=>e===t;function jF(e=mi){const t=e===mi?Vv:af(e),r=(s,i={})=>{const{equalityFn:n=UF}=typeof i=="function"?{equalityFn:i}:i,o=t(),{store:a,subscription:l,getServerState:c}=o;x.useRef(!0);const u=x.useCallback({[s.name](h){return s(h)}}[s.name],[s]),d=kF.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,n);return x.useDebugValue(d),d};return Object.assign(r,{withTypes:()=>r}),r}var $F=jF();function jt(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var KF=typeof Symbol=="function"&&Symbol.observable||"@@observable",fp=KF,Yu=()=>Math.random().toString(36).substring(7).split("").join("."),qF={INIT:`@@redux/INIT${Yu()}`,REPLACE:`@@redux/REPLACE${Yu()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Yu()}`},dc=qF;function lf(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Wv(e,t,r){if(typeof e!="function")throw new Error(jt(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(jt(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(jt(1));return r(Wv)(e,t)}let s=e,i=t,n=new Map,o=n,a=0,l=!1;function c(){o===n&&(o=new Map,n.forEach((m,v)=>{o.set(v,m)}))}function u(){if(l)throw new Error(jt(3));return i}function d(m){if(typeof m!="function")throw new Error(jt(4));if(l)throw new Error(jt(5));let v=!0;c();const w=a++;return o.set(w,m),function(){if(v){if(l)throw new Error(jt(6));v=!1,c(),o.delete(w),n=null}}}function h(m){if(!lf(m))throw new Error(jt(7));if(typeof m.type>"u")throw new Error(jt(8));if(typeof m.type!="string")throw new Error(jt(17));if(l)throw new Error(jt(9));try{l=!0,i=s(i,m)}finally{l=!1}return(n=o).forEach(w=>{w()}),m}function f(m){if(typeof m!="function")throw new Error(jt(10));s=m,h({type:dc.REPLACE})}function p(){const m=d;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(jt(11));function w(){const y=v;y.next&&y.next(u())}return w(),{unsubscribe:m(w)}},[fp](){return this}}}return h({type:dc.INIT}),{dispatch:h,subscribe:d,getState:u,replaceReducer:f,[fp]:p}}function XF(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:dc.INIT})>"u")throw new Error(jt(12));if(typeof r(void 0,{type:dc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(jt(13))})}function YF(e){const t=Object.keys(e),r={};for(let n=0;n<t.length;n++){const o=t[n];typeof e[o]=="function"&&(r[o]=e[o])}const s=Object.keys(r);let i;try{XF(r)}catch(n){i=n}return function(o={},a){if(i)throw i;let l=!1;const c={};for(let u=0;u<s.length;u++){const d=s[u],h=r[d],f=o[d],p=h(f,a);if(typeof p>"u")throw a&&a.type,new Error(jt(14));c[d]=p,l=l||p!==f}return l=l||s.length!==Object.keys(o).length,l?c:o}}function hc(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...s)=>t(r(...s)))}function JF(...e){return t=>(r,s)=>{const i=t(r,s);let n=()=>{throw new Error(jt(15))};const o={getState:i.getState,dispatch:(l,...c)=>n(l,...c)},a=e.map(l=>l(o));return n=hc(...a)(i.dispatch),{...i,dispatch:n}}}function ZF(e){return lf(e)&&"type"in e&&typeof e.type=="string"}var zv=Symbol.for("immer-nothing"),gp=Symbol.for("immer-draftable"),dr=Symbol.for("immer-state");function Jr(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Er=Object,ao=Er.getPrototypeOf,fc="constructor",cu="prototype",Jd="configurable",gc="enumerable",Gl="writable",fa="value",qs=e=>!!e&&!!e[dr];function is(e){var t;return e?Uv(e)||du(e)||!!e[gp]||!!((t=e[fc])!=null&&t[gp])||hu(e)||fu(e):!1}var QF=Er[cu][fc].toString(),pp=new WeakMap;function Uv(e){if(!e||!cf(e))return!1;const t=ao(e);if(t===null||t===Er[cu])return!0;const r=Er.hasOwnProperty.call(t,fc)&&t[fc];if(r===Object)return!0;if(!_n(r))return!1;let s=pp.get(r);return s===void 0&&(s=Function.toString.call(r),pp.set(r,s)),s===QF}function uu(e,t,r=!0){ja(e)===0?(r?Reflect.ownKeys(e):Er.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((s,i)=>t(i,s,e))}function ja(e){const t=e[dr];return t?t.type_:du(e)?1:hu(e)?2:fu(e)?3:0}var mp=(e,t,r=ja(e))=>r===2?e.has(t):Er[cu].hasOwnProperty.call(e,t),Zd=(e,t,r=ja(e))=>r===2?e.get(t):e[t],pc=(e,t,r,s=ja(e))=>{s===2?e.set(t,r):s===3?e.add(r):e[t]=r};function eR(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var du=Array.isArray,hu=e=>e instanceof Map,fu=e=>e instanceof Set,cf=e=>typeof e=="object",_n=e=>typeof e=="function",Ju=e=>typeof e=="boolean";function tR(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var _s=e=>e.copy_||e.base_,uf=e=>e.modified_?e.copy_:e.base_;function Qd(e,t){if(hu(e))return new Map(e);if(fu(e))return new Set(e);if(du(e))return Array[cu].slice.call(e);const r=Uv(e);if(t===!0||t==="class_only"&&!r){const s=Er.getOwnPropertyDescriptors(e);delete s[dr];let i=Reflect.ownKeys(s);for(let n=0;n<i.length;n++){const o=i[n],a=s[o];a[Gl]===!1&&(a[Gl]=!0,a[Jd]=!0),(a.get||a.set)&&(s[o]={[Jd]:!0,[Gl]:!0,[gc]:a[gc],[fa]:e[o]})}return Er.create(ao(e),s)}else{const s=ao(e);if(s!==null&&r)return{...e};const i=Er.create(s);return Er.assign(i,e)}}function df(e,t=!1){return gu(e)||qs(e)||!is(e)||(ja(e)>1&&Er.defineProperties(e,{set:fl,add:fl,clear:fl,delete:fl}),Er.freeze(e),t&&uu(e,(r,s)=>{df(s,!0)},!1)),e}function rR(){Jr(2)}var fl={[fa]:rR};function gu(e){return e===null||!cf(e)?!0:Er.isFrozen(e)}var mc="MapSet",eh="Patches",vp="ArrayMethods",jv={};function rn(e){const t=jv[e];return t||Jr(0,e),t}var Cp=e=>!!jv[e],ga,$v=()=>ga,sR=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:Cp(mc)?rn(mc):void 0,arrayMethodsPlugin_:Cp(vp)?rn(vp):void 0});function wp(e,t){t&&(e.patchPlugin_=rn(eh),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function th(e){rh(e),e.drafts_.forEach(iR),e.drafts_=null}function rh(e){e===ga&&(ga=e.parent_)}var xp=e=>ga=sR(ga,e);function iR(e){const t=e[dr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function yp(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[dr].modified_&&(th(t),Jr(4)),is(e)&&(e=Sp(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[dr].base_,e,t)}else e=Sp(t,r);return nR(t,e,!0),th(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==zv?e:void 0}function Sp(e,t){if(gu(t))return t;const r=t[dr];if(!r)return vc(t,e.handledSet_,e);if(!pu(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:s}=r;if(s)for(;s.length>0;)s.pop()(e);Xv(r,e)}return r.copy_}function nR(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&df(t,r)}function Kv(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var pu=(e,t)=>e.scope_===t,oR=[];function qv(e,t,r,s){const i=_s(e),n=e.type_;if(s!==void 0&&Zd(i,s,n)===t){pc(i,s,r,n);return}if(!e.draftLocations_){const a=e.draftLocations_=new Map;uu(i,(l,c)=>{if(qs(c)){const u=a.get(c)||[];u.push(l),a.set(c,u)}})}const o=e.draftLocations_.get(t)??oR;for(const a of o)pc(i,a,r,n)}function aR(e,t,r){e.callbacks_.push(function(i){var a;const n=t;if(!n||!pu(n,i))return;(a=i.mapSetPlugin_)==null||a.fixSetContents(n);const o=uf(n);qv(e,n.draft_??n,o,r),Xv(n,i)})}function Xv(e,t){var s;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((s=e.assigned_)==null?void 0:s.size)??0)>0)){const{patchPlugin_:i}=t;if(i){const n=i.getPath(e);n&&i.generatePatches_(e,n,t)}Kv(e)}}function lR(e,t,r){const{scope_:s}=e;if(qs(r)){const i=r[dr];pu(i,s)&&i.callbacks_.push(function(){Wl(e);const o=uf(i);qv(e,r,o,t)})}else is(r)&&e.callbacks_.push(function(){const n=_s(e);e.type_===3?n.has(r)&&vc(r,s.handledSet_,s):Zd(n,t,e.type_)===r&&s.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&vc(Zd(e.copy_,t,e.type_),s.handledSet_,s)})}function vc(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||qs(e)||t.has(e)||!is(e)||gu(e)||(t.add(e),uu(e,(s,i)=>{if(qs(i)){const n=i[dr];if(pu(n,r)){const o=uf(n);pc(e,s,o,e.type_),Kv(n)}}else is(i)&&vc(i,t,r)})),e}function cR(e,t){const r=du(e),s={type_:r?1:0,scope_:t?t.scope_:$v(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=s,n=Cc;r&&(i=[s],n=pa);const{revoke:o,proxy:a}=Proxy.revocable(i,n);return s.draft_=a,s.revoke_=o,[a,s]}var Cc={get(e,t){if(t===dr)return e;let r=e.scope_.arrayMethodsPlugin_;const s=e.type_===1&&typeof t=="string";if(s&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const i=_s(e);if(!mp(i,t,e.type_))return uR(e,i,t);const n=i[t];if(e.finalized_||!is(n)||s&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&tR(t))return n;if(n===Zu(e.base_,t)){Wl(e);const o=e.type_===1?+t:t,a=ih(e.scope_,n,e,o);return e.copy_[o]=a}return n},has(e,t){return t in _s(e)},ownKeys(e){return Reflect.ownKeys(_s(e))},set(e,t,r){const s=Yv(_s(e),t);if(s!=null&&s.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const i=Zu(_s(e),t),n=i==null?void 0:i[dr];if(n&&n.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(eR(r,i)&&(r!==void 0||mp(e.base_,t,e.type_)))return!0;Wl(e),sh(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),lR(e,t,r)),!0},deleteProperty(e,t){return Wl(e),Zu(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),sh(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=_s(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{[Gl]:!0,[Jd]:e.type_!==1||t!=="length",[gc]:s[gc],[fa]:r[t]}},defineProperty(){Jr(11)},getPrototypeOf(e){return ao(e.base_)},setPrototypeOf(){Jr(12)}},pa={};for(let e in Cc){let t=Cc[e];pa[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}pa.deleteProperty=function(e,t){return pa.set.call(this,e,t,void 0)};pa.set=function(e,t,r){return Cc.set.call(this,e[0],t,r,e[0])};function Zu(e,t){const r=e[dr];return(r?_s(r):e)[t]}function uR(e,t,r){var i;const s=Yv(t,r);return s?fa in s?s[fa]:(i=s.get)==null?void 0:i.call(e.draft_):void 0}function Yv(e,t){if(!(t in e))return;let r=ao(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=ao(r)}}function sh(e){e.modified_||(e.modified_=!0,e.parent_&&sh(e.parent_))}function Wl(e){e.copy_||(e.assigned_=new Map,e.copy_=Qd(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var dR=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(t,r,s)=>{if(_n(t)&&!_n(r)){const n=r;r=t;const o=this;return function(l=n,...c){return o.produce(l,u=>r.call(this,u,...c))}}_n(r)||Jr(6),s!==void 0&&!_n(s)&&Jr(7);let i;if(is(t)){const n=xp(this),o=ih(n,t,void 0);let a=!0;try{i=r(o),a=!1}finally{a?th(n):rh(n)}return wp(n,s),yp(i,n)}else if(!t||!cf(t)){if(i=r(t),i===void 0&&(i=t),i===zv&&(i=void 0),this.autoFreeze_&&df(i,!0),s){const n=[],o=[];rn(eh).generateReplacementPatches_(t,i,{patches_:n,inversePatches_:o}),s(n,o)}return i}else Jr(1,t)},this.produceWithPatches=(t,r)=>{if(_n(t))return(o,...a)=>this.produceWithPatches(o,l=>t(l,...a));let s,i;return[this.produce(t,r,(o,a)=>{s=o,i=a}),s,i]},Ju(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),Ju(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),Ju(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){is(e)||Jr(8),qs(e)&&(e=hR(e));const t=xp(this),r=ih(t,e,void 0);return r[dr].isManual_=!0,rh(t),r}finishDraft(e,t){const r=e&&e[dr];(!r||!r.isManual_)&&Jr(9);const{scope_:s}=r;return wp(s,t),yp(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const s=rn(eh).applyPatches_;return qs(e)?s(e,t):this.produce(e,i=>s(i,t))}};function ih(e,t,r,s){const[i,n]=hu(t)?rn(mc).proxyMap_(t,r):fu(t)?rn(mc).proxySet_(t,r):cR(t,r);return((r==null?void 0:r.scope_)??$v()).drafts_.push(i),n.callbacks_=(r==null?void 0:r.callbacks_)??[],n.key_=s,r&&s!==void 0?aR(r,n,s):n.callbacks_.push(function(l){var u;(u=l.mapSetPlugin_)==null||u.fixSetContents(n);const{patchPlugin_:c}=l;n.modified_&&c&&c.generatePatches_(n,[],l)}),i}function hR(e){return qs(e)||Jr(10,e),Jv(e)}function Jv(e){if(!is(e)||gu(e))return e;const t=e[dr];let r,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Qd(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else r=Qd(e,!0);return uu(r,(i,n)=>{pc(r,i,Jv(n))},s),t&&(t.finalized_=!1),r}var fR=new dR,Zv=fR.produce;function Qv(e){return({dispatch:r,getState:s})=>i=>n=>typeof n=="function"?n(r,s,e):i(n)}var gR=Qv(),pR=Qv,mR=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?hc:hc.apply(null,arguments)},vR=e=>e&&typeof e.match=="function";function qo(e,t){function r(...s){if(t){let i=t(...s);if(!i)throw new Error(Hs(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:s[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=s=>ZF(s)&&s.type===e,r}var eC=class Wo extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Wo.prototype)}static get[Symbol.species](){return Wo}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Wo(...t[0].concat(this)):new Wo(...t.concat(this))}};function bp(e){return is(e)?Zv(e,()=>{}):e}function gl(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function CR(e){return typeof e=="boolean"}var wR=()=>function(t){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:i=!0,actionCreatorCheck:n=!0}=t??{};let o=new eC;return r&&(CR(r)?o.push(gR):o.push(pR(r.extraArgument))),o},xR="RTK_autoBatch",Fp=e=>t=>{setTimeout(t,e)},yR=(e={type:"raf"})=>t=>(...r)=>{const s=t(...r);let i=!0,n=!1,o=!1;const a=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Fp(10):e.type==="callback"?e.queueNotification:Fp(e.timeout),c=()=>{o=!1,n&&(n=!1,a.forEach(u=>u()))};return Object.assign({},s,{subscribe(u){const d=()=>i&&u(),h=s.subscribe(d);return a.add(u),()=>{h(),a.delete(u)}},dispatch(u){var d;try{return i=!((d=u==null?void 0:u.meta)!=null&&d[xR]),n=!i,n&&(o||(o=!0,l(c))),s.dispatch(u)}finally{i=!0}}})},SR=e=>function(r){const{autoBatch:s=!0}=r??{};let i=new eC(e);return s&&i.push(yR(typeof s=="object"?s:void 0)),i};function bR(e){const t=wR(),{reducer:r=void 0,middleware:s,devTools:i=!0,preloadedState:n=void 0,enhancers:o=void 0}=e||{};let a;if(typeof r=="function")a=r;else if(lf(r))a=YF(r);else throw new Error(Hs(1));let l;typeof s=="function"?l=s(t):l=t();let c=hc;i&&(c=mR({trace:!1,...typeof i=="object"&&i}));const u=JF(...l),d=SR(u);let h=typeof o=="function"?o(d):d();const f=c(...h);return Wv(a,n,f)}function tC(e){const t={},r=[];let s;const i={addCase(n,o){const a=typeof n=="string"?n:n.type;if(!a)throw new Error(Hs(28));if(a in t)throw new Error(Hs(29));return t[a]=o,i},addAsyncThunk(n,o){return o.pending&&(t[n.pending.type]=o.pending),o.rejected&&(t[n.rejected.type]=o.rejected),o.fulfilled&&(t[n.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:n.settled,reducer:o.settled}),i},addMatcher(n,o){return r.push({matcher:n,reducer:o}),i},addDefaultCase(n){return s=n,i}};return e(i),[t,r,s]}function FR(e){return typeof e=="function"}function RR(e,t){let[r,s,i]=tC(t),n;if(FR(e))n=()=>bp(e());else{const a=bp(e);n=()=>a}function o(a=n(),l){let c=[r[l.type],...s.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[i]),c.reduce((u,d)=>{if(d)if(qs(u)){const f=d(u,l);return f===void 0?u:f}else{if(is(u))return Zv(u,h=>d(h,l));{const h=d(u,l);if(h===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return u},a)}return o.getInitialState=n,o}var ER=(e,t)=>vR(e)?e.match(t):e(t);function TR(...e){return t=>e.some(r=>ER(r,t))}var kR="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",PR=(e=21)=>{let t="",r=e;for(;r--;)t+=kR[Math.random()*64|0];return t},DR=["name","message","stack","code"],Qu=class{constructor(e,t){ul(this,"_type");this.payload=e,this.meta=t}},Rp=class{constructor(e,t){ul(this,"_type");this.payload=e,this.meta=t}},AR=e=>{if(typeof e=="object"&&e!==null){const t={};for(const r of DR)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},Ep="External signal was aborted",mu=(()=>{function e(t,r,s){const i=qo(t+"/fulfilled",(l,c,u,d)=>({payload:l,meta:{...d||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),n=qo(t+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=qo(t+"/rejected",(l,c,u,d,h)=>({payload:d,error:(s&&s.serializeError||AR)(l||"Rejected"),meta:{...h||{},arg:u,requestId:c,rejectedWithValue:!!d,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function a(l,{signal:c}={}){return(u,d,h)=>{const f=s!=null&&s.idGenerator?s.idGenerator(l):PR(),p=new AbortController;let g,m;function v(C){m=C,p.abort()}c&&(c.aborted?v(Ep):c.addEventListener("abort",()=>v(Ep),{once:!0}));const w=(async function(){var b,F;let C;try{let S=(b=s==null?void 0:s.condition)==null?void 0:b.call(s,l,{getState:d,extra:h});if(MR(S)&&(S=await S),S===!1||p.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const D=new Promise((T,V)=>{g=()=>{V({name:"AbortError",message:m||"Aborted"})},p.signal.addEventListener("abort",g,{once:!0})});u(n(f,l,(F=s==null?void 0:s.getPendingMeta)==null?void 0:F.call(s,{requestId:f,arg:l},{getState:d,extra:h}))),C=await Promise.race([D,Promise.resolve(r(l,{dispatch:u,getState:d,extra:h,requestId:f,signal:p.signal,abort:v,rejectWithValue:(T,V)=>new Qu(T,V),fulfillWithValue:(T,V)=>new Rp(T,V)})).then(T=>{if(T instanceof Qu)throw T;return T instanceof Rp?i(T.payload,f,l,T.meta):i(T,f,l)})])}catch(S){C=S instanceof Qu?o(null,f,l,S.payload,S.meta):o(S,f,l)}finally{g&&p.signal.removeEventListener("abort",g)}return s&&!s.dispatchConditionRejection&&o.match(C)&&C.meta.condition||u(C),C})();return Object.assign(w,{abort:v,requestId:f,arg:l,unwrap(){return w.then(IR)}})}}return Object.assign(a,{pending:n,rejected:o,fulfilled:i,settled:TR(o,i),typePrefix:t})}return e.withTypes=()=>e,e})();function IR(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function MR(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var _R=Symbol.for("rtk-slice-createasyncthunk");function LR(e,t){return`${e}/${t}`}function OR({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[_R];return function(i){const{name:n,reducerPath:o=n}=i;if(!n)throw new Error(Hs(11));const a=(typeof i.reducers=="function"?i.reducers(HR()):i.reducers)||{},l=Object.keys(a),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(y,b){const F=typeof y=="string"?y:y.type;if(!F)throw new Error(Hs(12));if(F in c.sliceCaseReducersByType)throw new Error(Hs(13));return c.sliceCaseReducersByType[F]=b,u},addMatcher(y,b){return c.sliceMatchers.push({matcher:y,reducer:b}),u},exposeAction(y,b){return c.actionCreators[y]=b,u},exposeCaseReducer(y,b){return c.sliceCaseReducersByName[y]=b,u}};l.forEach(y=>{const b=a[y],F={reducerName:y,type:LR(n,y),createNotation:typeof i.reducers=="function"};GR(b)?zR(F,b,u,t):VR(F,b,u)});function d(){const[y={},b=[],F=void 0]=typeof i.extraReducers=="function"?tC(i.extraReducers):[i.extraReducers],S={...y,...c.sliceCaseReducersByType};return RR(i.initialState,D=>{for(let T in S)D.addCase(T,S[T]);for(let T of c.sliceMatchers)D.addMatcher(T.matcher,T.reducer);for(let T of b)D.addMatcher(T.matcher,T.reducer);F&&D.addDefaultCase(F)})}const h=y=>y,f=new Map,p=new WeakMap;let g;function m(y,b){return g||(g=d()),g(y,b)}function v(){return g||(g=d()),g.getInitialState()}function w(y,b=!1){function F(D){let T=D[y];return typeof T>"u"&&b&&(T=gl(p,F,v)),T}function S(D=h){const T=gl(f,b,()=>new WeakMap);return gl(T,D,()=>{const V={};for(const[_,I]of Object.entries(i.selectors??{}))V[_]=NR(I,D,()=>gl(p,D,v),b);return V})}return{reducerPath:y,getSelectors:S,get selectors(){return S(F)},selectSlice:F}}const C={name:n,reducer:m,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:v,...w(o),injectInto(y,{reducerPath:b,...F}={}){const S=b??o;return y.inject({reducerPath:S,reducer:m},F),{...C,...w(S,!0)}}};return C}}function NR(e,t,r,s){function i(n,...o){let a=t(n);return typeof a>"u"&&s&&(a=r()),e(a,...o)}return i.unwrapped=e,i}var BR=OR();function HR(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function VR({type:e,reducerName:t,createNotation:r},s,i){let n,o;if("reducer"in s){if(r&&!WR(s))throw new Error(Hs(17));n=s.reducer,o=s.prepare}else n=s;i.addCase(e,n).exposeCaseReducer(t,n).exposeAction(t,o?qo(e,o):qo(e))}function GR(e){return e._reducerDefinitionType==="asyncThunk"}function WR(e){return e._reducerDefinitionType==="reducerWithPrepare"}function zR({type:e,reducerName:t},r,s,i){if(!i)throw new Error(Hs(18));const{payloadCreator:n,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=r,d=i(e,n,u);s.exposeAction(t,d),o&&s.addCase(d.fulfilled,o),a&&s.addCase(d.pending,a),l&&s.addCase(d.rejected,l),c&&s.addMatcher(d.settled,c),s.exposeCaseReducer(t,{fulfilled:o||pl,pending:a||pl,rejected:l||pl,settled:c||pl})}function pl(){}function Hs(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const UR="/api";class jR{constructor(t=UR){ul(this,"baseURL");this.baseURL=t}async request(t,r={}){try{const s=`${this.baseURL}${t}`,i={headers:{"Content-Type":"application/json",...r.headers},...r},n=await fetch(s,i),o=await n.json();return n.ok?{success:!0,data:o}:{success:!1,error:o.message||"Request failed"}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Network error"}}}async get(t){return this.request(t,{method:"GET"})}async post(t,r){return this.request(t,{method:"POST",body:r?JSON.stringify(r):void 0})}async put(t,r){return this.request(t,{method:"PUT",body:r?JSON.stringify(r):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}}const $a=new jR,$R={items:[],loading:!1,error:null},zl=mu("inventory/fetchInventory",async(e,{rejectWithValue:t})=>{const r=await $a.get("/inventory");return r.success&&r.data?r.data:t(r.error||"Failed to fetch inventory")}),wc=mu("inventory/addItem",async(e,{rejectWithValue:t})=>{const r=await $a.post("/inventory",e);return r.success&&r.data?r.data:t(r.error||"Failed to add item")}),xc=mu("inventory/updateItem",async({id:e,data:t},{rejectWithValue:r})=>{const s=await $a.put(`/inventory/${e}`,t);return s.success&&s.data?s.data:r(s.error||"Failed to update item")}),nh=mu("inventory/deleteItem",async(e,{rejectWithValue:t})=>{const r=await $a.delete(`/inventory/${e}`);return r.success?e:t(r.error||"Failed to delete item")}),rC=BR({name:"inventory",initialState:$R,reducers:{clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(zl.pending,t=>{t.loading=!0,t.error=null}).addCase(zl.fulfilled,(t,r)=>{t.loading=!1,t.items=r.payload}).addCase(zl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(wc.fulfilled,(t,r)=>{t.items.push(r.payload)}).addCase(wc.rejected,(t,r)=>{t.error=r.payload}).addCase(xc.fulfilled,(t,r)=>{const s=t.items.findIndex(i=>i.id===r.payload.id);s!==-1&&(t.items[s]=r.payload)}).addCase(xc.rejected,(t,r)=>{t.error=r.payload}).addCase(nh.fulfilled,(t,r)=>{t.items=t.items.filter(s=>s.id!==r.payload)}).addCase(nh.rejected,(t,r)=>{t.error=r.payload})}}),{clearError:_X}=rC.actions,KR=rC.reducer,qR=bR({reducer:{inventory:KR}}),sC=x.createContext(void 0);function XR({children:e}){const[t,r]=x.useState(null),[s,i]=x.useState(!0);x.useEffect(()=>{const a=localStorage.getItem("user"),l=localStorage.getItem("token");a&&l&&r(JSON.parse(a)),i(!1)},[]);const n=async(a,l)=>{try{const c=await $a.post("/auth/login",{username:a,password:l});return c.success&&c.data?(r(c.data.user),localStorage.setItem("user",JSON.stringify(c.data.user)),localStorage.setItem("token",c.data.token),!0):!1}catch(c){return console.error("Login error:",c),!1}},o=()=>{r(null),localStorage.removeItem("user"),localStorage.removeItem("token")};return E.jsx(sC.Provider,{value:{user:t,isAuthenticated:!!t,isLoading:s,login:n,logout:o},children:e})}function hf(){const e=x.useContext(sC);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function Oi({children:e}){const{isAuthenticated:t,isLoading:r}=hf();return r?E.jsx("div",{className:"min-h-screen flex items-center justify-center",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t?E.jsx(E.Fragment,{children:e}):E.jsx(Lv,{to:"/login",replace:!0})}function Ul({onClick:e,children:t,variant:r="primary",size:s="md",className:i="",disabled:n=!1,type:o="button"}){const a="flex items-center gap-1.5 rounded-lg transition-all duration-300 shadow-md font-medium",l={primary:"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 hover:shadow-blue-500/30",success:"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white hover:from-emerald-700 hover:to-emerald-800 hover:shadow-emerald-600/30",info:"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white hover:from-indigo-700 hover:to-indigo-800 hover:shadow-indigo-600/30",secondary:"bg-gradient-to-r from-gray-500 to-gray-600 text-white hover:from-gray-600 hover:to-gray-700 hover:shadow-gray-500/30"},c={sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"},u=n?"opacity-50 cursor-not-allowed":"";return E.jsx("button",{type:o,onClick:e,disabled:n,className:`${a} ${l[r]} ${c[s]} ${u} ${i}`,children:t})}function vn(...e){return $S(KS(e))}function Tp({className:e,type:t,...r}){return E.jsx("input",{type:t,"data-slot":"input",className:vn("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}function kp({className:e,...t}){return E.jsx(WS,{"data-slot":"label",className:vn("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function YR({className:e,...t}){return E.jsx("div",{"data-slot":"card",className:vn("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",e),...t})}function JR({className:e,...t}){return E.jsx("div",{"data-slot":"card-header",className:vn("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function ZR({className:e,...t}){return E.jsx("h4",{"data-slot":"card-title",className:vn("leading-none",e),...t})}function QR({className:e,...t}){return E.jsx("p",{"data-slot":"card-description",className:vn("text-muted-foreground",e),...t})}function eE({className:e,...t}){return E.jsx("div",{"data-slot":"card-content",className:vn("px-6 [&:last-child]:pb-6",e),...t})}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rE=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,s)=>s?s.toUpperCase():r.toLowerCase()),Pp=e=>{const t=rE(e);return t.charAt(0).toUpperCase()+t.slice(1)},iC=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=x.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:i="",children:n,iconNode:o,...a},l)=>x.createElement("svg",{ref:l,...sE,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:iC("lucide",i),...a},[...o.map(([c,u])=>x.createElement(c,u)),...Array.isArray(n)?n:[n]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=(e,t)=>{const r=x.forwardRef(({className:s,...i},n)=>x.createElement(iE,{ref:n,iconNode:t,className:iC(`lucide-${tE(Pp(e))}`,`lucide-${e}`,s),...i}));return r.displayName=Pp(e),r};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],oE=mt("calculator",nE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],nC=mt("chef-hat",aE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],oC=mt("circle-check-big",lE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],uE=mt("circle-x",cE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dE=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],hE=mt("download",dE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fE=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],gE=mt("file-text",fE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pE=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],mE=mt("layout-dashboard",pE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],CE=mt("lock",vE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],xE=mt("log-out",wE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],SE=mt("mail",yE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=[["path",{d:"M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z",key:"1ront0"}],["path",{d:"m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9",key:"19h2x1"}],["path",{d:"M12 3v6",key:"1holv5"}]],FE=mt("package-2",bE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],EE=mt("package",RE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],kE=mt("pencil",TE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],DE=mt("plus",PE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],IE=mt("receipt",AE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],_E=mt("search",ME);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],OE=mt("shopping-cart",LE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],BE=mt("trash-2",NE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ff=mt("triangle-alert",HE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],GE=mt("upload",VE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],zE=mt("users",WE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],jE=mt("utensils",UE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]],KE=mt("wine",$E);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],aC=mt("x",qE),XE="/assets/MPH_AI_Logo-D6njH9i9.png",lC="/assets/MPH_Logo_White-CvcbVX4b.png";function YE(){const[e,t]=x.useState(""),[r,s]=x.useState(""),[i,n]=x.useState(""),o=au(),{login:a}=hf(),l=async c=>{c.preventDefault(),n(""),await a(e,r)?o("/inventory"):n("Invalid username or password")};return E.jsxs("div",{className:"min-h-screen flex",children:[E.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative bg-gradient-to-br from-amber-900 via-orange-800 to-red-900 overflow-hidden",children:[E.jsx("div",{className:"absolute inset-0 opacity-10",children:E.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(255,255,255,.1) 35px, rgba(255,255,255,.1) 70px)"}})}),E.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full p-12 text-white",children:[E.jsx("div",{className:"mb-12",children:E.jsx("img",{src:lC,alt:"Madurai Pandiyan Hotel Logo",className:"w-40 h-40 object-contain drop-shadow-2xl"})}),E.jsxs("div",{className:"flex gap-12 mb-16",children:[E.jsxs("div",{className:"flex flex-col items-center gap-3",children:[E.jsx("div",{className:"w-20 h-20 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center border-2 border-white/20",children:E.jsx(jE,{className:"w-10 h-10"})}),E.jsx("span",{className:"text-white/90",children:"Fine Dining"})]}),E.jsxs("div",{className:"flex flex-col items-center gap-3",children:[E.jsx("div",{className:"w-20 h-20 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center border-2 border-white/20",children:E.jsx(nC,{className:"w-10 h-10"})}),E.jsx("span",{className:"text-white/90",children:"Expert Chefs"})]}),E.jsxs("div",{className:"flex flex-col items-center gap-3",children:[E.jsx("div",{className:"w-20 h-20 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center border-2 border-white/20",children:E.jsx(KE,{className:"w-10 h-10"})}),E.jsx("span",{className:"text-white/90",children:"Premium Service"})]})]}),E.jsxs("div",{className:"text-center max-w-md",children:[E.jsx("h2",{className:"mb-4 text-white",children:"Madurai Pandiyan Hotel"}),E.jsx("p",{className:"text-white/90 mb-8",children:"Experience the authentic flavors of South India with our traditional recipes passed down through generations"}),E.jsxs("div",{className:"space-y-3 text-white/80",children:[E.jsxs("div",{className:"flex items-center justify-center gap-3",children:[E.jsx("div",{className:"w-12 h-0.5 bg-white/30"}),E.jsx("span",{children:"Authentic South Indian Cuisine"}),E.jsx("div",{className:"w-12 h-0.5 bg-white/30"})]}),E.jsxs("div",{className:"flex items-center justify-center gap-3",children:[E.jsx("div",{className:"w-12 h-0.5 bg-white/30"}),E.jsx("span",{children:"Since 1985"}),E.jsx("div",{className:"w-12 h-0.5 bg-white/30"})]})]})]})]}),E.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 border-t-4 border-l-4 border-white/20"}),E.jsx("div",{className:"absolute bottom-0 right-0 w-32 h-32 border-b-4 border-r-4 border-white/20"})]}),E.jsx("div",{className:"flex-1 flex items-center justify-center p-8 bg-gray-50",children:E.jsxs("div",{className:"w-full max-w-md",children:[E.jsxs("div",{className:"text-center mb-8",children:[E.jsx("div",{className:"inline-flex items-center justify-center mb-4",children:E.jsx("img",{src:XE,alt:"Madurai Pandiyan Hotel Logo",className:"w-24 h-24 object-contain"})}),E.jsx("h1",{className:"text-gray-900 mb-2",children:"Madurai Pandiyan Hotel"}),E.jsx("p",{className:"text-gray-600",children:"Management System"})]}),E.jsxs(YR,{children:[E.jsxs(JR,{children:[E.jsx(ZR,{children:"Sign In"}),E.jsx(QR,{children:"Enter your credentials to access the management dashboard"})]}),E.jsxs(eE,{children:[E.jsxs("form",{onSubmit:l,className:"space-y-4",children:[i&&E.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm",children:i}),E.jsxs("div",{className:"space-y-2",children:[E.jsx(kp,{htmlFor:"username",children:"Username"}),E.jsxs("div",{className:"relative",children:[E.jsx(SE,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),E.jsx(Tp,{id:"username",type:"text",placeholder:"Enter your username",value:e,onChange:c=>t(c.target.value),className:"pl-10",required:!0})]})]}),E.jsxs("div",{className:"space-y-2",children:[E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx(kp,{htmlFor:"password",children:"Password"}),E.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-700 transition-colors",children:"Forgot?"})]}),E.jsxs("div",{className:"relative",children:[E.jsx(CE,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),E.jsx(Tp,{id:"password",type:"password",placeholder:"Enter your password",value:r,onChange:c=>s(c.target.value),className:"pl-10",required:!0})]})]}),E.jsx(Ul,{type:"submit",className:"w-full",children:"Sign In"})]}),E.jsx("div",{className:"mt-6 text-center",children:E.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",E.jsx("button",{className:"text-blue-600 hover:text-blue-700 transition-colors",children:"Contact Administrator"})]})})]})]}),E.jsx("p",{className:"text-center text-gray-500 mt-8",children:"Â© 2026 Madurai Pandiyan Hotel. All rights reserved."})]})})]})}const JE="/assets/pandianHotel-DL-QHa8q.jpeg",ZE=[{path:"/dashboard",label:"Dashboard",icon:mE},{path:"/inventory",label:"Inventory",icon:EE},{path:"/recipes",label:"Recipes",icon:nC},{path:"/calculator",label:"Calculator",icon:oE},{path:"/users",label:"Users",icon:zE},{path:"/billing",label:"Billing",icon:IE},{path:"/purchases",label:"Purchases",icon:OE}];function QE(){const e=Zs();return E.jsx("nav",{className:"bg-white/10 backdrop-blur-md rounded-lg p-2 mb-4",children:E.jsx("div",{className:"flex flex-wrap gap-2",children:ZE.map(({path:t,label:r,icon:s})=>E.jsxs(of,{to:t,className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${e.pathname===t?"bg-orange-500 text-white shadow-md":"text-white/80 hover:bg-white/20 hover:text-white"}`,children:[E.jsx(s,{className:"size-4"}),r]},t))})})}function Cn({successMessage:e,showStats:t=!1,statsComponent:r}){const s=au(),{logout:i}=hf(),n=()=>{i(),s("/login")};return E.jsxs("div",{className:"relative overflow-hidden",children:[E.jsxs("div",{className:"absolute inset-0",children:[E.jsx("img",{src:JE,alt:"Traditional Indian biryani platters",className:"w-full h-full object-cover"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-900/50 via-gray-800/45 to-gray-900/50"})]}),E.jsxs("div",{className:"relative max-w-7xl mx-auto p-6",children:[e&&E.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-3 animate-slide-in",children:[E.jsx(oC,{className:"size-5"}),E.jsx("span",{className:"font-medium",children:e})]}),E.jsx("div",{className:"mb-8",children:E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center shadow-lg",children:E.jsx("img",{src:lC})}),E.jsxs("div",{children:[E.jsx("h1",{className:"text-3xl font-bold text-white drop-shadow-lg",children:"Madurai Pandian Hotel"}),E.jsx("p",{className:"text-orange-200 font-medium",children:"Food Inventory Management System"})]})]}),E.jsxs("button",{onClick:n,className:"flex items-center gap-1.5 px-3 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 shadow-md hover:shadow-red-500/30 text-sm font-medium",children:[E.jsx(xE,{className:"size-4"}),"Log Out"]})]})}),E.jsx(QE,{}),t&&r&&E.jsx("div",{className:"mb-6",children:r})]})]})}function eT(){return E.jsxs("div",{className:"min-h-screen bg-gray-100",children:[E.jsx(Cn,{showStats:!1}),E.jsx("div",{className:"max-w-7xl mx-auto p-6",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Dashboard"}),E.jsx("p",{className:"text-gray-600",children:"Welcome to the hotel management dashboard."})]})})]})}const tT=()=>zF(),rT=$F;function sT({inventory:e}){const t=e.filter(s=>s.quantity_available<=s.minimum_stock&&s.quantity_available>0).length,r=e.filter(s=>s.quantity_available===0).length;return E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[E.jsxs("div",{className:"group relative",children:[E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400 to-blue-500 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-opacity duration-500"}),E.jsxs("div",{className:"relative bg-white/10 backdrop-blur-md border-2 border-blue-400/30 rounded-xl p-4 hover:border-blue-400/50 transition-all duration-300 hover:scale-105",children:[E.jsxs("div",{className:"flex items-start justify-between",children:[E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-500/20 rounded-full mb-2",children:[E.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full animate-pulse"}),E.jsx("span",{className:"text-xs font-bold text-blue-300 uppercase tracking-wide",children:"Total"})]}),E.jsx("h3",{className:"text-3xl font-black text-white mb-0.5 group-hover:text-blue-300 transition-colors",children:e.length}),E.jsx("p",{className:"text-xs text-gray-300 font-medium",children:"Total Products"})]}),E.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-500 rounded-lg flex items-center justify-center shadow-md group-hover:shadow-blue-500/30 group-hover:rotate-12 transition-all duration-500",children:E.jsx(FE,{className:"size-6 text-white"})})]}),E.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[E.jsx("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden",children:E.jsx("div",{className:"h-full bg-gradient-to-r from-blue-400 to-blue-500 rounded-full transition-all duration-1000",style:{width:"100%"}})}),E.jsx("span",{className:"text-xs font-bold text-blue-300",children:"100%"})]})]})]}),E.jsxs("div",{className:"group relative",children:[E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-400 to-green-500 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-opacity duration-500"}),E.jsxs("div",{className:"relative bg-white/10 backdrop-blur-md border-2 border-green-400/30 rounded-xl p-4 hover:border-green-400/50 transition-all duration-300 hover:scale-105",children:[E.jsxs("div",{className:"flex items-start justify-between",children:[E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-500/20 rounded-full mb-2",children:[E.jsx("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"}),E.jsx("span",{className:"text-xs font-bold text-green-300 uppercase tracking-wide",children:"Healthy"})]}),E.jsx("h3",{className:"text-3xl font-black text-white mb-0.5 group-hover:text-green-300 transition-colors",children:e.length-r-t}),E.jsx("p",{className:"text-xs text-gray-300 font-medium",children:"Items In Stock"})]}),E.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-green-500 rounded-lg flex items-center justify-center shadow-md group-hover:shadow-green-500/30 group-hover:rotate-12 transition-all duration-500",children:E.jsx(oC,{className:"size-6 text-white"})})]}),E.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[E.jsx("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden",children:E.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-green-500 rounded-full transition-all duration-1000",style:{width:`${(e.length-r-t)/e.length*100}%`}})}),E.jsxs("span",{className:"text-xs font-bold text-green-300",children:[Math.round((e.length-r-t)/e.length*100),"%"]})]})]})]}),E.jsxs("div",{className:"group relative",children:[E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400 to-amber-500 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-opacity duration-500"}),E.jsxs("div",{className:"relative bg-white/10 backdrop-blur-md border-2 border-amber-400/30 rounded-xl p-4 hover:border-amber-400/50 transition-all duration-300 hover:scale-105",children:[E.jsxs("div",{className:"flex items-start justify-between",children:[E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-amber-500/20 rounded-full mb-2",children:[E.jsx("div",{className:"w-1.5 h-1.5 bg-amber-400 rounded-full animate-ping"}),E.jsx("span",{className:"text-xs font-bold text-amber-300 uppercase tracking-wide",children:"Warning"})]}),E.jsx("h3",{className:"text-3xl font-black text-white mb-0.5 group-hover:text-amber-300 transition-colors",children:t}),E.jsx("p",{className:"text-xs text-gray-300 font-medium",children:"Low Stock Alert"})]}),E.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-400 to-amber-500 rounded-lg flex items-center justify-center shadow-md group-hover:shadow-amber-500/30 group-hover:rotate-12 group-hover:scale-110 transition-all duration-500",children:E.jsx(ff,{className:"size-6 text-white animate-pulse"})})]}),E.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[E.jsx("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden",children:E.jsx("div",{className:"h-full bg-gradient-to-r from-amber-400 to-amber-500 rounded-full transition-all duration-1000",style:{width:e.length>0?`${t/e.length*100}%`:"0%"}})}),E.jsxs("span",{className:"text-xs font-bold text-amber-300",children:[e.length>0?Math.round(t/e.length*100):0,"%"]})]})]})]}),E.jsxs("div",{className:"group relative",children:[E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400 to-red-500 rounded-xl blur-lg opacity-20 group-hover:opacity-30 transition-opacity duration-500"}),E.jsxs("div",{className:"relative bg-white/10 backdrop-blur-md border-2 border-red-400/30 rounded-xl p-4 hover:border-red-400/50 transition-all duration-300 hover:scale-105",children:[E.jsxs("div",{className:"flex items-start justify-between",children:[E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-red-500/20 rounded-full mb-2",children:[E.jsx("div",{className:"w-1.5 h-1.5 bg-red-400 rounded-full animate-ping"}),E.jsx("span",{className:"text-xs font-bold text-red-300 uppercase tracking-wide",children:"Critical"})]}),E.jsx("h3",{className:"text-3xl font-black text-white mb-0.5 group-hover:text-red-300 transition-colors",children:r}),E.jsx("p",{className:"text-xs text-gray-300 font-medium",children:"Out of Stock"})]}),E.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-400 to-red-500 rounded-lg flex items-center justify-center shadow-md group-hover:shadow-red-500/30 group-hover:rotate-12 group-hover:scale-110 transition-all duration-500",children:E.jsx(uE,{className:"size-6 text-white"})})]}),E.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[E.jsx("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden",children:E.jsx("div",{className:"h-full bg-gradient-to-r from-red-400 to-red-500 rounded-full transition-all duration-1000",style:{width:e.length>0?`${r/e.length*100}%`:"0%"}})}),E.jsxs("span",{className:"text-xs font-bold text-red-300",children:[e.length>0?Math.round(r/e.length*100):0,"%"]})]})]})]})]})}function iT({value:e,onChange:t,placeholder:r="Search...",className:s=""}){return E.jsxs("div",{className:`flex-1 relative ${s}`,children:[E.jsx(_E,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-500"}),E.jsx("input",{type:"text",placeholder:r,value:e,onChange:i=>t(i.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-900 placeholder-gray-500"})]})}function Dp({value:e,onChange:t,options:r,className:s=""}){const i=r.map(n=>typeof n=="string"?{value:n,label:n}:n);return E.jsx("select",{value:e,onChange:n=>t(n.target.value),className:`px-4 py-2 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-900 ${s}`,children:i.map(n=>E.jsx("option",{value:n.value,className:"bg-white text-gray-900",children:n.label},n.value))})}function nT({onChange:e,accept:t,children:r,className:s="",id:i="file-input"}){return E.jsxs(E.Fragment,{children:[E.jsx("input",{type:"file",accept:t,onChange:e,className:"hidden",id:i}),E.jsx("label",{htmlFor:i,className:`flex items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-indigo-600 to-indigo-700 text-white rounded-lg hover:from-indigo-700 hover:to-indigo-800 transition-all duration-300 shadow-md hover:shadow-indigo-600/30 text-sm font-medium cursor-pointer ${s}`,children:r})]})}function oT({searchQuery:e,setSearchQuery:t,selectedCategory:r,setSelectedCategory:s,selectedStockLevel:i,setSelectedStockLevel:n,categories:o,onAddItem:a,onExport:l,onImport:c,onDownloadTemplate:u}){const d=["All Stock Levels","In Stock","Low Stock","Out of Stock"];return E.jsx("div",{className:"bg-gradient-to-r from-gray-100 to-gray-200 rounded-lg shadow-md mb-6 p-4 border border-gray-300",children:E.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[E.jsx(iT,{value:e,onChange:t,placeholder:"Search items..."}),E.jsx(Dp,{value:r,onChange:s,options:o}),E.jsx(Dp,{value:i,onChange:n,options:d.map(h=>({value:h==="All Stock Levels"?"All":h,label:h}))}),E.jsxs(Ul,{onClick:a,variant:"primary",children:[E.jsx(DE,{className:"size-4"}),"Add"]}),E.jsxs(Ul,{onClick:u,variant:"secondary",children:[E.jsx(gE,{className:"size-4"}),"Get Template"]}),E.jsxs(Ul,{onClick:l,variant:"success",children:[E.jsx(hE,{className:"size-4"}),"Export"]}),E.jsxs(nT,{onChange:c,accept:".xlsx, .xls",id:"import-file",children:[E.jsx(GE,{className:"size-4"}),"Import"]})]})})}var sn=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,r){const s=t?this.allAsyncListeners:this.allSyncListeners;let i=s.get(e);return!i&&r&&(i=new Set,s.set(e,i)),i}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,r=!1){this.getListeners(e,r,!0).add(t)}removeEventListener(e,t,r=!1){const s=this.getListeners(e,r,!1);s&&(s.delete(t),s.size===0&&(r?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const r=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const{frameworkOverrides:s}=this,i=a=>{const l=s?()=>s.wrapIncoming(a):a;t?this.dispatchAsync(l):l()},n=this.getListeners(r,t,!1);if(((n==null?void 0:n.size)??0)>0){const a=new Set(n);for(const l of a)n!=null&&n.has(l)&&i(()=>l(e))}const o=this.getGlobalListeners(t);if(o.size>0){const a=new Set(o);for(const l of a)i(()=>l(r,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(const t of e)t()}};function Vs(e){return e==null||e===""?null:e}function Ce(e){return e!=null&&e!==""}function ct(e){return!Ce(e)}function oh(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function ma(e,t){const r=e?JSON.stringify(e):null,s=t?JSON.stringify(t):null;return r===s}function aT(e,t,r={}){r.transform&&(e=r.transform(e),t=r.transform(t));const s=e==null,i=t==null;if(e!=null&&e.toNumber&&(e=e.toNumber()),t!=null&&t.toNumber&&(t=t.toNumber()),s&&i)return 0;if(s)return-1;if(i)return 1;function n(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!r.accentedCompare)return n(e,t);try{return e.localeCompare(t)}catch{return n(e,t)}}var lT=/[&<>"']/g,cT={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function So(e){return(e==null?void 0:e.toString().toString())??null}function Xo(e){var t;return((t=So(e))==null?void 0:t.replace(lT,r=>cT[r]))??null}function Ap(e){return typeof e=="string"&&e.startsWith("=")&&e.length>1}function ps(e){return e.eRootDiv.getRootNode()}function pt(e){return ps(e).activeElement}function Gt(e){const{gos:t,eRootDiv:r}=e;let s=null;const i=t.get("getDocument");return i&&Ce(i)?s=i():r&&(s=r.ownerDocument),s&&Ce(s)?s:document}function gf(e){const t=pt(e);return t===null||t===Gt(e).body}function cC(e){return Gt(e).defaultView||window}function pf(e){let t=null,r=null;try{t=Gt(e).fullscreenElement}catch{}finally{t||(t=ps(e));const s=t.querySelector("body");s?r=s:t instanceof ShadowRoot?r=t:t instanceof Document?r=t==null?void 0:t.documentElement:r=t}return r}function uT(e){const t=pf(e);return(t==null?void 0:t.clientWidth)??(window.innerWidth||-1)}function dT(e){const t=pf(e);return(t==null?void 0:t.clientHeight)??(window.innerHeight||-1)}function ns(e,t,r){r==null||typeof r=="string"&&r==""?uC(e,t):os(e,t,r)}function os(e,t,r){e.setAttribute(dC(t),r.toString())}function uC(e,t){e.removeAttribute(dC(t))}function dC(e){return`aria-${e}`}function nn(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function hT(e){const t=e==null?void 0:e.direction;return t==="asc"?"ascending":t==="desc"?"descending":t==="mixed"?"other":"none"}function fT(e){return e.getAttribute("aria-label")}function lo(e,t){ns(e,"label",t)}function va(e,t){ns(e,"labelledby",t)}function hC(e,t){ns(e,"live",t)}function gT(e,t){ns(e,"atomic",t)}function pT(e,t){ns(e,"relevant",t)}function mf(e,t){ns(e,"invalid",t)}function mT(e,t){ns(e,"disabled",t)}function fC(e,t){ns(e,"hidden",t)}function ah(e,t){os(e,"expanded",t)}function vT(e,t){os(e,"setsize",t)}function CT(e,t){os(e,"posinset",t)}function wT(e,t){os(e,"rowcount",t)}function gC(e,t){os(e,"rowindex",t)}function xT(e,t){os(e,"rowspan",t)}function yT(e,t){os(e,"colcount",t)}function pC(e,t){os(e,"colindex",t)}function ST(e,t){os(e,"colspan",t)}function bT(e,t){os(e,"sort",t)}function FT(e){uC(e,"sort")}function mC(e,t){ns(e,"selected",t)}function RT(e,t){ns(e,"controls",t)}function ET(e,t){RT(e,t.id),va(t,e.id)}function Ip(e,t){ns(e,"owns",t)}function vu(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var TT="[tabindex], input, select, button, textarea, [href]",vC="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Yo(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(vC)?!1:Qs(e)}function it(e,t,r={}){const{skipAriaHidden:s}=r;e.classList.toggle("ag-hidden",!t),s||fC(e,!t)}function kT(e,t,r={}){const{skipAriaHidden:s}=r;e.classList.toggle("ag-invisible",!t),s||fC(e,!t)}function Ca(e,t){const r="disabled",s=t?n=>n.setAttribute(r,""):n=>n.removeAttribute(r);s(e);const i=e.querySelectorAll("input")??[];for(const n of i)s(n)}function ji(e,t,r){let s=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof r=="number"){if(++s>r)break}else if(e===r)break}return!1}function wn(e){const{height:t,width:r,borderTopWidth:s,borderRightWidth:i,borderBottomWidth:n,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:d,marginRight:h,marginBottom:f,marginLeft:p,boxSizing:g}=window.getComputedStyle(e),m=Number.parseFloat;return{height:m(t||"0"),width:m(r||"0"),borderTopWidth:m(s||"0"),borderRightWidth:m(i||"0"),borderBottomWidth:m(n||"0"),borderLeftWidth:m(o||"0"),paddingTop:m(a||"0"),paddingRight:m(l||"0"),paddingBottom:m(c||"0"),paddingLeft:m(u||"0"),marginTop:m(d||"0"),marginRight:m(h||"0"),marginBottom:m(f||"0"),marginLeft:m(p||"0"),boxSizing:g}}function vf(e){const t=wn(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function wa(e){const t=wn(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function CC(e){const{height:t,marginBottom:r,marginTop:s}=wn(e);return Math.floor(t+r+s)}function yc(e){const{width:t,marginLeft:r,marginRight:s}=wn(e);return Math.floor(t+r+s)}function wC(e){const t=e.getBoundingClientRect(),{borderTopWidth:r,borderLeftWidth:s,borderRightWidth:i,borderBottomWidth:n}=wn(e);return{top:t.top+(r||0),left:t.left+(s||0),right:t.right+(i||0),bottom:t.bottom+(n||0)}}function Sc(e,t){let r=e.scrollLeft;return t&&(r=Math.abs(r)),r}function bc(e,t,r){r&&(t*=-1),e.scrollLeft=t}function wr(e){for(;e!=null&&e.firstChild;)e.firstChild.remove()}function vi(e){e!=null&&e.parentNode&&e.remove()}function Cf(e){return!!e.offsetParent}function Qs(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!Cf(e)||window.getComputedStyle(e).visibility!=="visible")}function wf(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function jl(e){return()=>{const t=e();return t?xf(t)||xC(t):!0}}function xf(e){return e.clientWidth<e.scrollWidth}function xC(e){return e.clientHeight<e.scrollHeight}function Fc(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Fs(e,t)}function Fs(e,t){t=yf(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Jo(e,t){t=yf(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function yf(e){return typeof e=="number"?`${e}px`:e}function Sf(e){return e instanceof Node||e instanceof HTMLElement}function pr(e,t,r){r==null||r===""?e.removeAttribute(t):e.setAttribute(t,r.toString())}function ei(e,t,r){const i=cC(e).ResizeObserver,n=i?new i(r):null;return n==null||n.observe(t),()=>n==null?void 0:n.disconnect()}function ti(e,t){const r=cC(e);r.requestAnimationFrame?r.requestAnimationFrame(t):r.webkitRequestAnimationFrame?r.webkitRequestAnimationFrame(t):r.setTimeout(t,0)}var yC="data-ref",ed;function Mp(){return ed??(ed=document.createTextNode(" ")),ed.cloneNode()}function gi(e){const{attrs:t,children:r,cls:s,ref:i,role:n,tag:o}=e,a=document.createElement(o);if(s&&(a.className=s),i&&a.setAttribute(yC,i),n&&a.setAttribute("role",n),t)for(const l of Object.keys(t))a.setAttribute(l,t[l]);if(r)if(typeof r=="string")a.textContent=r;else{let l=!0;for(const c of r)c&&(typeof c=="string"?(a.appendChild(document.createTextNode(c)),l=!1):typeof c=="function"?a.appendChild(c()):(l&&(a.appendChild(Mp()),l=!1),a.append(gi(c)),a.appendChild(Mp())))}return a}var PT=["touchstart","touchend","touchmove","touchcancel","scroll"],DT=["wheel"],td={},SC=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r=>{if(typeof td[r]=="boolean")return td[r];const s=document.createElement(e[r]||"div");return r="on"+r,td[r]=r in s}})();function AT(e,t){return!t||!e?!1:MT(t).indexOf(e)>=0}function IT(e){const t=[];let r=e.target;for(;r;)t.push(r),r=r.parentElement;return t}function MT(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():IT(t)}function _T(e,t,r){const s=LT(t);let i;s!=null&&(i={passive:s}),e.addEventListener(t,r,i)}var LT=e=>{const t=PT.includes(e),r=DT.includes(e);if(t)return!0;if(r)return!1};function bC(e,t,r){if(r===0)return!1;const s=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY);return Math.max(s,i)<=r}var zn=(e,t)=>{const r=e.identifier;for(let s=0,i=t.length;s<i;++s){const n=t[s];if(n.identifier===r)return n}return null};function xa(e,t){return e.gos.isElementInThisInstance(t.target)}function OT(e,t,r){const i=e.getBoundingClientRect().height,n=uT(r)-2,o=dT(r)-2;if(!e.offsetParent)return;const l=wC(e.offsetParent),{clientY:c,clientX:u}=t;let d=c-l.top-i/2,h=u-l.left-10;const f=Gt(r),p=f.defaultView||window,g=p.pageYOffset||f.documentElement.scrollTop,m=p.pageXOffset||f.documentElement.scrollLeft;n>0&&h+e.clientWidth>n+m&&(h=n+m-e.clientWidth),h<0&&(h=0),o>0&&d+e.clientHeight>o+g&&(d=o+g-e.clientHeight),d<0&&(d=0),e.style.left=`${h}px`,e.style.top=`${d}px`}var $l=(e,...t)=>{for(const r of t){const[s,i,n,o]=r;s.addEventListener(i,n,o),e.push(r)}},bf=e=>{if(e){for(const[t,r,s,i]of e)t.removeEventListener(r,s,i);e.length=0}},Nn=e=>{e.cancelable&&e.preventDefault()};function NT(e,t){return t}function FC(e){return(e==null?void 0:e.getLocaleTextFunc())??NT}function BT(e,t,r,s){const i=t[r];return e.getLocaleTextFunc()(r,typeof i=="function"?i(s):i,s)}function HT(e){return(t,r,s)=>e({key:t,defaultValue:r,variableValues:s})}function VT(e){return(t,r,s)=>{let i=e==null?void 0:e[t];if(i&&(s!=null&&s.length)){let n=0;for(;!(n>=s.length||i.indexOf("${variable}")===-1);)i=i.replace("${variable}",s[n++])}return i??r}}var hr=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,r){this.localEventService||(this.localEventService=new sn),this.localEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){var s;(s=this.localEventService)==null||s.removeEventListener(e,t,r)}dispatchLocalEvent(e){var t;(t=this.localEventService)==null||t.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const r=[];for(const s of Object.keys(t)){const i=t[s];i&&r.push(this._setupListener(e,s,i))}return r}_setupListener(e,t,r){if(this.destroyed)return()=>null;let s;if(GT(e))e.__addEventListener(t,r),s=()=>(e.__removeEventListener(t,r),null);else{const i=WT(e);e instanceof HTMLElement?_T(e,t,r):i?e.addListener(t,r):e.addEventListener(t,r),s=i?()=>(e.removeListener(t,r),null):()=>(e.removeEventListener(t,r),null)}return this.destroyFunctions.push(s),()=>(s(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==s),null)}setupPropertyListener(e,t){const{gos:r}=this;r.addPropertyEventListener(e,t);const s=()=>(r.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(s),()=>(s(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==s),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const r=e.join("-")+this.propertyListenerId++,s=i=>{if(i.changeSet){if(i.changeSet&&i.changeSet.id===this.lastChangeSetIdLookup[r])return;this.lastChangeSetIdLookup[r]=i.changeSet.id}const n={type:"propertyChanged",changeSet:i.changeSet,source:i.source};t(n)};for(const i of e)this.setupPropertyListener(i,s)}getLocaleTextFunc(){return FC(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const r=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),r}createBean(e,t,r){return(t||this.stubContext).createBean(e,r)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function GT(e){return e.__addEventListener!==void 0}function WT(e){return e.eventServiceType==="global"}var ee=class extends hr{},lh=new Set,Cu=(e,t)=>{lh.has(t)||(lh.add(t),e())};Cu._set=lh;var zT={pending:!1,funcs:[]},UT={pending:!1,funcs:[]};function ch(e,t="setTimeout",r){const s=t==="raf"?UT:zT;if(s.funcs.push(e),s.pending)return;s.pending=!0;const i=()=>{const n=s.funcs.slice();s.funcs.length=0,s.pending=!1;for(const o of n)o()};t==="raf"?ti(r,i):window.setTimeout(i,0)}function Wt(e,t,r){let s;return function(...i){const n=this;return window.clearTimeout(s),s=window.setTimeout(function(){e.isAlive()&&t.apply(n,i)},r),s}}function _p(e,t){let r=0;return function(...s){const i=this,n=Date.now();n-r<t||(r=n,e.apply(i,s))}}function jT(e,t,r,s=100){const i=Date.now();let n=null,o=!1;const a=()=>{n!=null&&(window.clearInterval(n),n=null)};e.addDestroyFunc(a);const l=()=>{const c=Date.now()-i>s;(t()||c)&&(r(),o=!0,a())};l(),o||(n=window.setInterval(l,10))}var RC=new Set(["__proto__","constructor","prototype"]);function $T(e,t){if(e!=null){if(Array.isArray(e)){for(let r=0;r<e.length;r++)t(r.toString(),e[r]);return}for(const r of Object.keys(e).filter(s=>!RC.has(s)))t(r,e[r])}}function cr(e,t,r=!0,s=!1){Ce(t)&&$T(t,(i,n)=>{let o=e[i];o!==n&&(s&&o==null&&n!=null&&typeof n=="object"&&n.constructor===Object&&(o={},e[i]=o),Lp(n)&&Lp(o)&&!Array.isArray(o)?cr(o,n,r,s):(r||n!==void 0)&&(e[i]=n))})}function Lp(e){return typeof e=="object"&&e!==null}var Ff=class Ms{static applyGlobalGridOptions(t){if(!Ms.gridOptions)return{...t};let r={};return cr(r,Ms.gridOptions,!0,!0),Ms.mergeStrategy==="deep"?cr(r,t,!0,!0):r={...r,...t},Ms.gridOptions.context&&(r.context=Ms.gridOptions.context),t.context&&(Ms.mergeStrategy==="deep"&&r.context&&cr(t.context,r.context,!0,!0),r.context=t.context),r}static applyGlobalGridOption(t,r){if(Ms.mergeStrategy==="deep"){const s=EC(t);if(s&&typeof s=="object"&&typeof r=="object")return Ms.applyGlobalGridOptions({[t]:r})[t]}return r}};Ff.gridOptions=void 0;Ff.mergeStrategy="shallow";var Rf=Ff;function EC(e){var t;return(t=Rf.gridOptions)==null?void 0:t[e]}var TC={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,refreshAfterGroupEdit:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,enableFilterHandlers:!1},kC="https://www.ag-grid.com";function on(e,t,...r){e.get("debug")&&console.log("AG Grid: "+t,...r)}function Zo(e,...t){Cu(()=>console.warn("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}function Un(e,...t){Cu(()=>console.error("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}var PC=new Set,Rc={},$i={},Kl,DC=!1,AC=!1,KT=!1;function qT(e){const[t,r]=e.version.split(".")||[],[s,i]=Kl.split(".")||[];return t===s&&r===i}function XT(e){var s;Kl||(Kl=e.version);const t=i=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${i} Please update all modules to the same version.`;e.version?qT(e)||Un(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${Kl}.`)):Un(t(`'${e.moduleName}' is incompatible.`));const r=(s=e.validate)==null?void 0:s.call(e);r&&!r.isValid&&Un(`${r.message}`)}function ya(e,t,r=!1){r||(DC=!0),XT(e);const s=e.rowModels??["all"];PC.add(e);let i;t!==void 0?(AC=!0,$i[t]===void 0&&($i[t]={}),i=$i[t]):i=Rc;for(const n of s)i[n]===void 0&&(i[n]={}),i[n][e.moduleName]=e;if(e.dependsOn)for(const n of e.dependsOn)ya(n,t,r)}function YT(e){delete $i[e]}function uh(e,t,r){const s=i=>{var n,o,a;return!!((n=Rc[i])!=null&&n[e])||!!((a=(o=$i[t])==null?void 0:o[i])!=null&&a[e])};return s(r)||s("all")}function Ef(){return AC}function JT(e,t){const r=$i[e]??{};return[...Object.values(Rc.all??{}),...Object.values(r.all??{}),...Object.values(Rc[t]??{}),...Object.values(r[t]??{})]}function ZT(){return new Set(PC)}function QT(e,t){const r=$i[e]??{};return[...Object.values(r.all??{}),...Object.values(r[t]??{})]}function e2(){return DC}function IC(){return KT}var t2=class{static register(e){ya(e,void 0)}static registerModules(e){for(const t of e)ya(t,void 0)}},we="35.0.0",Op=2e3,Np=100,MC="_version_",ql=null,jn=`${kC}/javascript-data-grid`;function r2(e){ql=e}function s2(e){jn=e}function _C(e,t,r){return(ql==null?void 0:ql(e,t))??[a2(e,t,r)]}function Tf(e,t,r,s,i){e(`${s?"warning":"error"} #${t}`,..._C(t,r,i))}function i2(e){if(!e)return String(e);const t={};for(const r of Object.keys(e))typeof e[r]!="object"&&typeof e[r]!="function"&&(t[r]=e[r]);return JSON.stringify(t)}function n2(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=i2(e)),t}function Xl(e){return e===void 0?"undefined":e===null?"null":e}function dh(e,t){return`${e}?${t.toString()}`}function o2(e,t,r){const s=Array.from(t.entries()).sort((n,o)=>o[1].length-n[1].length);let i=dh(e,t);for(const[n,o]of s){if(n===MC)continue;const a=i.length-r;if(a<=0)break;const l="...",c=a+l.length,u=o.length-c>Np?o.slice(0,o.length-c)+l:o.slice(0,Np)+l;t.set(n,u),i=dh(e,t)}return i}function LC(e,t){const r=new URLSearchParams;if(r.append(MC,we),t)for(const n of Object.keys(t))r.append(n,n2(t[n]));const s=`${jn}/errors/${e}`,i=dh(s,r);return i.length<=Op?i:o2(s,r,Op)}var a2=(e,t,r)=>{const s=LC(e,t);return`${`${r?r+` 
`:""}Visit ${s}`}${r?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function oe(...e){Tf(Zo,e[0],e[1],!0)}function Qe(...e){Tf(Un,e[0],e[1],!1)}function zo(e,t,r){Tf(Un,e,t,!1,r)}function l2(e,t){const r=t[0];return`error #${r} `+_C(r,t[1],e).join(" ")}function Rs(...e){return l2(void 0,e)}function OC(e,t){return e.get("rowModelType")===t}function wt(e,t){return OC(e,"clientSide")}function bo(e,t){return OC(e,"serverSide")}function qt(e,t){return e.get("domLayout")===t}function Ki(e){return Tc(e)!==void 0}function NC(e){return typeof e.get("getRowHeight")=="function"}function c2(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function u2({gos:e,formula:t}){const r=e.get("rowNumbers");return r||!!(t!=null&&t.active)&&r!==!1}function Ci(e,t,r=!1,s){const{gos:i,environment:n}=e;if(s==null&&(s=n.getDefaultRowHeight()),NC(i)){if(r)return{height:s,estimated:!0};const l={node:t,data:t.data},c=i.getCallback("getRowHeight")(l);if(hh(c))return c===0&&oe(23),{height:Math.max(1,c),estimated:!1}}if(t.detail&&i.get("masterDetail"))return d2(i);const o=i.get("rowHeight");return{height:o&&hh(o)?o:s,estimated:!1}}function d2(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return hh(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function qi(e){const{environment:t,gos:r}=e,s=r.get("rowHeight");if(!s||ct(s))return t.getDefaultRowHeight();const i=t.refreshRowHeightVariable();return i!==-1?i:(oe(24),t.getDefaultRowHeight())}function hh(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function BC(e,t,r){const s=t[e.getDomDataKey()];return s?s[r]:void 0}function an(e,t,r,s){const i=e.getDomDataKey();let n=t[i];ct(n)&&(n={},t[i]=n),n[r]=s}function $n(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function HC(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||qt(e,"print"))}function Cs(e){const t=e.get("autoGroupColumnDef");return!(t!=null&&t.comparator)&&!e.get("treeData")}function fh(e){const t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function VC(e){return e.get("grandTotalRow")}function GC(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function WC(e,t,r){return!!t.group&&!t.footer&&GC(e,r)}function co(e){const t=e.getCallback("getRowId");return t===void 0?t:r=>{let s=t(r);return typeof s!="string"&&(Cu(()=>oe(25,{id:s}),"getRowIdString"),s=String(s)),s}}function h2(e,t){const r=e.get("groupHideParentOfSingleChild");return!!(r===!0||r==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function f2(e){const t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function Kn(e){return(e==null?void 0:e.checkboxes)??!0}function Yl(e){return(e==null?void 0:e.mode)==="multiRow"&&(e.headerCheckbox??!0)}function Ec(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function rd(e){return(e==null?void 0:e.hideDisabledCheckboxes)??!1}function g2(e){return typeof e.get("rowSelection")!="string"}function wi(e){const t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function qn(e){const t=e.get("cellSelection")??!1;return(typeof t=="object"&&t.enableColumnSelection)??!1}function zC(e){const t=e.get("rowSelection")??"single";if(typeof t=="string"){const r=e.get("suppressRowClickSelection"),s=e.get("suppressRowDeselection");return r&&s?!1:r?"enableDeselection":s?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function p2(e){const t=zC(e);return t===!0||t==="enableSelection"}function m2(e){const t=zC(e);return t===!0||t==="enableDeselection"}function gh(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t==null?void 0:t.isRowSelectable}function Tc(e){const t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t==null?void 0:t.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function kc(e){return Tc(e)==="multiRow"}function v2(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):(t==null?void 0:t.enableSelectionWithoutKeys)??!1}function Pc(e){const t=e.get("rowSelection");if(typeof t=="string"){const r=e.get("groupSelectsChildren"),s=e.get("groupSelectsFiltered");return r&&s?"filteredDescendants":r?"descendants":"self"}return(t==null?void 0:t.mode)==="multiRow"?t.groupSelects:void 0}function UC(e,t=!0){const r=e.get("rowSelection");return typeof r!="object"?t?"all":void 0:r.mode==="multiRow"?r.selectAll:"all"}function C2(e){const t=e.get("rowSelection");return typeof t=="string"?!1:(t==null?void 0:t.mode)==="multiRow"?t.ctrlASelectsRows??!1:!1}function Sa(e){const t=Pc(e);return t==="descendants"||t==="filteredDescendants"}function Bp(e){const t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function w2(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function Tr(e){return e.get("columnMenu")==="legacy"}function x2(e){return!Tr(e)}function y2(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function S2(e,t,r){typeof e!="object"&&(e={});const s={...e};for(const i of r){const n=t[i];typeof n<"u"&&(s[i]=n)}return s}function b2(e,t){if(!e)return;const r={};let s=!1;for(const o of Object.keys(e))r[o]=e[o],s=!0;if(!s)return;const i={type:"gridOptionsChanged",options:r};t.dispatchEvent(i);const n={type:"componentStateChanged",...r};t.dispatchEvent(n)}function ke(e,t){return e.addCommon(t)}function Jl(e,t){var r;return e[t]??((r=e.gridOptions)==null?void 0:r[t])??EC(t)??TC[t]}function F2({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var R2={resizable:!0,sortable:!0},E2=0;function jC(){return E2++}function xi(e){return e instanceof xn}var T2=["asc","desc",null],k2=[{type:"absolute",direction:"asc"},{type:"absolute",direction:"desc"},null],xn=class extends ee{constructor(e,t,r,s){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=r,this.primary=s,this.isColumn=!0,this.instanceId=jC(),this.autoHeaderHeight=null,this.sortDef=Zr(),this._wasSortExplicitlyRemoved=!1,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.formulaRef=null,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new sn,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Xo(r)}destroy(){var e;super.destroy(),(e=this.beans.rowSpanSvc)==null||e.deregister(this)}getInstanceId(){return this.instanceId}initState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:r,colFlex:s}}=this;t==null||t.initCol(this);const i=e.hide;i!==void 0?this.visible=!i:this.visible=!e.initialHide,r==null||r.initCol(this),s==null||s.initCol(this)}setColDef(e,t,r){var i;const s=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),s&&((i=this.beans.rowSpanSvc)==null||i.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",r)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.initState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:r}}=this,s=e.get("suppressFieldDotNotation");this.fieldContainsDots=Ce(t)&&t.includes(".")&&!s,this.tooltipFieldContainsDots=Ce(r)&&r.includes(".")&&!s}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){var e;(e=this.beans.tooltipSvc)==null||e.initCol(this)}initRowSpan(){var e;this.colDef.spanRows&&((e=this.beans.rowSpanSvc)==null||e.register(this))}addPivotListener(){const e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:r=>{const s=e.recreateColDef(this.colDef);this.setColDef(s,s,r.source)}})}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const r=e.width,s=e.initialWidth;return r!=null?t=r:s!=null?t=s:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){var t;return((t=this.beans.showRowGroupCols)==null?void 0:t.isRowGroupDisplayed(this,e))??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){var s,i,n;this.frameworkEventListenerService=(i=(s=this.beans.frameworkOverrides).createLocalEventListenerWrapper)==null?void 0:i.call(s,this.frameworkEventListenerService,this.colEventSvc);const r=((n=this.frameworkEventListenerService)==null?void 0:n.wrap(e,t))??t;this.colEventSvc.addEventListener(e,r)}removeEventListener(e,t){var s;const r=((s=this.frameworkEventListenerService)==null?void 0:s.unwrap(e,t))??t;this.colEventSvc.removeEventListener(e,r)}createColumnFunctionCallbackParams(e){return ke(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){var t;return((t=this.beans.cellNavigation)==null?void 0:t.isSuppressNavigable(this,e))??!1}isCellEditable(e){var t;return((t=this.beans.editSvc)==null?void 0:t.isCellEditable({rowNode:e,column:this}))??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){var t;return((t=this.beans.selectionSvc)==null?void 0:t.isCellCheckboxSelection(this,e))??!1}isSuppressPaste(e){var t;return this.isColumnFunc(e,((t=this.colDef)==null?void 0:t.suppressPaste)??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??R2[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const r=this.createColumnFunctionCallbackParams(e);return t(r)}return!1}createColumnEvent(e,t){return ke(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sortDef.direction}getSortDef(){return this.sortDef.direction?this.sortDef:null}getColDefAllowedSortTypes(){const e=[],{sort:t,initialSort:r}=this.colDef,s=t===null?t:Xs(t==null?void 0:t.type),i=r===null?r:Xs(r==null?void 0:r.type);return s&&e.push(s),i&&e.push(i),e}getSortingOrder(){const e=this.getColDefAllowedSortTypes().includes("absolute")?k2:T2;return(this.colDef.sortingOrder??this.gos.get("sortingOrder")??e).map(t=>Zr(t))}getAvailableSortTypes(){const e=this.getSortingOrder().reduce((t,r)=>(r.direction&&t.push(r.type),t),this.getColDefAllowedSortTypes());return new Set(e)}get wasSortExplicitlyRemoved(){return this._wasSortExplicitlyRemoved}setSortDef(e,t=!1){t||(this._wasSortExplicitlyRemoved=!e.direction),this.sortDef=e}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.getSort()==="asc"}isSortDescending(){return this.getSort()==="desc"}isSortNone(){return ct(this.getSort())}isSorting(){return Ce(this.getSort())}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){var e;return oe(261),!!((e=this.beans.colHover)!=null&&e.isHovered(this))}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const r=e===!0;this.visible!==r&&(this.visible=r,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e!=null&&e.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!(e!=null&&e.isPadding()))return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let r=!0;for(;e;){if(!e.isPadding()){r=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:r}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return ke(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(ct(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.colSpan(t);return Math.max(r,1)}getRowSpan(e){if(ct(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.rowSpan(t);return Math.max(r,1)}setActualWidth(e,t,r=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),r||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}isAllowFormula(){return this.colDef.allowFormula===!0}dispatchColEvent(e,t,r){const s=this.createColumnEvent(e,t);r&&cr(s,r),this.colEventSvc.dispatchEvent(s)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Zr(e){return Xn(e)?{direction:e.direction,type:e.type}:{direction:wu(e),type:Xs(e)}}function pi(e){return e==="asc"||e==="desc"||e===null}function kf(e){return e==="default"||e==="absolute"}function Xn(e){if(!e||typeof e!="object")return!1;const t=e;return kf(t.type)&&pi(t.direction)}function Zl(e,t){return e?t?e.type===t.type&&e.direction===t.direction:e?e.direction===null:!0:t?t.direction===null:!0}function wu(e){return pi(e)?e:null}function Xs(e){return kf(e)?e:"default"}function Zt(e){return e instanceof Ql}var Ql=class extends ee{constructor(e,t,r,s){super(),this.colGroupDef=e,this.groupId=t,this.padding=r,this.level=s,this.isColumn=!1,this.expandable=!1,this.instanceId=jC(),this.expandableListenerRemoveCallback=null,this.expanded=!!(e!=null&&e.openByDefault)}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(const t of this.children)xi(t)?e(t):Zt(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(const t of this.children)xi(t)?e.push(t):Zt(t)&&t.addLeafColumns(e)}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);for(const t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(const t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,r=!1;const s=this.findChildrenRemovingPadding();for(let n=0,o=s.length;n<o;n++){const a=s[n];if(!a.isVisible())continue;const l=a.getColumnGroupShow();l==="open"?(e=!0,r=!0):l==="closed"?(t=!0,r=!0):(e=!0,t=!0)}const i=e&&t&&r;this.expandable!==i&&(this.expandable=i,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=r=>{for(const s of r)Zt(s)&&s.isPadding()?t(s.children):e.push(s)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},P2={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function Hp(e,t,r){const s={},i=e.gos;return Object.assign(s,i.get("defaultColGroupDef")),Object.assign(s,t),i.validateColDef(s,r),s}var D2=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=oh(e);let r=0;for(;;){let s=e??t;if(s?r!==0&&(s+="_"+r):s=r,!this.existingKeys[s]){const i=String(s);return e&&r>0&&oe(273,{providedId:e,usedId:i}),this.existingKeys[i]=!0,i}r++}}};function nt(e){if(e!=null&&e.length)return e[e.length-1]}function Ei(e,t,r){if(e===t)return!0;if(!e||!t)return e==null&&t==null;const s=e.length;if(s!==t.length)return!1;for(let i=0;i<s;i++)if(e[i]!==t[i]&&!(r!=null&&r(e[i],t[i])))return!1;return!0}function Lo(e,t){if(e){for(const r of e)if(t(r))return!0}}function Es(e,t){const r=e.indexOf(t);r>=0&&e.splice(r,1)}function Vp(e,t,r){for(let s=0;s<t.length;s++)Es(e,t[s]);for(let s=t.length-1;s>=0;s--)e.splice(r,0,t[s])}var xu="ag-Grid-AutoColumn",$C="ag-Grid-SelectionColumn",KC="ag-Grid-RowNumbersColumn";function qC(e){const t=[],r=s=>{for(let i=0;i<s.length;i++){const n=s[i];xi(n)?t.push(n):Zt(n)&&r(n.getChildren())}};return r(e),t}function Ls(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}function Dc(e,t,r){const s={};if(!t)return;Ws(null,t,n=>{s[n.getInstanceId()]=n}),r&&Ws(null,r,n=>{s[n.getInstanceId()]=null});const i=Object.values(s).filter(n=>n!=null);e.context.destroyBeans(i)}function Pf(e){return e.getId().startsWith(xu)}function Ti(e){const t=typeof e=="string"?e:"getColId"in e?e.getColId():e.colId;return(t==null?void 0:t.startsWith($C))??!1}function Gs(e){const t=typeof e=="string"?e:"getColId"in e?e.getColId():e.colId;return(t==null?void 0:t.startsWith(KC))??!1}function A2(e){return Ti(e)||Gs(e)}function Ac(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function I2(e,t){return Ei(e,t,(r,s)=>r.getColId()===s.getColId())}function M2(e){e.map={};for(const t of e.list)e.map[t.getId()]=t}function Yn(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function Qo(e,t){const r=e===t,s=e.getColDef()===t,i=e.getColId()==t;return r||s||i}var _2=(e,t)=>(r,s)=>{const i={value1:void 0,value2:void 0};let n=!1;return e&&(e[r]!==void 0&&(i.value1=e[r],n=!0),Ce(s)&&e[s]!==void 0&&(i.value2=e[s],n=!0)),!n&&t&&(t[r]!==void 0&&(i.value1=t[r]),Ce(s)&&t[s]!==void 0&&(i.value2=t[s])),i};function L2(e,t){const r={...e,sort:void 0,colId:t},s=XC(e);return s&&(r.sort=s.direction,r.sortType=s.type),r}function XC(e){const{sort:t,initialSort:r}=e,s=Xn(t)||pi(t),i=Xn(r)||pi(r);return s?Zr(t):i?Zr(r):null}var O2=(e,t)=>{Zt(e)&&e.setupExpandable(),e.originalParent=t};function N2(e,t=null,r,s,i){const n=new D2,{existingCols:o,existingGroups:a,existingColKeys:l}=B2(s);n.addExistingKeys(l);const c=YC(e,t,0,r,o,n,a,i),{colGroupSvc:u}=e,d=(u==null?void 0:u.findMaxDepth(c,0))??0,h=u?u.balanceColumnTree(c,0,d,n):c;return Ws(null,h,O2),{columnTree:h,treeDepth:d}}function B2(e){const t=[],r=[],s=[];return e&&Ws(null,e,i=>{if(Zt(i)){const n=i;r.push(n)}else{const n=i;s.push(n.getId()),t.push(n)}}),{existingCols:t,existingGroups:r,existingColKeys:s}}function YC(e,t,r,s,i,n,o,a){if(!t)return[];const{colGroupSvc:l}=e,c=new Array(t.length);for(let u=0;u<c.length;u++){const d=t[u];l&&U2(d)?c[u]=l.createProvidedColumnGroup(s,d,r,i,n,o,a):c[u]=H2(e,s,d,i,n,a)}return c}function H2(e,t,r,s,i,n){var l;const o=G2(r,s);o&&(s==null||s.splice(o.idx,1));let a=o==null?void 0:o.column;if(a){const c=ph(e,r,a.getColId());a.setColDef(c,r,n),V2(e,a,c,n)}else{const c=i.getUniqueKey(r.colId,r.field),u=ph(e,r,c);a=new xn(u,r,c,t),e.context.createBean(a)}return(l=e.dataTypeSvc)==null||l.addColumnListeners(a),a}function JC(e,t,r,s,i,n,o,a){const{sortSvc:l,pinnedCols:c,colFlex:u}=e;r!==void 0&&t.setVisible(!r,a),l&&(l.updateColSort(t,s,a),i!==void 0&&l.setColSortIndex(t,i)),n!==void 0&&(c==null||c.setColPinned(t,n)),o!==void 0&&(u==null||u.setColFlex(t,o))}function V2(e,t,r,s){JC(e,t,r.hide,r.sort,r.sortIndex,r.pinned,r.flex,s);const i=t.getFlex();if(!(i!=null&&i>0))if(r.width!=null)t.setActualWidth(r.width,s);else{const n=t.getActualWidth();t.setActualWidth(n,s)}}function G2(e,t){if(t)for(let r=0;r<t.length;r++){const s=t[r].getUserProvidedColDef();if(!s)continue;if(e.colId!=null){if(t[r].getId()===e.colId)return{idx:r,column:t[r]};continue}if(e.field!=null){if(s.field===e.field)return{idx:r,column:t[r]};continue}if(s===e)return{idx:r,column:t[r]}}}function ph(e,t,r,s){const{gos:i,dataTypeSvc:n}=e,o={},a=i.get("defaultColDef");cr(o,a,!1,!0);const l=W2(e,o,t,r);l&&z2(e,l,o);const c=o.cellDataType;cr(o,t,!1,!0),c!==void 0&&(o.cellDataType=c);const u=i.get("autoGroupColumnDef"),d=Cs(i);return t.rowGroup&&u&&d&&cr(o,{sort:u.sort,initialSort:u.initialSort},!1,!0),n==null||n.postProcess(o),n==null||n.validateColDef(o),i.validateColDef(o,r,s),o}function W2(e,t,r,s){var o;const i=(o=e.dataTypeSvc)==null?void 0:o.updateColDefAndGetColumnType(t,r,s),n=r.type??i??t.type;return t.type=n,n?Ac(n):void 0}function z2(e,t,r){if(!t.length)return;const s=Object.assign({},P2),i=e.gos.get("columnTypes")||{};for(const n of Object.keys(i)){const o=i[n];n in s?oe(34,{key:n}):(o.type&&oe(35),s[n]=o)}for(const n of t){const o=s[n.trim()];o?cr(r,o,!1,!0):oe(36,{t:n})}}function U2(e){return e.children!==void 0}function Ws(e,t,r){if(t)for(let s=0;s<t.length;s++){const i=t[s];Zt(i)&&Ws(i,i.getChildren(),r),r(i,e)}}function ZC(e,t){const r=[],s=[],i=[];return e.forEach(o=>{const a=o.getColDef().lockPosition;a==="right"?i.push(o):a==="left"||a===!0?r.push(o):s.push(o)}),t.get("enableRtl")?[...i,...s,...r]:[...r,...s,...i]}function QC(e,t){let r=!0;return Ws(null,t,s=>{if(!Zt(s))return;const i=s,n=i.getColGroupDef();if(!(n==null?void 0:n.marryChildren))return;const a=[];for(const h of i.getLeafColumns()){const f=e.indexOf(h);a.push(f)}const l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),u=l-c,d=i.getLeafColumns().length-1;u>d&&(r=!1)}),r}function ew(e,t){if(!e||e.length==0)return;const r=t(e[0]);for(let s=1;s<e.length;s++)if(r!==t(e[s]))return;return r}function tw(e,t,r){if(!t.length)return;const s=t.length===1?t[0]:null,i=ew(t,n=>n.getPinned());e.dispatchEvent({type:"columnPinned",pinned:i??null,columns:t,column:s,source:r})}function j2(e,t,r){if(!t.length)return;const s=t.length===1?t[0]:null,i=ew(t,n=>n.isVisible());e.dispatchEvent({type:"columnVisible",visible:i,columns:t,column:s,source:r})}function $2(e,t,r,s){e.dispatchEvent({type:t,columns:r,column:r&&r.length==1?r[0]:null,source:s})}function uo(e,t,r,s,i=null){t!=null&&t.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:i,finished:r,source:s})}function ts(e,t,r){var b;const{colModel:s,rowGroupColsSvc:i,pivotColsSvc:n,autoColSvc:o,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:u,environment:d,valueColsSvc:h,eventSvc:f,gos:p}=e,g=s.getColDefCols()??[],m=a==null?void 0:a.getColumns();if(!g.length&&!(m!=null&&m.length))return!1;if(t!=null&&t.state&&!t.state.forEach)return oe(32),!1;const v=(F,S,D,T,V)=>{if(!F)return;const _=_2(S,t.defaultState),I=_("flex").value1,z=_("sort").value1,U=_("sortType").value1,j=pi(z)||kf(U),ne=Xs(U),se=wu(z),xe=j?{type:ne,direction:se}:void 0;if(JC(e,F,_("hide").value1,xe,_("sortIndex").value1,_("pinned").value1,I,r),I==null){const W=_("width").value1;if(W!=null){const fe=F.getColDef().minWidth??d.getDefaultColumnMinWidth();fe!=null&&W>=fe&&F.setActualWidth(W,r)}}V||!F.isPrimary()||(h==null||h.syncColumnWithState(F,r,_),i==null||i.syncColumnWithState(F,r,_,D),n==null||n.syncColumnWithState(F,r,_,T))},w=(F,S,D)=>{var pe,P;const T=rw(e,r),V=S.slice(),_={},I={},z=[],U=[],j=[];let ne=0;const se=(i==null?void 0:i.columns.slice())??[],xe=(n==null?void 0:n.columns.slice())??[];for(const B of F){const H=B.colId;if(H.startsWith(xu)){z.push(B),j.push(B);continue}if(Ti(H)){U.push(B),j.push(B);continue}const J=D(H);J?(v(J,B,_,I,!1),Es(V,J)):(j.push(B),ne+=1)}const W=B=>v(B,null,_,I,!1);V.forEach(W),i==null||i.sortColumns(Gp.bind(i,_,se)),n==null||n.sortColumns(Gp.bind(n,I,xe)),s.refreshCols(!1,r);const fe=(B,H,G=[])=>{for(const J of H){const ae=B(J.colId);Es(G,ae),v(ae,J,null,null,!0)}G.forEach(W)};return fe(B=>(o==null?void 0:o.getColumn(B))??null,z,(pe=o==null?void 0:o.getColumns())==null?void 0:pe.slice()),fe(B=>(a==null?void 0:a.getColumn(B))??null,U,(P=a==null?void 0:a.getColumns())==null?void 0:P.slice()),q2(t,s,p),c.refresh(r),f.dispatchEvent({type:"columnEverythingChanged",source:r}),T(),{unmatchedAndAutoStates:j,unmatchedCount:ne}};l==null||l.start();let{unmatchedAndAutoStates:C,unmatchedCount:y}=w(t.state||[],g,F=>s.getColDefCol(F));if(C.length>0||Ce(t.defaultState)){const F=((b=u==null?void 0:u.getPivotResultCols())==null?void 0:b.list)??[];y=w(C,F,S=>(u==null?void 0:u.getPivotResultCol(S))??null).unmatchedCount}return l==null||l.finish(),y===0}function K2(e,t){var w,C;const{colModel:r,autoColSvc:s,selectionColSvc:i,eventSvc:n,gos:o}=e,a=r.getColDefCols();if(!(a!=null&&a.length))return;const l=r.getColDefColTree(),c=qC(l),u=[];let d=1e3,h=1e3;const f=y=>{const b=sw(y);ct(b.rowGroupIndex)&&b.rowGroup&&(b.rowGroupIndex=d++),ct(b.pivotIndex)&&b.pivot&&(b.pivotIndex=h++),u.push(b)};(w=s==null?void 0:s.getColumns())==null||w.forEach(f),(C=i==null?void 0:i.getColumns())==null||C.forEach(f),c==null||c.forEach(f),ts(e,{state:u},t);const p=(s==null?void 0:s.getColumns())??[],v=[...(i==null?void 0:i.getColumns())??[],...p,...a].map(y=>({colId:y.colId}));ts(e,{state:v,applyOrder:!0},t),n.dispatchEvent(ke(o,{type:"columnsReset",source:t}))}function rw(e,t){const{rowGroupColsSvc:r,pivotColsSvc:s,valueColsSvc:i,colModel:n,sortSvc:o,eventSvc:a}=e,l={rowGroupColumns:(r==null?void 0:r.columns.slice())??[],pivotColumns:(s==null?void 0:s.columns.slice())??[],valueColumns:(i==null?void 0:i.columns.slice())??[]},c=Ic(e),u={};for(const d of c)u[d.colId]=d;return()=>{const d=(F,S,D,T)=>{const V=S.map(T),_=D.map(T);if(Ei(V,_))return;const z=new Set(S);for(const j of D)z.delete(j)||z.add(j);const U=[...z];a.dispatchEvent({type:F,columns:U,column:U.length===1?U[0]:null,source:t})},h=F=>{const S=[];return n.forAllCols(D=>{const T=u[D.getColId()];T&&F(T,D)&&S.push(D)}),S},f=F=>F.getColId();d("columnRowGroupChanged",l.rowGroupColumns,(r==null?void 0:r.columns)??[],f),d("columnPivotChanged",l.pivotColumns,(s==null?void 0:s.columns)??[],f);const g=h((F,S)=>{const D=F.aggFunc!=null,T=D!=S.isValueActive(),V=D&&F.aggFunc!=S.getAggFunc();return T||V});g.length>0&&$2(a,"columnValueChanged",g,t),uo(a,h((F,S)=>F.width!=S.getActualWidth()),!0,t),tw(a,h((F,S)=>F.pinned!=S.getPinned()),t),j2(a,h((F,S)=>F.hide==S.isVisible()),t);const y=h((F,S)=>!Zl(S.getSortDef(),{type:Xs(F.sortType),direction:wu(F.sort)})||F.sortIndex!=S.getSortIndex());y.length>0&&(o==null||o.dispatchSortChangedEvents(t,y));const b=Ic(e);Y2(c,b,t,n,a)}}function Ic(e){const{colModel:t,rowGroupColsSvc:r,pivotColsSvc:s}=e,i=t.getColDefCols();if(ct(i)||!t.isAlive())return[];const n=r==null?void 0:r.columns,o=s==null?void 0:s.columns,a=[],l=u=>{var g;const d=u.isRowGroupActive()&&n?n.indexOf(u):null,h=u.isPivotActive()&&o?o.indexOf(u):null,f=u.isValueActive()?u.getAggFunc():null,p=u.getSortIndex()!=null?u.getSortIndex():null;a.push({colId:u.getColId(),width:u.getActualWidth(),hide:!u.isVisible(),pinned:u.getPinned(),sort:u.getSort(),sortType:(g=u.getSortDef())==null?void 0:g.type,sortIndex:p,aggFunc:f,rowGroup:u.isRowGroupActive(),rowGroupIndex:d,pivot:u.isPivotActive(),pivotIndex:h,flex:u.getFlex()??null})};t.forAllCols(u=>l(u));const c=new Map(t.getCols().map((u,d)=>[u.getColId(),d]));return a.sort((u,d)=>{const h=c.has(u.colId)?c.get(u.colId):-1,f=c.has(d.colId)?c.get(d.colId):-1;return h-f}),a}function sw(e){const t=(m,v)=>m??v??null,r=e.getColDef(),s=Zr(t(r.sort,r.initialSort)),i=s.direction,n=s.type,o=t(r.sortIndex,r.initialSortIndex),a=t(r.hide,r.initialHide),l=t(r.pinned,r.initialPinned),c=t(r.width,r.initialWidth),u=t(r.flex,r.initialFlex);let d=t(r.rowGroupIndex,r.initialRowGroupIndex),h=t(r.rowGroup,r.initialRowGroup);d==null&&!h&&(d=null,h=null);let f=t(r.pivotIndex,r.initialPivotIndex),p=t(r.pivot,r.initialPivot);f==null&&!p&&(f=null,p=null);const g=t(r.aggFunc,r.initialAggFunc);return{colId:e.getColId(),sort:i,sortType:n,sortIndex:o,hide:a,pinned:l,width:c,flex:u,rowGroup:h,rowGroupIndex:d,pivot:p,pivotIndex:f,aggFunc:g}}function q2(e,t,r){if(!e.applyOrder||!e.state)return;const s=[];for(const i of e.state)i.colId!=null&&s.push(i.colId);X2(t.cols,s,t,r)}function X2(e,t,r,s){if(e==null)return;let i=[];const n={};for(const a of t){if(n[a])continue;const l=e.map[a];l&&(i.push(l),n[a]=!0)}let o=0;for(const a of e.list){const l=a.getColId();if(n[l]!=null)continue;l.startsWith(xu)?i.splice(o++,0,a):i.push(a)}if(i=ZC(i,s),!QC(i,r.getColTree())){oe(39);return}e.list=i}function Y2(e,t,r,s,i){const n={};for(const u of t)n[u.colId]=u;const o={};for(const u of e)n[u.colId]&&(o[u.colId]=!0);const a=e.filter(u=>o[u.colId]),l=t.filter(u=>o[u.colId]),c=[];l.forEach((u,d)=>{const h=a==null?void 0:a[d];if(h&&h.colId!==u.colId){const f=s.getCol(h.colId);f&&c.push(f)}}),c.length&&i.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,finished:!0,source:r})}var Gp=(e,t,r,s)=>{const i=e[r.getId()],n=e[s.getId()],o=i!=null,a=n!=null;if(o&&a)return i-n;if(o)return-1;if(a)return 1;const l=t.indexOf(r),c=t.indexOf(s),u=l>=0,d=c>=0;return u&&d?l-c:u?-1:1},J2=class extends ee{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(Yn(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),Yn(e.source)))}createColsFromColDefs(e){var w,C,y;const{beans:t}=this,{valueCache:r,colAutosize:s,rowGroupColsSvc:i,pivotColsSvc:n,valueColsSvc:o,visibleCols:a,eventSvc:l,groupHierarchyColSvc:c}=t,u=this.colDefs?rw(t,e):void 0;r==null||r.expire();const d=(w=this.colDefCols)==null?void 0:w.list,h=(C=this.colDefCols)==null?void 0:C.tree,f=N2(t,this.colDefs,!0,h,e);Dc(t,(y=this.colDefCols)==null?void 0:y.tree,f.columnTree);const p=f.columnTree,g=f.treeDepth,m=qC(p),v={};for(const b of m)v[b.getId()]=b;this.colDefCols={tree:p,treeDepth:g,list:m,map:v},this.createColumnsForService([c],this.colDefCols,e),i==null||i.extractCols(e,d),n==null||n.extractCols(e,d),o==null||o.extractCols(e,d),this.ready=!0,this.changeEventsDispatching=!0,this.refreshCols(!0,e),this.changeEventsDispatching=!1,a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),u&&(this.changeEventsDispatching=!0,u(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&(s==null||s.applyAutosizeStrategy())}refreshCols(e,t){var m;if(!this.colDefCols)return;const r=(m=this.cols)==null?void 0:m.tree;this.saveColOrder();const{autoColSvc:s,selectionColSvc:i,rowNumbersSvc:n,quickFilter:o,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:c,visibleCols:u,colViewport:d,eventSvc:h,formula:f}=this.beans,p=this.selectCols(a,this.colDefCols);f==null||f.setFormulasActive(p),this.createColumnsForService([s,i,n],p,t);const g=c2(this.gos,this.showingPivotResult);(!e||g)&&this.restoreColOrder(p),this.positionLockedCols(p),l==null||l.refresh(),o==null||o.refreshCols(),this.setColSpanActive(),c==null||c.setAutoHeightActive(p),u.clear(),d.clear(),Ei(r,this.cols.tree)||h.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,r){for(const s of e)s&&(s.createColumns(t,i=>{this.lastOrder=i(this.lastOrder),this.lastPivotOrder=i(this.lastPivotOrder)},r),s.addColumns(t))}selectCols(e,t){const r=(e==null?void 0:e.getPivotResultCols())??null;this.showingPivotResult=r!=null;const{map:s,list:i,tree:n,treeDepth:o}=r??t;return this.cols={list:i.slice(),map:{...s},tree:n.slice(),treeDepth:o},r&&(r.list.some(l=>{var c;return((c=this.cols)==null?void 0:c.map[l.getColId()])!==void 0})||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];const{beans:e,showingPivotResult:t,cols:r}=this,{valueColsSvc:s,selectionColSvc:i}=e,n=this.isPivotMode()&&!t,o=i==null?void 0:i.isSelectionColumnEnabled(),a=u2(e),l=s==null?void 0:s.columns;return r.list.filter(u=>{const d=Pf(u);if(n){const h=l==null?void 0:l.includes(u);return d||h||o&&Ti(u)||a&&Gs(u)}else return d||u.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,r){ts(this.beans,{state:e.map(s=>({colId:typeof s=="string"?s:s.getColId(),hide:!t}))},r)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const r=t.filter(d=>e.map[d.getId()]!=null);if(r.length===0)return;if(r.length===e.list.length){e.list=r;return}const s=d=>{const h=d.getOriginalParent();return h?h.getChildren().length>1?!0:s(h):!1};if(!r.some(d=>s(d))){const d=new Set(r);for(const h of e.list)d.has(h)||r.push(h);e.list=r;return}const i=new Map;for(let d=0;d<r.length;d++){const h=r[d];i.set(h,d)}const n=e.list.filter(d=>!i.has(d));if(n.length===0){e.list=r;return}const o=(d,h)=>{const f=h?h.getOriginalParent():d.getOriginalParent();if(!f)return null;let p=null,g=null;for(const m of f.getChildren())if(!(m===h||m===d)){if(m instanceof xn){const v=i.get(m);if(v==null)continue;(p==null||p<v)&&(p=v,g=m);continue}m.forEachLeafColumn(v=>{const w=i.get(v);w!=null&&(p==null||p<w)&&(p=w,g=v)})}return g??o(d,f)},a=[],l=new Map;for(const d of n){const h=o(d,null);if(h==null){a.push(d);continue}const f=l.get(h);f===void 0?l.set(h,d):Array.isArray(f)?f.push(d):l.set(h,[f,d])}const c=new Array(e.list.length);let u=c.length-1;for(let d=a.length-1;d>=0;d--)c[u--]=a[d];for(let d=r.length-1;d>=0;d--){const h=r[d],f=l.get(h);if(f)if(Array.isArray(f))for(let p=f.length-1;p>=0;p--){const g=f[p];c[u--]=g}else c[u--]=f;c[u--]=h}e.list=c}positionLockedCols(e){e.list=ZC(e.list,this.gos)}saveColOrder(){var e,t;this.showingPivotResult?this.lastPivotOrder=((e=this.cols)==null?void 0:e.list)??null:this.lastOrder=((t=this.cols)==null?void 0:t.list)??null}getColumnDefs(e){var t,r;return this.colDefCols&&((r=this.beans.colDefFactory)==null?void 0:r.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,((t=this.cols)==null?void 0:t.list)??[],e))}setColSpanActive(){var e;this.colSpanActive=!!((e=this.cols)!=null&&e.list.some(t=>t.getColDef().colSpan!=null))}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);const{visibleCols:r,eventSvc:s}=this.beans;r.refresh(t),s.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){var t;const e=(t=this.beans.pivotColsSvc)==null?void 0:t.columns;return this.pivotMode&&!!(e!=null&&e.length)}recreateColumnDefs(e){var r;if(!this.cols)return;(r=this.beans.autoColSvc)==null||r.updateColumns(e);const t=Yn(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){var e;Dc(this.beans,(e=this.colDefCols)==null?void 0:e.tree),super.destroy()}getColTree(){var e;return((e=this.cols)==null?void 0:e.tree)??[]}getColDefColTree(){var e;return((e=this.colDefCols)==null?void 0:e.tree)??[]}getColDefCols(){var e;return((e=this.colDefCols)==null?void 0:e.list)??null}getCols(){var e;return((e=this.cols)==null?void 0:e.list)??[]}forAllCols(e){var n,o,a,l,c;const{pivotResultCols:t,autoColSvc:r,selectionColSvc:s,groupHierarchyColSvc:i}=this.beans;Lo((n=this.colDefCols)==null?void 0:n.list,e)||Lo((o=r==null?void 0:r.columns)==null?void 0:o.list,e)||Lo((a=s==null?void 0:s.columns)==null?void 0:a.list,e)||Lo((l=i==null?void 0:i.columns)==null?void 0:l.list,e)||Lo((c=t==null?void 0:t.getPivotResultCols())==null?void 0:c.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){var t;return(t=this.colDefCols)!=null&&t.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){var t;return((t=this.cols)==null?void 0:t.map[e])??null}getColFromCollection(e,t){if(t==null)return null;const{map:r,list:s}=t;if(typeof e=="string"&&r[e])return r[e];for(let a=0;a<s.length;a++)if(Qo(s[a],e))return s[a];const{autoColSvc:i,selectionColSvc:n,groupHierarchyColSvc:o}=this.beans;return(i==null?void 0:i.getColumn(e))??(n==null?void 0:n.getColumn(e))??(o==null?void 0:o.getColumn(e))??null}},iw=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let r;return typeof t!="number"?r=0:r=t+1,this.existingIds[e]=r,r}},Fo=class extends ee{};function Ka(e,t,r){return r&&e.addDestroyFunc(()=>t.destroyBean(r)),r??e}var be=null;function Wp(e){return typeof(e==null?void 0:e.getGui)=="function"}var qa=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){var s;if(!e)return;if(e.includes(" ")){const i=(e||"").split(" ");if(i.length>1){for(const n of i)this.toggleCss(n,t);return}}this.cssClassStates[e]!==t&&e.length&&((s=this.getGui())==null||s.classList.toggle(e,t),this.cssClassStates[e]=t)}},Z2=0,Ro=class extends hr{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=Z2++,this.cssManager=new qa(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(r=>[r.selector,r])),e&&this.setTemplate(e)}preConstruct(){var t,r;this.wireTemplate(this.getGui());const e="component-"+((r=(t=Object.getPrototypeOf(this))==null?void 0:t.constructor)==null?void 0:r.name);for(const s of this.css??[])this.beans.environment.addGlobalCSS(s,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(yC):null}applyElementsToComponent(e,t,r,s=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){const i=this[t];if(i===be)this[t]=s??e;else{const n=r==null?void 0:r[t];if(!this.suppressDataRefValidation&&!n)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${i}`)}}}createChildComponentsFromTags(e,t){const r=[];for(const s of e.childNodes??[])r.push(s);for(const s of r){if(!(s instanceof HTMLElement))continue;const i=this.createComponentFromElement(s,n=>{const o=n.getGui();if(o)for(const a of s.attributes??[])o.setAttribute(a.name,a.value)},t);if(i){if(i.addItems&&s.children.length){this.createChildComponentsFromTags(s,t);const n=Array.prototype.slice.call(s.children);i.addItems(n)}this.swapComponentForNode(i,e,s)}else s.childNodes&&this.createChildComponentsFromTags(s,t)}}createComponentFromElement(e,t,r){const s=e.nodeName,i=this.getDataRefAttribute(e),n=s.indexOf("AG-")===0,o=n?this.componentSelectors.get(s):null;let a=null;if(o){const l=r&&i?r[i]:void 0;a=new o.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(n)throw new Error(`selector: ${s}`);return this.applyElementsToComponent(e,i,r,a),a}swapComponentForNode(e,t,r){const s=e.getGui();t.replaceChild(s,r),t.insertBefore(document.createComment(r.nodeName),s),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e,t){const r=t??this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(const s of e)s.setAttribute("tabindex",r.toString())}setTemplate(e,t,r){let s;typeof e=="string"||e==null?s=wf(e):s=gi(e),this.setTemplateFromElement(s,t,r)}setTemplateFromElement(e,t,r,s=!1){if(this.eGui=e,this.suppressDataRefValidation=s,t)for(let i=0;i<t.length;i++){const n=t[i];this.componentSelectors.set(n.selector,n)}this.wireTemplate(e,r)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let r=t;return e==null?null:(r||(r=this.eGui),Sf(e)?{element:e,parent:r}:{element:e.getGui(),parent:r})}prependChild(e,t){const{element:r,parent:s}=this.getContainerAndElement(e,t)||{};!r||!s||s.insertAdjacentElement("afterbegin",r)}appendChild(e,t){const{element:r,parent:s}=this.getContainerAndElement(e,t)||{};!r||!s||s.appendChild(r)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:r}=t;kT(this.eGui,e,{skipAriaHidden:r})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:r}=t;it(this.eGui,e,{skipAriaHidden:r});const s={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(s)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,r){this.eGui.addEventListener(e,t,r),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},Rt=class extends Ro{};function nw(e){return typeof e=="object"&&!!e.component}function Q2(e,t){return new Ue(r=>{r(window.setInterval(e,t))})}var Ue=class Uo{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(r=>this.onDone(r),r=>this.onReject(r))}static all(t){return t.length?new Uo(r=>{let s=t.length;const i=new Array(s);t.forEach((n,o)=>{n.then(a=>{i[o]=a,s--,s===0&&r(i)})})}):Uo.resolve()}static resolve(t=null){return new Uo(r=>r(t))}then(t){return new Uo(r=>{this.status===1?r(t(this.resolution)):this.waiters.push(s=>r(t(s)))})}onDone(t){this.status=1,this.resolution=t;for(const r of this.waiters)r(t)}onReject(t){}};function ek(e){return e?e.prototype&&"getGui"in e.prototype:!1}function ow(e,t,r,s){const{name:i}=r;let n,o,a,l,c,u;if(t){const d=t,h=d[i+"Selector"],f=h?h(s):null,p=g=>{typeof g=="string"?n=g:g!=null&&g!==!0&&(e.isFrameworkComponent(g)?a=g:o=g)};f?(p(f.component),l=f.params,c=f.popup,u=f.popupPosition):p(d[i])}return{compName:n,jsComp:o,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:u}}var tk=class extends ee{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,r,s=!1){return this.getCompDetails(this.gridOptions,e,t,r,s)}getCompDetails(e,t,r,s,i=!1){var C;const{name:n,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:c,paramsFromSelector:u,popupFromSelector:d,popupPositionFromSelector:h}=ow(this.beans.frameworkOverrides,e,t,s),f,p;const g=y=>{const b=this.registry.getUserComponent(n,y);b&&(l=b.componentFromFramework?void 0:b.component,c=b.componentFromFramework?b.component:void 0,f=b.params,p=b.processParams)};if(a!=null&&g(a),l==null&&c==null&&r!=null&&g(r),l&&o&&!ek(l)&&(l=(C=this.agCompUtils)==null?void 0:C.adaptFunction(t,l)),!l&&!c){const{validation:y}=this.beans;i&&(a!==r||!r)?a?y!=null&&y.isProvidedUserComp(a)||Qe(50,{compName:a}):r?y||Qe(260,{...this.gos.getModuleErrorParams(),propName:n,compName:r}):Qe(216,{name:n}):r&&!y&&Qe(146,{comp:r});return}const m=this.mergeParams(e,t,s,u,f,p),v=l==null,w=l??c;return{componentFromFramework:v,componentClass:w,params:m,type:t,popupFromSelector:d,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(w,v,m,t)}}newAgStackInstance(e,t,r,s){var a;const i=!t;let n;i?n=new e:n=this.frameworkCompWrapper.wrap(e,s.mandatoryMethods,s.optionalMethods,s),this.createBean(n);const o=(a=n.init)==null?void 0:a.call(n,r);return o==null?Ue.resolve(n):o.then(()=>n)}mergeParams(e,t,r,s=null,i,n){const o={...r,...i},a=e,l=a==null?void 0:a[t.name+"Params"];if(typeof l=="function"){const c=l(r);cr(o,c)}else typeof l=="object"&&cr(o,l);return cr(o,s),n?n(o):o}},rk={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},sk={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},ik={name:"headerComponent",optionalMethods:["refresh"]},nk={name:"innerHeaderComponent"},ok={name:"innerHeaderGroupComponent"},ak={name:"headerGroupComponent"},lk={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},ck={name:"loadingCellRenderer",cellRenderer:!0},uk={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},dk={name:"tooltipComponent"},Df={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},hk={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},fk={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},gk={name:"loadingCellRenderer",cellRenderer:!0},pk={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},mk={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function vk(e,t){return e.getCompDetailsFromGridOptions(sk,"agDragAndDropImage",t,!0)}function Ck(e,t,r){return e.getCompDetails(t,ik,"agColumnHeader",r)}function wk(e,t,r){return e.getCompDetails(t,nk,void 0,r)}function xk(e,t){const r=t.columnGroup.getColGroupDef();return e.getCompDetails(r,ak,"agColumnGroupHeader",t)}function yk(e,t,r){return e.getCompDetails(t,ok,void 0,r)}function Sk(e,t){return e.getCompDetailsFromGridOptions(fk,void 0,t,!0)}function bk(e,t){return e.getCompDetailsFromGridOptions(gk,"agLoadingCellRenderer",t,!0)}function Fk(e,t){return e.getCompDetailsFromGridOptions(pk,"agGroupRowRenderer",t,!0)}function Rk(e,t){return e.getCompDetailsFromGridOptions(mk,"agDetailCellRenderer",t,!0)}function zp(e,t,r){return e.getCompDetails(t,lk,void 0,r)}function Up(e,t,r){return e.getCompDetails(t,ck,"agSkeletonCellRenderer",r,!0)}function aw(e,t,r){return e.getCompDetails(t,uk,"agCellEditor",r,!0)}function Ek(e,t,r,s){const i=t.filter;return nw(i)&&(t={filter:i.component,filterParams:t.filterParams}),e.getCompDetails(t,Df,s,r,!0)}function Tk(e,t,r){return e.getCompDetails(t,rk,"agDateInput",r,!0)}function kk(e,t){return e.getCompDetails(t.colDef,dk,"agTooltipComponent",t,!0)}function Pk(e,t,r,s){return e.getCompDetails(t,hk,s,r)}function lw(e,t){return ow(e,t,Df)}function sd(e,t,r){return e.mergeParams(t,Df,r)}function ba(e){const t=e;return(t==null?void 0:t.getFrameworkComponentInstance)!=null?t.getFrameworkComponentInstance():e}function Dk(e){return typeof e=="object"&&!!e.getComp}var K={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},Ak=65,Ik=67,Mk=86,_k=68,Lk=90,Ok=89;function cw(e){const{keyCode:t}=e;let r;switch(t){case Ak:r=K.A;break;case Ik:r=K.C;break;case Mk:r=K.V;break;case _k:r=K.D;break;case Lk:r=K.Z;break;case Ok:r=K.Y;break;default:r=e.code}return r}var Af=class extends Ro{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;(e==null?void 0:e.isAlive())&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},id,nd,od,ad,mh,vh,ld;function ki(){return id===void 0&&(id=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),id}function Fa(){return nd===void 0&&(nd=/(firefox)/i.test(navigator.userAgent)),nd}function uw(){return od===void 0&&(od=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),od}function Xi(){return ad===void 0&&(ad=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),ad}function Ch(e){if(!e)return null;const t=e.tabIndex,r=e.getAttribute("tabIndex");return t===-1&&(r===null||r===""&&!Fa())?null:t.toString()}function Nk(){if(ld!==void 0)return ld;if(!document.body)return-1;let e=1e6;const t=Fa()?6e6:1e9,r=document.createElement("div");for(document.body.appendChild(r);;){const s=e*2;if(r.style.height=s+"px",s>t||r.clientHeight!==s)break;e=s}return r.remove(),ld=e,e}function Bk(){return vh==null&&dw(),vh}function dw(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let r=t.offsetWidth-t.clientWidth;r===0&&t.clientWidth===0&&(r=null),t.parentNode&&t.remove(),r!=null&&(vh=r,mh=r===0)}function hw(){return mh==null&&dw(),mh}var wh=!1,Mc=0;function Hk(e){Mc>0||(e.addEventListener("keydown",_c),e.addEventListener("mousedown",_c))}function Vk(e){Mc>0||(e.removeEventListener("keydown",_c),e.removeEventListener("mousedown",_c))}function _c(e){const t=wh,r=e.type==="keydown";r&&(e.ctrlKey||e.metaKey||e.altKey)||t!==r&&(wh=r)}function Gk(e){const t=Gt(e);return Hk(t),Mc++,()=>{Mc--,Vk(t)}}function fw(){return wh}function Jn(e,t,r=!1){const s=TT;let i=vC;t&&(i+=", "+t),r&&(i+=', [tabindex="-1"]');const n=Array.prototype.slice.apply(e.querySelectorAll(s)).filter(l=>Qs(l)),o=Array.prototype.slice.apply(e.querySelectorAll(i));return o.length?((l,c)=>l.filter(u=>c.indexOf(u)===-1))(n,o):n}function ln(e,t=!1,r=!1,s=!1){const i=Jn(e,s?".ag-tab-guard":null,r),n=t?nt(i):i[0];return n?(n.focus({preventScroll:!0}),!0):!1}function yn(e,t,r,s){const i=Jn(t,r?':not([tabindex="-1"])':null),n=pt(e);let o;r?o=i.findIndex(l=>l.contains(n)):o=i.indexOf(n);const a=o+(s?-1:1);return a<0||a>=i.length?null:i[a]}function gw(e,t=5){let r=0;for(;e&&Ch(e)===null&&++r<=t;)e=e.parentElement;return Ch(e)===null?null:e}var Wk="ag-focus-managed",pw=class extends hr{constructor(e,t={isStopPropagation:()=>!1,stopPropagation:()=>{}},r={}){super(),this.eFocusable=e,this.stopPropagationCallbacks=t,this.callbacks=r,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:s=>{if(s.defaultPrevented)return;const i=yn(this.beans,this.eFocusable,!1,s.shiftKey);i&&(i.focus(),s.preventDefault())},...r}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:r}}=this;e.classList.add(Wk),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),r&&this.addManagedElementListeners(e,{focusout:r})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||this.stopPropagationCallbacks.isStopPropagation(t))return;const{callbacks:r}=this;if(r.shouldStopEventPropagation(t)){this.stopPropagationCallbacks.stopPropagation(t);return}t.key===K.TAB?r.onTabKeyDown(t):r.handleKeyDown&&r.handleKeyDown(t)}})}},Zn={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},mw=class extends hr{constructor(e,t){super(),this.stopPropagationCallbacks=t,this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:r,eTopGuard:s,eBottomGuard:i,focusTrapActive:n,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:a,focusInnerElement:l,onFocusIn:c,onFocusOut:u,shouldStopEventPropagation:d,onTabKeyDown:h,handleKeyDown:f,isEmpty:p,eFocusableElement:g}=e;this.comp=r,this.eTopGuard=s,this.eBottomGuard=i,this.providedFocusInnerElement=l,this.eFocusableElement=g,this.focusTrapActive=!!n,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!a,this.providedFocusIn=c,this.providedFocusOut=u,this.providedShouldStopEventPropagation=d,this.providedOnTabKeyDown=h,this.providedHandleKeyDown=f,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new pw(this.eFocusableElement,this.stopPropagationCallbacks,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(const e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Jn(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){var l;const t=Gt(this.beans),r=Jn(t.body,null,!0),s=r.indexOf(e?this.eTopGuard:this.eBottomGuard);if(s===-1)return;let i,n;e?(i=0,n=s):(i=s+1,n=r.length);const o=r.slice(i,n),a=this.gos.get("tabIndex");o.sort((c,u)=>{const d=Number.parseInt(c.getAttribute("tabindex")||"0"),h=Number.parseInt(u.getAttribute("tabindex")||"0");return h===a?1:d===a?-1:d===0?1:h===0?-1:d-h}),(l=o[e?o.length-1:0])==null||l.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const r=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),r&&(r.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=Jn(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return yn(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},zk=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick??20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){const r=t||this.shouldSkipVerticalScroll();if(r&&this.shouldSkipHorizontalScroll())return;const s=this.scrollContainer.getBoundingClientRect(),i=this.scrollByTick;this.tickLeft=e.clientX<s.left+i,this.tickRight=e.clientX>s.right-i,this.tickUp=e.clientY<s.top+i&&!r,this.tickDown=e.clientY>s.bottom-i&&!r,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},vw="ag-resizer-wrapper",ni=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),Uk={tag:"div",cls:vw,children:[ni("eTopLeft","topLeft"),ni("eTop","top"),ni("eTopRight","topRight"),ni("eRight","right"),ni("eBottomRight","bottomRight"),ni("eBottom","bottom"),ni("eBottomLeft","bottomLeft"),ni("eLeft","left")]},jk=class extends hr{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config={popup:!1,...t}}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){const{clientHeight:t,clientWidth:r}=this.offsetParent,s=r/2-this.getWidth()/2,i=t/2-this.getHeight()/2;this.offsetElement(s,i,e)}initialisePosition(e){if(this.positioned)return;const{centered:t,forcePopupParentAsOffsetParent:r,minWidth:s,width:i,minHeight:n,height:o,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let c=0,u=0;const d=Qs(this.element);if(d){const h=this.findBoundaryElement(),f=window.getComputedStyle(h);if(f.minWidth!=null){const p=h.offsetWidth-this.element.offsetWidth;u=Number.parseInt(f.minWidth,10)-p}if(f.minHeight!=null){const p=h.offsetHeight-this.element.offsetHeight;c=Number.parseInt(f.minHeight,10)-p}}if(this.minHeight=n||c,this.minWidth=s||u,i&&this.setWidth(i),o&&this.setHeight(o),(!i||!o)&&this.refreshSize(),t)this.center(e);else if(a||l)this.offsetElement(a,l,e);else if(d&&r){let h=this.boundaryEl,f=!0;if(h||(h=this.findBoundaryElement(),f=!1),h){const p=Number.parseFloat(h.style.top),g=Number.parseFloat(h.style.left);f?this.offsetElement(Number.isNaN(g)?0:g,Number.isNaN(p)?0:p,e):this.setPosition(g,p)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){var s,i;if(!this.config.popup||e===this.movable)return;this.movable=e;const r=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?((s=this.dragSvc)==null||s.addDragSource(r),this.moveElementDragListener=r):((i=this.dragSvc)==null||i.removeDragSource(r),this.moveElementDragListener=void 0)}setResizable(e){var t;if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}for(const r of Object.keys(e)){const s=!!e[r],i=this.getResizerElement(r),n={dragStartPixels:0,eElement:i,onDragStart:o=>this.onResizeStart(o,r),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,r)};(s||!this.isAlive()&&!s)&&(s?((t=this.dragSvc)==null||t.addDragSource(n),this.resizeListeners.push(n),i.style.pointerEvents="all"):i.style.pointerEvents="none",this.resizable[r]=s)}}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,r=this.element;let s=!1;if(typeof e=="string"&&e.includes("%"))Jo(r,e),e=CC(r),s=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const i=this.getAvailableHeight();i&&e>i&&(e=i)}this.getHeight()!==e&&(s?(r.style.maxHeight="unset",r.style.minHeight="unset"):t?Jo(r,e):(r.style.height=`${e}px`,r.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:r}=this.offsetParent;if(!r)return null;const s=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),n=e?this.position.y:s.top,o=e?0:i.top;let a=0;if(t){const c=this.element.parentElement;if(c){const{bottom:u}=c.getBoundingClientRect();a=u-s.bottom}}return r+o-n-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:r}=this.config;let s=!1;if(typeof e=="string"&&e.includes("%"))Fs(t,e),e=yc(t),s=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:i}=this.offsetParent,n=r?this.position.x:this.element.getBoundingClientRect().left;i&&e+n>i&&(e=i-n)}this.getWidth()!==e&&(s?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Fs(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,r){var n;const{forcePopupParentAsOffsetParent:s}=this.config,i=s?this.boundaryEl:this.element;i&&((n=this.popupSvc)==null||n.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:r}),this.setPosition(Number.parseFloat(i.style.left),Number.parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){var r,s;if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};e&&this.popupSvc?((r=this.resizeObserverSubscriber)==null||r.call(this),this.resizeObserverSubscriber=ei(this.beans,(s=this.popupSvc)==null?void 0:s.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:r,isTop:s,anywhereWithin:i,topBuffer:n}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!r,!!i,o)?0:o,c=this.shouldSkipY(t,!!s,n,a)?0:a;return{movementX:l,movementY:c}}shouldSkipX(e,t,r,s){const i=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:i.left;let l=a<=0&&n.left>=e.clientX||n.right<=e.clientX&&n.right<=o.right;return l?!0:(t?l=s<0&&e.clientX>a+n.left||s>0&&e.clientX<a+n.left:r?l=s<0&&e.clientX>o.right||s>0&&e.clientX<a+n.left:l=s<0&&e.clientX>o.right||s>0&&e.clientX<o.right,l)}shouldSkipY(e,t,r=0,s){const i=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:i.top;let l=a<=0&&n.top>=e.clientY||n.bottom<=e.clientY&&n.bottom<=o.bottom;return l?!0:(t?l=s<0&&e.clientY>a+n.top+r||s>0&&e.clientY<a+n.top:l=s<0&&e.clientY>o.bottom||s>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;const e=this.element;e&&(e.appendChild(gi(Uk)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${vw}`);e==null||e.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:r,forcePopupParentAsOffsetParent:s}=this.config;!r&&!s&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(r=>!r.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,r=0;for(const s of e){const i=!!s.style.flex&&s.style.flex!=="0 0 auto";if(s===this.element)continue;let n=this.minHeight||0,o=this.minWidth||0;if(i){const a=window.getComputedStyle(s);a.minHeight&&(n=Number.parseInt(a.minHeight,10)),a.minWidth&&(o=Number.parseInt(a.minWidth,10))}else n=s.offsetHeight,o=s.offsetWidth;t+=n,r+=o}return{height:t,width:r}}applySizeToSiblings(e){let t=null;const r=this.getSiblings();if(r){for(let s=0;s<r.length;s++){const i=r[s];i!==t&&(e?i.style.height=`${i.offsetHeight}px`:i.style.width=`${i.offsetWidth}px`,i.style.flex="0 0 auto",i===this.element&&(t=r[s+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:r}=this.config,{isTop:s,isRight:i,isBottom:n,isLeft:o}=this.currentResizer,a=i||o,l=n||s,{movementX:c,movementY:u}=this.calculateMouseMovement({e,isLeft:o,isTop:s}),d=this.position.x,h=this.position.y;let f=0,p=0;if(a&&c){const g=o?-1:1,m=this.getWidth(),v=m+c*g;let w=!1;o&&(f=m-v,(d+f<=0||v<=this.minWidth)&&(w=!0,f=0)),w||this.setWidth(v)}if(l&&u){const g=s?-1:1,m=this.getHeight(),v=m+u*g;let w=!1;s?(p=m-v,(h+p<=0||v<=this.minHeight)&&(w=!0,p=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<v&&this.getMinSizeOfSiblings().height+v>this.element.parentElement.offsetHeight&&(w=!0),w||this.setHeight(v)}this.updateDragStartPosition(e.clientX,e.clientY),((t||r)&&f||p)&&this.offsetElement(d+f,h+p)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:r}=this.position;let s;this.config.calculateTopBuffer&&(s=this.config.calculateTopBuffer());const{movementX:i,movementY:n}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:s});this.offsetElement(t+i,r+n),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){var e;for(;this.resizeListeners.length;){const t=this.resizeListeners.pop();(e=this.dragSvc)==null||e.removeDragSource(t)}}destroy(){var e;super.destroy(),this.moveElementDragListener&&((e=this.dragSvc)==null||e.removeDragSource(this.moveElementDragListener)),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},If="T",$k=new RegExp(`[${If} ]`),Kk=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${If}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function ws(e,t){return e.toString().padStart(t,"0")}function kr(e,t=!0,r=If){if(!e)return null;let s=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(i=>ws(i,2)).join("-");return t&&(s+=r+[e.getHours(),e.getMinutes(),e.getSeconds()].map(i=>ws(i,2)).join(":")),s}function ml(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),ws(e.getDate(),2),ws(e.getHours(),2),`:${ws(e.getMinutes(),2)}`,`:${ws(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,ws(e.getDate(),2)].map(String):null}var cd=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},jp=["January","February","March","April","May","June","July","August","September","October","November","December"],ud=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function xh(e,t){if(t==null)return kr(e,!1);const r=ws(e.getFullYear(),4),s={YYYY:()=>r.slice(r.length-4,r.length),YY:()=>r.slice(r.length-2,r.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>jp[e.getMonth()],MMM:()=>jp[e.getMonth()].slice(0,3),MM:()=>ws(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${cd(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${cd(e.getDate())}`,DD:()=>ws(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>ud[e.getDay()],ddd:()=>ud[e.getDay()].slice(0,3),dd:()=>ud[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${cd(e.getDay())}`,d:()=>`${e.getDay()}`},i=new RegExp(Object.keys(s).join("|"),"g");return t.replace(i,n=>n in s?s[n]():n)}function ec(e,t=!1){return!!xr(e,t)}function qk(e){return ec(e,!0)}function xr(e,t=!1,r){if(!e||!r&&!Kk.test(e))return null;const[s,i]=e.split($k);if(!s)return null;const n=s.split("-").map(f=>Number.parseInt(f,10));if(n.filter(f=>!isNaN(f)).length!==3)return null;const[o,a,l]=n,c=new Date(o,a-1,l);if(c.getFullYear()!==o||c.getMonth()!==a-1||c.getDate()!==l||!i&&t)return null;if(!i||i==="00:00:00")return c;const[u,d,h]=i.split(":").map(f=>Number.parseInt(f,10));if(u>=0&&u<24)c.setHours(u);else if(t)return null;if(d>=0&&d<60)c.setMinutes(d);else if(t)return null;if(h>=0&&h<60)c.setSeconds(h);else if(t)return null;return c}function yh(e){const{inputValue:t,allSuggestions:r,hideIrrelevant:s,filterByPercentageOfBestMatch:i}=e;let n=(r??[]).map((l,c)=>({value:l,relevance:Xk(t,l),idx:c}));if(n.sort((l,c)=>l.relevance-c.relevance),s&&(n=n.filter(l=>l.relevance<Math.max(l.value.length,t.length))),n.length>0&&i&&i>0){const c=n[0].relevance*i;n=n.filter(u=>c-u.relevance<0)}const o=[],a=[];for(const l of n)o.push(l.value),a.push(l.idx);return{values:o,indices:a}}function Xk(e,t){const r=e.length,s=t.length;if(s===0)return r||0;let i=e.toLocaleLowerCase(),n=t.toLocaleLowerCase(),o;e.length<t.length&&(o=n,n=i,i=o,o=t,t=e,e=o);let a=new Uint16Array(s+1),l=new Uint16Array(s+1);for(let d=0;d<=s;d++)a[d]=d;let c=0;const u=r/2-10;for(let d=1;d<=r;d++){const h=e[d-1],f=i[d-1];l[0]=d;for(let p=1;p<=s;p++){const g=t[p-1],m=n[p-1];if(f!==m){const v=l[p-1],w=a[p],C=a[p-1];let y=v<w?v:w;C<y&&(y=C),l[p]=y+1|0;continue}if(c++,h===g&&c++,d>1&&p>1){const v=e[d-2],w=i[d-2],C=t[p-2],y=n[p-2];w===y&&(c++,v===C&&c++)}d<u&&c++,l[p]=a[p-1]}o=a,a=l,l=o}return a[s]/(c+1)}function Cw(e){var r;return e.altKey||e.ctrlKey||e.metaKey?!1:((r=e.key)==null?void 0:r.length)===1}var Yk=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",Jk=class extends Ro{constructor(e,t,r){super(t,r),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(Yk)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:r,labelAlignment:s,disabled:i,labelEllipsis:n}=this.config;i!=null&&this.setDisabled(i),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),r!=null&&this.setLabelWidth(r),n!=null&&this.setLabelEllipsis(n),this.setLabelAlignment(s||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;wr(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(it(t,!1),nn(t,"presentation")):(it(t,!0),nn(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const r=this.getGui().classList;return r.toggle("ag-label-align-left",e==="left"),r.toggle("ag-label-align-right",e==="right"),r.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(Fc(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return Ca(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},ww=class extends Jk{constructor(e,t,r,s){super(e,t,r),this.className=s}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:r,ariaLabel:s}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),r!=null&&this.onValueChange(r),s!=null&&this.setAriaLabel(s),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),r=this.getLabel();r==null||r==""||fT(e)!==null?va(e,""):va(e,t??"")}setAriaLabel(e){return lo(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Fs(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function Zk(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var zi=class extends ww{constructor(e,t,r="text",s="input"){super(e,(e==null?void 0:e.template)??Zk(s),[],t),this.inputType=r,this.displayFieldTag=s,this.eLabel=be,this.eWrapper=be,this.eInput=be}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);const{eLabel:e,eWrapper:t,eInput:r,className:s}=this;e.classList.add(`${s}-label`),t.classList.add(`${s}-input-wrapper`),r.classList.add(`${s}-input`),this.addCss("ag-input-field"),r.id=r.id||`ag-${this.getCompId()}-input`;const{inputName:i,inputWidth:n,inputPlaceholder:o,autoComplete:a,tabIndex:l}=this.config;i!=null&&this.setInputName(i),n!=null&&this.setInputWidth(n),o!=null&&this.setInputPlaceholder(o),a!=null&&this.setAutoComplete(a),this.addInputListeners(),this.activateTabIndex([r],l)}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,pr(this.eInput,"type",e))}getInputElement(){return this.eInput}getWrapperElement(){return this.eWrapper}setInputWidth(e){return Fc(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return pr(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return lo(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Ca(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)pr(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";pr(this.eInput,"autocomplete",t)}return this}},Mf=class extends zi{constructor(e,t="ag-checkbox",r="checkbox"){super(e,t,r),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t,name:r}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t),r!=null&&this.setName(r)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;const r=this.eInput;r.checked=e,r.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,r){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:r});const s=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:s.id,name:s.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),r=this.selected=e.target.checked;this.refreshSelectedClass(r),this.dispatchChange(r,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},_f={selector:"AG-CHECKBOX",component:Mf},Qk=class extends Mf{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){const t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}},Sn=class extends zi{constructor(e,t="ag-text-field",r="text"){super(e,t,r)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const r=this.eInput;return r.value!==e&&(r.value=Ce(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}setCustomValidity(e){const t=this.eInput,r=e.length>0;t.setCustomValidity(e),r&&t.reportValidity(),mf(t,r)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=r=>{Cw(r)&&r.key&&!e.test(r.key)&&r.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:r=>{var i;const s=(i=r.clipboardData)==null?void 0:i.getData("text");s!=null&&s.split("").some(n=>!e.test(n))&&r.preventDefault()}})}},yu={selector:"AG-INPUT-TEXT-FIELD",component:Sn},eP=class extends zi{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const r=super.setValue(e,t);return this.eInput.value=e,r}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},tP={selector:"AG-INPUT-TEXT-AREA",component:eP},Lf=class extends Sn{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();const e=this.eInput;this.addManagedListeners(e,{blur:()=>{const n=Number.parseFloat(e.value),o=isNaN(n)?"":this.normalizeValue(n.toString());this.value!==o&&this.setValue(o)},wheel:this.onWheel.bind(this)}),e.step="any";const{precision:t,min:r,max:s,step:i}=this.config;typeof t=="number"&&this.setPrecision(t),typeof r=="number"&&this.setMin(r),typeof s=="number"&&this.setMax(s),typeof i=="number"&&this.setStep(i)}onWheel(e){pt(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){const r=this.precision;if(r==null)return e;if(t){const i=Number.parseFloat(e).toFixed(r);return Number.parseFloat(i).toString()}const s=String(e).split(".");if(s.length>1){if(s[1].length<=r)return e;if(r>0)return`${s[0]}.${s[1].slice(0,r)}`}return s[0]}setMin(e){return this.min===e?this:(this.min=e,pr(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,pr(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,pr(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(r=>super.setValue(r,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,r){if(Ce(r)){let s=this.isScientificNotation(r);if(s&&this.eInput.validity.valid)return e(r);if(!s){r=this.adjustPrecision(r);const i=this.normalizeValue(r);s=r!=i}if(s)return t(r)}return e(r)}getValue(e=!1){const t=this.eInput;if(!t.validity.valid&&!e)return;const r=t.value;return this.isScientificNotation(r)?this.adjustPrecision(r,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},rP={selector:"AG-INPUT-NUMBER-FIELD",component:Lf},sP=class extends Sn{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=ki();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){pt(this.beans)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?kr(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,pr(this.eInput,"min",t),this)}setMax(e){const t=e instanceof Date?kr(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,pr(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,pr(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return xr(this.getValue())??void 0}setDate(e,t){this.setValue(kr(e??null,this.includeTime),t)}},xw={selector:"AG-INPUT-DATE-FIELD",component:sP},iP=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",nP="ag-active-item",oP=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),aP=class extends Ro{constructor(e,t,r){super(oP(e,t)),this.label=t,this.value=r,this.eText=be}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){const t=this.getGui();t.classList.toggle(nP,e),mC(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){const r=this.getGui();CT(r,e),vT(r,t)}createTooltip(){const e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>xf(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){const e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},lP=class extends Ro{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(iP)}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){const t=e.key;switch(t){case K.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{const r=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(r)}break;case K.DOWN:case K.UP:e.preventDefault(),this.navigate(t);break;case K.PAGE_DOWN:case K.PAGE_UP:case K.PAGE_HOME:case K.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){const{value:t,text:r}=e,s=r??t;return this.options.push({value:t,text:s}),this.renderOption(t,s),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(const e of this.listItems)e.destroy();wr(this.getGui()),this.listItems=[],this.refreshAriaRole()}updateOptions(e){const t=this.options!==e;return t&&(this.clearOptions(),this.addOptions(e)),t}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;const r=this.options.findIndex(s=>s.value===e);if(r!==-1){const s=this.options[r];this.value=s.value,this.displayValue=s.text,this.highlightItem(this.listItems[r]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){const t=e.getGui();if(!Qs(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;const r=this.getGui(),{scrollTop:s,clientHeight:i}=r,{offsetTop:n,offsetHeight:o}=t;(n+o>s+i||n<s)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){var e,t;(t=(e=this.highlightedItem)==null?void 0:e.tooltipFeature)==null||t.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){var e;(e=this.highlightedItem)==null||e.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){const r=new aP(this.cssIdentifier,t,e);r.setParentComponent(this);const s=this.createManagedBean(r);this.listItems.push(s),this.getGui().appendChild(s.getGui())}navigate(e){const t=e===K.DOWN;let r;const{listItems:s,highlightedItem:i}=this;if(!i)r=t?s[0]:nt(s);else{let o=s.indexOf(i)+(t?1:-1);o=Math.min(Math.max(o,0),s.length-1),r=s[o]}this.highlightItem(r)}navigateToPage(e){const{listItems:t,highlightedItem:r}=this;if(!r||t.length===0)return;const s=t.indexOf(r),i=this.options.length-1,n=t[0].getHeight(),o=Math.floor(this.getGui().clientHeight/n);let a=-1;e===K.PAGE_HOME?a=0:e===K.PAGE_END?a=i:e===K.PAGE_DOWN?a=Math.min(s+o,i):e===K.PAGE_UP&&(a=Math.max(s-o,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){nn(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();const e=this.listItems,t=e.length;e.forEach((r,s)=>{r.setIndex(s+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},cP=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",uP={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},dP=class extends ww{constructor(e){if(super(e,(e==null?void 0:e.template)||uP,(e==null?void 0:e.agComponents)||[],e==null?void 0:e.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=be,this.eWrapper=be,this.eDisplayField=be,this.eIcon=be,this.registerCSS(cP),this.ariaRole=e==null?void 0:e.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:r,variableWidth:s,minPickerWidth:i,maxPickerWidth:n}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!s,r!=null&&this.setPickerMaxHeight(r),i!=null&&this.setPickerMinWidth(i),n!=null&&this.setPickerMaxWidth(n)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:r,inputWidth:s}=this.config;if(r){const i=this.beans.iconSvc.createIconNoSpan(r);i&&this.eIcon.appendChild(i)}s!=null&&this.setInputWidth(s)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),ah(e,!1),this.ariaRole&&nn(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&(e==null?void 0:e.target)===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case K.UP:case K.DOWN:case K.ENTER:case K.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case K.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:r,pickerAriaLabelValue:s,modalPicker:i=!0},maxPickerHeight:n,minPickerWidth:o,maxPickerWidth:a,variableWidth:l,beans:c,eWrapper:u}=this,d={modal:i,eChild:e,closeOnEsc:!0,closedCallback:()=>{const g=gf(c);this.beforeHidePicker(),g&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(r,s),anchorToElement:u};e.style.position="absolute";const h=c.popupSvc,f=h.addPopup(d);l?(o&&(e.style.minWidth=o),e.style.width=yf(yc(u)),a&&(e.style.maxWidth=a)):Fc(e,a??yc(u));const p=n??`${vf(h.getPopupParent())}px`;return e.style.setProperty("max-height",p),this.alignPickerToComponent(),f.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerGap:e,config:{pickerType:t},beans:{popupSvc:r,gos:s},eWrapper:i,pickerComponent:n}=this,o=s.get("enableRtl")?"right":"left";r.positionPopupByComponent({type:t,eventSource:i,ePopup:n.getGui(),position:"under",alignSide:o,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();ah(t,e);const r=this.eWrapper.classList;r.toggle("ag-picker-expanded",e),r.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var t;(t=this.pickerComponent)!=null&&t.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return Fc(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},hP=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",Of=class extends dP{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox",...e}),this.registerCSS(hP)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:jl(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:r}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),r&&t==null&&(this.eDisplayField.textContent=r),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){const e=this.createBean(new lP("select"));this.listComponent=e,e.setParentComponent(this);const t=e.getAriaElement(),r=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",r),ET(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:s=>{s==null||s.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){var e;(e=this.listComponent)==null||e.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){var r;const{key:t}=e;switch(t===K.TAB&&this.hidePicker(),t){case K.ENTER:case K.UP:case K.DOWN:case K.PAGE_UP:case K.PAGE_DOWN:case K.PAGE_HOME:case K.PAGE_END:e.preventDefault(),this.isPickerDisplayed?(r=this.listComponent)==null||r.handleKeyDown(e):super.onKeyDown(e);break;case K.ESCAPE:super.onKeyDown(e);break;case K.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){const e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){var e;return(e=this.listComponent)==null||e.clearOptions(),this.setValue(void 0,!0),this}updateOptions(e){var t;return(t=this.listComponent)!=null&&t.updateOptions(e)&&this.setValue(void 0,!0),this}setValue(e,t,r){const{listComponent:s,config:{placeholder:i},eDisplayField:n,tooltipFeature:o}=this;if(this.value===e||!s)return this;if(r||s.setValue(e,!0),s.getValue()===this.getValue())return this;let l=s.getDisplayValue();return l==null&&i&&(l=i),n.textContent=l,o==null||o.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},fP={selector:"AG-SELECT",component:Of},gP=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-tab-guard{display:block;height:0;position:absolute;width:0}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',vv,Cv,Nf=typeof window!="object"||!((Cv=(vv=window==null?void 0:window.document)==null?void 0:vv.fonts)!=null&&Cv.forEach),ho=(e,t,r,s,i,n)=>{if(Nf)return;s&&(e=`@layer ${CSS.escape(s).replaceAll("\\.",".")} { ${e} }`);let o=Qn.map.get(t);if(o||(o=[],Qn.map.set(t,o)),o.some(u=>u.css===e))return;const a=document.createElement("style");n&&a.setAttribute("nonce",n),a.dataset.agGlobalCss=r,a.textContent=e;const l={css:e,el:a,priority:i};let c;for(const u of o){if(u.priority>i)break;c=u}if(c){c.el.insertAdjacentElement("afterend",a);const u=o.indexOf(c);o.splice(u+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),o.push(l)},yw=(e,t,r,s)=>{ho(gP,e,"shared",t,0,r),s==null||s.forEach((i,n)=>i.forEach(o=>ho(o,e,n,t,0,r)))},pP=e=>{Qn.grids.add(e)},mP=e=>{if(Qn.grids.delete(e),Qn.grids.size===0){Qn.map=new WeakMap;for(const t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},$p,Qn=($p=typeof window=="object"?window:{}).agStyleInjectionState??($p.agStyleInjectionState={map:new WeakMap,grids:new Set}),Ts=e=>new Sw(e),ui="$default",vP=0,Sw=class{constructor({feature:e,params:t,modeParams:r={},css:s,cssImports:i}){this.feature=e,this.css=s,this.cssImports=i,this.modeParams={[ui]:{...r[ui]??{},...t??{}},...r}}use(e,t,r){let s=this._inject;if(s==null){let{css:i}=this;if(i){const n=`ag-theme-${this.feature??"part"}-${++vP}`;typeof i=="function"&&(i=i()),i=`:where(.${n}) {
${i}
}
`;for(const o of this.cssImports??[])i=`@import url(${JSON.stringify(o)});
${i}`;s={css:i,class:n}}else s=!1;this._inject=s}return s&&e&&ho(s.css,e,s.class,t,1,r),s?s.class:!1}},CP=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),bw=e=>`--ag-${CP(e)}`,ks=e=>`var(${bw(e)})`,wP=(e,t,r)=>Math.max(t,Math.min(r,e)),xP=e=>{const t=new Map;return r=>{const s=r;return t.has(s)||t.set(s,e(r)),t.get(s)}},ms=e=>({ref:"accentColor",mix:e}),Or=e=>({ref:"foregroundColor",mix:e}),Gr=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),yP=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),mr={ref:"backgroundColor"},Bn={ref:"foregroundColor"},Os={ref:"accentColor"},Lc={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:Or(.15),chromeBackgroundColor:Gr(.02),browserColorScheme:"light"},SP={...Lc,textColor:Bn,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:ms(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:mr,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Os,toggleButtonOffBackgroundColor:Gr(.3),toggleButtonSwitchBackgroundColor:mr,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}},bP=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],FP=xP(e=>(e=e.toLowerCase(),bP.find(t=>e.endsWith(t.toLowerCase()))??"length")),Su=e=>typeof e=="object"&&(e!=null&&e.ref)?ks(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,Bf=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){const t=ks(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?ks(e.onto):"transparent"}, ${t} ${wP(e.mix*100,0,100)}%)`}return!1},RP=Su,Hn=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,r=>r[0]==="-"?r:" "+ks(r)+" ")})`:e&&"ref"in e?ks(e.ref):!1,EP=Su,Sh=(e,t)=>typeof e=="string"?e:e===!0?Sh({},t):e===!1?t==="columnBorder"?Sh({color:"transparent"},t):"none":e&&"ref"in e?ks(e.ref):Fw(e.style??"solid")+" "+Hn(e.width??{ref:"borderWidth"})+" "+Bf(e.color??{ref:"borderColor"}),TP=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?ks(e.ref):[Hn(e.offsetX??0),Hn(e.offsetY??0),Hn(e.radius??0),Hn(e.spread??0),Bf(e.color??{ref:"foregroundColor"})].join(" "),Fw=Su,Rw=e=>typeof e=="string"?e.includes(",")?e:Kp(e):e&&"googleFont"in e?Rw(e.googleFont):e&&"ref"in e?ks(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),Kp(t))).join(", "):!1,Kp=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),kP=Su,Ew=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?Ew({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?ks(e.ref):!1,PP=(e,t,r)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&r.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?ks(e.ref):!1,DP={color:Bf,colorScheme:RP,length:Hn,scale:EP,border:Sh,borderStyle:Fw,shadow:TP,image:Ew,fontFamily:Rw,fontWeight:kP,duration:PP},AP=(e,t,r)=>{const s=FP(e);return DP[s](t,e,r)},IP=e=>new Tw(e),Tw=class kw{constructor(t,r=[]){this.themeLogger=t,this.parts=r}withPart(t){return typeof t=="function"&&(t=t()),t instanceof Sw?new kw(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(Ts({feature:t}))}withParams(t,r=ui){return this.withPart(Ts({modeParams:{[r]:t}}))}_startUse({styleContainer:t,cssLayer:r,nonce:s,loadThemeGoogleFonts:i,moduleCss:n}){if(Nf)return;_P(),yw(t,r,s,n);const o=MP(this);if(o.length>0)for(const a of o)i&&LP(a,s);for(const a of this.parts)a.use(t,r,s)}_getCssClass(){return this._cssClassCache??(this._cssClassCache=qp(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){const r={[ui]:{...SP}};for(const s of qp(this.parts))for(const i of Object.keys(s.modeParams)){const n=s.modeParams[i];if(n){const o=r[i]??(r[i]={}),a=new Set;for(const l of Object.keys(n)){const c=n[l];c!==void 0&&(o[l]=c,a.add(l))}if(i===ui)for(const l of Object.keys(r)){const c=r[l];if(l!==ui)for(const u of a)delete c[u]}}}this._paramsCache=t=r}return t}_getPerInstanceCss(t){const r="##SELECTOR##";let s=this._paramsCssCache;if(!s){let i="",n="";const o=this._getModeParams();for(const l of Object.keys(o)){const c=o[l];if(l!==ui){const d=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;i+=d,n+=d}for(const u of Object.keys(c).sort()){const d=c[u],h=AP(u,d,this.themeLogger);if(h===!1)this.themeLogger.error(107,{key:u,value:d});else{const f=bw(u),p=f.replace("--ag-","--ag-inherited-");i+=`	${f}: var(${p}, ${h});
`,n+=`	${p}: var(${f});
`}}l!==ui&&(i+=`}
`,n+=`}
`)}let a=`${r} {
${i}}
`;a+=`:has(> ${r}):not(${r}) {
${n}}
`,this._paramsCssCache=s=a}return s.replaceAll(r,`:where(.${t})`)}},qp=e=>{const t=new Map;for(const s of e)t.set(s.feature,s);const r=[];for(const s of e)(!s.feature||t.get(s.feature)===s)&&r.push(s);return r},MP=e=>{const t=new Set,r=n=>{if(Array.isArray(n))n.forEach(r);else{const o=n==null?void 0:n.googleFont;typeof o=="string"&&t.add(o)}};return Object.values(e._getModeParams()).flatMap(n=>Object.values(n)).forEach(r),Array.from(t).sort()},Xp=!1,_P=()=>{if(!Xp){Xp=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},LP=async(e,t)=>{const r=`@import url('https://${OP}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;ho(r,document.head,`googleFont:${e}`,void 0,0,t)},OP="fonts.googleapis.com",NP=1,BP=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=NP++,e!=null&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(const t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(const t of e.beanClasses){const r=new t;r.beanName?this.beans[r.beanName]=r:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(r)}for(const t of e.derivedBeans??[]){const{beanName:r,bean:s}=t(this);this.beans[r]=s,this.createdBeans.push(s)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){var s,i,n,o;const r=this.beans;for(const a of e)(s=a.preWireBeans)==null||s.call(a,r),(i=a.wireBeans)==null||i.call(a,r);for(const a of e)(n=a.preConstruct)==null||n.call(a);t&&e.forEach(t);for(const a of e)(o=a.postConstruct)==null||o.call(a)}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){var t;if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],(t=this.destroyCallback)==null||t.call(this)}destroyBean(e){var t;(t=e==null?void 0:e.destroy)==null||t.call(e)}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},HP=0,Yp={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},VP=class extends hr{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1,this.paramsClass=`ag-theme-params-${++HP}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){const{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t);const r=e.get("themeStyleContainer"),s=typeof ShadowRoot<"u",i=s&&t.getRootNode()instanceof ShadowRoot;this.eStyleContainer=(typeof r=="function"?r():r)??(i?t:document.head),!r&&!i&&s&&GP(t,this.shadowRootError.bind(this),this.addDestroyFunc.bind(this)),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.getSizeEl(Yp),this.initVariables(),this.addDestroyFunc(()=>mP(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){const{theme:r}=this;let s;r?s=`${this.paramsClass} ${r._getCssClass()}`:s=this.applyLegacyThemeClasses();for(const i of Array.from(e.classList))i.startsWith("ag-theme-")&&e.classList.remove(i);if(s){const i=e.className;e.className=`${i}${i?" ":""}${s}${t!=null&&t.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let r=!1;for(const s of Array.from(t.classList))s.startsWith("ag-theme-")&&(r=!0,e=e?`${e} ${s}`:s);r&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?ho(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(Yp)}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const r=this.measureSizeEl(e);return r==="detached"||r==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,r),r)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const r=t.offsetWidth;return r===dd?"no-styles":(this.sizesMeasured=!0,r)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=gi({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const r=this.getMeasurementContainer();t=gi({tag:"div"});const{border:s,noWarn:i}=e;s?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${dd}px)`)):t.style.width=`var(${e.cssName}, ${dd}px)`,r.appendChild(t),this.sizeEls.set(e,t);let n=this.measureSizeEl(e);n==="no-styles"&&!i&&this.varError(e);const o=ei(this.beans,t,()=>{const a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==n&&(n=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>o()),t}handleThemeChange(){const{gos:e,theme:t}=this,r=e.get("theme");let s;if(r==="legacy")s=void 0;else{const i=r??this.getDefaultTheme();i instanceof Tw?s=i:this.themeError(i)}s!==t&&this.handleNewTheme(s),this.postProcessThemeChange(s,r)}handleNewTheme(e){const{gos:t,eRootDiv:r,globalCSS:s}=this,i=this.getAdditionalCss();if(e){pP(this),yw(this.eStyleContainer,this.cssLayer,this.styleNonce,i);for(const[o,a]of s)ho(o,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);s.length=0}this.theme=e,e==null||e._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:i});let n=this.eParamsStyle;if(!n){n=this.eParamsStyle=gi({tag:"style"});const o=t.get("styleNonce");o&&n.setAttribute("nonce",o),r.appendChild(n)}Nf||(n.textContent=(e==null?void 0:e._getPerInstanceCss(this.paramsClass))||""),this.applyThemeClasses(r),this.fireStylesChangedEvent("themeChanged")}fireStylesChangedEvent(e){this.eventSvc.dispatchEvent({type:"stylesChanged",[e]:!0})}},dd=15538,GP=(e,t,r)=>{let s=60;const i=setInterval(()=>{typeof ShadowRoot<"u"&&e.getRootNode()instanceof ShadowRoot&&(t(),clearInterval(i)),(Cf(e)||--s<0)&&clearInterval(i)},1e3);r(()=>clearInterval(i))},WP=class extends hr{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(const t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...r){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));const s=this.dynamicBeans[e];if(s==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new s(...r)}},zP=class extends hr{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new sn}addListener(e,t,r){this.globalSvc.addEventListener(e,t,r)}removeListener(e,t,r){this.globalSvc.removeEventListener(e,t,r)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},Pw=class extends hr{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){const r="title",s=this.ctrl.getGui();s&&(e!=null&&(e!=""||t)?s.setAttribute(r,e):s.removeAttribute(r))}updateTooltipText(){const{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){const e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){var e;(e=this.tooltipManager)==null||e.prepareToShowTooltip()}attemptToHideTooltip(){var e;(e=this.tooltipManager)==null||e.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},UP=1e3,jP=1e3,Jp=100,Zp,vl=!1,$P=class extends hr{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){var t,r,s,i;return e==="show"?((r=(t=this.tooltipCtrl).getTooltipShowDelayOverride)==null?void 0:r.call(t))??this.getGridOptionsTooltipDelay("tooltipShowDelay"):((i=(s=this.tooltipCtrl).getTooltipHideDelayOverride)==null?void 0:i.call(s))??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Xi()&&(vl?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},Jp):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){var i;const t=e.relatedTarget,r=this.tooltipCtrl.getGui(),s=(i=this.tooltipComp)==null?void 0:i.getGui();this.isInteractingWithTooltip||r.contains(t)||this.interactionEnabled&&(s!=null&&s.contains(t))||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||vl)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-Zp<UP}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){var i,n;const e=this.getTooltipValue(),t=this.tooltipCtrl;if(!Ce(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}const r=this.gos.addCommon({location:((i=t.getLocation)==null?void 0:i.call(t))??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0),...(n=t.getAdditionalParams)==null?void 0:n.call(t)});this.state=2,this.tooltipInstanceCount++;const s=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(r,s)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),Zp=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){var o;if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}const s=t.getGui();this.tooltipComp=t,s.classList.contains("ag-tooltip")||s.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&s.classList.add("ag-tooltip-animate"),this.interactionEnabled&&s.classList.add("ag-tooltip-interactive");const i=this.getLocaleTextFunc(),n=(o=this.popupSvc)==null?void 0:o.addPopup({eChild:s,ariaLabel:i("ariaLabelTooltip","Tooltip")});if(n&&(this.tooltipPopupDestroyFunc=n.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){const a=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:a}),this.setEventHandlers(a)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(s,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Gt(this.beans),{keydown:a=>{s.contains(a==null?void 0:a.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(s,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:s,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){var r;const e=(r=this.tooltipComp)==null?void 0:r.getGui(),t=pt(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){var t,r;const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?(t=this.popupSvc)==null||t.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):(r=this.popupSvc)==null||r.positionPopupByComponent({...e,eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,r=this.tooltipTrigger===0?jP:0;window.setTimeout(()=>{e(),this.destroyBean(t)},r),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(const e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){vl=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},Jp)}unlockService(){vl=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},KP=class extends Pw{constructor(e,t,r){super(e,r),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},Cl=0,qP=200,XP=class extends hr{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}postConstruct(){this.addManagedEventListeners({stylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:r,nudgeY:s,skipObserver:i}=e;this.positionPopup({ePopup:t,nudgeX:r,nudgeY:s,keepWithinBounds:!0,skipObserver:i,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:r,nudgeY:s,keepWithinBounds:i,eventSource:n,alignSide:o="left",position:a="over",type:l}=e,c=n.getBoundingClientRect(),u=this.getParentRect();this.setAlignedTo(n,t);const d=()=>{let h=c.left-u.left;o==="right"&&(h-=t.offsetWidth-c.width);let f;return a==="over"?(f=c.top-u.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,c,u,e.nudgeY||0)==="under"?f=c.top-u.top+c.height:f=c.top-t.offsetHeight-(s||0)*2-u.top),{x:h,y:f}};this.positionPopup({ePopup:t,nudgeX:r,nudgeY:s,keepWithinBounds:i,updatePosition:d,postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,l,t,n,null)})}positionPopupForMenu(e){const{eventSource:t,ePopup:r,event:s}=e,i=t.getBoundingClientRect(),n=this.getParentRect();this.setAlignedTo(t,r);let o=!1;const a=()=>{const l=this.keepXYWithinBounds(r,i.top-n.top,0),c=r.clientWidth>0?r.clientWidth:200;o||(r.style.minWidth=`${c}px`,o=!0);const d=n.right-n.left-c;let h;return this.gos.get("enableRtl")?(h=p(),h<0&&(h=f(),this.setAlignedStyles(r,"left")),h>d&&(h=0,this.setAlignedStyles(r,"right"))):(h=f(),h>d&&(h=p(),this.setAlignedStyles(r,"right")),h<0&&(h=0,this.setAlignedStyles(r,"left"))),{x:h,y:l};function f(){return i.right-n.left-2}function p(){return i.left-n.left-c}};this.positionPopup({ePopup:r,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,"subMenu",r,t,s instanceof MouseEvent?s:void 0)})}shouldRenderUnderOrAbove(e,t,r,s){const i=r.bottom-t.bottom,n=t.top-r.top,o=e.offsetHeight+s;return i>o?"under":n>o||n>i?"above":"under"}setAlignedStyles(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const s=this.popupList[r],{alignedToElement:i}=s;if(!i)return;const n=["right","left","over","above","under"];for(const o of n)i.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`);t&&(i.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){const r=this.getPopupIndex(t);if(r!==-1){const s=this.popupList[r];s.alignedToElement=e}}positionPopup(e){const{ePopup:t,keepWithinBounds:r,nudgeX:s,nudgeY:i,skipObserver:n,updatePosition:o}=e,a={width:0,height:0},l=(c=!1)=>{let{x:u,y:d}=o();c&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,s&&(u+=s),i&&(d+=i),r&&(u=this.keepXYWithinBounds(t,u,1),d=this.keepXYWithinBounds(t,d,0)),t.style.left=`${u}px`,t.style.top=`${d}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!n){const c=ei(this.beans,t,()=>l(!0));setTimeout(()=>c(),qP)}}getParentRect(){const e=Gt(this.beans);let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),wC(t)}keepXYWithinBounds(e,t,r){const s=r===0,i=s?"clientHeight":"clientWidth",n=s?"top":"left",o=s?"height":"width",a=s?"scrollTop":"scrollLeft",l=Gt(this.beans),c=l.documentElement,u=this.getPopupParent(),d=e.getBoundingClientRect(),h=u.getBoundingClientRect(),f=l.documentElement.getBoundingClientRect(),p=u===l.body,g=Math.ceil(d[o]);let v=p?(s?CC:yc)(c)+c[a]:u[i];p&&(v-=Math.abs(f[n]-h[n]));const w=v-g;return Math.min(Math.max(t,0),Math.max(w,0))}addPopup(e){const{eChild:t,ariaLabel:r,ariaOwns:s,alwaysOnTop:i,positionCallback:n,anchorToElement:o}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);const l=this.createPopupWrapper(t,!!i,r,s),c=this.addEventListenersToPopup({...e,wrapperEl:l});return n&&n(),this.addPopupToPopupList(t,l,c,o),{hideFunc:c}}initialisePopupPosition(e){const r=this.getPopupParent().getBoundingClientRect();Ce(e.style.top)||(e.style.top=`${r.top*-1}px`),Ce(e.style.left)||(e.style.left=`${r.left*-1}px`)}createPopupWrapper(e,t,r,s){const i=this.getPopupParent(),{environment:n,gos:o}=this.beans,a=gi({tag:"div"});return n.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(o.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||nn(e,"dialog"),r?lo(e,r):s&&(e.id||(e.id=`popup-component-${Cl}`),Ip(s,e.id)),a.appendChild(e),i.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){const t=this.beans,r=Gt(t),{wrapperEl:s,eChild:i,closedCallback:n,afterGuiAttached:o,closeOnEsc:a,modal:l,ariaOwns:c}=e;let u=!1;const d=g=>{if(!s.contains(pt(t)))return;g.key===K.ESCAPE&&!this.isStopPropagation(g)&&p({keyboardEvent:g})},h=g=>p({mouseEvent:g}),f=g=>p({touchEvent:g}),p=(g={})=>{const{mouseEvent:m,touchEvent:v,keyboardEvent:w,forceHide:C}=g;!C&&(this.isEventFromCurrentPopup({mouseEvent:m,touchEvent:v},i)||u)||(u=!0,s.remove(),r.removeEventListener("keydown",d),r.removeEventListener("mousedown",h),r.removeEventListener("touchstart",f),r.removeEventListener("contextmenu",h),this.eventSvc.removeListener("dragStarted",h),n&&n(m||v||w),this.removePopupFromPopupList(i,c))};return o&&o({hidePopup:p}),window.setTimeout(()=>{a&&r.addEventListener("keydown",d),l&&(r.addEventListener("mousedown",h),this.eventSvc.addListener("dragStarted",h),r.addEventListener("touchstart",f),r.addEventListener("contextmenu",h))},0),p}addPopupToPopupList(e,t,r,s){this.popupList.push({element:e,wrapper:t,hideFunc:r,instanceId:Cl,isAnchored:!!s}),s&&this.setPopupPositionRelatedToElement(e,s),Cl=Cl+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const s=this.popupList[r];if(s.stopAnchoringPromise&&s.stopAnchoringPromise.then(n=>n&&n()),s.stopAnchoringPromise=void 0,s.isAnchored=!1,!t)return;const i=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:s.hideFunc});return s.stopAnchoringPromise=i,s.isAnchored=!0,i}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&Ip(t,null),this.popupList=this.popupList.filter(r=>r.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),r=t.getBoundingClientRect(),{element:s,ePopup:i}=e,n=s.getBoundingClientRect(),o=d=>Number.parseInt(d.substring(0,d.length-1),10),a=(d,h)=>{const f=r[d]-n[d],p=o(i.style[d]);return{initialDiff:f,lastDiff:f,initial:p,last:p,direction:h}},l=a("top",0),c=a("left",1),u=this.beans.frameworkOverrides;return new Ue(d=>{u.wrapIncoming(()=>{Q2(()=>{const h=t.getBoundingClientRect(),f=s.getBoundingClientRect();if(f.top==0&&f.left==0&&f.height==0&&f.width==0){e.hidePopup();return}const g=(m,v)=>{const w=o(i.style[v]);m.last!==w&&(m.initial=w,m.last=w);const C=h[v]-f[v];if(C!=m.lastDiff){const y=this.keepXYWithinBounds(i,m.initial+m.initialDiff-C,m.direction);i.style[v]=`${y}px`,m.last=y}m.lastDiff=C};g(l,"top"),g(c,"left")},200).then(h=>{d(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){const{mouseEvent:r,touchEvent:s}=e,i=r||s;if(!i)return!1;const n=this.getPopupIndex(t);if(n===-1)return!1;for(let o=n;o<this.popupList.length;o++){const a=this.popupList[o];if(AT(a.element,i))return!0}return this.isElementWithinCustomPopup(i.target)}isElementWithinCustomPopup(e){const t=Gt(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const r=this.getWrapper(e);r&&(r.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(r))}bringPopupToFront(e){const t=this.getPopupParent(),r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),s=r.length,i=this.getWrapper(e);if(!i||s<=1||!t.contains(e))return;const n=[],o=[];for(const h of r)h!==i&&(h.classList.contains("ag-always-on-top")?o.push(h):n.push(h));const a=[],l=o.length,d=i.classList.contains("ag-always-on-top")||!l?[...n,...o,i]:[...n,i,...o];for(let h=0;h<=s;h++){const f=d[h];if(r[h]===d[h]||f===i)continue;const p=f.querySelectorAll("div");for(const g of p)g.scrollTop!==0&&a.push([g,g.scrollTop]);h===0?t.insertAdjacentElement("afterbegin",f):d[h-1].insertAdjacentElement("afterend",f)}for(;a.length;){const h=a.pop();h[0].scrollTop=h[1]}}handleThemeChange(e){if(e.themeChanged){const t=this.beans.environment;for(const r of this.popupList)t.applyThemeClasses(r.wrapper)}}},YP=class extends Af{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){const{value:t}=e,r=this.getGui();r.textContent=So(t);const s=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();r.classList.add(`ag-${s}-tooltip`)}},Dw=(e,t)=>{if(t!=null&&(e!=null&&e.setPointerCapture))try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},JP=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;const r=t.pointerId;if(!Dw(e,r))return null;const s={eElement:e,pointerId:r,onLost(i){QP(s,i)}};return e.addEventListener("lostpointercapture",s.onLost),s},ZP=e=>{if(!e)return;Aw(e);const{eElement:t,pointerId:r}=e;if(t){try{t.releasePointerCapture(r)}catch{}e.eElement=null}},Aw=e=>{const{eElement:t,onLost:r}=e;t&&r&&(t.removeEventListener("lostpointercapture",r),e.onLost=null)},QP=(e,t)=>{Aw(e);const{eElement:r,pointerId:s}=e;r&&t.pointerId===s&&Dw(r,s)},ls,vs,hd={passive:!0},oi={passive:!1},cs=e=>{if(!vs)vs=new WeakSet;else if(vs.has(e))return!1;return vs.add(e),!0},eD=class extends hr{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){var e;return((e=this.drag)==null?void 0:e.start.target)??null}isPointer(){return!!(ls!=null&&ls.has(ps(this.beans)))}hasPointerCapture(){var t,r,s;const e=(t=this.drag)==null?void 0:t.pointerCapture;return!!(e&&((s=(r=this.beans.eRootDiv).hasPointerCapture)!=null&&s.call(r,e.pointerId)))}destroy(){this.drag&&this.cancelDrag();const e=this.dragSources;for(const t of e)Qp(t);e.length=0,super.destroy()}removeDragSource(e){const t=this.dragSources;for(let r=0,s=t.length;r<s;++r){const i=t[r];if(i.params===e){t.splice(r,1),Qp(i);break}}}addDragSource(e){if(!this.isAlive())return;const{eElement:t,includeTouch:r}=e,s=[];let i;if(r){const c=t.style;c&&(i=c.touchAction,c.touchAction="none")}const n={handlers:s,params:e,oldTouchAction:i};this.dragSources.push(n),$l(s,[t,"pointerdown",c=>this.onPointerDown(e,c),oi],[t,"mousedown",c=>this.onMouseDown(e,c)]);const l=this.gos.get("suppressTouch");r&&!l&&$l(s,[t,"touchstart",u=>this.onTouchStart(e,u),oi])}cancelDrag(e){var r,s;const t=this.drag;e??(e=t==null?void 0:t.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),(s=t==null?void 0:(r=t.params).onDragCancel)==null||s.call(r),this.destroyDrag()}shouldPreventMouseEvent(e){const t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&xa(this.beans,e)&&!Yo(gd(e))}initDrag(e,...t){this.drag=e;const r=this.beans,s=a=>this.onScroll(a),i=a=>this.onKeyDown(a),n=ps(r),o=Gt(r);$l(e.handlers,[n,"contextmenu",Nn],[n,"keydown",i],[o,"scroll",s,{capture:!0}],[o.defaultView||window,"scroll",s],...t)}destroyDrag(){this.dragging=!1;const e=this.drag;if(e){const t=e.rootEl;(ls==null?void 0:ls.get(t))===e&&ls.delete(t),this.drag=null,ZP(e.pointerCapture),bf(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;const r=this.beans;if(vs!=null&&vs.has(t))return;const s=t.pointerType;if(s==="touch"&&(r.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),Yo(gd(t))))||!t.isPrimary||s==="mouse"&&t.button!==0)return;this.destroyDrag();const i=ps(r),n=e.eElement,o=t.pointerId,a=new fd(i,e,t,o);ls??(ls=new WeakMap),ls.set(i,a);const l=h=>{h.pointerId===o&&this.onMouseOrPointerMove(h)},c=h=>{h.pointerId===o&&this.onMouseOrPointerUp(h)},u=h=>{h.pointerId===o&&cs(h)&&this.cancelDrag()},d=h=>this.draggingPreventDefault(h);this.initDrag(a,[i,"pointerup",c],[i,"pointercancel",u],[i,"pointermove",l,oi],[i,"touchmove",d,oi],[n,"mousemove",d,oi]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):cs(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!cs(t)||Yo(gd(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){this.dragging&&Nn(t);return}this.destroyDrag();const s=this.beans,i=ps(s),n=new fd(i,e,t.touches[0]),o=h=>this.onTouchMove(h),a=h=>this.onTouchUp(h),l=h=>this.onTouchCancel(h),c=h=>this.draggingPreventDefault(h),u=ps(s),d=t.target??e.eElement;this.initDrag(n,[d,"touchmove",o,hd],[d,"touchend",a,hd],[d,"touchcancel",l,hd],[u,"touchmove",c,oi],[u,"touchend",a,oi],[u,"touchcancel",l,oi]),e.dragStartPixels===0&&this.onMove(n.start)}draggingPreventDefault(e){this.dragging&&Nn(e)}onMouseDown(e,t){if(t.button!==0||vs!=null&&vs.has(t)||this.isPointer())return;const r=this.beans;this.destroyDrag();const s=new fd(ps(r),e,t),i=a=>this.onMouseOrPointerMove(a),n=a=>this.onMouseOrPointerUp(a),o=ps(r);this.initDrag(s,[o,"mousemove",i],[o,"mouseup",n]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):cs(t)}onScroll(e){var s,i;if(!cs(e))return;const t=this.drag,r=t==null?void 0:t.lastDrag;r&&this.dragging&&((i=(s=t.params)==null?void 0:s.onDragging)==null||i.call(s,r))}onMouseOrPointerMove(e){var t;cs(e)&&(ki()&&((t=Gt(this.beans).getSelection())==null||t.removeAllRanges()),this.shouldPreventMouseEvent(e)&&Nn(e),this.onMove(e))}onTouchCancel(e){const t=this.drag;!t||!cs(e)||zn(t.start,e.changedTouches)&&this.cancelDrag()}onTouchMove(e){const t=this.drag;if(!t||!cs(e))return;const r=zn(t.start,e.touches);r&&(this.onMove(r),this.draggingPreventDefault(e))}onMove(e){var s,i,n;const t=this.drag;if(!t)return;t.lastDrag=e;const r=t.params;if(!this.dragging){const o=t.start,l=r.dragStartPixels??4;if(bC(e,o,l)||(this.dragging=!0,r.capturePointer&&(t.pointerCapture=JP(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:r.eElement}),(s=r.onDragStart)==null||s.call(r,o),this.drag!==t)||((i=r.onDragging)==null||i.call(r,o),this.drag!==t))return}(n=r.onDragging)==null||n.call(r,e)}onTouchUp(e){const t=this.drag;t&&cs(e)&&this.onUp(zn(t.start,e.changedTouches))}onMouseOrPointerUp(e){cs(e)&&this.onUp(e)}onUp(e){var r,s;const t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,(s=(r=t.params).onDragStop)==null||s.call(r,e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===K.ESCAPE&&this.cancelDrag()}},Qp=e=>{bf(e.handlers);const t=e.oldTouchAction;if(t!=null){const r=e.params.eElement.style;r&&(r.touchAction=t)}},fd=class{constructor(e,t,r,s=null){this.rootEl=e,this.params=t,this.start=r,this.pointerId=s,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},gd=e=>{const t=e.target;return t instanceof Element?t:null},tD=class extends hr{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.externalDropZoneCount=0,this.lastDropTarget=null}addDragSource(e,t=!1){const r={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:s=>this.onDragStart(e,s),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(r),this.beans.dragSvc.addDragSource(r)}setDragImageCompIcon(e,t=!1){const r=this.dragImageComp;r&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,r.setIcon(e,t))}removeDragSource(e){var s;const{dragSourceAndParamsList:t,beans:r}=this;for(let i=0,n=t.length;i<n;i++)if(t[i].dragSource===e){const o=t[i];(s=r.dragSvc)==null||s.removeDragSource(o),t.splice(i,1);break}}destroy(){const{dragSourceAndParamsList:e,dropTargets:t,beans:r}=this,s=r.dragSvc;for(const i of e)s==null||s.removeDragSource(i);e.length=0,t.length=0,this.externalDropZoneCount=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){const e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){var s;this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();const r=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-r.left,this.dragInitialSourcePointerOffsetY=t.clientY-r.top,(s=e.onDragStarted)==null||s.call(e),this.createAndUpdateDragImageComp(e)}onDragStop(e){var s,i;const{dragSource:t,lastDropTarget:r}=this;if((s=t==null?void 0:t.onDragStopped)==null||s.call(t),r){const n=this.dropTargetEvent(r,e,!1);(i=r.onDragStop)==null||i.call(r,n)}this.clearDragAndDropProperties()}onDragCancel(){var s,i;const{dragSource:e,lastDropTarget:t,lastMouseEvent:r}=this;if((s=e==null?void 0:e.onDragCancelled)==null||s.call(e),t&&r){const n=this.dropTargetEvent(t,r,!1);(i=t.onDragCancel)==null||i.call(t,n)}this.clearDragAndDropProperties()}onDragging(e,t=!1){var a,l,c;this.positionDragImageComp(e);const r=this.findCurrentDropTarget(e),{lastDropTarget:s,dragSource:i,dragItem:n}=this;let o=!1;if(r!==s){if(o=!0,s){const u=this.dropTargetEvent(s,e,t);(a=s.onDragLeave)==null||a.call(s,u)}if(s!==null&&!r?this.handleExit(i,n):s===null&&r&&this.handleEnter(i,n),r){const u=this.dropTargetEvent(r,e,t);(l=r.onDragEnter)==null||l.call(r,u)}this.lastDropTarget=r}else if(r){const u=this.dropTargetEvent(r,e,t);(c=r.onDragging)==null||c.call(r,u),u!=null&&u.changed&&(o=!0)}this.lastMouseEvent=e,o&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){var n;const t=e.getContainer(),r=(n=e.getSecondaryContainers)==null?void 0:n.call(e),s=r==null?void 0:r.length;if(!s)return[[t]];const i=new Array(s+1);i[0]=[t];for(let o=0;o<s;++o)i[o+1]=r[o];return i}isMouseOnDropTarget(e,t){const r=this.getAllContainersFromDropTarget(t);let s=!1;const i=(a,l)=>{for(const c of l){const{width:u,height:d,left:h,right:f,top:p,bottom:g}=c.getBoundingClientRect();if(u===0||d===0)return!1;const m=a.clientX>=h&&a.clientX<f,v=a.clientY>=p&&a.clientY<g;if(!m||!v)return!1}return!0};for(const a of r)if(i(e,a)){s=!0;break}const{eElement:n,type:o}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(n)?!1:s&&t.isInterestedIn(o,n)}findCurrentDropTarget(e){const t=[],r=this.dropTargets;for(let o=0,a=r.length;o<a;++o){const l=r[o];this.isMouseOnDropTarget(e,l)&&t.push(l)}const s=t.length;if(s===0)return null;if(s===1)return t[0];const n=ps(this.beans).elementsFromPoint(e.clientX,e.clientY);for(let o=0,a=n.length;o<a;++o){const l=n[o];for(let c=0,u=t.length;c<u;c++){const d=t[c],h=this.getAllContainersFromDropTarget(d);let f=!1;for(let p=0,g=h.length;p<g&&!f;p++){const m=h[p];for(let v=0,w=m.length;v<w;v++)if(m[v]===l){f=!0;break}}if(f)return d}}return null}addDropTarget(e){this.dropTargets.push(e),e.external&&this.externalDropZoneCount++}removeDropTarget(e){const t=e.getContainer(),r=this.dropTargets;let s=0;for(let i=0,n=r.length;i<n;++i){const o=r[i];if(o.getContainer()===t){o.external&&--this.externalDropZoneCount;continue}s!==i&&(r[s]=o),++s}r.length=s}hasExternalDropZones(){return this.externalDropZoneCount>0}findExternalZone(e){const t=this.dropTargets;for(let r=0,s=t.length;r<s;++r){const i=t[r];if(i.external&&i.getContainer()===e)return i}return null}dropTargetEvent(e,t,r){const{dragSource:s,dragItem:i,lastDraggingEvent:n,lastMouseEvent:o,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,c=e.getContainer(),u=c.getBoundingClientRect(),{clientX:d,clientY:h}=t,f=d-((o==null?void 0:o.clientX)||0),p=h-((o==null?void 0:o.clientY)||0),g=this.createEvent({event:t,x:d-u.left,y:h-u.top,vDirection:p>0?"down":p<0?"up":null,hDirection:f<0?"left":f>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:s,fromNudge:r,dragItem:i,dropZoneTarget:c,dropTarget:(n==null?void 0:n.dropTarget)??null,changed:!!(n!=null&&n.changed)});return this.lastDraggingEvent=g,g}positionDragImageComp(e){var r;const t=(r=this.dragImageComp)==null?void 0:r.getGui();t&&OT(t,e,this.beans)}removeDragImageComp(e){var t;this.dragImageComp===e&&(this.dragImageComp=null),e&&((t=e.getGui())==null||t.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){const t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t==null||t.then(r=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(r);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;const s=this.dragImageComp;s!==r&&(this.dragImageComp=r,this.removeDragImageComp(s)),r&&(this.appendDragImageComp(r),this.updateDragImageComp())})}appendDragImageComp(e){var i;const t=e.getGui(),r=t.style;r.position="absolute",r.zIndex="9999",(i=this.beans.dragSvc)!=null&&i.hasPointerCapture()&&(r.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),r.top="20px",r.left="20px";const s=pf(this.beans);s?s.appendChild(t):this.warnNoBody()}updateDragImageComp(){var o;const{dragImageComp:e,dragSource:t,lastDropTarget:r,lastDraggingEvent:s,dragImageLastLabel:i}=this;if(!e)return;this.setDragImageCompIcon(((o=r==null?void 0:r.getIconName)==null?void 0:o.call(r,s))??null);let n=t==null?void 0:t.dragItemName;typeof n=="function"&&(n=n(s)),n||(n=""),i!==n&&(this.dragImageLastLabel=n,e.setLabel(n))}},rD=class extends hr{constructor(e,t){super(),this.comp=e,this.stopPropagationCallbacks=t}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:r,eFocusableElement:s,stopPropagationCallbacks:i}=this,n=[t,r],o={setTabIndex:v=>{for(const w of n)v==null?w.removeAttribute("tabindex"):w.setAttribute("tabindex",v)}};this.addTabGuards(t,r);const{focusTrapActive:a=!1,onFocusIn:l,onFocusOut:c,focusInnerElement:u,handleKeyDown:d,onTabKeyDown:h,shouldStopEventPropagation:f,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:m}=e;this.tabGuardCtrl=this.createManagedBean(new mw({comp:o,focusTrapActive:a,eTopGuard:t,eBottomGuard:r,eFocusableElement:s,onFocusIn:l,onFocusOut:c,focusInnerElement:u,handleKeyDown:d,onTabKeyDown:h,shouldStopEventPropagation:f,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:m},i))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=Gt(this.beans).createElement("div"),r=e==="top"?Zn.TAB_GUARD_TOP:Zn.TAB_GUARD_BOTTOM;return t.classList.add(Zn.TAB_GUARD,r),nn(t,"presentation"),t}addTabGuards(e,t){const r=this.eFocusableElement;r.prepend(e),r.append(t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];wr(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,r){Sf(t)||(t=t.getGui());const{eBottomGuard:s}=this;s?s.before(t):e(t,r)}destroy(){const{eTopGuard:e,eBottomGuard:t}=this;vi(e),vi(t),super.destroy()}},sD=class extends Ro{initialiseTabGuard(e,t){this.tabGuardFeature=this.createManagedBean(new rD(this,t)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},iD=class extends tD{createEvent(e){return ke(this.gos,e)}createDragImageComp(e){const{gos:t,beans:r}=this,s=vk(r.userCompFactory,ke(t,{dragSource:e}));return s==null?void 0:s.newAgStackInstance()}handleEnter(e,t){var r;(r=e==null?void 0:e.onGridEnter)==null||r.call(e,t)}handleExit(e,t){var r;(r=e==null?void 0:e.onGridExit)==null||r.call(e,t)}warnNoBody(){oe(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){const r={getContainer:e,isInterestedIn:s=>s===1||s===0,getIconName:()=>"notAllowed"};this.addDropTarget(r),t.addDestroyFunc(()=>this.removeDropTarget(r))}};function Iw(e,t){return e+"_"+t}function kt(e){return e instanceof Ra}var Ra=class extends ee{constructor(e,t,r,s){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=r,this.pinned=s,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=Xo(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return Iw(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(const e of this.displayedChildren)kt(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=nt(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(const t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(const t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(const t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){var e;return!!((e=this.getColGroupDef())!=null&&e.autoHeaderHeight)}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(const t of this.displayedChildren??[])xi(t)?e.push(t):kt(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(const t of this.children??[])xi(t)?e.push(t):kt(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!(e!=null&&e.isPadding())?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){var r;this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(const s of this.children??[]){if(kt(s)&&!((r=s.displayedChildren)!=null&&r.length))continue;switch(s.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(s);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(s);break;default:this.displayedChildren.push(s);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},e0="row-group-",Hf="t-",Vf="b-",nD=0,yi=class{constructor(e){this.id=void 0,this.destroyed=!1,this._groupData=void 0,this.master=!1,this.detail=void 0,this.rowIndex=null,this.field=null,this.rowGroupColumn=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=nD++,this.alreadyRendered=!1,this.formulaRowIndex=null,this.hovered=!1,this.__selected=!1,this.beans=e}get groupData(){var t,r;const e=this._groupData;return e!==void 0?e:this.footer?(t=this.sibling)==null?void 0:t.groupData:((r=this.beans.groupStage)==null?void 0:r.loadGroupData(this))??null}set groupData(e){this._groupData=e}get allLeafChildren(){var t,r;const e=this._leafs;return e===void 0?((r=(t=this.beans.groupStage)==null?void 0:t.loadLeafs)==null?void 0:r.call(t,this))??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){var a,l,c;const{valueCache:r,eventSvc:s}=this.beans,i=this.data;this.data=e,r==null||r.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();const n=this.createDataChangedEvent(e,i,t);if((a=this.__localEventService)==null||a.dispatchEvent(n),this.sibling){this.sibling.data=e;const u=this.sibling.createDataChangedEvent(e,i,t);(l=this.sibling.__localEventService)==null||l.dispatchEvent(u)}s.dispatchEvent({type:"rowNodeDataChanged",node:this});const o=this.pinnedSibling;o&&(o.data=e,(c=o.__localEventService)==null||c.dispatchEvent(o.createDataChangedEvent(e,i,t)),s.dispatchEvent({type:"rowNodeDataChanged",node:o}))}updateDataOnDetailNode(){const e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,r){return{type:"dataChanged",node:this,oldData:t,newData:e,update:r}}getRowIndexString(){return this.rowIndex==null?(Qe(13),null):this.rowPinned==="top"?Hf+this.rowIndex:this.rowPinned==="bottom"?Vf+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){var o,a;const{selectionSvc:r}=this.beans,s=(o=r==null?void 0:r.createDaemonNode)==null?void 0:o.call(r,this),i=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),r&&(r.updateRowSelectable(this),r.syncInRowNode(this,s));const n=this.createDataChangedEvent(e,i,!1);(a=this.__localEventService)==null||a.dispatchEvent(n)}setId(e){var r;const t=co(this.beans.gos);if(t)if(this.data){const s=((r=this.parent)==null?void 0:r.getRoute())??[];this.id=t({data:this.data,parentKeys:s.length>0?s:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(e0)&&Qe(14,{groupPrefix:e0})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");const t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,r){var s;(s=this.beans.expansionSvc)==null||s.setExpanded(this,e,t,r)}setDataValue(e,t,r){var u;const{colModel:s,valueSvc:i,gos:n,editSvc:o}=this.beans,a=typeof e!="string"?e:s.getCol(e)??s.getColDefCol(e);if(!a)return!1;const l=i.getValueForDisplay({column:a,node:this,source:"api"}).value;if(n.get("readOnlyEdit")){const{beans:{eventSvc:d},data:h,rowIndex:f,rowPinned:p}=this;return d.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:f,rowPinned:p,column:a,colDef:a.colDef,data:h,node:this,oldValue:l,newValue:t,value:t,source:r}),!1}if(o&&!o.committing){const d=o.setDataValue({rowNode:this,column:a},t,r);if(d!=null)return d}const c=i.setValue(this,a,t,r);return this.dispatchCellChangedEvent(a,t,l),c&&((u=this.pinnedSibling)==null||u.dispatchCellChangedEvent(a,t,l)),c}updateHasChildren(){var r;let e=this.group&&!this.footer||!!((r=this.childrenAfterGroup)!=null&&r.length);const{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,r){var i;const s={type:"cellChanged",node:this,column:e,newValue:t,oldValue:r};(i=this.__localEventService)==null||i.dispatchEvent(s)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){var e;return((e=this.beans.expansionSvc)==null?void 0:e.isExpandable(this))??!1}isSelected(){if(this.footer)return this.sibling.isSelected();const e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){const t=this.childrenAfterGroup;if(t)for(let r=0,s=t.length;r<s;++r)t[r].depthFirstSearch(e);e(this)}dispatchRowEvent(e){var t;(t=this.__localEventService)==null||t.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,r="api"){var s;(s=this.beans.selectionSvc)==null||s.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:r})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new sn)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){var i,n,o,a;(i=this.beans.validation)==null||i.checkRowEvents(e);const r=this.__localEventService??(this.__localEventService=new sn);this.frameworkEventListenerService=(o=(n=this.beans.frameworkOverrides).createLocalEventListenerWrapper)==null?void 0:o.call(n,this.frameworkEventListenerService,r);const s=((a=this.frameworkEventListenerService)==null?void 0:a.wrap(e,t))??t;r.addEventListener(e,s)}removeEventListener(e,t){var s;const r=((s=this.frameworkEventListenerService)==null?void 0:s.unwrap(e,t))??t;this.removeLocalListener(e,r)}removeLocalListener(e,t){const r=this.__localEventService;r&&(r.removeEventListener(e,t),r.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(oe(61),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;const e=[];let t=this;for(;(t==null?void 0:t.key)!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){var t;const e=this.childStore;return e?e.getFirstNode():((t=this.childrenAfterSort)==null?void 0:t[0])??null}_destroy(e){if(this.destroyed)return!1;if(this.destroyed=!0,e?this.clearRowTopAndRowIndex():(this.setRowTop(null),this.setRowIndex(null)),!this.footer){const t=this.detailNode;t&&t._destroy(e);const r=this.sibling;r&&r._destroy(e)}return!0}};function oD(e,t,r){return ke(t,{type:r,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var aD=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_groupData","_leafs","childStore","groupValue","oldRowTop","sticky","treeNodeFlags","treeParent"]),lD=(e,t)=>{const r=new yi(t);for(const s of Object.keys(e))aD.has(s)||(r[s]=e[s]);return r.oldRowTop=null,r},bh=(e,t,r)=>{if(!r)return;let s=r.rowIndex;if(s==null)return;s+=t;const i=e.getRowCount();for(;s>=0&&s<i;){const n=e.getRow(s);if(!n||!n.footer&&!n.detail)return n;s+=t}},Mw={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},cD=new Set(Object.values(Mw));function ai(e,t){const r=e.filterUi;if(!r)return null;if(r.created)return r.promise;if(t)return null;const s=r.create(r.refreshed),i=r;return i.created=!0,i.promise=s,s}function uD(e,t,r,s,i,n,o){var a;return(a=t.refresh)==null||a.call(t,{...r,model:s,source:n,additionalEventAttributes:o}),e().then(l=>{if(l){const{filter:c,filterParams:u}=l;_w(c,u,s,i,n,o)}})}function _w(e,t,r,s,i,n){var o;(o=e==null?void 0:e.refresh)==null||o.call(e,{...t,model:r,state:s,source:i,additionalEventAttributes:n})}function Lw(e,t,r,s){const i=e();i!=null&&i.created&&i.promise.then(n=>{const o=t();_w(n,i.filterParams,o,r()??{model:o},"ui",s)})}function t0(e){var h;let t,r=!1,s;const{action:i,filterParams:n,getFilterUi:o,getModel:a,getState:l,updateState:c,updateModel:u,processModelToApply:d}=e;switch(i){case"apply":{const f=l();s=(f==null?void 0:f.model)??null,d&&(s=d(s)),t={state:f==null?void 0:f.state,model:s},r=!0;break}case"clear":{t={model:null},(h=n==null?void 0:n.buttons)!=null&&h.includes("apply")||(r=!0,s=null);break}case"reset":{t={model:null},r=!0,s=null;break}case"cancel":{t={model:a()};break}}c(t),r?u(s):Lw(o,a,l,{fromAction:i})}function Bt(e,t){return e[t]??null}function jr(e){return gi(e)}function dD(e){return{tag:"div",cls:e}}var hD=class extends Rt{constructor(e){const{className:t="ag-filter-apply-panel"}=e??{};super(dD(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){const r=this.buttons;if(this.buttons=e,r===e)return;const s=this.getGui();wr(s);let i;this.destroyListeners();const n=document.createDocumentFragment(),o=this.className,a=({type:c,label:u})=>{const d=v=>{this.dispatchLocalEvent({type:c,event:v})};["apply","clear","reset","cancel"].includes(c)||oe(75);const h=c==="apply",p=jr({tag:"button",attrs:{type:h&&t?"submit":"button"},ref:`${c}FilterButton`,cls:`ag-button ag-standard-button ${o}-button${h?" "+o+"-apply-button":""}`,children:u});this.activateTabIndex([p]),h&&(i=p);const g=v=>{v.key===K.ENTER&&(v.preventDefault(),d(v))},m=this.listeners;p.addEventListener("click",d),m.push(()=>p.removeEventListener("click",d)),p.addEventListener("keydown",g),m.push(()=>p.removeEventListener("keydown",g)),n.append(p)};for(const c of e)a(c);this.eApply=i;const l=this.validationTooltipFeature;i&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!i&&l&&(this.validationTooltipFeature=this.destroyBean(l)),s.append(n)}getApplyButton(){return this.eApply}updateValidity(e,t=null){var s;const r=this.eApply;r&&(Ca(r,!e),this.validationMessage=t,(s=this.validationTooltipFeature)==null||s.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(const e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}},fD={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`,minDateValidation:e=>`Date must be after ${e[0]}`,maxDateValidation:e=>`Date must be before ${e[0]}`,strictMinValueValidation:e=>`Must be greater than ${e[0]}`,strictMaxValueValidation:e=>`Must be less than ${e[0]}`};function xs(e,t,r){return BT(e,fD,t,r)}function Gf(e,t){const{debounceMs:r}=e;return bu(e)?(r!=null&&oe(71),0):r??t}function bu(e){var t;return(((t=e.buttons)==null?void 0:t.indexOf("apply"))??-1)>=0}function Ow(e,t,r,s){let i=xs(e,r);if(typeof t=="function"){const n=xs(e,s);i=t({filterOptionKey:s,filterOption:n,placeholder:i})}else typeof t=="string"&&(i=t);return i}var gD=class extends Rt{constructor(e,t,r,s,i,n){super(),this.column=e,this.wrapper=t,this.eventParent=r,this.updateModel=s,this.isGlobalButtons=i,this.enableGlobalButtonCheck=n,this.hidePopup=null,this.applyActive=!1}postConstruct(){const{comp:e,params:t}=this.wrapper,r=t,s=r.useForm,i=s?"form":"div";this.setTemplate({tag:i,cls:"ag-filter-wrapper"}),s&&this.addManagedElementListeners(this.getGui(),{submit:n=>{n==null||n.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=r,this.resetButtonsPanel(r),this.addManagedListeners(this.eventParent,{filterParamsChanged:({column:n,params:o})=>{n===this.column&&this.resetButtonsPanel(o,this.params)},filterStateChanged:({column:n,state:o})=>{var a;n===this.column&&((a=this.eButtons)==null||a.updateValidity(o.valid!==!1))},filterAction:({column:n,action:o,event:a})=>{n===this.column&&this.afterAction(o,a)},...this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:n})=>{if(n!==this.isGlobalButtons){this.isGlobalButtons=n;const o=this.params;this.resetButtonsPanel(o,o,!0)}}}:void 0})}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,r){const{buttons:s,readOnly:i}=t??{},{buttons:n,readOnly:o,useForm:a}=e;if(!r&&i===o&&ma(s,n))return;const l=n&&n.length>0&&!e.readOnly&&!this.isGlobalButtons;let c=this.eButtons;if(l){const u=n.map(d=>{const h=`${d}Filter`;return{type:d,label:xs(this,h)}});if(this.applyActive=bu(this.params),!c){c=this.createBean(new hD),this.appendChild(c.getGui());const d=this.column,h=f=>({event:p})=>{this.updateModel(d,f,{fromButtons:!0}),this.afterAction(f,p)};c==null||c.addManagedListeners(c,{apply:h("apply"),clear:h("clear"),reset:h("reset"),cancel:h("cancel")}),this.eButtons=c}c.updateButtons(u,a)}else this.applyActive=!1,c&&(vi(c.getGui()),this.eButtons=this.destroyBean(c))}close(e){const t=this.hidePopup;if(!t)return;const r=e,s=r==null?void 0:r.key;let i;(s===K.ENTER||s===K.SPACE)&&(i={keyboardEvent:r}),t(i),this.hidePopup=null}afterAction(e,t){const{params:r,applyActive:s}=this,i=r==null?void 0:r.closeOnApply;switch(e){case"apply":{t==null||t.preventDefault(),i&&s&&this.close(t);break}case"reset":{i&&s&&this.close();break}case"cancel":{i&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===K.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},pD={tag:"div",cls:"ag-filter"},mD=class extends Rt{constructor(e,t,r){super(pD),this.column=e,this.source=t,this.enableGlobalButtonCheck=r,this.wrapper=null}postConstruct(){var e;(e=this.beans.colFilter)==null||e.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){var e;return((e=this.wrapper)==null?void 0:e.then(t=>t.comp))??null}afterInit(){var e;return((e=this.wrapper)==null?void 0:e.then(()=>{}))??Ue.resolve()}afterGuiAttached(e){var t;this.afterGuiAttachedParams=e,(t=this.wrapper)==null||t.then(r=>{var s,i,n;(s=this.comp)==null||s.afterGuiAttached(e),(n=(i=r==null?void 0:r.comp)==null?void 0:i.afterGuiAttached)==null||n.call(i,e)})}afterGuiDetached(){var e;(e=this.wrapper)==null||e.then(t=>{var r,s;(s=(r=t==null?void 0:t.comp)==null?void 0:r.afterGuiDetached)==null||s.call(r)})}createFilter(e){const{column:t,source:r,beans:{colFilter:s}}=this,i=s.getFilterUiForDisplay(t)??null;this.wrapper=i,i==null||i.then(n=>{var c;if(!n)return;const{isHandler:o,comp:a}=n;let l;if(o){const u=!!this.enableGlobalButtonCheck,d=this.createBean(new gD(t,n,s,s.updateModel.bind(s),u&&s.isGlobalButtons,u));this.comp=d,l=d.getGui()}else l=a.getGui(),Ce(l)||oe(69,{guiFromFilter:l});this.appendChild(l),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:r,eGui:this.getGui()}):(c=a.afterGuiAttached)==null||c.call(a,this.afterGuiAttachedParams)})}onFilterDestroyed(e){const{source:t,column:r}=e;(t==="api"||t==="paramsUpdated")&&r.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(wr(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){var e;(e=this.beans.colFilter)==null||e.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},r0={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},s0=["january","february","march","april","may","june","july","august","september","october","november","december"];function vD(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function i0(e){return e instanceof Date&&!isNaN(e.getTime())}var Fh={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:i0}),dateString:({dataTypeDefinition:e})=>({comparator:(t,r)=>{const s=e.dateParser(r);return r==null||s<t?-1:s>t?1:0},isValidDate:t=>typeof t=="string"&&i0(e.dateParser(t))}),dateTime:e=>Fh.date(e),dateTimeString:e=>Fh.dateString(e),object:()=>{},text:()=>{}},Rh={number:()=>({comparator:vD}),boolean:({t:e})=>({valueFormatter:t=>Ce(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:r=>{const s=e(r);return Ce(s)?s:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(r,s)=>{if(r==="NaN")return t("invalidDate","Invalid Date");if(s===1&&r!=null){const i=s0[Number(r)-1];return t(i,r0[i])}return r??t("blanks","(Blanks)")},treeListPathGetter:r=>ml(r,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:r})=>({valueFormatter:s=>{const i=e(s);return Ce(i)?i:r("blanks","(Blanks)")},treeList:!0,treeListPathGetter:s=>ml(t.dateParser(s??void 0),!1),treeListFormatter:(s,i)=>{if(i===1&&s!=null){const n=s0[Number(s)-1];return r(n,r0[n])}return s??r("blanks","(Blanks)")}}),dateTime:e=>{const t=Rh.date(e);return t.treeListPathGetter=ml,t},dateTimeString(e){const t=e.dataTypeDefinition.dateParser,r=Rh.dateString(e);return r.treeListPathGetter=s=>ml(t(s??void 0)),r},object:({formatValue:e,t})=>({valueFormatter:r=>{const s=e(r);return Ce(s)?s:t("blanks","(Blanks)")}}),text:()=>{}};function CD(e,t,r,s,i,n,o){let a=t,l=r;const c=e==="agSetColumnFilter";!l&&s.baseDataType==="object"&&!c&&(l=({column:f,node:p})=>i({column:f,node:p,value:n.valueSvc.getValue(f,p)}));const d=(c?Rh:Fh)[s.baseDataType],h=d({dataTypeDefinition:s,formatValue:i,t:o});return a=typeof t=="object"?{...h,...t}:h,{filterParams:a,filterValueGetter:l}}var wD={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},xD={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function yD(e,t=!1){return(t?xD:wD)[e??"text"]}var SD=class extends jk{},Nw="__ag_Grid_Stop_Propagation";function cn(e){e[Nw]=!0}function zs(e){return e[Nw]===!0}var Wf={isStopPropagation:zs,stopPropagation:cn},Xa=class extends pw{constructor(e,t){super(e,Wf,t)}},bD=class extends Rt{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){const e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new Xa(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new SD(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){const t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}areStatesEqual(e,t){return e===t}refresh(e){const t=e,r=this.params;this.params=t;const{source:s,state:i,additionalEventAttributes:n}=t;s==="colDef"&&this.updateParams(t,r);const o=this.state;this.state=i;const a=n==null?void 0:n.fromAction;return(a&&a!=="apply"||i.model!==o.model||!this.areStatesEqual(i.state,o.state))&&this.setModelIntoUi(i.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=bu(e),this.setupApplyDebounced()}doesFilterPass(e){oe(283);const{getHandler:t,model:r,column:s}=this.params;return t().doesFilterPass({...e,model:r,handlerParams:this.beans.colFilter.getHandlerParams(s)})}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return oe(284),this.params.model!=null}setupApplyDebounced(){const e=Gf(this.params,this.defaultDebounceMs),t=Wt(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return oe(285),this.params.model}setModel(e){oe(286);const{beans:t,params:r}=this;return t.colFilter.setModelForColumnLegacy(r.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){const{params:t,state:{valid:r=!0,model:s}}=this;if(!r)return!1;const i=!this.areModelsEqual(t.model,s);return i&&t.onAction("apply",e),i}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();const r=this.getModelFromUi(),s={model:r,state:this.getState(),valid:this.canApply(r)};this.state=s;const{params:i,gos:n,eventSvc:o,applyActive:a}=this;i.onStateChange(s),i.onUiChange(this.getUiChangeEventParams()),n.get("enableFilterHandlers")||o.dispatchEvent({type:"filterModified",column:i.column,filterInstance:this}),s.valid&&(e??(e=a?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced())}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e==null?void 0:e.container,this.refreshFilterResizer(e==null?void 0:e.container)}refreshFilterResizer(e){const{positionableFeature:t,gos:r}=this;if(!t)return;const s=e==="floatingFilter"||e==="columnFilter";s?(t.restoreLastSize(),t.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(s)}afterGuiDetached(){var e;this.checkApplyDebounce(),(e=this.positionableFeature)==null||e.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e,t){return xs(this,e,t)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function Bw(e){return!!e.operator}function FD(e,t,r){if(t==null)return null;let s=null;const{compName:i,jsComp:n,fwComp:o}=lw(e,t);return i?s={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[i]:n==null&&o==null&&t.filter===!0&&(s=r()),s}var tc={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},zf=class extends ee{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},r=t.autoHeight?tc.AUTO_HEIGHT:t.print?tc.PRINT:tc.NORMAL;this.view.updateLayoutClasses(r,t)}},li="Viewport",n0="fakeVScrollComp",pd=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],o0=100,md=150,RD=class extends ee{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=Wt(this,()=>this.lastScrollSource[1]=null,md),this.resetLastVScrollDebounced=Wt(this,()=>this.lastScrollSource[0]=null,md)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,r=>{this.centerRowsCtrl=r.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,li)});for(const e of pd){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),r=t?Wt(this,this.onVScroll.bind(this,li),o0):this.onVScroll.bind(this,li),s=t?Wt(this,this.onVScroll.bind(this,n0),o0):this.onVScroll.bind(this,n0);this.addManagedElementListeners(this.eBodyViewport,{scroll:r}),this.registerScrollPartner(e,s)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...pd,li]){if(this.lastScrollSource[1]===t)continue;const r=this.getViewportForSource(t);bc(r,e,this.enableRtl)}}getViewportForSource(e){return e===li?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:r}=t;if(this.shouldBlockScrollUpdate(1,r,!0))return;const s=Sc(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(s),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===li?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:r}=this;r==null||r.setScrollTop(t),this.nextScrollTop=t,e===li?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,r!=null&&r.active?r.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})},md)}shouldBlockScrollUpdate(e,t,r=!1){return r&&!Xi()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=vf(this.eBodyViewport),{scrollHeight:r}=this.eBodyViewport;return e<0||e+t>r}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:r}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>r}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){const e=this.scrollLeft;let t=!1;for(const r of pd)if(this.getViewportForSource(r).scrollLeft!==e){t=!0;break}t&&this.onHScroll(li)}scrollGridIfNeeded(e=!1){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){const s=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:s:e=Math.min(Math.max(e,0),s)),bc(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:r,lastScrollTop:s}=this;return{top:s,bottom:s+r}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const{rowModel:r}=this.beans,s=r.getRowCount();let i=-1;for(let n=0;n<s;n++){const o=r.getRow(n);if(typeof e=="function"){if(o&&e(o)){i=n;break}}else if(e===o||e===o.data){i=n;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t,r=0){if(qt(this.gos,"print"))return;const{rowModel:s}=this.beans,i=s.getRowCount();if(typeof e!="number"||e<0||e>=i){oe(88,{index:e});return}this.clearRetryListeners();const{frameworkOverrides:n,pageBounds:o,rowContainerHeight:a,rowRenderer:l}=this.beans;n.wrapIncoming(()=>{var p,g;const c=this.ctrlsSvc.getGridBodyCtrl(),u=s.getRow(e);let d,h,f=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:m,stickyBottomHeight:v}=c,w=u.rowTop,C=u.rowHeight,y=o.getPixelOffset(),b=u.rowTop-y,F=b+u.rowHeight,S=this.getVScrollPosition(),D=a.divStretchOffset,T=S.top+D,V=S.bottom+D,_=V-T,I=a.getScrollPositionForPixel(b),z=a.getScrollPositionForPixel(F-_),U=Math.min((I+z)/2,b),j=T+m>b,ne=V-v<F;let se=null;t==="top"?se=I-m:t==="bottom"?se=z+v:t==="middle"?se=U:j?se=I-m:ne&&(z-I>_?se=I-m:se=z+v),se!==null&&(this.setVerticalScrollPosition(se),l.redraw({afterScroll:!0})),d=w!==u.rowTop||C!==u.rowHeight,h=m!==c.stickyTopHeight||v!==c.stickyBottomHeight,f++}while((d||h)&&f<10);if((p=this.animationFrameSvc)==null||p.flushAllFrames(),r<10&&(u!=null&&u.stub||!((g=this.beans.rowAutoHeight)!=null&&g.areRowsMeasured()))){const m=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{const v=this.getVScrollPosition().top;m!==v&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=s.getRowCount())&&this.ensureIndexVisible(e,t,r+1)}})}})}clearRetryListeners(){for(const e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){const{colModel:r,frameworkOverrides:s}=this.beans,i=r.getCol(e);if(!i||i.isPinned()||!this.visibleCols.isColDisplayed(i))return;const n=this.getPositionedHorizontalScroll(i,t);s.wrapIncoming(()=>{var o;n!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(n),this.centerRowsCtrl.onHorizontalViewportChanged(),(o=this.animationFrameSvc)==null||o.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:r,columnAfterEnd:s}=this.isColumnOutsideViewport(e),i=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),n=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?r:s)||i,l=o?s:r;t!=="auto"&&(a=t==="start",l=t==="end");const c=t==="middle";if(a||l||c){const{colLeft:u,colMiddle:d,colRight:h}=this.getColumnBounds(e);return c?d-n/2:a?o?h:u:o?u-n:h-n}return null}isColumnOutsideViewport(e){const{start:t,end:r}=this.getViewportBounds(),{colLeft:s,colRight:i}=this.getColumnBounds(e),n=this.enableRtl,o=n?t>i:r<i,a=n?r<s:t>s;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,r=this.visibleCols.bodyWidth,s=e.getActualWidth(),i=e.getLeft(),n=t?-1:1,o=t?r-i:i,a=o+s*n,l=o+s/2*n;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),r=t,s=e+t;return{start:r,end:s,width:e}}},Uf=class extends ee{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=qt(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:r}=this.beans,s=t.bodyWidth,i=t.getColsLeftWidth(),n=t.getDisplayedColumnsRightWidth();let o;e?o=s+i+n:(o=s,this.addSpacer&&(this.gos.get("enableRtl")?i:n)===0&&r.verticalScrollShowing&&(o+=r.getScrollbarWidth())),this.callback(o)}},ED=class extends ee{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:r}=this,s=()=>{ti(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(s),r.registerBodyViewportResizeListener(s)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e==null||e.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const r=this.centerContainerCtrl.getCenterWidth();r!==this.centerWidth&&(this.centerWidth=r,t==null||t.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.eBodyViewport,t=vf(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function rc(e,t,r,s){var n;const i=(n=t.getColDef().cellRendererParams)==null?void 0:n.suppressMouseEventHandling;return Hw(e,t,r,s,i)}function TD(e,t,r,s){const i=t==null?void 0:t.suppressMouseEventHandling;return Hw(e,void 0,r,s,i)}function Hw(e,t,r,s,i){return i?i(ke(e,{column:t,node:r,event:s})):!1}function Vw(e,t,r){let s=t;for(;s;){const i=BC(e,s,r);if(i)return i;s=s.parentElement}return null}var Oc="cellCtrl";function jf(e,t){return Vw(e,t,Oc)}var Nc="renderedRow";function kD(e,t){return Vw(e,t,Nc)}function Eh(e,t,r,s,i){const n=s?s.getColDef().suppressKeyboardEvent:void 0;if(!n)return!1;const o=ke(e,{event:t,editing:i,column:s,node:r,data:r.data,colDef:s.getColDef()});return!!(n&&n(o))}function PD(e){const{pinnedRowModel:t,rowModel:r,rangeSvc:s,visibleCols:i}=e;if(!s||i.allCols.length===0)return;const n=(t==null?void 0:t.isEmpty("top"))??!0,o=(t==null?void 0:t.isEmpty("bottom"))??!0,a=n?null:"top";let l,c;o?(l=null,c=r.getRowCount()-1):(l="bottom",c=(t==null?void 0:t.getPinnedBottomRowCount())??-1),s.setCellRange({rowStartIndex:0,rowStartPinned:a,rowEndIndex:c,rowEndPinned:l})}var DD=class extends ee{constructor(e){super(),this.element=e}postConstruct(){var e;this.addKeyboardListeners(),this.addMouseListeners(),(e=this.beans.touchSvc)==null||e.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){const t=["dblclick","contextmenu","mouseover","mouseout","click",SC("touchstart")?"touchstart":"mousedown"];for(const r of t){const s=this.processMouseEvent.bind(this,r);this.addManagedElementListeners(this.element,{[r]:s})}}processMouseEvent(e,t){var i;if(!xa(this.beans,t)||zs(t))return;const{cellCtrl:r,rowCtrl:s}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(r!=null&&r.column&&r.dispatchCellContextMenuEvent(t),(i=this.beans.contextMenuSvc)==null||i.handleContextMenuMouseEvent(t,void 0,s,r)):(r&&r.onMouseEvent(e,t),s&&s.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:jf(t,e),rowCtrl:kD(t,e)}}processKeyboardEvent(e,t){const{cellCtrl:r,rowCtrl:s}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):s!=null&&s.isFullWidth()&&this.processFullWidthRowKeyboardEvent(s,e,t))}processCellKeyboardEvent(e,t,r){var n,o;const s=((n=this.editSvc)==null?void 0:n.isEditing(e,{withOpenEditor:!0}))??!1;!Eh(this.gos,r,e.rowNode,e.column,s)&&t==="keydown"&&(!s&&((o=this.beans.navigation)!=null&&o.handlePageScrollingKey(r))||e.onKeyDown(r),this.doGridOperations(r,s),Cw(r)&&e.processCharacter(r)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(r,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,r){const{rowNode:s}=e,{focusSvc:i,navigation:n}=this.beans,o=i.getFocusedCell(),a=o==null?void 0:o.column;if(!Eh(this.gos,r,s,a,!1)){const c=r.key;if(t==="keydown")switch(c){case K.PAGE_HOME:case K.PAGE_END:case K.PAGE_UP:case K.PAGE_DOWN:n==null||n.handlePageScrollingKey(r,!0);break;case K.LEFT:case K.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case K.UP:case K.DOWN:e.onKeyboardNavigate(r);break;case K.TAB:e.onTabKeyDown(r);break}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",r))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!xa(this.beans,e))return;const r=cw(e),{clipboardSvc:s,undoRedo:i}=this.beans;if(r===K.A)return this.onCtrlAndA(e);if(r===K.C)return this.onCtrlAndC(s,e);if(r===K.D)return this.onCtrlAndD(s,e);if(r===K.V)return this.onCtrlAndV(s,e);if(r===K.X)return this.onCtrlAndX(s,e);if(r===K.Y)return this.onCtrlAndY(i);if(r===K.Z)return this.onCtrlAndZ(i,e)}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:r,selectionSvc:s},gos:i}=this;r&&wi(i)&&!C2(i)&&t.isRowsToRender()?PD(this.beans):s&&s.selectAllRowNodes({source:"keyboardSelectAll",selectAll:UC(i)}),e.preventDefault()}onCtrlAndC(e,t){var s;if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);(s=this.editSvc)!=null&&s.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){var s;if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);(s=this.editSvc)!=null&&s.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){var s;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);(s=this.editSvc)!=null&&s.isEditing(r,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e==null||e.redo("ui")}},Gw=class extends ee{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,r=t!=null?`${t}px`:"";this.eContainer.style.height=r,this.eViewport&&(this.eViewport.style.height=r)}},wl=e=>e.topRowCtrls,xl=e=>e.getStickyTopRowCtrls(),yl=e=>e.getStickyBottomRowCtrls(),Sl=e=>e.bottomRowCtrls,bl=e=>e.allRowCtrls,vd=e=>e.getCtrls("top"),Cd=e=>e.getCtrls("center"),wd=e=>e.getCtrls("bottom"),AD={center:{type:"center",name:"center-cols",getRowCtrls:bl,getSpannedRowCtrls:Cd},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:bl,getSpannedRowCtrls:Cd},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:bl,getSpannedRowCtrls:Cd},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:bl},topCenter:{type:"center",name:"floating-top",getRowCtrls:wl,getSpannedRowCtrls:vd},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:wl,getSpannedRowCtrls:vd},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:wl,getSpannedRowCtrls:vd},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:wl},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:xl},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:xl},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:xl},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:xl},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:yl},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:yl},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:yl},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:yl},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:Sl,getSpannedRowCtrls:wd},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Sl,getSpannedRowCtrls:wd},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Sl,getSpannedRowCtrls:wd},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:Sl}};function Ww(e){return`ag-${Ya(e).name}-viewport`}function sc(e){const t=Ya(e);return t.container??`ag-${t.name}-container`}function ID(e){return`ag-${Ya(e).name}-spanned-cells-container`}function Ya(e){return AD[e]}var MD=["topCenter","topLeft","topRight"],_D=["bottomCenter","bottomLeft","bottomRight"],LD=["center","left","right"],OD=["center","left","right","fullWidth"],ND=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],BD=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],HD=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],zw=["stickyTopCenter","stickyTopLeft","stickyTopRight"],Uw=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],VD=[...zw,"stickyTopFullWidth",...Uw,"stickyBottomFullWidth"],GD=[...MD,..._D,...LD,...zw,...Uw],WD=class extends ee{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=Ya(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new ED(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,r,s){this.comp=e,this.eContainer=t,this.eSpannedContainer=r,this.eViewport=s,this.createManagedBean(new DD(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:i,rangeSvc:n}=this.beans,o=()=>this.onPinnedWidthChanged();this.forContainers(BD,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i==null?void 0:i.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:o})}),this.forContainers(HD,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i==null?void 0:i.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:o})}),this.forContainers(OD,()=>this.createManagedBean(new Gw(this.eContainer,this.name==="center"?s:void 0))),n&&this.forContainers(GD,()=>this.createManagedBean(n.createDragListenerFeature(this.eContainer))),this.forContainers(ND,()=>this.createManagedBean(new Uf(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans,r=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:r,displayedColumnsWidthChanged:r,displayedRowsChanged:s=>this.onDisplayedRowsChanged(s.afterScroll)}),r(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const s=this.options.getSpannedRowCtrls(e);s&&this.comp.setSpannedRowCtrls(s,!1)}})}listenOnDomOrder(){if(VD.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const r=this.gos.get("ensureDomOrder"),s=qt(this.gos,"print");this.comp.setDomOrder(r||s)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=r=>{e.dragging&&r.cancelable&&r.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,r,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return wa(this.eViewport)}getCenterViewportScrollLeft(){return Sc(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=ei(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return Cf(this.eViewport)}getViewportScrollLeft(){return Sc(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||xf(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){bc(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const r=qt(this.gos,"print"),i=this.gos.get("embedFullWidthRows")||r,n=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!i&&a:i||!a});this.comp.setRowCtrls({rowCtrls:n,useFlushSync:e})}},zD="ag-force-vertical-scroll",UD="ag-selectable",jD="ag-column-moving",$D=class extends ee{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,r,s,i,n,o){var a,l;this.comp=e,this.eGridBody=t,this.eBodyViewport=r,this.eTop=s,this.eBottom=i,this.eStickyTop=n,this.eStickyBottom=o,this.eCenterColsViewport=r.querySelector(`.${Ww("center")}`),this.eFullWidthContainer=r.querySelector(`.${sc("fullWidth")}`),this.eStickyTopFullWidthContainer=n.querySelector(`.${sc("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${sc("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",c=>this.setCellTextSelection(c.currentValue)),this.createManagedBean(new zf(this.comp)),this.scrollFeature=this.createManagedBean(new RD(r)),(a=this.beans.rowDragSvc)==null||a.setupRowDrag(r,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([s,r,i,n,o]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),(l=this.filterManager)==null||l.setupAdvFilterHeaderComp(s),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),r=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:r,rowResizeEnded:r}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){const t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const r=t&&e.getScrollbarWidth()||0,s=hw()?16:0,i=`calc(100% + ${r+s}px)`;ti(this.beans,()=>this.comp.setBodyViewportWidth(i)),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t,gos:r}=this;let s=r.get("treeData");if(!s){const i=t.isPivotMode();s=(e?e.columns.length:0)>=(i?2:1)}this.comp.setGridRootRole(s?"treegrid":"grid")}addFocusListeners(e){for(const t of e)this.addManagedElementListeners(t,{focusin:r=>{const{target:s}=r,i=ji(s,"ag-root",t);t.classList.toggle("ag-has-focus",!i)},focusout:r=>{const{target:s,relatedTarget:i}=r,n=t.contains(i),o=ji(i,"ag-root",t);ji(s,"ag-root",t)||(!n||o)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(jD,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(UD,e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){var e;(e=this.beans.editSvc)==null||e.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){var i,n;const e=(((i=this.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:i.getRowCount())??0)+(((n=this.filterManager)==null?void 0:n.getHeaderRowCount())??0),{rowModel:t}=this.beans,r=t.isLastRowIndexKnown()?t.getRowCount():-1,s=r===-1?-1:e+r;this.comp.setRowCount(s)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?zD:null,r=qt(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||r&&xC(this.eBodyViewport)}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let r=t.sizesMeasured;const s=()=>{const i=r&&$n(this.gos)&&!e.stretching,n=i?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(n,i)};s(),this.addManagedEventListeners({heightScaleChanged:s}),this.addManagedPropertyListener("animateRows",s),this.addManagedEventListeners({stylesChanged:()=>{!r&&t.sizesMeasured&&(r=!0,s())}})}addBodyViewportListener(){const{eBodyViewport:e,eStickyTop:t,eStickyBottom:r,eTop:s,eBottom:i,beans:{popupSvc:n,touchSvc:o}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),o==null||o.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,n)});const l=this.onStickyWheel.bind(this);for(const u of[t,r,s,i])this.addManagedElementListeners(u,{wheel:l});const c=this.onHorizontalWheel.bind(this);for(const u of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(u).eContainer,{wheel:c});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:r,shiftKey:s}=e;(s||Math.abs(t)>Math.abs(r))&&xa(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){const{deltaX:t,deltaY:r,shiftKey:s}=e;(s||Math.abs(t)>Math.abs(r))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:r}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||r})}onBodyViewportContextMenu(e,t,r){var i;if(!e&&!r)return;this.gos.get("preventDefaultOnContextMenu")&&(e||r).preventDefault();const{target:s}=e||t;(s===this.eBodyViewport||s===this.ctrlsSvc.get("center").eViewport)&&((i=this.beans.contextMenuSvc)==null||i.showContextMenu({mouseEvent:e,touchEvent:r,value:null,anchorToElement:this.eGridBody,source:"ui"}))}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e!=null&&e.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e,beans:{environment:t}}=this,r=e==null?void 0:e.getPinnedTopTotalHeight(),s=e==null?void 0:e.getPinnedBottomTotalHeight(),i=t.getPinnedRowBorderWidth(),n=t.getRowBorderWidth(),o=i-n,a=r?o+r:0,l=s?o+s:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){var i,n;const t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(((i=this.filterManager)==null?void 0:i.getHeaderHeight())??0),r=((n=this.pinnedRowModel)==null?void 0:n.getPinnedTopTotalHeight())??0;let s=0;t>0&&(s+=t),r>0&&(s+=r),s>0&&(s+=1),this.comp.setStickyTopTop(`${s}px`)}setStickyBottomOffsetBottom(){const{pinnedRowModel:e,scrollVisibleSvc:t,comp:r}=this,s=(e==null?void 0:e.getPinnedBottomTotalHeight())??0,n=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,o=s+n;r.setStickyBottomBottom(`${o}px`)}};function KD(e,t){var r;return((r=jf(e,t.target))==null?void 0:r.getFocusedCellPosition())??null}function a0(e,t){const r=qt(e.gos,"normal"),s=t;let i,n;s.clientX!=null||s.clientY!=null?(i=s.clientX,n=s.clientY):(i=s.x,n=s.y);const{pageFirstPixel:o}=e.pageBounds.getCurrentPagePixelRange();if(n+=o,r){const a=e.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),c=a.getHScrollPosition();i+=c.left,n+=l.top}return{x:i,y:n}}var jw=class extends Rt{constructor(e,t){super(),this.direction=t,this.eViewport=be,this.eContainer=be,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",uw()||Xi())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=hw(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),r=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:r,touchend:r})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),ti(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;jT(this,()=>Qs(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},qD={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},XD=class extends jw{constructor(){super(qD,"horizontal"),this.eLeftSpacer=be,this.eRightSpacer=be,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new Uf(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){var t;if(!this.invisibleScrollbar)return;const e=((t=this.beans.pinnedRowModel)==null?void 0:t.getPinnedBottomTotalHeight())??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const r=!this.enableRtl&&e,s=this.scrollVisibleSvc.getScrollbarWidth();r&&(t+=s),Fs(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=s);let i=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(i+=s),Fs(this.eLeftSpacer,i),this.eLeftSpacer.classList.toggle("ag-scroller-corner",i<=s)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,r=this.gos.get("suppressHorizontalScroll"),s=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,n=r?0:s===0&&t?16:s,o=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),Jo(this.getGui(),n),Jo(this.eViewport,n),Jo(this.eContainer,n),n||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(o,100):o()}getScrollPosition(){return Sc(this.eViewport,this.enableRtl)}setScrollPosition(e){Qs(this.eViewport)||this.attemptSettingScrollPosition(e),bc(this.eViewport,e,this.enableRtl)}},YD={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},JD=class extends jw{constructor(){super(YD,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new Gw(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,r=this.invisibleScrollbar,s=t&&e.getScrollbarWidth()||0,i=s===0&&r?16:s;this.toggleCss("ag-scrollbar-invisible",r),Fs(this.getGui(),i),Fs(this.eViewport,i),Fs(this.eContainer,i),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const r=e.getGridBodyCtrl().eBodyViewport,s=this.getScrollPosition(),i=r.scrollTop;s!=i&&this.setScrollPosition(i,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!Qs(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},ZD="ag-column-first",QD="ag-column-last";function $w(e,t,r,s){return ct(e)?[]:tA(e.headerClass,e,t,r,s)}function Kw(e,t,r){e.toggleCss(ZD,r.isColAtEdge(t,"first")),e.toggleCss(QD,r.isColAtEdge(t,"last"))}function eA(e,t,r,s){return ke(t,{colDef:e,column:r,columnGroup:s})}function tA(e,t,r,s,i){if(ct(e))return[];let n;if(typeof e=="function"){const o=eA(t,r,s,i);n=e(o)}else n=e;return typeof n=="string"?[n]:Array.isArray(n)?[...n]:[]}function rA(e){const{rowIndex:t,rowPinned:r,column:s}=e;return`${t}.${r??"null"}.${s.getId()}`}function $f(e,t){const r=e.column===t.column,s=e.rowPinned===t.rowPinned,i=e.rowIndex===t.rowIndex;return r&&s&&i}function sA(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(Ce(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function iA(e,t){return!e&&!t?!0:!e||!t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function nA(e){let t=0,r;const{pinnedRowModel:s,rowModel:i,pageBounds:n}=e;return s!=null&&s.getPinnedTopRowCount()?r="top":i.getRowCount()?(r=null,t=n.getFirstRow()):s!=null&&s.getPinnedBottomRowCount()&&(r="bottom"),r===void 0?null:{rowIndex:t,rowPinned:r}}function oA(e){let t,r=null;const{pinnedRowModel:s,pageBounds:i}=e,n=s==null?void 0:s.getPinnedBottomRowCount(),o=s==null?void 0:s.getPinnedTopRowCount();return n?(r="bottom",t=n-1):e.rowModel.getRowCount()?t=i.getLastRow():o&&(r="top",t=o-1),t===void 0?null:{rowIndex:t,rowPinned:r}}function Ys(e,t){var r,s;switch(t.rowPinned){case"top":return(r=e.pinnedRowModel)==null?void 0:r.getPinnedTopRow(t.rowIndex);case"bottom":return(s=e.pinnedRowModel)==null?void 0:s.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Vn(e,t){var i;const r=(i=e.spannedRowRenderer)==null?void 0:i.getCellByPosition(t);if(r)return r;const s=e.rowRenderer.getRowByPosition(t);return s?s.getCellCtrl(t.column):null}function aA(e,t,r){const{rowModel:s,pinnedRowModel:i}=e;let n;return n??(n=s==null?void 0:s.getRowNode(t)),r?n??(n=i==null?void 0:i.getPinnedRowById(t,r)):(n??(n=i==null?void 0:i.getPinnedRowById(t,"top")),n??(n=i==null?void 0:i.getPinnedRowById(t,"bottom"))),n}function Bc(e,t,r=!1){const{rowIndex:s,rowPinned:i}=t,{pageBounds:n,pinnedRowModel:o,rowModel:a}=e;if(s===0)return i==="top"?null:i==="bottom"&&a.isRowsToRender()?{rowIndex:n.getLastRow(),rowPinned:null}:o!=null&&o.isRowsToRender("top")?{rowIndex:o.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(r){const l=i?void 0:a.getRow(s);return qw(e,l,!0)??{rowIndex:s-1,rowPinned:i}}return{rowIndex:s-1,rowPinned:i}}function l0(e,t,r=!1){const{rowIndex:s,rowPinned:i}=t,{pageBounds:n,pinnedRowModel:o,rowModel:a}=e;if(lA(e,t))return i==="bottom"?null:i==="top"&&a.isRowsToRender()?{rowIndex:n.getFirstRow(),rowPinned:null}:o!=null&&o.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(r){const l=i?void 0:a.getRow(s);return qw(e,l)??{rowIndex:s+1,rowPinned:i}}return{rowIndex:s+1,rowPinned:i}}function qw(e,t,r=!1){const{gos:s,rowRenderer:i}=e;if(!(t!=null&&t.sticky)||!HC(s))return;const n=i.getStickyTopRowCtrls(),o=i.getStickyBottomRowCtrls(),a=!o.some(d=>d.rowNode.rowIndex===t.rowIndex),l=a?n:o,c=(r?-1:1)*(a?-1:1);let u;for(let d=0;d<l.length;d++)if(l[d].rowNode.rowIndex===t.rowIndex){u=l[d+c];break}return u?{rowIndex:u.rowNode.rowIndex,rowPinned:null}:void 0}function lA(e,t){const{rowPinned:r,rowIndex:s}=t,{pinnedRowModel:i,pageBounds:n}=e;return r==="top"?((i==null?void 0:i.getPinnedTopRowCount())??0)-1<=s:r==="bottom"?((i==null?void 0:i.getPinnedBottomRowCount())??0)-1<=s:n.getLastRow()<=s}function cA(e,t,r){t.addManagedElementListeners(r,{keydown:s=>{if(!s.defaultPrevented&&s.key===K.TAB){const i=s.shiftKey;yn(e,r,!1,i)||fo(e,i)&&s.preventDefault()}}})}function uA(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function Yi(e){var t;return e.gos.get("suppressHeaderFocus")||!!((t=e.overlays)!=null&&t.exclusive)}function Fu(e){var t;return e.gos.get("suppressCellFocus")||!!((t=e.overlays)!=null&&t.exclusive)}function fo(e,t,r=!1){const s=e.ctrlsSvc.get("gridCtrl");return!r&&s.focusNextInnerContainer(t)?!0:((r||!t&&!s.isDetailGrid())&&s.forceFocusOutOfContainer(t),!1)}function dA(e,t){const r=e.focusSvc,s=r.getFocusedCell();if(s&&t&&$f(s,t)){const{rowIndex:i,rowPinned:n,column:o}=t;gf(e)&&r.setFocusedCell({rowIndex:i,column:o,rowPinned:n,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!fw()})}}function ys(e){var t;return((t=e.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:t.getRowCount())??0}function Kf(e){const t=[],r=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const s of r){if(!s)continue;const i=s.getGroupRowCount()||0;for(let n=0;n<i;n++){const o=s.getGroupRowCtrlAtIndex(n),a=t[n];if(o){const l=hA(e,o);(a==null||l>a)&&(t[n]=l)}}}return t}function hA(e,t){let s=e.colModel.isPivotMode()?gA(e):Yw(e);const i=t.getHeaderCellCtrls();for(const n of i){const{column:o}=n,a=o.getAutoHeaderHeight();a!=null&&a>s&&o.isAutoHeaderHeight()&&(s=a)}return s}function qf(e){let r=e.colModel.isPivotMode()?fA(e):Ja(e);return e.colModel.forAllCols(s=>{const i=s.getAutoHeaderHeight();i!=null&&i>r&&s.isAutoHeaderHeight()&&(r=i)}),r}function Ja(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function Xw(e){return e.gos.get("floatingFiltersHeight")??Ja(e)}function Yw(e){return e.gos.get("groupHeaderHeight")??Ja(e)}function fA(e){return e.gos.get("pivotHeaderHeight")??Ja(e)}function gA(e){return e.gos.get("pivotGroupHeaderHeight")??Yw(e)}function pA(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var mA=class extends ee{setComp(e,t,r){this.comp=e,this.eGui=t;const{beans:s}=this,{headerNavigation:i,touchSvc:n,ctrlsSvc:o}=s;i&&this.createManagedBean(new Xa(r,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,s),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,s)}),this.onPivotModeChanged(s),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),n==null||n.mockHeaderContextMenu(this,a),o.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>ti(this.beans,()=>e()),stylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){var n;const{beans:e}=this;let t=0;const r=Kf(e).reduce((o,a)=>o+a,0),s=qf(e);if((n=e.filterManager)!=null&&n.hasFloatingFilters()&&(t+=Xw(e)),t+=r,t+=s,this.headerHeight===t)return;this.headerHeight=t;const i=`${t+1}px`;this.comp.setHeightAndMinHeight(i),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const r=e.visibleCols.allCols.some(s=>s.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",r)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),r=e.shiftKey,s=r!==t?"LEFT":"RIGHT",{beans:i}=this,{headerNavigation:n,focusSvc:o}=i;(n.navigateHorizontally(s,!0,e)||!r&&o.focusOverlay(!1)||fo(i,r,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:r}=this.beans;switch(e.key){case K.LEFT:t="LEFT";case K.RIGHT:{Ce(t)||(t="RIGHT"),r.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case K.UP:t="UP";case K.DOWN:{Ce(t)||(t="DOWN"),r.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:r,beans:s}=this;!t&&r.contains(pt(s))||r.contains(t)||(s.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,r){var o;const{menuSvc:s,ctrlsSvc:i}=this.beans;if(!e&&!r||!(s!=null&&s.isHeaderContextMenuEnabled()))return;const{target:n}=e??t;(n===this.eGui||n===((o=i.getHeaderRowContainerCtrl())==null?void 0:o.eViewport))&&s.showHeaderContextMenu(void 0,e,r)}},Xf=class extends ee{constructor(e,t,r,s){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=s,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=r}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?nt(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,r=e.get("suppressColumnMoveAnimation"),s=Ce(this.columnOrGroup.getOldLeft());(t==null?void 0:t.isActive())&&s&&!r?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),r=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=r,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:r,visibleCols:s}=this.beans;if(!qt(r,"print")||e.getPinned()==="left")return t;const n=s.getColsLeftWidth();if(e.getPinned()==="right"){const o=s.bodyWidth;return n+o+t}return n+t}setLeft(e){if(Ce(e)&&(this.eCell.style.left=`${e}px`),kt(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&ST(this.ariaEl,t.length)}}},vA=0,Jw="headerCtrl",Yf=class extends ee{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+vA++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,r,s,i){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,r,s,i),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){const{headerRowIndex:t,column:r}=this.beans.focusSvc.focusedHeader,s=r.getDefinition(),i=s==null?void 0:s.suppressHeaderKeyboardEvent;if(!Ce(i))return!1;const n=ke(this.gos,{colDef:s,column:r,headerRowIndex:t,event:e});return!!i(n)}getWrapperHasFocus(){return pt(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let r;if(typeof t=="function"){const s=this.getHeaderClassParams();r=t(s)}else r=t;r&&this.comp.setUserStyles(r)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:r,compBean:s}=e,{beans:i}=this,n=d=>{if(!this.isAlive()||!s.isAlive())return;const{paddingTop:h,paddingBottom:f,borderBottomWidth:p,borderTopWidth:g}=wn(this.eGui),m=h+f+p+g,w=t.offsetHeight+m;if(d<5){const C=Gt(i),y=!(C!=null&&C.contains(t)),b=w==0;if(y||b){ch(()=>n(d+1),"raf",i);return}}this.setColHeaderHeight(this.column,w)};let o=!1,a;const l=()=>{const d=this.column.isAutoHeaderHeight();d&&!o&&c(),!d&&o&&u()},c=()=>{o=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),n(0),a=ei(this.beans,t,()=>n(0))},u=()=>{o=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),s.addDestroyFunc(()=>u()),s.addManagedListeners(this.column,{widthChanged:()=>o&&n(0)}),s.addManagedEventListeners({sortChanged:()=>{o&&window.setTimeout(()=>n(0))}}),r&&r(l)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:r,eGui:s}=this;!e||!t||!s||(Kw(e,t,r.visibleCols),pC(s,r.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=Yi(this.beans);this.eGui&&pr(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){var o,a;const t=pt(this.beans),r=e.key===K.LEFT||e.key===K.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)return;if((this.isResizing||r)&&(e.preventDefault(),e.stopImmediatePropagation()),(e.ctrlKey||e.metaKey)&&cw(e)===K.C)return(o=this.beans.clipboardSvc)==null?void 0:o.copyToClipboard();if(!r)return;const n=e.key===K.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const l=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(l,e.shiftKey),(a=this.resizeFeature)==null||a.toggleColumnResizing(!0)}else this.moveHeader(n)}moveHeader(e){var t;(t=this.beans.colMoves)==null||t.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:r}=this.beans;return r?r.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:r}=this;let s=e.key===K.LEFT!==t.get("enableRtl");const i=r.getPinned(),n=t.get("enableRtl");return i&&n!==(i==="right")&&(s=!s),(s?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{var e;(e=this.resizeFeature)==null||e.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case K.PAGE_DOWN:case K.PAGE_UP:case K.PAGE_HOME:case K.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=Jw,{eGui:r,gos:s}=this;an(s,r,t,this),e.addDestroyFunc(()=>an(s,r,t,null))}focus(e){if(!this.isAlive())return!1;const{eGui:t}=this;return t?(this.lastFocusEvent=e||null,t.focus()):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){var e;this.dragSource&&((e=this.beans.dragAndDrop)==null||e.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,r){const s=e??t,{menuSvc:i,gos:n}=this.beans;n.get("preventDefaultOnContextMenu")&&s.preventDefault(),i!=null&&i.isHeaderContextMenuEnabled(r)&&i.showHeaderContextMenu(r,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",r)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:r}=this;e.isColumn?r.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):r.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},CA=class extends Yf{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,r,s,i){this.comp=e;const{rowCtrl:n,column:o,beans:a}=this,{colResize:l,context:c,colHover:u,rangeSvc:d}=a,h=Ka(this,c,i);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:s,checkMeasuringCallback:p=>this.setRefreshFunction("measuring",p),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(n.pinned,o,r,e,this)):it(r,!1),u==null||u.createHoverFeature(h,[o],t),d==null||d.createRangeHighlightFeature(h,o,e),h.createManagedBean(new Xf(o,t,a)),h.createManagedBean(new Xa(t,{shouldStopEventPropagation:p=>this.shouldStopEventPropagation(p),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(o,{colDefChanged:()=>this.refresh(),formulaRefChanged:()=>this.refresh(),headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const f=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:f,columnRowGroupChanged:f,columnPivotChanged:f,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){var r;(r=this.beans.colResize)==null||r.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return ke(t.gos,{colDef:r,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return Ck(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:r,gos:s}=this.beans;return ke(s,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!(e!=null&&e.isHeaderFilterButtonEnabled(this.column)),enableFilterIcon:!!r&&(!this.openFilterEnabled||Tr(this.gos)),showColumnMenu:(n,o)=>{e==null||e.showColumnMenu({column:this.column,buttonElement:n,positionBy:"button",onClosedCallback:o})},showColumnMenuAfterMouseClick:(n,o)=>{e==null||e.showColumnMenu({column:this.column,mouseEvent:n,positionBy:"mouse",onClosedCallback:o})},showFilter:n=>{e==null||e.showFilterMenu({column:this.column,buttonElement:n,containerType:"columnFilter",positionBy:"button"})},progressSort:n=>{t==null||t.progressSort(this.column,!!n,"uiColumnSorted")},setSort:(n,o)=>{t==null||t.setSortForColumn(this.column,Zr(n),!!o,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(n,o)=>{s.assertModuleRegistered("Tooltip",3),this.setupTooltip(n,o)}})}setupSelectAll(e){var r;const{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),(r=this.selectAllFeature)==null||r.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{var i;const s=t.createSelectAllFeature(this.column);s&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(s),(i=this.selectAllFeature)==null||i.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!s&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){var e;return(e=this.selectAllFeature)==null?void 0:e.getCheckboxGui()}handleKeyDown(e){var t;super.handleKeyDown(e),e.key===K.SPACE?(t=this.selectAllFeature)==null||t.onSpaceKeyDown(e):e.key===K.ENTER?this.onEnterKeyDown(e):e.key===K.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){var o,a;const{column:t,gos:r,sortable:s,beans:i}=this;let n=!1;(e.ctrlKey||e.metaKey)&&(n=this.showMenuOnKeyPress(e,!0)),n||(!e.altKey&&qn(r)?(o=i.rangeSvc)==null||o.handleColumnSelection(t,e):s&&((a=i.sortSvc)==null||a.progressSort(t,e.shiftKey,"uiColumnSorted")))}showMenuOnKeyPress(e,t){const r=this.comp.getUserCompInstance();return c0(r)&&r.onMenuKeyboardShortcut(t)?(e.preventDefault(),!0):!1}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),fw()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){var r;this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),r=$w(t,this.gos,this.column,null),s=this.userHeaderClasses;this.userHeaderClasses=new Set(r);for(const i of r)s.has(i)?s.delete(i):this.comp.toggleCss(i,!0);for(const i of s)this.comp.toggleCss(i,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){var t;this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=((t=this.beans.colMoves)==null?void 0:t.setDragSourceForHeader(e,this.column,this.displayName))??null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!(e!=null&&e.isColumnMenuInHeaderEnabled(this.column)),this.openFilterEnabled=!!(e!=null&&e.isFilterMenuInHeaderEnabled(this.column)),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(const e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const r=this.column.getActualWidth();this.comp.setWidth(`${r}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{var r;(r=this.comp)==null||r.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const r=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",r),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=e===0,r=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",r)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){var h;const{eGui:e,column:t,comp:r,beans:s}=this,i=Kf(this.beans),n=i.reduce((f,p)=>f+p,0)===0;if(r.toggleCss("ag-header-parent-hidden",n),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),r.toggleCss("ag-header-span-height",!1),r.toggleCss("ag-header-span-total",!1);return}const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();r.toggleCss("ag-header-span-height",o>0);const l=qf(s);if(o===0){r.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}r.toggleCss("ag-header-span-total",a);const c=(((h=this.column.getFirstRealParent())==null?void 0:h.getLevel())??-1)+1,u=i.length-c;let d=0;for(let f=0;f<u;f++)d+=i[i.length-1-f];e.style.setProperty("top",`${-d}px`),e.style.setProperty("height",`${l+d}px`)}refreshAriaSort(){var n;let e=null;const{beans:t,column:r,comp:s,sortable:i}=this;if(i){const o=this.getLocaleTextFunc(),a=((n=t.sortSvc)==null?void 0:n.getDisplaySortForColumn(r))??null;s.setAriaSort(hT(a)),e=o("ariaSortableColumn","Press ENTER to sort")}else s.setAriaSort();this.setAriaDescriptionProperty("sort",e)}refreshAriaMenu(){let e=null;this.menuEnabled&&(e=this.getLocaleTextFunc()("ariaMenuColumn","Press ALT DOWN to open column menu")),this.setAriaDescriptionProperty("menu",e)}refreshAriaFilterButton(){let e=null;const{openFilterEnabled:t,gos:r}=this;t&&!Tr(r)&&(e=this.getLocaleTextFunc()("ariaFilterColumn","Press CTRL ENTER to open filter")),this.setAriaDescriptionProperty("filterButton",e)}refreshAriaFiltered(){let e=null;this.column.isFilterActive()&&(e=this.getLocaleTextFunc()("ariaColumnFiltered","Column Filtered")),this.setAriaDescriptionProperty("filter",e)}refreshAriaCellSelection(){var n;let e=null;const{gos:t,column:r,beans:s}=this;if(qn(t)){const o=this.getLocaleTextFunc(),a=(n=s.rangeSvc)==null?void 0:n.isColumnInAnyRange(r);e=o("ariaColumnCellSelection",`Press CTRL+SPACE to ${a?"de":""}select all visible cells in this column`)}this.setAriaDescriptionProperty("cellSelection",e)}setAriaDescriptionProperty(e,t){const r=this.ariaDescriptionProperties;t!=null?r.set(e,t):r.delete(e)}announceAriaDescription(){var i;const{beans:e,eGui:t,ariaDescriptionProperties:r}=this;if(!t.contains(pt(e)))return;const s=Array.from(r.keys()).sort((n,o)=>n==="filter"?-1:o.charCodeAt(0)-n.charCodeAt(0)).map(n=>r.get(n)).join(". ");(i=e.ariaAnnounce)==null||i.announceValue(s,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered(),this.refreshAriaCellSelection()}addColumnHoverListener(e){var t;(t=this.beans.colHover)==null||t.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=i=>this.handleMouseOverChange(i.type==="mouseenter"),r=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},s=i=>this.handleContextMenuMouseEvent(i,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:r,contextmenu:s})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return c0(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function c0(e){return typeof(e==null?void 0:e.getAnchorElementForMenu)=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var wA=0,xd=class extends ee{constructor(e,t,r){super(),this.rowIndex=e,this.pinned=t,this.type=r,this.instanceId=wA++,this.comp=null,this.allCtrls=[];let s="ag-header-row-column";r==="group"?s="ag-header-row-group":r==="filter"&&(s="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${s}`}setRowIndex(e){var t;this.rowIndex=e,(t=this.comp)==null||t.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=qt(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,r=!0){this.comp=e,t=Ka(this,this.beans.context,t),r&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),r=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:r,virtualColumnsChanged:s=>this.onVirtualColumnsChanged(s.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,stylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",r),e.addManagedPropertyListener("ensureDomOrder",s=>this.isEnsureDomOrder=s.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=qt(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0;const t=Kf(this.beans);for(let i=0;i<t.length;i++){if(i===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[i]};e+=t[i]}const r=qf(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:r};e+=r;const s=Xw(this.beans);return{topOffset:e,rowHeight:s}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;const t=this.getUpdatedHeaderCtrls(),r=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,r,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const s of t)this.recycleAndCreateHeaderCtrls(s,this.ctrlsById,e);const r=s=>{const{focusSvc:i,visibleCols:n}=this.beans;return i.isHeaderWrapperFocused(s)?n.isVisible(s.column):!1};if(e)for(const[s,i]of e)r(i)?this.ctrlsById.set(s,i):this.destroyBean(i);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,r){if(e.isEmptyGroup())return;const s=e.getUniqueId();let i;if(r&&(i=r.get(s),r.delete(s)),i&&i.column!=e&&(this.destroyBean(i),i=void 0),i==null)switch(this.type){case"filter":{i=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":i=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:i=this.createBean(new CA(e,this));break}t.set(s,i)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];const e=[];for(const t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){const r=this.allCtrls.find(i=>i.column==e);return r?r.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},xA=class extends ee{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:r,ctrlsSvc:s,colModel:i,colMoves:n}=this.beans;this.setupCenterWidth(),r==null||r.setupHeaderPinnedWidth(this),this.setupDragAndDrop(n,this.eViewport);const o=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:o,advancedFilterEnabledChanged:o});const a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;s.register(a,this),i.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const{focusSvc:t,filterManager:r,visibleCols:s}=this.beans;let i=0;const n=t.getFocusHeaderToUseAfterRefresh(),o=()=>{const d=s.headerGroupRowCount;i=d,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));const h=this.groupsRowCtrls.length;if(h!==d){if(h>d){for(let f=d;f<h;f++)this.destroyBean(this.groupsRowCtrls[f]);this.groupsRowCtrls.length=d;return}for(let f=h;f<d;f++){const p=this.createBean(new xd(f,this.pinned,"group"));this.groupsRowCtrls.push(p)}}},a=()=>{const d=i++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new xd(d,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==d&&this.columnsRowCtrl.setRowIndex(d)},l=()=>{this.includeFloatingFilter=!!(r!=null&&r.hasFloatingFilters())&&!this.hidden;const d=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){d();return}e||d();const h=i++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==h&&this.filtersRowCtrl.setRowIndex(h):this.filtersRowCtrl=this.createBean(new xd(h,this.pinned,"filter"))},c=this.getAllCtrls();o(),a(),l();const u=this.getAllCtrls();this.comp.setCtrls(u),this.restoreFocusOnHeader(t,n),c.length!==u.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){const t=r=>r==null?void 0:r.getHeaderCellCtrls().find(s=>s.column===e);if(xi(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let r=0;r<this.groupsRowCtrls.length;r++){const s=t(this.groupsRowCtrls[r]);if(s)return s}}getHtmlElementForColumnHeader(e){var t;return((t=this.getHeaderCtrlForColumn(e))==null?void 0:t.eGui)??null}getRowType(e){var t;return(t=this.getAllCtrls()[e])==null?void 0:t.type}focusHeader(e,t,r){const i=this.getAllCtrls()[e];return i?i.focusHeader(t,r):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const r=e==null?void 0:e.createBodyDropTarget(this.pinned,t);r&&this.createManagedBean(r)}restoreFocusOnHeader(e,t){if(!t)return;const{column:r}=t;r.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new Uf(e=>this.comp.setCenterWidth(`${e}px`),!0))}},yA=class extends ee{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){const{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(d0(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,r){var s;(s=this.activeMenuFactory)==null||s.showMenuAfterContextMenuEvent(e,t,r)}hidePopupMenu(){var e,t;(e=this.beans.contextMenuSvc)==null||e.hideActiveMenu(),(t=this.activeMenuFactory)==null||t.hideActiveMenu()}hideFilterMenu(){var e;(e=d0(this.beans))==null||e.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){var r;const{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!((r=this.activeMenuFactory)!=null&&r.isMenuEnabled(e))&&(Tr(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){var t;return!e.getColDef().suppressHeaderFilterButton&&!!((t=this.beans.filterManager)!=null&&t.isFilterAllowed(e))}isHeaderContextMenuEnabled(e){const t=e&&xi(e)?e.getColDef():e==null?void 0:e.getColGroupDef();return!(t!=null&&t.suppressHeaderContextMenu)&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Xi()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!Tr(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){var t;return!!((t=this.beans.filterManager)!=null&&t.isFilterAllowed(e))&&!Tr(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos,t=e.get("suppressMenuHide");return Tr(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,r,s){const{positionBy:i,onClosedCallback:n}=t,o=t.column;if(i==="button"){const{buttonElement:a}=t;e==null||e.showMenuAfterButtonClick(o,a,r,n,s)}else if(i==="mouse"){const{mouseEvent:a}=t;e==null||e.showMenuAfterMouseEvent(o,a,r,n,s)}else if(o){const a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(o,"auto"),ti(a,()=>{var u;const c=(u=l.getHeaderRowContainerCtrl(o.getPinned()))==null?void 0:u.getHeaderCtrlForColumn(o);c&&(e==null||e.showMenuAfterButtonClick(o,c.getAnchorElementForMenu(s),r,n,s))})}}};function u0(e,t,r){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",r))}function d0(e){const{enterpriseMenuFactory:t,filterMenuFactory:r,gos:s}=e;return t&&Tr(s)?t:r}var Ru=class extends Af{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},Eu=class extends Rt{constructor(){super()}};function SA(e,t,r){const s=vr(e,t,r);if(s){const{className:n}=s;if(typeof n=="string"&&n.includes("ag-icon")||typeof n=="object"&&n["ag-icon"])return s}const i=jr({tag:"span"});return i.appendChild(s),i}function vr(e,t,r){var n;let s=null;e==="smallDown"?oe(262):e==="smallLeft"?oe(263):e==="smallRight"&&oe(264);const i=r==null?void 0:r.getColDef().icons;if(i&&(s=i[e]),t.gos&&!s){const o=t.gos.get("icons");o&&(s=o[e])}if(s){let o;if(typeof s=="function")o=s();else if(typeof s=="string")o=s;else{oe(38,{iconName:e});return}if(typeof o=="string")return wf(o);if(Sf(o))return o;oe(133,{iconName:e});return}else{const o=t.registry.getIcon(e);return o||(n=t.validation)==null||n.validateIcon(e),jr({tag:"span",cls:`ag-icon ag-icon-${o??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var bA={tag:"div",cls:"ag-overlay-loading-center",children:[{tag:"span",ref:"eLoadingIcon",cls:"ag-loading-icon"},{tag:"span",ref:"eLoadingText",cls:"ag-loading-text"}]},FA=class extends Eu{constructor(){super(...arguments),this.eLoadingIcon=be,this.eLoadingText=be}init(e){var i,n;const{beans:t,gos:r}=this,s=Vs((i=r.get("overlayLoadingTemplate"))==null?void 0:i.trim());if(this.setTemplate(s??bA),!s){const o=vr("overlayLoading",t,null);o&&this.eLoadingIcon.appendChild(o);const a=((n=e.loading)==null?void 0:n.overlayText)??this.getLocaleTextFunc()("loadingOoo","Loading...");this.eLoadingText.textContent=a,t.ariaAnnounce.announceValue(a,"overlay")}}},RA={tag:"div",cls:"ag-overlay-exporting-center",children:[{tag:"span",ref:"eExportingIcon",cls:"ag-loading-icon"},{tag:"span",ref:"eExportingText",cls:"ag-exporting-text"}]},EA=class extends Eu{constructor(){super(...arguments),this.eExportingIcon=be,this.eExportingText=be}init(e){var i;const{beans:t}=this;this.setTemplate(RA);const r=vr("overlayExporting",t,null);r&&this.eExportingIcon.appendChild(r);const s=((i=e.exporting)==null?void 0:i.overlayText)??this.getLocaleTextFunc()("exportingOoo","Exporting...");this.eExportingText.textContent=s,t.ariaAnnounce.announceValue(s,"overlay")}},TA={tag:"span",cls:"ag-overlay-no-rows-center"},kA=class extends Eu{init(e){var i,n;const{beans:t,gos:r}=this,s=Vs((i=r.get("overlayNoRowsTemplate"))==null?void 0:i.trim());if(this.setTemplate(s??TA),!s){const o=((n=e.noRows)==null?void 0:n.overlayText)??this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=o,t.ariaAnnounce.announceValue(o,"overlay")}}},PA={tag:"span",cls:"ag-overlay-no-matching-rows-center"},DA=class extends Eu{init(e){var s;const{beans:t}=this;this.setTemplate(PA);const r=((s=e.noMatchingRows)==null?void 0:s.overlayText)??this.getLocaleTextFunc()("noMatchingRows","No Matching Rows");this.getGui().textContent=r,t.ariaAnnounce.announceValue(r,"overlay")}},AA=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",IA={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},MA=class extends Rt{constructor(){super(),this.dragSource=null,this.eIcon=be,this.eLabel=be,this.eGhost=be,this.registerCSS(AA)}postConstruct(){const e=t=>SA(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(IA),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eGhost:r,eIcon:s,dragSource:i,dropIconMap:n,gos:o}=this;wr(s);let a=null;e||(e=i!=null&&i.getDefaultIconName?i.getDefaultIconName():"notAllowed"),a=n[e],r.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),s.classList.toggle("ag-shake-left-to-right",t),!(a===n.hide&&o.get("suppressDragLeaveHidesColumns"))&&a&&s.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},_A=".ag-checkbox-cell{height:100%}",LA={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},OA=class extends Rt{constructor(){super(LA,[_f]),this.eCheckbox=be,this.registerCSS(_A)}init(e){this.refresh(e);const{eCheckbox:t,beans:r}=this,s=t.getInputElement();s.setAttribute("tabindex","-1"),hC(s,"polite"),this.addManagedListeners(s,{click:i=>{if(cn(i),t.isDisabled())return;const n=t.getValue();this.onCheckboxChanged(n)},dblclick:i=>{cn(i)}}),this.addManagedElementListeners(e.eGridCell,{keydown:i=>{if(i.key===K.SPACE&&!t.isDisabled()){e.eGridCell===pt(r)&&t.toggle();const n=t.getValue();this.onCheckboxChanged(n),i.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,r=!0;const{value:s,column:i,node:n}=e;if(n.group&&i)if(typeof s=="boolean")t=s;else{const d=i.getColId();d.startsWith(xu)?t=s==null||s===""?void 0:s==="true":n.aggData&&n.aggData[d]!==void 0||n.sourceRowIndex>=0?t=s??void 0:r=!1}else t=s??void 0;const{eCheckbox:o}=this;if(!r){o.setDisplayed(!1);return}o.setValue(t);const a=e.disabled??!(i!=null&&i.isCellEditable(n));o.setDisabled(a);const l=this.getLocaleTextFunc(),c=vu(l,t),u=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;o.setInputAriaLabel(u)}onCheckboxChanged(e){const{params:t}=this,{column:r,node:s,value:i}=t,{editSvc:n}=this.beans;if(!r)return;const o={rowNode:s,column:r};n==null||n.dispatchCellEvent(o,null,"cellEditingStarted",{value:i});const a=s.setDataValue(r,e,"ui");n==null||n.dispatchCellEvent(o,null,"cellEditingStopped",{oldValue:i,newValue:e,valueChanged:a}),a||this.updateCheckbox(t)}},h0=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){const{all:t,visible:r,order:s}=this;t.has(e)||(t.add(e),r.add(e),s.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),Es(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(const t of this.visible)if(t.id==e)return t}clear(){const{all:e,visible:t,order:r,queued:s}=this;e.clear(),s.clear(),t.clear(),r.length=0}sort(){const{sortSvc:e,rowNodeSorter:t,gos:r}=this.beans,s=(e==null?void 0:e.getSortOptions())??[],i=HA(this.order);if(this.order.sort((o,a)=>{var l,c;return(((l=o.pinnedSibling)==null?void 0:l.rowIndex)??0)-(((c=a.pinnedSibling)==null?void 0:c.rowIndex)??0)}),this.order=(t==null?void 0:t.doFullSort(this.order,s))??this.order,!i)return;const n=VC(r);n==="bottom"||n==="pinnedBottom"?this.order.push(i):this.order.unshift(i)}hide(e){const{all:t,visible:r}=this,s=r.size;return t.forEach(i=>e(i)?r.delete(i):r.add(i)),this.order=Array.from(r),this.sort(),s!=r.size}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function Zw(e){var r;if(e.level===-1)return!0;const t=e.parent;return(r=t==null?void 0:t.childrenAfterSort)!=null&&r.some(s=>s==e)?Zw(t):!1}function yd(e,t){const{gos:r,rowModel:s,filterManager:i}=e;return bo(r)?!s.getRowNode(t.id):i!=null&&i.isAnyFilterPresent()?!Zw(t):r.get("pivotMode")?!t.group:!1}function NA(e){return!!e.footer&&e.level===-1}function BA(e){return!!e.pinnedSibling&&NA(e.pinnedSibling)}function HA(e){var r;const t=e.findIndex(BA);if(t>-1)return(r=e.splice(t,1))==null?void 0:r[0]}var f0=class extends ee{postConstruct(){const{gos:e,beans:t}=this;this.top=new h0(t,"top"),this.bottom=new h0(t,"bottom");const r=i=>yd(t,i.pinnedSibling),s=()=>{const i=e.get("isRowPinned");i&&e.get("enableRowPinning")&&t.rowModel.forEachNode(n=>this.pinRow(n,i(n)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({stylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:i})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow();let n=!1;this.forContainers(a=>{n||(n=a.hide(r))});const o=this.refreshRowPositions();(!i||o||n)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(GA),this.refreshRowPositions()},rowNodeDataChanged:({node:i})=>{const n=e.get("isRowPinnable");((n==null?void 0:n(i))??!0)||this.pinRow(i,null)},firstDataRendered:s}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(i=>i.hide(r)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:i})=>{this._grandTotalPinned=i==="pinnedBottom"?"bottom":i==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",s)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{const r=[];t.forEach(s=>r.push(s)),r.forEach(s=>this.pinRow(s,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,r){var o;if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,zA(this.beans);return}const s=e.rowPinned??((o=e.pinnedSibling)==null?void 0:o.rowPinned);if(s!=null&&t!=null&&t!=s){const a=e.rowPinned?e:e.pinnedSibling,l=e.rowPinned?e.pinnedSibling:e;this.pinRow(a,null,r),this.pinRow(l,t,r);return}const n=r&&WA(this.beans,e,r);if(n){n.forEach(a=>this.pinRow(a,t));return}if(t==null){const a=e.rowPinned?e:e.pinnedSibling,l=this.findPinnedRowNode(a);if(!l)return;l.delete(a);const c=a.pinnedSibling;Sd(a),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(c)}else{const a=g0(this.beans,e,t),l=this.getContainer(t);l.add(a),yd(this.beans,e)&&l.hide(c=>yd(this.beans,c.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0;const r=s=>{if(s.rowHeightEstimated){const i=Ci(this.beans,s);s.setRowTop(t),s.setRowHeight(i.height),t+=i.height,e=!0}};return this.bottom.forEach(r),t=0,this.top.forEach(r),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return p0(this.top)}getPinnedBottomTotalHeight(){return p0(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){const e=t=>{const r=[];return this.forEachPinnedRow(t,s=>r.push(s.pinnedSibling.id)),r};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,r)=>{for(const s of e[r]){const i=this.beans.rowModel.getRowNode(s);i?this.pinRow(i,r):t.queue(s)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{const r=new Set;e.forEachQueued(s=>{const i=this.beans.rowModel.getRowNode(s);i&&r.add(i)});for(const s of r)e.unqueue(s.id),this.pinRow(s,t)})}pinGrandTotalRow(){var a;const{gos:e,beans:t,_grandTotalPinned:r}=this,s=t.rowModel;if(!wt(e))return;const i=(a=s.rootNode)==null?void 0:a.sibling;if(!i)return;const n=i.pinnedSibling,o=n&&this.findPinnedRowNode(n);if(r){if(o&&o.floating!==r&&(o.delete(n),Sd(n)),!o||o.floating!==r){const l=g0(t,i,r);this.getContainer(r).add(l)}}else{if(!o)return;o.delete(n),Sd(n)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(r=>r.setRowHeight(r.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){const t=s=>VA(this.beans,s);if(e)return t(this.getContainer(e));let r=!1;return this.forContainers(s=>{const i=t(s);r||(r=i)}),r}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e==null||e.dispatchRowEvent("rowPinned")}};function VA(e,t){let r=0,s=!1;return t.forEach((i,n)=>{if(s||(s=i.rowTop!==r),i.setRowTop(r),i.rowHeightEstimated||i.rowHeight==null){const o=Ci(e,i).height;s||(s=i.rowHeight!==o),i.setRowHeight(o)}i.setRowIndex(n),r+=i.rowHeight}),s}function g0(e,t,r){if(t.pinnedSibling)return t.pinnedSibling;const s=lD(t,e);s.setRowTop(null),s.setRowIndex(null),s.rowPinned=r;const i=r==="top"?Hf:Vf;return s.id=`${i}${r}-${t.id}`,s.pinnedSibling=t,t.pinnedSibling=s,s}function Sd(e){if(!e.pinnedSibling)return;e.rowPinned=null,e._destroy(!1);const t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function GA(e){const t=new Set;e.forEach(r=>{r.group&&t.add(r)}),t.forEach(r=>e.delete(r))}function WA(e,t,r){var n;const{rowSpanSvc:s}=e,i=(r&&(s==null?void 0:s.isCellSpanning(r,t)))??!1;if(r&&i)return(n=s==null?void 0:s.getCellSpan(r,t))==null?void 0:n.spannedNodes}function p0(e){const t=e.size();if(t===0)return 0;const r=e.getByIndex(t-1);return r===void 0?0:r.rowTop+r.rowHeight}function zA({gos:e,rowModel:t}){wt(e)&&t.refreshModel({step:"map"})}var m0=class extends ee{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){const e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({stylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){const t=r=>{r.setRowHeight(r.rowHeight,!0)};Oo(this.pinnedBottomRows,t),Oo(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0;const r=s=>{if(s.rowHeightEstimated){const i=Ci(this.beans,s);s.setRowTop(t),s.setRowHeight(i.height),t+=i.height,e=!0}};return Oo(this.pinnedBottomRows,r),t=0,Oo(this.pinnedTopRows,r),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){var u;const r=this.getCache(t);if(e===void 0){r.order.length=0,r.cache={};return}const s=co(this.gos),i=t==="top"?Hf:Vf,n=new Set(r.order),o=[],a=new Set;let l=0,c=-1;for(const d of e){const h=(s==null?void 0:s({data:d,level:0,rowPinned:t}))??i+this.nextId++;if(a.has(h)){oe(96,{id:h,data:d});continue}c++,a.add(h),o.push(h);const f=ea(r,h);if(f!==void 0)f.data!==d&&f.updateData(d),l+=this.setRowTopAndRowIndex(f,l,c),n.delete(h);else{const p=new yi(this.beans);p.id=h,p.data=d,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,c),r.cache[h]=p,r.order.push(h)}}for(const d of n)(u=ea(r,d))==null||u.clearRowTopAndRowIndex(),delete r.cache[d];r.order=o}setRowTopAndRowIndex(e,t,r){return e.setRowTop(t),e.setRowHeight(Ci(this.beans,e).height),e.setRowIndex(r),e.rowHeight}getPinnedTopTotalHeight(){return v0(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return v0(this.pinnedBottomRows)}getPinnedTopRowCount(){return kh(this.pinnedTopRows)}getPinnedBottomRowCount(){return kh(this.pinnedBottomRows)}getPinnedTopRow(e){return Th(this.pinnedTopRows,e)}getPinnedBottomRow(e){return Th(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return ea(this.getCache(t),e)}forEachPinnedRow(e,t){return Oo(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function v0(e){const t=kh(e);if(t===0)return 0;const r=Th(e,t-1);return r===void 0?0:r.rowTop+r.rowHeight}function ea(e,t){return e.cache[t]}function Th(e,t){return ea(e,e.order[t])}function Oo(e,t){e.order.forEach((r,s)=>{const i=ea(e,r);i&&t(i,s)})}function kh(e){return e.order.length}var UA=class extends ee{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){const{gos:e}=this,t=()=>{const r=e.get("enableRowPinning"),s=VC(e),n=!!r||(s==="pinnedBottom"||s==="pinnedTop"),o=n?this.inner instanceof m0:this.inner instanceof f0;this.inner&&o&&this.destroyBean(this.inner),(o||!this.inner)&&(this.inner=this.createManagedBean(n?new f0:new m0))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,r){return this.inner.pinRow(e,t,r)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}},Hc=e=>{let t=e.childrenAfterGroup;for(;t!=null&&t.length;){const r=t[0];if(r.sourceRowIndex>=0)return r;t=r.childrenAfterGroup}},jA=(e,t,r,s)=>{if(!t.size||!e)return!1;let i=!1;const n=e.length??0;let o=-1;r&&(o=r.sourceRowIndex,r=o<0?Hc(r):null,r&&(o=r.sourceRowIndex)),o<0||o>=n?o=n:s||++o;let a=o,l=Math.min(o,n-1);for(const d of t){const h=d.sourceRowIndex;h<a&&(a=h),h>l&&(l=h)}let c=a;for(let d=a;d<o;++d){const h=e[d];t.has(h)||(h.sourceRowIndex!==c&&(h.sourceRowIndex=c,e[c]=h,i=!0),++c)}let u=l;for(let d=l;d>=o;--d){const h=e[d];t.has(h)||(h.sourceRowIndex!==u&&(h.sourceRowIndex=u,e[u]=h,i=!0),--u)}for(const d of t)d.sourceRowIndex!==c&&(d.sourceRowIndex=c,e[c]=d,i=!0),++c;return i},ic=class{constructor(){this.reordered=!1,this.removals=[],this.updates=new Set,this.adds=new Set}};function Za(e){return!!(e.rowPinned&&e.pinnedSibling)}function Nr(e,t,r,s){const i=t==="top";if(!r)return Nr(e,t,i?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),s);if(!s){const l=i?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return Nr(e,t,r,i?e.getPinnedTopRow(l-1):e.getPinnedBottomRow(l-1))}let n=!1,o=!1;const a=[];return e.forEachPinnedRow(t,l=>{if(l===r&&!n){n=!0,a.push(l);return}if(n&&l===s){o=!0,a.push(l);return}n&&!o&&a.push(l)}),a}var $A={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},KA=class extends Rt{constructor(){super($A,[_f]),this.eCheckbox=be}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:r}=this,s=t.isSelected(),i=vu(e,s),[n,o]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(n,o);r.setValue(s,!0),r.setInputAriaLabel(`${a} (${i})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getWrapperElement(),{dblclick:cn,click:s=>{var i;cn(s),!this.eCheckbox.isDisabled()&&((i=this.beans.selectionSvc)==null||i.handleSelectionEvent(s,this.rowNode,"checkboxSelected"))}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:s,previousValue:i})=>{const n=typeof s=="object"?rd(s):void 0,o=typeof i=="object"?rd(i):void 0;n!==o&&this.onSelectableChanged()}),gh(this.gos)||typeof this.getIsVisible()=="function"){const s=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:s}),this.addManagedListeners(this.rowNode,{dataChanged:s,cellChanged:s}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){const{column:e,rowNode:t,overrides:r,gos:s}=this,i=t.selectable,n=this.getIsVisible();let o;if(typeof n=="function"){const d=r==null?void 0:r.callbackParams;if(!e)o=n({...d,node:t,data:t.data});else{const h=e.createColumnFunctionCallbackParams(t);o=n({...d,...h})}}else o=n??!1;const a=i&&!o||!i&&o,l=i||o,c=s.get("rowSelection"),u=c&&typeof c!="string"?!rd(c):!!(e!=null&&e.getColDef().showDisabledCheckboxes);this.setVisible(l&&(a?u:!0)),this.setDisplayed(l&&(a?u:!0)),l&&this.eCheckbox.setDisabled(a),r!=null&&r.removeHidden&&this.setDisplayed(l)}getIsVisible(){var r,s;const e=this.overrides;if(e)return e.isVisible;const t=this.gos.get("rowSelection");return t&&typeof t!="string"?Kn(t):(s=(r=this.column)==null?void 0:r.getColDef())==null?void 0:s.checkboxSelection}},qA=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){const e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t;const{rowModel:r,pinnedRowModel:s}=this;return t??(t=r.getRowNode(e)),s!=null&&s.isManual()&&(t??(t=s.getPinnedRowById(e,"top")),t??(t=s.getPinnedRowById(e,"bottom"))),t}truncate(e){const t=this.getRange();if(t.length===0)return{keep:[],discard:[]};const r=t[0].id===this.rootId,s=t.findIndex(i=>i.id===e.id);if(s>-1){const i=t.slice(0,s),n=t.slice(s+1);return this.setEndRange(e),r?{keep:i,discard:n}:{keep:n,discard:i}}else return{keep:t,discard:[]}}extend(e,t=!1){const r=this.getRoot();if(r==null){const i=this.getRange().slice();return t&&e.depthFirstSearch(n=>!n.group&&i.push(n)),i.push(e),this.setRoot(e),{keep:i,discard:[]}}const s=this.getNodesInRange(r,e);if(!s)return this.setRoot(e),{keep:[e],discard:[]};if(s.find(i=>i.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const i=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:i}}}getNodesInRange(e,t){const{pinnedRowModel:r,rowModel:s}=this;if(!(r!=null&&r.isManual()))return s.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return Nr(r,"top",e,void 0).concat(s.getNodesInRangeForSelection(s.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){const i=Nr(r,"bottom",void 0,e),n=s.getRowCount(),o=s.getRow(n-1);return(s.getNodesInRangeForSelection(t,o)??[]).concat(i)}if(!e.rowPinned&&!t.rowPinned)return s.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return Nr(r,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){const i=Nr(r,"top",t,void 0),n=Nr(r,"bottom",void 0,e),o=s.getRow(0),a=s.getRow(s.getRowCount()-1);return i.concat(s.getNodesInRangeForSelection(o,a)??[]).concat(n)}if(!e.rowPinned&&t.rowPinned==="top")return Nr(r,"top",t,void 0).concat(s.getNodesInRangeForSelection(s.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){const i=Nr(r,"top",e,void 0),n=Nr(r,"bottom",void 0,t),o=s.getRow(0),a=s.getRow(s.getRowCount()-1);return i.concat(s.getNodesInRangeForSelection(o,a)??[]).concat(n)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return Nr(r,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){const i=Nr(r,"bottom",void 0,t),n=s.getRow(s.getRowCount());return(s.getNodesInRangeForSelection(e,n)??[]).concat(i)}return null}},XA=class extends ee{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(pt(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;const t=this.createManagedBean(new Mf);this.cbSelectAll=t,t.addCss("ag-header-select-all"),nn(t.getGui(),"presentation"),this.showOrHideSelectAll();const r=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:r,paginationChanged:r,modelUpdated:r}),this.addManagedPropertyListener("rowSelection",({currentValue:s,previousValue:i})=>{const n=o=>typeof o=="string"||!o||o.mode==="singleRow"?void 0:o.selectAll;n(s)!==n(i)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){const t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.getSelectAllMode(),t=this.beans.selectionSvc,r=this.cbSelectAll,s=t.getSelectAllState(e);r.setValue(s);const i=t.hasNodesToSelect(e);r.setDisabled(!i),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){const t=this.getLocaleTextFunc(),{headerCellCtrl:r,cbSelectAll:s,cbSelectAllVisible:i}=this,n=s.getValue(),o=vu(t,n),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");r.setAriaDescriptionProperty("selectAll",i?`${a} (${o})`:null),s.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||r.announceAriaDescription()}checkSelectionType(e){return kc(this.gos)?!0:(oe(128,{feature:e}),!1)}checkRightRowModelType(e){const{gos:t,rowModel:r}=this.beans;return wt(t)||bo(t)?!0:(oe(129,{feature:e,rowModel:r.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.getSelectAllMode();let r="uiSelectAll";t==="currentPage"?r="uiSelectAllCurrentPage":t==="filtered"&&(r="uiSelectAllFiltered");const s={source:r,selectAll:t},i=this.beans.selectionSvc;e?i.selectAllRowNodes(s):i.deselectAllRowNodes(s)}isCheckboxSelection(){const{column:e,gos:t,beans:r}=this,n=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return Qw(r,e)&&this.checkRightRowModelType(n)&&this.checkSelectionType(n)}getSelectAllMode(){const e=UC(this.gos,!1);if(e)return e;const{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:r}=this.column.getColDef();return t?"currentPage":r?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function Qw({gos:e,selectionColSvc:t},r){const s=e.get("rowSelection"),i=r.getColDef(),{headerCheckboxSelection:n}=i;let o=!1;if(typeof s=="object"){const l=Ti(r),c=Pf(r);(Ec(s)==="autoGroupColumn"&&c||l&&(t!=null&&t.isSelectionColumnEnabled()))&&(o=Yl(s))}else typeof n=="function"?o=n(ke(e,{column:r,colDef:i})):o=!!n;return o}var YA=class extends ee{postConstruct(){const{gos:e,beans:t}=this;this.selectionCtx=new qA(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{const r=gh(e);r!==this.isRowSelectable&&(this.isRowSelectable=r,this.updateSelectable())}),this.isRowSelectable=gh(e),this.addManagedEventListeners({cellValueChanged:r=>this.updateRowSelectable(r.node),rowNodeDataChanged:r=>this.updateRowSelectable(r.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new KA}createSelectAllFeature(e){if(Qw(this.beans,e))return new XA(e)}isMultiSelect(){return kc(this.gos)}onRowCtrlSelected(e,t,r){const s=!!e.rowNode.isSelected();e.forEachGui(r,i=>{i.rowComp.toggleCss("ag-row-selected",s);const n=i.element;mC(n,s),n.contains(pt(this.beans))&&t(i)})}announceAriaRowSelection(e){var n,o;if(this.isRowSelectionBlocked(e))return;const t=e.isSelected(),r=(n=this.beans.editSvc)==null?void 0:n.isEditing({rowNode:e});if(!e.selectable||r)return;const i=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);(o=this.beans.ariaAnnounce)==null||o.announceValue(i,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!Za(e)||!Ki(this.gos)}updateRowSelectable(e,t){var s;const r=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:((s=this.isRowSelectable)==null?void 0:s.call(this,e))??!0;return this.setRowSelectable(e,r,t),r}setRowSelectable(e,t,r){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),r)return;if(Sa(this.gos)){const i=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:i??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){var s;let t=!1,r=!1;if(!((s=e.childrenAfterGroup)!=null&&s.length))return e.selectable?e.__selected:null;for(let i=0;i<e.childrenAfterGroup.length;i++){const n=e.childrenAfterGroup[i];let o=n.isSelected();if(!n.selectable){const a=this.calculateSelectedFromChildren(n);if(a===null)continue;o=a}switch(o){case!0:t=!0;break;case!1:r=!0;break;default:return}}if(!(t&&r))return t?!0:r?!1:e.selectable?e.__selected:null}selectRowNode(e,t,r,s="api"){if(t&&e.destroyed)return!1;const i=!e.selectable&&t,n=e.__selected===t;if(i||n)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");const o=e.sibling;o&&o.footer&&o.__localEventService&&o.dispatchRowEvent("rowSelected");const a=e.pinnedSibling;return a!=null&&a.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent({...oD(e,this.gos,"rowSelected"),event:r||null,source:s}),!0}isCellCheckboxSelection(e,t){const r=this.gos.get("rowSelection");if(r&&typeof r!="string"){const s=Ti(e)&&Kn(r);return e.isColumnFunc(t,s)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,r,s){const{gos:i,selectionCtx:n}=this,o=e.isSelected(),a=Sa(i),l=p2(i),c=m2(i),u=this.isMultiSelect(),d=s==="rowClicked";if(d&&!(l||c))return null;if(t&&r&&u){const h=n.getRoot();if(h)if(h.isSelected()){const f=n.isInRange(e)?n.truncate(e):n.extend(e,a);return{deselect:f.discard,select:f.keep,reset:!1}}else{const f=n.extend(e,a);return{select:[],deselect:f.keep,reset:!1}}else return null}else if(t&&u){const h=n.selectAll?this.beans.rowModel.getRow(0):void 0,f=n.getRoot(h),p=n.isInRange(e)?n.truncate(e):n.extend(e,a);return{select:p.keep,deselect:p.discard,reset:n.selectAll||!!(f&&!f.isSelected())}}else if(r){if(d){const h=!o;return h&&!l||!h&&!c?null:(n.setRoot(e),{node:e,newValue:h,clearSelection:!1})}return n.setRoot(e),{node:e,newValue:!o,clearSelection:!u}}else{n.setRoot(e);const h=v2(i),f=Pc(i)==="filteredDescendants",p=d&&(!h||!l);if(f&&o===void 0&&wt(i))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!u||p};if(d){const g=o?!h:l;return g===o&&!p||g&&!l||!g&&!c?null:{node:e,newValue:g,clearSelection:!u||p,keepDescendants:e.group&&a}}return{node:e,newValue:!o,clearSelection:!u||p}}}},JA=class extends sD{initialiseTabGuard(t){super.initialiseTabGuard(t,Wf)}},ZA=class extends mw{constructor(e){super(e,Wf)}},QA=500,eI=550,Fl,tI=e=>{if(!Fl)Fl=new WeakSet;else if(Fl.has(e))return!1;return Fl.add(e),!0},Hi=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let r=this.eventSvc;if(!r){if(r===null)return;this.eventSvc=r=new sn;const s=this.onTouchStart.bind(this);this.startListener=s,this.eElement.addEventListener("touchstart",s,{passive:!0})}r.addEventListener(e,t)}removeEventListener(e,t){var r;(r=this.eventSvc)==null||r.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!tI(e))return;const t=e.touches[0];this.touchStart=t;const r=this.handlers;if(!r.length){const s=this.eElement,i=s.ownerDocument,n=this.onTouchMove.bind(this),o=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},c={passive:!1};$l(r,[s,"touchmove",n,l],[i,"touchcancel",a,l],[i,"touchend",o,c],[i,"contextmenu",Nn,c])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{var s;this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,(s=this.eventSvc)==null||s.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},eI)}onTouchMove(e){const{moved:t,touchStart:r}=this;if(!t&&r){const s=zn(r,e.touches);s&&!bC(s,r,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){var r;const t=this.touchStart;!t||!zn(t,e.changedTouches)||(this.moved||((r=this.eventSvc)==null||r.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&Nn(e),this.cancel())}onTouchCancel(e){const t=this.touchStart;!t||!zn(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){var s;let t=Date.now();const r=this.lastTapTime;r&&t-r>QA&&((s=this.eventSvc)==null||s.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),bf(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){const e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}},ex=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${kC}/${this.frameworkName}-data-grid`,s2(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function rI(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var sI=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],C0=Object.fromEntries(sI.map((e,t)=>[e,t]));function iI(e,t){const r=(e.beanName?C0[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,s=(t.beanName?C0[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return r-s}function nI(e,t){return(e==null?void 0:e.beanName)==="gridDestroySvc"?-1:(t==null?void 0:t.beanName)==="gridDestroySvc"?1:0}var oI=class extends ee{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,r){this.view=e,this.eGridHostDiv=t,this.eGui=r,this.eGui.setAttribute("grid-id",this.beans.context.getId());const{dragAndDrop:s,ctrlsSvc:i}=this.beans;s==null||s.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new zf(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const n=ei(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>n()),i.register("gridCtrl",this)}isDetailGrid(){var t;const e=gw(this.getGui());return((t=e==null?void 0:e.getAttribute("row-id"))==null?void 0:t.startsWith("detail"))||!1}getOptionalSelectors(){var t,r,s,i,n;const e=this.beans;return{paginationSelector:(t=e.pagination)==null?void 0:t.getPaginationSelector(),gridHeaderDropZonesSelector:(r=e.registry)==null?void 0:r.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:(s=e.sideBar)==null?void 0:s.getSelector(),statusBarSelector:(i=e.registry)==null?void 0:i.getSelector("AG-STATUS-BAR"),watermarkSelector:(n=e.licenseManager)==null?void 0:n.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){const{view:t}=this;if(e===!1)t.setCursor(null);else{const r=e===1?"ew-resize":"ns-resize";t.setCursor(r)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:r,nextIndex:s}=this.getNextFocusableIndex(t,e);if(s<0||s>=t.length)return!1;if(s===0){if(r>0){const{visibleCols:i,focusSvc:n}=this.beans,o=i.allCols,a=nt(o);if(n.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[s],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t!=null&&t({fromBottom:!!e}))return!0;const r=this.getFocusableContainers(),{focusSvc:s,visibleCols:i}=this.beans,n=i.allCols;if(e){if(r.length>1)return this.focusContainer(nt(r),e);const o=nt(n);if(s.focusGridView({column:o,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||Yi(this.beans)){if(s.focusGridView({column:n[0],backwards:e}))return!0;for(let o=1;o<r.length;o++)if(ln(r[o].getGui(),e))return!0;return!1}return s.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:r}=this.getNextFocusableIndex(t,e),s=t[r];s?this.focusContainer(s):this.forceFocusOutOfContainer(e)}isFocusable(){var t,r;const e=this.beans;return!Fu(e)||!Yi(e)||!!((r=(t=e.sideBar)==null?void 0:t.comp)!=null&&r.isDisplayed())}getNextFocusableIndex(e,t){const r=pt(this.beans),s=e.findIndex(n=>n.getGui().contains(r)),i=s+(t?-1:1);return{indexWithFocus:s,nextIndex:i}}focusContainer(e,t){var s,i;(s=e.setAllowFocus)==null||s.call(e,!0);const r=ln(e.getGui(),t,!1,!0);return(i=e.setAllowFocus)==null||i.call(e,!1),r}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},Pe=(e,t)=>{for(const r of Object.keys(t))t[r]=e;return t},w0={dispatchEvent:"CommunityCore",...Pe("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0}),...Pe("GridState",{getState:0,setState:0}),...Pe("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...Pe("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...Pe("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...Pe("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...Pe("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...Pe("ValueCache",{expireValueCache:0}),...Pe("CellApi",{getCellValue:0}),...Pe("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...Pe("Sort",{onSortChanged:0}),...Pe("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0}),...Pe("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...Pe("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...Pe("HighlightChanges",{flashCells:0}),...Pe("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0}),...Pe("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...Pe("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...Pe("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...Pe("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...Pe("ColumnResize",{setColumnWidths:0}),...Pe("ColumnHover",{isColumnHovered:0}),...Pe("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0}),...Pe("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0}),...Pe("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...Pe("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...Pe("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0}),...Pe("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...Pe("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...Pe("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...Pe("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0}),...Pe("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...Pe("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0}),...Pe("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...Pe("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...Pe("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...Pe("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...Pe("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...Pe("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...Pe("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...Pe("ContextMenu",{showContextMenu:0}),...Pe("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...Pe("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...Pe("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...Pe("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...Pe("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...Pe("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0}),...Pe("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...Pe("StatusBar",{getStatusPanel:0}),...Pe("AiToolkit",{getStructuredSchema:0})},bd={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},aI=(e,t)=>e.eventSvc.dispatchEvent(t),tx=class{};Reflect.defineProperty(tx,"name",{value:"GridApi"});var lI=class extends ee{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new tx,this.fns={...bd,dispatchEvent:aI},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(w0))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){var i;const{fns:r,beans:s}=this;r!==bd&&(r[e]=((i=s==null?void 0:s.validation)==null?void 0:i.validateApiFunction(e,t))??t)}makeApi(e){return{[e]:(...t)=>{const{beans:r,fns:{[e]:s}}=this;return s?s(r,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:r,preDestroyLink:s}=this;if(!t)oe(26,{fnName:e,preDestroyLink:s});else{const i=w0[e];r.assertModuleRegistered(i,`api.${e}`)&&oe(27,{fnName:e,module:i})}}destroy(){super.destroy(),this.fns=bd,this.beans=null}};function cI(e){return e.context.getId()}function uI(e){e.gridDestroySvc.destroy()}function dI(e){return e.gridDestroySvc.destroyCalled}function hI(e,t){return e.gos.get(t)}function fI(e,t,r){rx(e,{[t]:r})}function rx(e,t){e.gos.updateGridOptions({options:t})}function gI(e,t){const r=t.replace(/Module$/,"");return e.gos.isModuleRegistered(r)}var pI={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},mI=class extends Rt{constructor(e,t,r){super(pI),this.rowNode=e,this.column=t,this.eCell=r}postConstruct(){this.getGui().appendChild(vr("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const{rowNode:t,column:r,eCell:s,gos:i}=this,n=r.getColDef().dndSourceOnRowDrag,o=e.dataTransfer;if(o.setDragImage(s,0,0),n){const a=ke(i,{rowNode:t,dragEvent:e});n(a)}else try{const a=JSON.stringify(t.data);o.setData("application/json",a),o.setData("text/plain",a)}catch{}}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function vI(e,t){var r,s;(s=(r=e.rowDragSvc)==null?void 0:r.rowDragFeature)==null||s.addRowDropZone(t)}function CI(e,t){var s,i;const r=(s=e.dragAndDrop)==null?void 0:s.findExternalZone(t.getContainer());r&&((i=e.dragAndDrop)==null||i.removeDropTarget(r))}function wI(e,t){var r,s;return(s=(r=e.rowDragSvc)==null?void 0:r.rowDragFeature)==null?void 0:s.getRowDropZone(t)}function xI(e){const t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function yI(e,t){const r=e.rowDropHighlightSvc;if(!r)return;const s=t==null?void 0:t.row;let i=t==null?void 0:t.dropIndicatorPosition;i!=="above"&&i!=="below"&&i!=="inside"&&(i="none");const n=s==null?void 0:s.rowIndex;n==null||i==="none"?r.clear():r.set(s,i)}var SI=class extends eD{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},bI=class extends ee{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:r}=this.beans;return r.addDragSource(t),()=>r.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const r=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(r)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},FI={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},Rl={skipAriaHidden:!0},RI=class extends Rt{constructor(e,t,r,s,i,n=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=r,this.customGui=s,this.dragStartPixels=i,this.alwaysVisible=n,this.dragSource=null,this.disabled=!1}isCustomGui(){return this.customGui!=null}postConstruct(){const{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(FI),this.getGui().appendChild(vr("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){const{beans:e,rowNode:t}=this,r=this.refreshVisibility.bind(this);this.addManagedListeners(e.eventSvc,{rowDragVisibilityChanged:r}),this.addManagedListeners(t,{dataChanged:r,cellChanged:r}),this.refreshVisibility()}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;const{beans:e,column:t,rowNode:r}=this,{gos:s,dragAndDrop:i,rowDragSvc:n}=e,o=n==null?void 0:n.visibility;let l=!(o==="suppress"||o==="hidden"&&!(i!=null&&i.hasExternalDropZones())),c=l;if(l&&!this.isCustomGui()&&t){const u=t.getColDef().rowDrag;if(u===!1)l=!1;else{const d=typeof u=="function";c=t.isRowDrag(r),l=d||c}}l&&c&&r.footer&&s.get("rowDragManaged")&&(c=!1,l=!0),c&&(c=l),l||this.setDisplayed(l,Rl),c||this.setVisible(c,Rl),this.setDisabled(!c||o==="disabled"&&!(i!=null&&i.hasExternalDropZones())),l&&this.setDisplayed(l,Rl),c&&this.setVisible(c,Rl)}setDisabled(e){var t,r;e!==this.disabled&&(this.disabled=e,(r=(t=this.getGui())==null?void 0:t.classList)==null||r.toggle("ag-drag-handle-disabled",e))}getSelectedNodes(){var s;const e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];const r=((s=this.beans.selectionSvc)==null?void 0:s.getSelectedNodes())??[];return r.indexOf(e)!==-1?r:[e]}getDragItem(){const{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:s=>{s==null||s.preventDefault()}})[0]);const r=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:s=>this.getDragItemName(s,r),getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}getDragItemName(e,t){var o,a,l,c;const r=(e==null?void 0:e.dragItem)||this.getDragItem(),s=(((o=e==null?void 0:e.dropTarget)==null?void 0:o.rows.length)??((a=r.rowNodes)==null?void 0:a.length))||1,i=((c=(l=this.column)==null?void 0:l.getColDef())==null?void 0:c.rowDragText)??this.gos.get("rowDragText");if(i)return i(r,s);if(s!==1)return`${s} ${t("rowDragRows","rows")}`;const n=this.cellValueFn();return n||`1 ${t("rowDragRow","rows")}`}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},Ea=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:r,children:s}=e;if(s)for(let i=0;i<s.length;++i)this.depthFirstSearchChangedPath(s[i],t);t(r)}depthFirstSearchEverything(e,t,r){const s=e.childrenAfterGroup;if(s)for(let i=0,n=s.length;i<n;++i){const o=s[i];o.childrenAfterGroup?this.depthFirstSearchEverything(o,t,r):r&&t(o)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,r=!1){this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,r=0;for(;!this.mapToItems[t.id];){const s={rowNode:t,children:null};this.mapToItems[t.id]=s,r++,t=t.parent}return r}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let r=e;for(;r;){this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={});for(const s of t)this.nodeIdsToColumns[r.id][s.getId()]=!0;r=r.parent}}linkPathItems(e,t){let r=e;for(let s=0;s<t;s++){const i=this.mapToItems[r.id],n=this.mapToItems[r.parent.id];n.children||(n.children=[]),n.children.push(i),r=r.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const r=this.createPathItems(e);this.linkPathItems(e,r),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const r=this.nodeIdsToColumns[e.id];return t.filter(i=>r[i.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const r=this.nodeIdsToColumns[e.id];return t.filter(i=>!r[i.getId()])}},EI=.25,TI=class extends ee{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.autoScroll=null,this.autoScrollChanged=!1,this.autoScrollChanging=!1,this.autoScrollOldV=null}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,t=>{const r=()=>t.gridBodyCtrl.scrollFeature.getVScrollPosition().top,s=new zk({scrollContainer:t.gridBodyCtrl.eBodyViewport,scrollAxis:"y",getVerticalPosition:r,setVerticalPosition:i=>t.gridBodyCtrl.scrollFeature.setVerticalScrollPosition(i),onScrollCallback:()=>{var o;const i=r();if(this.autoScrollOldV!==i){this.autoScrollOldV=i,this.autoScrollChanging=!0;return}const n=this.autoScrollChanging;this.autoScrollChanged=n,this.autoScrollChanging=!1,n&&((o=e.dragAndDrop)==null||o.nudge(),this.autoScrollChanged=!1)}});this.autoScroll=s,this.clearAutoScroll()})}destroy(){super.destroy(),this.clearAutoScroll(),this.autoScroll=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){var t;return((t=e==null?void 0:e.dropTarget)==null?void 0:t.allowed)===!1||this.beans.rowDragSvc.visibility!=="visible"?"notAllowed":"move"}getRowNodes(e){var r;if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const s=(r=this.beans.selectionSvc)==null?void 0:r.getSelectedNodes();if(s&&s.indexOf(t)>=0)return s.slice().sort(kI)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){var a;const{lastDraggingEvent:r,beans:s}=this;if(t){const l=this.getRowNodes(e);e.dragItem.rowNodes=l,y0(l,!0)}this.lastDraggingEvent=e;const i=e.fromNudge,n=this.makeRowsDrop(r,e,i,!1);(a=s.rowDropHighlightSvc)==null||a.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e);const o=this.autoScroll;n!=null&&n.rowDragManaged&&n.moved&&n.allowed&&n.sameGrid&&!n.suppressMoveWhenRowDragging&&(!i&&!(o!=null&&o.scrolling)||this.autoScrollChanged)&&this.dropRows(n),o==null||o.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,r,s){const{beans:i,gos:n}=this,o=this.newRowsDrop(t,s),a=i.rowModel;if(t.dropTarget=o,t.changed=!1,!o)return null;let{sameGrid:l,rootNode:c,source:u,target:d}=o;d??(d=a.getRow(a.getRowCount()-1)??null);const h=this.beans.groupEditSvc,f=!!(h!=null&&h.canSetParent(o));let p=null;if(d!=null&&d.footer){const m=bh(a,-1,d)??bh(a,1,d);f&&(p=d.sibling??c),d=m??null}d!=null&&d.detail&&(d=d.parent),o.moved&&(o.moved=u!==d);let g=.5;if(d&&(l&&o.moved&&(p||!f)?g=u.rowIndex>d.rowIndex?-.5:.5:g=(o.y-d.rowTop-d.rowHeight/2)/d.rowHeight||0),!f&&l&&d&&o.moved&&wt(n)){const m=PI(a,o);m&&(g=u.rowIndex>m.rowIndex?-.5:.5,d=m,o.moved&&(o.moved=u!==d))}return o.target=d,o.newParent=p,o.pointerPos=DI(d,o.y),o.yDelta=g,h==null||h.fixRowsDrop(o,f,r,g),this.validateRowsDrop(o,f,s),t.changed||(t.changed=x0(e==null?void 0:e.dropTarget,o)),o}newRowsDrop(e,t){const{beans:r,gos:s}=this,i=r.rowModel.rootNode,n=wt(s)?s.get("rowDragManaged"):!1,o=s.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e);let{rowNode:l,rowNodes:c}=e.dragItem;if(c||(c=l?[l]:[]),l||(l=c[0]),!l||!i)return null;const u=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e);let d=!0;n&&(!c.length||r.rowDragSvc.visibility!=="visible"||(o||!a)&&!u)&&(d=!1);const h=a0(r,e).y,f=this.getOverNode(h);return{api:r.gridApi,context:r.gridOptions.context,draggingEvent:e,rowDragManaged:n,suppressMoveWhenRowDragging:o,sameGrid:a,withinGrid:u,treeData:!1,rootNode:i,moved:l!==f,y:h,overNode:f,overIndex:(f==null?void 0:f.rowIndex)??-1,pointerPos:"none",position:"none",source:l,target:f??null,newParent:null,rows:c,allowed:d,highlight:!t&&n&&o&&(u||!a),yDelta:0,inside:!1,droppedManaged:!1}}validateRowsDrop(e,t,r){var f;const{source:s,target:i,yDelta:n,inside:o,moved:a,rowDragManaged:l,suppressMoveWhenRowDragging:c}=e;e.moved&&(e.moved=s!==i);const{position:u,fallbackPosition:d}=this.computeDropPosition(a,o,n);e.position=u,t||(e.newParent=null),this.enforceSuppressMoveWhenRowDragging(e,c,"initial");const h=(!l||e.allowed)&&this.gos.get("isRowValidDropPosition");h&&this.applyDropValidator(e,t,r,l,h),l&&(e.rows=this.filterRows(e)),(f=this.beans.groupEditSvc)==null||f.clearNewSameParent(e,t),this.enforceSuppressMoveWhenRowDragging(e,c,"final"),e.position==="inside"&&(!e.allowed||!e.newParent)&&(e.position=d)}computeDropPosition(e,t,r){const s=r<0?"above":"below";return e?{position:t?"inside":s,fallbackPosition:s}:{position:"none",fallbackPosition:s}}enforceSuppressMoveWhenRowDragging(e,t,r){if(t){if(r==="initial"){e.moved||(e.allowed=!1);return}(!e.rows.length||e.position==="none")&&(e.allowed=!1)}}applyDropValidator(e,t,r,s,i){var a;(a=this.beans.groupEditSvc)==null||a.clearNewSameParent(e,t);const n=i(e);if(!n){e.allowed=!1;return}if(typeof n!="object")return;n.rows!==void 0&&(e.rows=n.rows??[]),t&&n.newParent!==void 0&&(e.newParent=n.newParent),n.target!==void 0&&(e.target=n.target),n.position&&(e.position=n.position),n.allowed!==void 0?e.allowed=n.allowed:s||(e.allowed=!0);const o=e.draggingEvent;n.changed&&o&&(o.changed=!0),!r&&n.highlight!==void 0&&(e.highlight=n.highlight)}addRowDropZone(e){if(!e.getContainer()){oe(55);return}const t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){oe(56);return}const r=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(i=>e.onDragEnter(this.rowDragEvent("rowDragEnter",i))),onDragLeave:e.onDragLeave&&(i=>e.onDragLeave(this.rowDragEvent("rowDragLeave",i))),onDragging:e.onDragging&&(i=>e.onDragging(this.rowDragEvent("rowDragMove",i))),onDragStop:e.onDragStop&&(i=>e.onDragStop(this.rowDragEvent("rowDragEnd",i))),onDragCancel:e.onDragCancel&&(i=>e.onDragCancel(this.rowDragEvent("rowDragCancel",i)))},s={isInterestedIn:i=>i===2,getIconName:()=>"move",external:!0,...r};t.addDropTarget(s),this.addDestroyFunc(()=>t.removeDropTarget(s))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:r=>{var s;this.onDragEnter(r),(s=e==null?void 0:e.onDragEnter)==null||s.call(e,this.rowDragEvent("rowDragEnter",r))},onDragLeave:r=>{var s;this.onDragLeave(r),(s=e==null?void 0:e.onDragLeave)==null||s.call(e,this.rowDragEvent("rowDragLeave",r))},onDragging:r=>{var s;this.onDragging(r),(s=e==null?void 0:e.onDragging)==null||s.call(e,this.rowDragEvent("rowDragMove",r))},onDragStop:r=>{var s;this.onDragStop(r),(s=e==null?void 0:e.onDragStop)==null||s.call(e,this.rowDragEvent("rowDragEnd",r))},onDragCancel:r=>{var s;this.onDragCancel(r),(s=e==null?void 0:e.onDragCancel)==null||s.call(e,this.rowDragEvent("rowDragCancel",r))},fromGrid:!0}}getOverNode(e){const{pageBounds:t,rowModel:r}=this.beans,i=e>t.getCurrentPagePixelRange().pageLastPixel?-1:r.getRowIndexAtPixel(e);return i>=0?r.getRow(i):void 0}rowDragEvent(e,t){const r=this.beans,{dragItem:s,dropTarget:i,event:n,vDirection:o}=t,a=(i==null?void 0:i.rootNode)===r.rowModel.rootNode,l=a?i.y:a0(r,t).y,c=a?i.overNode:this.getOverNode(l),u=a?i.overIndex:(c==null?void 0:c.rowIndex)??-1;return{api:r.gridApi,context:r.gridOptions.context,type:e,event:n,node:s.rowNode,nodes:s.rowNodes,overIndex:u,overNode:c,y:l,vDirection:o,rowsDrop:i}}dispatchGridEvent(e,t){const r=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(r)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e,!1)}onDragStop(e){var s;const t=((s=this.lastDraggingEvent)==null?void 0:s.dropTarget)??null,r=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),r!=null&&r.allowed&&r.rowDragManaged&&(!(t!=null&&t.droppedManaged)||x0(t,r))&&this.dropRows(r),this.stopDragging(e,!0)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e,!0)}stopDragging(e,t){var r,s;this.clearAutoScroll(),(r=this.beans.groupEditSvc)==null||r.stopDragging(t),(s=this.beans.rowDropHighlightSvc)==null||s.fromDrag(null),y0(e.dragItem.rowNodes,!1),this.lastDraggingEvent=null}clearAutoScroll(){var e;(e=this.autoScroll)==null||e.ensureCleared(),this.autoScrollChanged=!1,this.autoScrollChanging=!1,this.autoScrollOldV=null}dropRows(e){return e.droppedManaged=!0,e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:r}){const s=co(this.gos),i=this.beans.rowModel,n=r.filter(({data:a,rowPinned:l})=>!i.getRowNode((s==null?void 0:s({data:a,level:0,rowPinned:l}))??a.id)).map(({data:a})=>a);if(n.length===0)return!1;let o;if(t){const a=t.sourceRowIndex>=0?t:Hc(t);a&&(o=a.sourceRowIndex+(e==="above"?0:1))}return i.updateRowData({add:n,addIndex:o}),!0}filterRows(e){const{groupEditSvc:t}=this.beans,{rows:r,sameGrid:s}=e;let i;for(let n=0,o=r.length;n<o;++n){let a=!0;const l=r[n];(!l||l.footer||s&&l.destroyed&&!l.group||!this.csrmGetLeaf(l))&&(a=!1),a&&t&&!t.canDropRow(l,e)&&(a=!1),a?i==null||i.push(l):i??(i=r.slice(0,n))}return i??r}csrmMoveRows(e){const t=this.beans.groupEditSvc;return t!=null&&t.isGroupingDrop(e)?t.dropGroupEdit(e):this.csrmMoveRowsReorder(e)}csrmMoveRowsReorder({position:e,target:t,rows:r,newParent:s,rootNode:i}){let n=!1;const o=new Set;for(const h of r){s&&h.parent!==s&&(h.treeParent=s,n=!0);const f=this.csrmGetLeaf(h);f&&o.add(f)}if(!n&&o.size===0)return!1;const a=this.beans.focusSvc,l=a.getFocusedCell(),c=l&&Vn(this.beans,l);if(o.size&&jA(i._leafs,o,t,e==="above")&&(n=!0),!n)return!1;const u=this.beans.rowModel,d=new ic;return d.reordered=!0,u.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new Ea(!1,i),changedRowNodes:d}),c?c.focusCell():a.clearFocusedCell(),!0}csrmGetLeaf(e){if(e.sourceRowIndex>=0)return e.destroyed?void 0:e;const t=this.beans.groupEditSvc;return t?t.csrmFirstLeaf(e):Hc(e)}},x0=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!Ei(e.rows,t.rows)),kI=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,y0=(e,t)=>{for(let r=0,s=(e==null?void 0:e.length)||0;r<s;++r){const i=e[r];i.dragging!==t&&(i.dragging=t,i.dispatchRowEvent("draggingChanged"))}},PI=(e,t)=>{let r=null,s=t.target;if(s&&t.rows.indexOf(s)<0)return null;const i=t.source;if(!s||!i)return null;let n=s.rowIndex-i.rowIndex;const o=n<0?-1:1;n=t.suppressMoveWhenRowDragging?Math.abs(n):1;const a=new Set(t.rows);do{const l=bh(e,o,s);if(!l)break;a.has(l)||(r=l,--n),s=l}while(n>0);return r},DI=(e,t)=>{const r=e==null?void 0:e.rowTop,s=(e==null?void 0:e.rowHeight)??0;if(r==null||!s||s<=0)return"none";const i=t-r,n=s*EI;return i<=n?"above":i>=s-n?"below":"inside"},AI=class extends ee{constructor(){super(...arguments),this.beanName="rowDragSvc",this.rowDragFeature=null,this.visibility="suppress"}setupRowDrag(e,t){const r=t.createManagedBean(new TI(e)),s=this.beans.dragAndDrop;s.addDropTarget(r),t.addDestroyFunc(()=>s.removeDropTarget(r)),this.rowDragFeature=r;const i=()=>this.refreshVisibility();this.addManagedPropertyListeners(["rowDragManaged","suppressRowDrag","refreshAfterGroupEdit"],i),this.addManagedEventListeners({newColumnsLoaded:i,columnRowGroupChanged:i,columnPivotModeChanged:i,sortChanged:i,filterChanged:i}),this.visibility=this.computeVisibility()}createRowDragComp(e,t,r,s,i,n){return new RI(e,t,r,s,i,n)}createRowDragCompForRow(e,t){if(wi(this.gos))return;const r=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${r("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,r,s,i,n){const o=this.gos;return o.get("rowDragManaged")&&(!wt(o)||o.get("pagination"))?void 0:this.createRowDragComp(r,e,t,s,i,n)}cancelRowDrag(){var e,t;(e=this.rowDragFeature)!=null&&e.lastDraggingEvent&&((t=this.beans.dragSvc)==null||t.cancelDrag())}computeVisibility(){var i,n,o,a;const e=this.beans,t=e.gos;if(t.get("suppressRowDrag"))return"suppress";if(!t.get("rowDragManaged"))return"visible";const s=e.colModel.isPivotMode();return(s||(n=(i=e.rowGroupColsSvc)==null?void 0:i.columns)!=null&&n.length)&&!t.get("refreshAfterGroupEdit")?"hidden":s||(o=e.filterManager)!=null&&o.isAnyFilterPresent()||(a=e.sortSvc)!=null&&a.isSortActive()?"disabled":"visible"}refreshVisibility(){var r;const e=this.visibility,t=this.computeVisibility();e!==t&&(this.visibility=t,(r=this.eventSvc)==null||r.dispatchEvent({type:"rowDragVisibilityChanged"}))}},II=class extends ee{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){const e=this.row,t=this.dragging;!e||(e==null?void 0:e.rowIndex)===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){const e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){const r=e!==this.row,s=e.uiLevel,i=t!==this.position,n=s!==this.uiLevel;this.dragging=!1,(r||i||n)&&(r&&this.clear(),this.uiLevel=s,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){const t=e==null?void 0:e.dropTarget;if(t){const{highlight:r,target:s,position:i}=t;if(r&&s&&i!=="none"){this.set(s,i),this.dragging=!0;return}}this.dragging&&this.clear()}},sx={moduleName:"Drag",version:we,beans:[SI]},MI={moduleName:"DragAndDrop",version:we,dynamicBeans:{dndSourceComp:mI},icons:{rowDrag:"grip"}},ix={moduleName:"SharedDragAndDrop",version:we,beans:[iD],dependsOn:[sx],userComponents:{agDragAndDropImage:MA},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},_I={moduleName:"RowDrag",version:we,beans:[II,AI],apiFunctions:{addRowDropZone:vI,removeRowDropZone:CI,getRowDropZoneParams:wI,getRowDropPositionIndicator:xI,setRowDropPositionIndicator:yI},dependsOn:[ix]},LI={moduleName:"HorizontalResize",version:we,beans:[bI],dependsOn:[sx]},OI=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",NI=class extends ee{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){const{executeNextFuncs:r,executeLaterFuncs:s}=this;if(r.length===0&&s.length===0){e(),t();return}const i=n=>{for(;n.length;){const o=n.pop();o&&o()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),i(r)},0),window.setTimeout(()=>{t(),i(s)},200)})}};function BI(e,t,r){var s;(s=e.colMoves)==null||s.moveColumnByIndex(t,r,"api")}function HI(e,t,r){var s;(s=e.colMoves)==null||s.moveColumns(t,r,"api")}var VI=class extends ee{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;if(t)for(const r of t)r.isPrimary()&&(r.isAnyFunctionActive()||(r.isAllowValue()?this.columnsToAggregate.push(r):r.isAllowRowGroup()?this.columnsToGroup.push(r):r.isAllowPivot()&&this.columnsToPivot.push(r)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:r,pivotColsSvc:s}=this.beans;this.columnsToAggregate.length>0&&(t==null||t.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop")),this.columnsToGroup.length>0&&(r==null||r.addColumns(this.columnsToGroup,"toolPanelDragAndDrop")),this.columnsToPivot.length>0&&(s==null||s.addColumns(this.columnsToPivot,"toolPanelDragAndDrop"))}onDragCancel(){this.clearColumnsList()}};function GI(e,t){!t||t.length<=1||t.filter(s=>e.indexOf(s)<0).length>0||t.sort((s,i)=>{const n=e.indexOf(s),o=e.indexOf(i);return n-o})}function WI(e){var r;const t=[...e];for(const s of e){let i=null,n=s.getParent();for(;n!=null&&n.getDisplayedLeafColumns().length===1;)i=n,n=n.getParent();if(i!=null){const a=!!((r=i.getColGroupDef())!=null&&r.marryChildren)?i.getProvidedColumnGroup().getLeafColumns():i.getLeafColumns();for(const l of a)t.includes(l)||t.push(l)}}return t}function zI(e,t,r,s){const i=s.allCols;let n=null,o=null;for(let a=0;a<e.length;a++){const l=e[a],c=r.getProposedColumnOrder(t,l);if(!r.doesOrderPassRules(c))continue;const u=c.filter(h=>i.includes(h));if(o===null)o=u;else if(!Ei(u,o))break;const d=jI(c);(n===null||d<n.fragCount)&&(n={move:l,fragCount:d})}return n}function nx(e){const{isFromHeader:t,fromLeft:r,xPosition:s,fromEnter:i,fakeEvent:n,pinned:o,gos:a,colModel:l,colMoves:c,visibleCols:u}=e;let{allMovingColumns:d}=e;t&&(d=WI(d));const h=d.slice();GI(l.getCols(),h);const f=KI({movingCols:h,draggingRight:r,xPosition:s,pinned:o,gos:a,colModel:l,visibleCols:u}),p=UI(h,l);if(f.length===0)return;const g=f[0];if(p!==null&&(t||!i)&&!n&&(!r&&g>=p||r&&g<=p))return;const v=zI(f,h,c,u);if(!v)return;const w=v.move;if(!(w>l.getCols().length-h.length))return{columns:h,toIndex:w}}function ox(e){const{columns:t,toIndex:r}=nx(e)||{},{finished:s,colMoves:i}=e;return!t||r==null?null:(i.moveColumns(t,r,"uiColumnMoved",s),s?null:{columns:t,toIndex:r})}function UI(e,t){const r=t.getCols(),s=e.map(l=>r.indexOf(l)).sort((l,c)=>l-c),i=s[0];return nt(s)-i!==s.length-1?null:i}function jI(e){function t(s){const i=[];let n=s.getOriginalParent();for(;n!=null;)i.push(n),n=n.getOriginalParent();return i}let r=0;for(let s=0;s<e.length-1;s++){let i=t(e[s]),n=t(e[s+1]);[i,n]=i.length>n.length?[i,n]:[n,i];for(const o of i)n.indexOf(o)===-1&&r++}return r}function $I(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function KI(e){const{movingCols:t,draggingRight:r,xPosition:s,pinned:i,gos:n,colModel:o,visibleCols:a}=e;if(n.get("suppressMovableColumns")||t.some(C=>C.getColDef().suppressMovable))return[];const c=$I(a,i),u=o.getCols(),d=c.filter(C=>t.includes(C)),h=c.filter(C=>!t.includes(C)),f=u.filter(C=>!t.includes(C));let p=0,g=s;if(r){let C=0;for(const y of d)C+=y.getActualWidth();g-=C}if(g>0){for(let C=0;C<h.length;C++){const y=h[C];if(g-=y.getActualWidth(),g<0)break;p++}r&&p++}let m;if(p>0){const C=h[p-1];m=f.indexOf(C)+1}else m=f.indexOf(h[0]),m===-1&&(m=0);const v=[m],w=(C,y)=>C-y;if(r){let C=m+1;const y=u.length-1;for(;C<=y;)v.push(C),C++;v.sort(w)}else{let C=m;const y=u.length-1;let b=u[C];for(;C<=y&&c.indexOf(b)<0;)C++,v.push(C),b=u[C];C=m-1;const F=0;for(;C>=F;)v.push(C),C--;v.sort(w).reverse()}return v}function Ph(e){var c;const{pinned:t,fromKeyboard:r,gos:s,ctrlsSvc:i,useHeaderRow:n,skipScrollPadding:o}=e;let a=(c=i.getHeaderRowContainerCtrl(t))==null?void 0:c.eViewport,{x:l}=e;return a?(r&&(l-=a.getBoundingClientRect().left),s.get("enableRtl")&&(n&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!o&&(l+=i.get("center").getCenterViewportScrollLeft()),l):0}function Fd(e,t){for(const r of e)r.moving=t,r.dispatchColEvent("movingChanged","uiColumnMoved")}var S0=7,Dh=100,El=Dh/2,qI=5,XI=100,YI=class extends ee{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!Ce(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const{pinned:e,lastDraggingEvent:t}=this,{dragItem:r}=t||{},s=(r==null?void 0:r.columns)??[];for(const i of s){const n=i.getPinned();if(i.getColDef().lockPinned){if(n==e)return"move";continue}const o=r==null?void 0:r.containerType;if(o===e||!e)return"move";if(e&&(!n||o!==e))return"pinned"}return"notAllowed"}onDragEnter(e){const t=e.dragItem,r=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(r,!0,"uiColumnDragged");else{const i=t.visibleState,n=(r||[]).filter(o=>i[o.getId()]&&!o.isVisible());this.setColumnsVisible(n,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(r,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,r=!1,s=!1){const{gos:i,ctrlsSvc:n}=this.beans,o=i.get("suppressMoveWhenColumnDragging");if(s&&!o){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!s&&ct(e.hDirection))return;const a=Ph({x:e.x,pinned:this.pinned,gos:i,ctrlsSvc:n});t||this.checkCenterForScrolling(a),o?this.handleColumnDragWhileSuppressingMovement(e,t,r,a,s):this.handleColumnDragWhileAllowingMovement(e,t,r,a,s)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,r){if(!(e!=null&&e.length))return;const s=e.filter(i=>!i.getColDef().lockVisible);s.length&&this.beans.colModel.setColsVisible(s,t,r)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:r}=e;this.beans.colMoves.moveColumns(t,r,"uiColumnMoved",!0)}updateDragItemContainerType(){const{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;const t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,r,s,i){const n=this.getAllMovingColumns(e,!0);if(i){const o=this.isAttemptingToPin(n);o&&this.attemptToPinColumns(n,void 0,!0);const{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(n,o)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:n,xPosition:l,fromEnter:t,fakeEvent:r,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(n,s)}}handleColumnDragWhileAllowingMovement(e,t,r,s,i){const n=this.getAllMovingColumns(e),o=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:n,isFromHeader:a,xPosition:s,fromLeft:o,fromEnter:t,fakeEvent:r}),c=ox({...l,finished:i});c&&(this.lastMovedInfo=c)}getAllMovingColumns(e,t=!1){const r=e.dragSource.getDragItem();let s=null;t?(s=r.columnsInSplit,s||(s=r.columns)):s=r.columns;const i=n=>n.getColDef().lockPinned?n.getPinned()==this.pinned:!0;return s?s.filter(i):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:r,xPosition:s,fromLeft:i,fromEnter:n,fakeEvent:o}=e,{gos:a,colModel:l,colMoves:c,visibleCols:u}=this.beans;return{allMovingColumns:t,isFromHeader:r,fromLeft:i,xPosition:s,pinned:this.pinned,fromEnter:n,fakeEvent:o,gos:a,colModel:l,colMoves:c,visibleCols:u}}highlightHoveredColumn(e,t){var u;const{gos:r,colModel:s}=this.beans,i=r.get("enableRtl"),n=s.getCols().filter(d=>d.isVisible()&&d.getPinned()===this.pinned);let o=null,a=null,l=null;for(const d of n){if(a=d.getActualWidth(),o=this.getNormalisedColumnLeft(d,0,i),o!=null){const h=o+a;if(o<=t&&h>=t){l=d;break}}o=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let d=n.length-1;d>=0;d--){const h=n[d],f=n[d].getParent();if(!f){l=h;break}const p=f==null?void 0:f.getDisplayedLeafColumns();if(p.length){l=nt(p);break}}if(!l)return;o=this.getNormalisedColumnLeft(l,0,i),a=l.getActualWidth()}if(((u=this.lastHighlightedColumn)==null?void 0:u.column)!==l&&this.clearHighlighted(),l==null||o==null||a==null)return;let c;t-o<a/2?c=0:c=1,b0(l,c),this.lastHighlightedColumn={column:l,position:c}}getNormalisedXPositionInfo(e,t){const{gos:r,visibleCols:s}=this.beans,i=r.get("enableRtl"),{firstMovingCol:n,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,i);if(!n||!o||a==null)return;const l=s.allCols,c=l.indexOf(n),u=l.indexOf(o),d=a===0,h=c<u||c===u&&!d;let f=0;if(d?h&&(f-=1):h||(f+=1),u+f===c)return;const p=l[u+f];if(!p)return;const g=this.getNormalisedColumnLeft(p,20,i);return{fromLeft:h,xPosition:g}}getColumnMoveAndTargetInfo(e,t,r){const s=this.lastHighlightedColumn||{},{firstMovingCol:i,lastMovingCol:n}=JI(e);if(!i||!n||s.column||!t)return{firstMovingCol:i,...s};const a=this.getPinDirection()==="left";return{firstMovingCol:i,position:a?1:0,column:a!==r?i:n}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,r){const{gos:s,ctrlsSvc:i}=this.beans,n=e.getLeft();if(n==null)return null;const o=e.getActualWidth();return Ph({x:r?n+o-t:n+t,pinned:e.getPinned(),useHeaderRow:r,skipScrollPadding:!0,gos:s,ctrlsSvc:i})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,r=this.failedMoveAttempts>S0;return t&&r||e.some(s=>s.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:r,fromEnter:s,fakeEvent:i,fromLeft:n}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:r,fromLeft:n,fromEnter:s,fakeEvent:i}),{columns:a,toIndex:l}=nx(o)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;e&&(b0(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),r=t.getCenterViewportScrollLeft(),s=r+t.getCenterWidth();let i,n;this.gos.get("enableRtl")?(i=e<r+El,n=e>s-El):(n=e<r+El,i=e>s-El),this.needToMoveRight=i,this.needToMoveLeft=n,n||i?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),XI),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){var s;let e;this.intervalCount++,e=10+this.intervalCount*qI,e>Dh&&(e=Dh);let t=null;const r=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=r.scrollHorizontally(-e):this.needToMoveRight&&(t=r.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:i,dragAndDrop:n,gos:o}=this.beans;if(this.failedMoveAttempts<=S0+1||!i)return;if(n.setDragImageCompIcon("pinned"),!o.get("suppressMoveWhenColumnDragging")){const a=(s=this.lastDraggingEvent)==null?void 0:s.dragItem.columns;this.attemptToPinColumns(a,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,r=!1){const s=(e||[]).filter(o=>!o.getColDef().lockPinned);if(!s.length)return 0;r&&(t=this.getPinDirection());const{pinnedCols:i,dragAndDrop:n}=this.beans;return i==null||i.setColsPinned(s,t,"uiColumnDragged"),r&&n.nudge(),s.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function b0(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function JI(e){const t=e.length;let r,s;for(let i=0;i<t;i++){if(!r){const n=e[i];n.getLeft()!=null&&(r=n)}if(!s){const n=e[t-1-i];n.getLeft()!=null&&(s=n)}if(r&&s)break}return{firstMovingCol:r,lastMovingCol:s}}var ZI=class extends ee{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,r=this.pinned;e.whenReady(this,s=>{let i;const n=s.gridBodyCtrl.eBodyViewport;switch(r){case"left":i=[[n,s.left.eContainer],[s.bottomLeft.eContainer],[s.topLeft.eContainer]];break;case"right":i=[[n,s.right.eContainer],[s.bottomRight.eContainer],[s.topRight.eContainer]];break;default:i=[[n,s.center.eViewport],[s.bottomCenter.eViewport],[s.topCenter.eViewport]];break}this.eSecondaryContainers=i}),this.moveColumnFeature=this.createManagedBean(new YI(r)),this.bodyDropPivotTarget=this.createManagedBean(new VI(r)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},QI=class extends ee{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,r){const s=this.beans.colModel.getCols();if(!s)return;const i=s[e];this.moveColumns([i],t,r)}moveColumns(e,t,r,s=!0){const{colModel:i,colAnimation:n,visibleCols:o,eventSvc:a}=this.beans,l=i.getCols();if(!l)return;if(t>l.length-e.length){oe(30,{toIndex:t});return}n==null||n.start();const c=i.getColsForKeys(e);this.doesMovePassRules(c,t)&&(Vp(i.getCols(),c,t),o.refresh(r),a.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,toIndex:t,finished:s,source:r})),n==null||n.finish()}doesMovePassRules(e,t){const r=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(r)}doesOrderPassRules(e){const{colModel:t,gos:r}=this.beans;return!(!QC(e,t.getColTree())||!(i=>{const n=c=>c?c==="left"||c===!0?-1:1:0,o=r.get("enableRtl");let a=o?1:-1,l=!0;for(const c of i){const u=n(c.getColDef().lockPosition);o?u>a&&(l=!1):u<a&&(l=!1),a=u}return l})(e))}getProposedColumnOrder(e,t){const s=this.beans.colModel.getCols().slice();return Vp(s,e,t),s}createBodyDropTarget(e,t){return new ZI(e,t)}moveHeader(e,t,r,s,i){const{ctrlsSvc:n,gos:o,colModel:a,visibleCols:l,focusSvc:c}=this.beans,u=t.getBoundingClientRect(),d=u.left,h=kt(r),f=h?u.width:r.getActualWidth(),p=e==="left"!==o.get("enableRtl"),g=Ph({x:p?d-20:d+f+20,pinned:s,fromKeyboard:!0,gos:o,ctrlsSvc:n}),m=c.focusedHeader;ox({allMovingColumns:h?r.getLeafColumns():[r],isFromHeader:!0,fromLeft:e==="right",xPosition:g,pinned:s,fromEnter:!1,fakeEvent:!1,gos:o,colModel:a,colMoves:this,visibleCols:l,finished:!0});let v;if(h){const w=r.getDisplayedLeafColumns();v=p?w[0]:nt(w)}else v=r;if(n.getScrollFeature().ensureColumnVisible(v,"auto"),(!i.isAlive()||o.get("ensureDomOrder"))&&m){let w;if(h){const C=r.getGroupId(),y=r.getLeafColumns();if(!y.length)return;const b=y[0].getParent();if(!b)return;w=eM(b,C)}else w=r;w&&c.focusHeaderPosition({headerPosition:{...m,column:w}})}}setDragSourceForHeader(e,t,r){const{gos:s,colModel:i,dragAndDrop:n,visibleCols:o}=this.beans;let a=!s.get("suppressDragLeaveHidesColumns");const l=kt(t),c=l?t.getProvidedColumnGroup().getLeafColumns():[t],d={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>rM(t,o.allCols):()=>tM(t),dragItemName:r,onDragStarted:()=>{a=!s.get("suppressDragLeaveHidesColumns"),Fd(c,!0)},onDragStopped:()=>Fd(c,!1),onDragCancelled:()=>Fd(c,!1),onGridEnter:h=>{if(a){const{columns:f=[],visibleState:p}=h??{},g=l?v=>!p||p[v.getColId()]:()=>!0,m=f.filter(v=>!v.getColDef().lockVisible&&g(v));i.setColsVisible(m,!0,"uiColumnMoved")}},onGridExit:h=>{var f;if(a){const p=((f=h==null?void 0:h.columns)==null?void 0:f.filter(g=>!g.getColDef().lockVisible))||[];i.setColsVisible(p,!1,"uiColumnMoved")}}};return n.addDragSource(d,!0),d}};function eM(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function tM(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function rM(e,t){var a;const r=e.getProvidedColumnGroup().getLeafColumns(),s={};for(const l of r)s[l.getId()]=l.isVisible();const i=[];for(const l of t)r.indexOf(l)>=0&&(i.push(l),Es(r,l));for(const l of r)i.push(l);const n=[],o=e.getLeafColumns();for(const l of i)o.indexOf(l)!==-1&&n.push(l);return{columns:i,columnsInSplit:n,visibleState:s,containerType:(a=n[0])==null?void 0:a.pinned}}var sM={moduleName:"ColumnMove",version:we,beans:[QI,NI],apiFunctions:{moveColumnByIndex:BI,moveColumns:HI},dependsOn:[ix],css:[OI]},iM=class extends ee{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const r=this.getHeaderCellForColumn(e);if(!r)return-1;const s=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||s.push(r),this.getPreferredWidthForElements(s)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const r=document.createElement("form");r.style.position="fixed";const s=this.centerRowContainerCtrl.eContainer;for(const n of e)this.cloneItemIntoDummy(n,r);s.appendChild(r);const i=r.offsetWidth;return r.remove(),t=t??this.gos.get("autoSizePadding"),i+t}getHeaderCellForColumn(e){let t=null;for(const r of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){const s=r.getHtmlElementForColumnHeader(e);s!=null&&(t=s)}return t}cloneItemIntoDummy(e,t){const r=e.cloneNode(!0);r.style.width="",r.style.position="static",r.style.left="";const s=document.createElement("div"),i=s.classList;["ag-header-cell","ag-header-group-cell"].some(a=>r.classList.contains(a))?(i.add("ag-header","ag-header-row"),s.style.position="static"):i.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const c=o.classList[l];c!="ag-row-position-absolute"&&i.add(c)}break}o=o.parentElement}s.appendChild(r),t.appendChild(s)}},ax={moduleName:"AutoWidth",version:we,beans:[iM]};function nM(e,t,r=!0,s="api"){var i;(i=e.colResize)==null||i.setColumnWidths(t,!1,r,s)}var oM=class extends ee{constructor(e,t,r,s){super(),this.comp=e,this.eResize=t,this.pinned=r,this.columnGroup=s}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const{horizontalResizeSvc:e,gos:t,colAutosize:r}=this.beans,s=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(s),!t.get("suppressAutoSize")&&r&&this.addDestroyFunc(r.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:r,resizeRatios:s,groupAfterColumns:i,groupAfterStartWidth:n,groupAfterRatios:o}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=r,this.resizeRatios=s,this.resizeTakeFromCols=i,this.resizeTakeFromStartWidth=n,this.resizeTakeFromRatios=o,this.toggleColumnResizing(!0)}onResizing(e,t,r="uiColumnResized"){const s=this.normaliseDragChange(t),i=this.resizeStartWidth+s;this.resizeColumnsFromLocalValues(i,r,e)}getInitialValues(e){var l;const t=c=>c.reduce((u,d)=>u+d.getActualWidth(),0),r=(c,u)=>c.map(d=>d.getActualWidth()/u),s=this.getColumnsToResize(),i=t(s),n=r(s,i),o={columnsToResize:s,resizeStartWidth:i,resizeRatios:n};let a=null;if(e&&(a=((l=this.beans.colGroupSvc)==null?void 0:l.getGroupAtDirection(this.columnGroup,"After"))??null),a){const c=a.getDisplayedLeafColumns(),u=o.groupAfterColumns=c.filter(h=>h.isResizable()),d=o.groupAfterStartWidth=t(u);o.groupAfterRatios=r(u,d)}else o.groupAfterColumns=void 0,o.groupAfterStartWidth=void 0,o.groupAfterRatios=void 0;return o}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),r=this.getInitialValues();t>r.resizeStartWidth&&this.resizeColumns(r,t,e,!0)}resizeColumnsFromLocalValues(e,t,r=!0){if(!this.resizeCols||!this.resizeRatios)return;const s={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(s,e,t,r)}resizeColumns(e,t,r,s=!0){var d;const{columnsToResize:i,resizeStartWidth:n,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:i,ratios:o,width:t}),a){const h=t-n;u.push({columns:a,ratios:c,width:l-h})}(d=this.beans.colResize)==null||d.resizeColumnSets({resizeSets:u,finished:s,source:r}),s&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},aM=class extends ee{constructor(e,t,r,s,i){super(),this.pinned=e,this.column=t,this.eResize=r,this.comp=s,this.ctrl=i}postConstruct(){const e=[];let t,r;const s=()=>{if(it(this.eResize,t),!t)return;const{horizontalResizeSvc:o,colAutosize:a}=this.beans,l=o.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),r&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},i=()=>{for(const o of e)o();e.length=0},n=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==r)&&(t=o,r=a,i(),s())};n(),this.addDestroyFunc(i),this.ctrl.setRefreshFunction("resize",n)}onResizing(e,t){const{column:r,lastResizeAmount:s,resizeStartWidth:i,beans:n}=this,o=this.normaliseResizeAmount(t),a=i+o,l=[{key:r,newWidth:a}],{pinnedCols:c,ctrlsSvc:u,colResize:d}=n;if(this.column.getPinned()){const h=(c==null?void 0:c.leftWidth)??0,f=(c==null?void 0:c.rightWidth)??0,p=wa(u.getGridBodyCtrl().eBodyViewport)-50;if(h+f+(o-s)>p)return}this.lastResizeAmount=o,d==null||d.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const r=this.pinned!=="left",s=this.pinned==="right";return this.gos.get("enableRtl")?r&&(t*=-1):s&&(t*=-1),t}},lM=class extends ee{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,r,s){const i=[],{colModel:n,gos:o,visibleCols:a}=this.beans;for(const l of e){const c=n.getColDefCol(l.key)||n.getCol(l.key);if(!c)continue;if(i.push({width:l.newWidth,ratios:[1],columns:[c]}),o.get("colResizeDefault")==="shift"&&(t=!t),t){const d=a.getColAfter(c);if(!d)continue;const h=c.getActualWidth()-l.newWidth,f=d.getActualWidth()+h;i.push({width:f,ratios:[1],columns:[d]})}}i.length!==0&&this.resizeColumnSets({resizeSets:i,finished:r,source:s})}resizeColumnSets(e){const{resizeSets:t,finished:r,source:s}=e;if(!(!t||t.every(u=>cM(u)))){if(r){const u=t&&t.length>0?t[0].columns:null;uo(this.eventSvc,u,r,s)}return}const n=[],o=[];for(const u of t){const{width:d,columns:h,ratios:f}=u,p={},g={};for(const w of h)o.push(w);let m=!0,v=0;for(;m;){if(v++,v>1e3){Qe(31);break}m=!1;const w=[];let C=0,y=d;h.forEach((F,S)=>{if(g[F.getId()])y-=p[F.getId()];else{w.push(F);const T=f[S];C+=T}});const b=1/C;w.forEach((F,S)=>{const D=S===w.length-1;let T;D?T=y:(T=Math.round(f[S]*d*b),y-=T);const V=F.getMinWidth(),_=F.getMaxWidth();T<V?(T=V,g[F.getId()]=!0,m=!0):_>0&&T>_&&(T=_,g[F.getId()]=!0,m=!0),p[F.getId()]=T})}for(const w of h){const C=p[w.getId()];w.getActualWidth()!==C&&(w.setActualWidth(C,s),n.push(w))}}const a=n.length>0;let l=[];if(a){const{colFlex:u,visibleCols:d,colViewport:h}=this.beans;l=(u==null?void 0:u.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}))??[],d.setLeftValues(s),d.updateBodyWidths(),h.checkViewportColumns()}const c=o.concat(l);(a||r)&&uo(this.eventSvc,c,r,s,l)}resizeHeader(e,t,r){if(!e.isResizable())return;const s=e.getActualWidth(),i=e.getMinWidth(),n=e.getMaxWidth(),o=Math.min(Math.max(s+t,i),n);this.setColumnWidths([{key:e,newWidth:o}],r,!0,"uiColumnResized")}createResizeFeature(e,t,r,s,i){return new aM(e,t,r,s,i)}createGroupResizeFeature(e,t,r,s){return new oM(e,t,r,s)}};function cM(e){const{columns:t,width:r}=e;let s=0,i=0,n=!0;for(const l of t){const c=l.getMinWidth();s+=c||0;const u=l.getMaxWidth();u>0?i+=u:n=!1}const o=r>=s,a=!n||r<=i;return o&&a}var uM={moduleName:"ColumnResize",version:we,beans:[lM],apiFunctions:{setColumnWidths:nM},dependsOn:[LI,ax]},dM=class extends ee{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);for(const t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(const e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},hM=class extends Yf{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,r,s,i){const{column:n,beans:o}=this,{context:a,colNames:l,colHover:c,rangeSvc:u,colResize:d}=o;this.comp=e,i=Ka(this,a,i),this.setGui(t,i),this.displayName=l.getDisplayNameForColumnGroup(n,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(i),this.setupExpandable(i),this.setupTooltip(),this.refreshAnnouncement(),this.setupAutoHeight({wrapperElement:s,compBean:i}),this.setupUserComp(),this.addHeaderMouseListeners(i,s),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const h=this.rowCtrl.pinned,f=n.getProvidedColumnGroup().getLeafColumns();c==null||c.createHoverFeature(i,f,t),u==null||u.createRangeHighlightFeature(i,n,e),i.createManagedBean(new Xf(n,t,o)),i.createManagedBean(new dM(e,n)),d?this.resizeFeature=i.createManagedBean(d.createGroupResizeFeature(e,r,h,n)):e.setResizableDisplayed(!1),i.createManagedBean(new Xa(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(i,f),this.addManagedEventListeners({cellSelectionChanged:()=>this.refreshAnnouncement()}),i.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(i),i.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.getDefinition();return ke(t.gos,{colDef:r,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,r=e.get("groupHeaderHeight");r!=null?r===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(r):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const r of t)e.addManagedListeners(r,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,r)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),r=t[0]===e,s=nt(t)===e;if(!r&&!s)return;const i=e.getHighlighted(),n=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving());let o=!1,a=!1;if(n){const l=this.beans.gos.get("enableRtl"),c=i===1,u=i===0;r&&(l?a=c:o=u),s&&(l?o=u:a=c)}this.comp.toggleCss("ag-header-highlight-before",o),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){const{resizeFeature:r}=this;if(!r)return;const s=r.getInitialValues(t);r.resizeColumns(s,s.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){var t;(t=this.resizeFeature)==null||t.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:r,enterpriseMenuFactory:s}=this.beans,i=this.column,n=i.getProvidedColumnGroup(),o=ke(r,{displayName:this.displayName,columnGroup:i,setExpanded:l=>{e.setColumnGroupOpened(n,l,"gridInitializing")},setTooltip:(l,c)=>{r.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,c)},showColumnMenu:(l,c)=>s==null?void 0:s.showMenuAfterButtonClick(n,l,"columnMenu",c),showColumnMenuAfterMouseClick:(l,c)=>s==null?void 0:s.showMenuAfterMouseEvent(n,l,"columnMenu",c),eGridHeader:this.eGui}),a=xk(t,o);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e,t){const{column:r,comp:s,beans:{rangeSvc:i},gos:n}=this,o=u=>this.handleMouseOverChange(u.type==="mouseenter"),a=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",r.getProvidedColumnGroup()),l=u=>this.handleContextMenuMouseEvent(u,void 0,r.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:o,mouseleave:o,click:a,contextmenu:l}),s.toggleCss("ag-header-group-cell-selectable",qn(n));const c=i==null?void 0:i.createHeaderGroupCellMouseListenerFeature(this.column,t);c&&this.createManagedBean(c)}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){var r;this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const r=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:r,expandableChanged:r})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),r=$w(t,this.gos,null,e);e.isPadding()?(r.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(i=>i.isSpanHeaderHeight())&&r.push("ag-header-span-height")):(r.push("ag-header-group-cell-with-group"),t!=null&&t.wrapHeaderText&&r.push("ag-header-cell-wrap-text"));for(const s of r)this.comp.toggleCss(s,!0)}setupMovingCss(e){const{column:t}=this,s=t.getProvidedColumnGroup().getLeafColumns(),i=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(const n of s)e.addManagedListeners(n,{movingChanged:i});i()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription())}handleKeyDown(e){var a;if(super.handleKeyDown(e),!this.getWrapperHasFocus())return;const{column:r,expandable:s,gos:i,beans:n}=this,o=qn(i);if(e.key==K.ENTER){if(o&&!e.altKey)(a=n.rangeSvc)==null||a.handleColumnSelection(r,e);else if(s){const l=!r.isExpanded();n.colGroupSvc.setColumnGroupOpened(r.getProvidedColumnGroup(),l,"uiColumnExpanded")}}}refreshAnnouncement(){var n;let e;const{gos:t,column:r,beans:s}=this;if(qn(t)){const o=this.getLocaleTextFunc(),a=(n=s.rangeSvc)==null?void 0:n.isColumnInAnyRange(r);e=o("ariaColumnCellSelection",`Press CTRL+SPACE to ${a?"de":""}select all visible cells in this column group`)}this.ariaAnnouncement=e}announceAriaDescription(){var s;const{beans:e,eGui:t,ariaAnnouncement:r}=this;!r||!t.contains(pt(e))||(s=e.ariaAnnounce)==null||s.announceValue(r,"columnHeader")}setDragSource(e){var t;!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=((t=this.beans.colMoves)==null?void 0:t.setDragSourceForHeader(e,this.column,this.displayName))??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function fM(e,t,r){var s;(s=e.colGroupSvc)==null||s.setColumnGroupOpened(t,r,"api")}function gM(e,t,r){var s;return((s=e.colGroupSvc)==null?void 0:s.getColumnGroup(t,r))??null}function pM(e,t){var r;return((r=e.colGroupSvc)==null?void 0:r.getProvidedColGroup(t))??null}function mM(e,t,r){return e.colNames.getDisplayNameForColumnGroup(t,r)||""}function vM(e){var t;return((t=e.colGroupSvc)==null?void 0:t.getColumnGroupState())??[]}function CM(e,t){var r;(r=e.colGroupSvc)==null||r.setColumnGroupState(t,"api")}function wM(e){var t;(t=e.colGroupSvc)==null||t.resetColumnGroupState("api")}function xM(e){return e.visibleCols.treeLeft}function yM(e){return e.visibleCols.treeCenter}function SM(e){return e.visibleCols.treeRight}function bM(e){return e.visibleCols.getAllTrees()}function FM(e,t){for(let r=0;r<t.length;r++){const s=e.indexOf(t[r]);s>=0&&(e[s]=e[e.length-1],e.pop())}}var RM=class extends ee{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){const{colFlex:r,colModel:s,colGroupSvc:i,colViewport:n,selectionColSvc:o}=this.beans;t||this.buildTrees(s,i),i==null||i.updateOpenClosedVisibility(),this.leftCols=Rd(this.treeLeft),this.centerCols=Rd(this.treeCenter),this.rightCols=Rd(this.treeRight),o==null||o.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(s),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),r==null||r.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(s,this.leftCols,this.rightCols,e),n.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(const t of this.allCols){let r=t.getParent();for(;r;){if(!r.isPadding()){const s=r.getProvidedColumnGroup().getLevel()+1;s>e&&(e=s);break}r=r.getParent()}}return e}updateBodyWidths(){const e=Ls(this.centerCols),t=Ls(this.leftCols),r=Ls(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==r)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=r,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,r,s){let i,n;this.gos.get("enableRtl")?(i=t?t[0]:null,n=r?nt(r):null):(i=t?nt(t):null,n=r?r[0]:null);for(const o of e.getCols())o.setLastLeftPinned(o===i,s),o.setFirstRightPinned(o===n,s)}buildTrees(e,t){const r=e.getColsToShow(),s=r.filter(l=>l.getPinned()=="left"),i=r.filter(l=>l.getPinned()=="right"),n=r.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),o=new iw,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:s,idCreator:o,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:i,idCreator:o,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:n,idCreator:o,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),r=[],s=[],i=[];for(const n of t){const o=n.getPinned();o?o===!0||o==="left"?r.push(n):i.push(n):s.push(n)}this.ariaOrderColumns=r.concat(s).concat(i)}getAriaColIndex(e){let t;return kt(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(const e of[this.treeLeft,this.treeRight,this.treeCenter])for(const t of e)kt(t)&&t.checkLeft()}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const s=t.getCols().slice(0),i=this.gos.get("enableRtl");for(const n of[this.leftCols,this.rightCols,this.centerCols]){if(i){let o=Ls(n);for(const a of n)o-=a.getActualWidth(),a.setLeft(o,e)}else{let o=0;for(const a of n)a.setLeft(o,e),o+=a.getActualWidth()}FM(s,n)}for(const n of s)n.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,r,s){const i=[];let n=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const h=c-1;for(let f=1;f<=h;f++)u.push(t[o+f]);o+=h}let d;if(r){d=!1;for(const h of u)r(h)&&(d=!0)}else d=!0;d&&(i.length===0&&n&&(s&&s(a))&&i.push(n),i.push(a)),n=a}return i}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,r=t.indexOf(e);return r>0?t[r-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};Ji(this.treeCenter,!1,e),Ji(this.treeLeft,!1,e),Ji(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let r=0;r<t.length;r++){const s=this[t[r]];if(s.length)return e?nt(s):s[0]}return null}getColAfter(e){const t=this.allCols,r=t.indexOf(e);return r<t.length-1?t[r+1]:null}getColsLeftWidth(){return Ls(this.leftCols)}getDisplayedColumnsRightWidth(){return Ls(this.rightCols)}isColAtEdge(e,t){const r=this.allCols;if(!r.length)return!1;const s=t==="first";let i;if(kt(e)){const n=e.getDisplayedLeafColumns();if(!n.length)return!1;i=s?n[0]:nt(n)}else i=e;return(s?r[0]:nt(r))===i}};function Ji(e,t,r){if(e)for(let s=0;s<e.length;s++){const i=e[s];if(kt(i)){const n=t?i.getDisplayedChildren():i.getChildren();Ji(n,t,r)}r(i)}}function Rd(e){const t=[];return Ji(e,!0,r=>{xi(r)&&t.push(r)}),t}var EM=class extends ee{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[],t=this.beans.colModel.getColTree();return Ws(null,t,r=>{Zt(r)&&e.push({groupId:r.getGroupId(),open:r.isExpanded()})}),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const r=[];Ws(null,t,s=>{if(Zt(s)){const i=s.getColGroupDef(),n={groupId:s.getGroupId(),open:i?i.openByDefault:void 0};r.push(n)}}),this.setColumnGroupState(r,e)}setColumnGroupState(e,t){const{colModel:r,colAnimation:s,visibleCols:i,eventSvc:n}=this.beans;if(!r.getColTree().length)return;s==null||s.start();const a=[];for(const l of e){const c=l.groupId,u=l.open,d=this.getProvidedColGroup(c);d&&d.isExpanded()!==u&&(d.setExpanded(u),a.push(d))}i.refresh(t,!0),a.length&&n.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),s==null||s.finish()}setColumnGroupOpened(e,t,r){let s;Zt(e)?s=e.getId():s=e||"",this.setColumnGroupState([{groupId:s,open:t}],r)}getProvidedColGroup(e){let t=null;return Ws(null,this.beans.colModel.getColTree(),r=>{Zt(r)&&r.getId()===e&&(t=r)}),t}getGroupAtDirection(e,t){const r=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),s=e.getDisplayedLeafColumns(),i=t==="After"?nt(s):s[0],n=`getCol${t}`;for(;;){const o=this.beans.visibleCols[n](i);if(!o)return null;const a=this.getColGroupAtLevel(o,r);if(a!==e)return a}}getColGroupAtLevel(e,t){let r=e.getParent(),s,i;for(;s=r.getProvidedColumnGroup().getLevel(),i=r.getPaddingLevel(),!(s+i<=t);)r=r.getParent();return r}updateOpenClosedVisibility(){const e=this.beans.visibleCols.getAllTrees();Ji(e,!1,t=>{kt(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(kt(e))return e;const r=this.beans.visibleCols.getAllTrees(),s=typeof t=="number";let i=null;return Ji(r,!1,n=>{if(kt(n)){const o=n;let a;s?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(i=o)}}),i}createColumnGroups(e){const{columns:t,idCreator:r,pinned:s,oldDisplayedGroups:i,isStandaloneStructure:n}=e,o=this.mapOldGroupsById(i),a=[];let l=t;for(;l.length;){const c=l;l=[];let u=0;const d=h=>{const f=u;u=h;const p=c[f],m=(kt(p)?p.getProvidedColumnGroup():p).getOriginalParent();if(m==null){for(let w=f;w<h;w++)a.push(c[w]);return}const v=this.createColumnGroup(m,r,o,s,n);for(let w=f;w<h;w++)v.addChild(c[w]);l.push(v)};for(let h=1;h<c.length;h++){const f=c[h],g=(kt(f)?f.getProvidedColumnGroup():f).getOriginalParent(),m=c[u],w=(kt(m)?m.getProvidedColumnGroup():m).getOriginalParent();g!==w&&d(h)}u<c.length&&d(c.length)}return n||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,r,s,i,n,o){const a=i.getUniqueKey(t.groupId||null,null),l=Hp(this.beans,t,a),c=new Ql(l,a,!1,r);this.createBean(c);const u=this.findExistingGroup(t,n);u&&n.splice(u.idx,1);const d=u==null?void 0:u.group;d&&c.setExpanded(d.isExpanded());const h=YC(this.beans,l.children,r+1,e,s,i,n,o);return c.setChildren(h),c}balanceColumnTree(e,t,r,s){const i=[];for(let n=0;n<e.length;n++){const o=e[n];if(Zt(o)){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,r,s);a.setChildren(l),i.push(a)}else{let a,l;for(let c=t;c<r;c++){const u=s.getUniqueKey(null,null),d=Hp(this.beans,null,u),h=new Ql(d,u,!0,c);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(i.push(a),e.some(u=>Zt(u))){l.setChildren([o]);continue}else{l.setChildren(e);break}i.push(o)}}return i}findDepth(e){let t=0,r=e;for(;r!=null&&r[0]&&Zt(r[0]);)t++,r=r[0].getChildren();return t}findMaxDepth(e,t){let r=t;for(let s=0;s<e.length;s++){const i=e[s];if(Zt(i)){const n=i,o=this.findMaxDepth(n.getChildren(),t+1);r<o&&(r=o)}}return r}balanceTreeForAutoCols(e,t){const r=[];for(const s of e){let i=s;for(let n=t-1;n>=0;n--){const o=new Ql(null,`FAKE_PATH_${s.getId()}}_${n}`,!0,n);this.createBean(o),o.setChildren([i]),i.originalParent=o,i=o}t===0&&(s.originalParent=null),r.push(i)}return r}findExistingGroup(e,t){if(e.groupId!=null)for(let s=0;s<t.length;s++){const i=t[s];if(i.getColGroupDef()&&i.getId()===e.groupId)return{idx:s,group:i}}}createColumnGroup(e,t,r,s,i){const n=e.getGroupId(),o=t.getInstanceIdForKey(n),a=Iw(n,o);let l=r[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),Ce(l)?l.reset():(l=new Ra(e,n,o,s),i||this.createBean(l)),l}mapOldGroupsById(e){const t={},r=s=>{for(const i of s)if(kt(i)){const n=i;t[i.getUniqueId()]=n,r(n.getChildren())}};return e&&r(e),t}setupParentsIntoCols(e,t){for(const r of e??[])if(r.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),r.parent=t,kt(r)){const s=r;this.setupParentsIntoCols(s.getChildren(),s)}}},TM={moduleName:"ColumnGroup",version:we,dynamicBeans:{headerGroupCellCtrl:hM},beans:[EM],apiFunctions:{getAllDisplayedColumnGroups:bM,getCenterDisplayedColumnGroups:yM,getColumnGroup:gM,getColumnGroupState:vM,getDisplayNameForColumnGroup:mM,getLeftDisplayedColumnGroups:xM,getProvidedColumnGroup:pM,getRightDisplayedColumnGroups:SM,resetColumnGroupState:wM,setColumnGroupOpened:fM,setColumnGroupState:CM}},kM={tag:"div",cls:"ag-skeleton-container"},PM=class extends Rt{constructor(){super(kM)}init(t){const r=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",r),this.addDestroyFunc(()=>va(t.eParentOfValue)),va(t.eParentOfValue,r),t.deferRender?this.setupLoading(t):t.node.failedLoad?this.setupFailed():this.setupLoading(t)}setupFailed(){const t=this.getLocaleTextFunc();this.getGui().textContent=t("loadingError","ERR");const r=t("ariaSkeletonCellLoadingFailed","Row failed to load");lo(this.getGui(),r)}setupLoading(t){const r=jr({tag:"div",cls:"ag-skeleton-effect"}),s=t.node.rowIndex;if(s!=null){const o=75+25*(s%2===0?Math.sin(s):Math.cos(s));r.style.width=`${o}%`}this.getGui().appendChild(r);const i=this.getLocaleTextFunc(),n=t.deferRender?i("ariaDeferSkeletonCellLoading","Cell is loading"):i("ariaSkeletonCellLoading","Row data is loading");lo(this.getGui(),n)}refresh(t){return!1}},DM={moduleName:"CheckboxCellRenderer",version:we,userComponents:{agCheckboxCellRenderer:OA}},AM={moduleName:"SkeletonCellRenderer",version:we,userComponents:{agSkeletonCellRenderer:PM}};function IM(e,t){const r=e.colModel.getColDefCol(t);return r?r.getColDef():null}function MM(e){return e.colModel.getColumnDefs(!0)}function _M(e,t,r){return e.colNames.getDisplayNameForColumn(t,r)||""}function LM(e,t){return e.colModel.getColDefCol(t)}function OM(e){return e.colModel.getColDefCols()}function NM(e,t){return ts(e,t,"api")}function BM(e){return Ic(e)}function HM(e){K2(e,"api")}function VM(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function GM(e){return e.visibleCols.isPinningLeft()}function WM(e){return e.visibleCols.isPinningRight()}function zM(e,t){return e.visibleCols.getColAfter(t)}function UM(e,t){return e.visibleCols.getColBefore(t)}function jM(e,t,r){e.colModel.setColsVisible(t,r,"api")}function $M(e,t,r){var s;(s=e.pinnedCols)==null||s.setColsPinned(t,r,"api")}function KM(e){return e.colModel.getCols()}function qM(e){return e.visibleCols.leftCols}function XM(e){return e.visibleCols.centerCols}function YM(e){return e.visibleCols.rightCols}function JM(e){return e.visibleCols.allCols}function ZM(e){return e.colViewport.getViewportColumns()}function Ah(e,t){if(!e)return;const r=e,s={};for(const i of Object.keys(r)){if(t&&t.indexOf(i)>=0||RC.has(i))continue;const n=r[i];typeof n=="object"&&n!==null&&n.constructor===Object?s[i]=Ah(n):s[i]=n}return s}var QM=class extends ee{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,r,s,i=!1){var l,c;const n=e.slice();t?n.sort((u,d)=>r.indexOf(u)-r.indexOf(d)):(r||i)&&n.sort((u,d)=>s.indexOf(u)-s.indexOf(d));const o=(l=this.rowGroupColsSvc)==null?void 0:l.columns,a=(c=this.pivotColsSvc)==null?void 0:c.columns;return this.buildColumnDefs(n,o,a)}buildColumnDefs(e,t=[],r=[]){const s=[],i={};for(const n of e){const o=this.createDefFromColumn(n,t,r);let a=!0,l=o,c=n.getOriginalParent(),u=null;for(;c;){let d=null;if(c.isPadding()){c=c.getOriginalParent();continue}const h=i[c.getGroupId()];if(h){h.children.push(l),a=!1;break}if(d=this.createDefFromGroup(c),d&&(d.children=[l],i[d.groupId]=d,l=d,c=c.getOriginalParent()),c!=null&&u===c){a=!1;break}u=c}a&&s.push(l)}return s}createDefFromGroup(e){const t=Ah(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,r){const s=Ah(e.getColDef());return s.colId=e.getColId(),s.width=e.getActualWidth(),s.rowGroup=e.isRowGroupActive(),s.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,s.pivot=e.isPivotActive(),s.pivotIndex=e.isPivotActive()?r.indexOf(e):null,s.aggFunc=e.isValueActive()?e.getAggFunc():null,s.hide=e.isVisible()?void 0:!0,s.pinned=e.isPinned()?e.getPinned():null,s.sort=e.getSortDef(),s.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,s}},e_=class extends ee{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){const t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);const r=this.flexViewportWidth,{visibleCols:s,colDelayRenderSvc:i}=this.beans,n=s.centerCols;let o=-1;if(e.resizingCols){const g=new Set(e.resizingCols);for(let m=n.length-1;m>=0;m--)if(g.has(n[m])){o=m;break}}let a=!1;const l=n.map((g,m)=>{const v=g.getFlex(),w=v!=null&&v>0&&m>o;return a||(a=w),{col:g,isFlex:w,flex:Math.max(0,v??0),initialSize:g.getActualWidth(),min:g.getMinWidth(),max:g.getMaxWidth(),targetSize:0}});if(a?(i==null||i.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(i),!r||!a)return[];let c=l.length,u=l.reduce((g,m)=>g+m.flex,0),d=r;const h=(g,m)=>{g.frozenSize=m,g.col.setActualWidth(m,t),d-=m,u-=g.flex,c-=1},f=g=>g.frozenSize!=null;for(const g of l)g.isFlex||h(g,g.initialSize);for(;c>0;){const g=Math.round(u<1?d*u:d);let m,v=0,w=0;for(const b of l){if(f(b))continue;m=b,w+=g*(b.flex/u);const F=w-v,S=Math.round(F);b.targetSize=S,v+=S}m&&(m.targetSize+=g-v);let C=0;for(const b of l){if(f(b))continue;const F=b.targetSize,S=Math.min(Math.max(F,b.min),b.max);C+=S-F,b.violationType=S===F?void 0:S<F?"max":"min",b.targetSize=S}const y=C===0?"all":C>0?"min":"max";for(const b of l)f(b)||(y==="all"||b.violationType===y)&&h(b,b.targetSize)}e.skipSetLeft||s.setLeftValues(t),e.updateBodyWidths&&s.updateBodyWidths();const p=l.filter(g=>g.isFlex&&!g.violationType).map(g=>g.col);if(e.fireResizedEvent){const g=l.filter(v=>v.initialSize!==v.frozenSize).map(v=>v.col),m=l.filter(v=>v.flex).map(v=>v.col);uo(this.eventSvc,g,!0,t,m)}return this.revealColumns(i),p}revealColumns(e){this.columnsHidden&&(e==null||e.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){const{flex:t,initialFlex:r}=e.colDef;t!==void 0?e.flex=t:r!==void 0&&(e.flex=r)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function ta(e,t,r){if(!t||!e)return;if(!r)return e[t];const s=t.split(".");let i=e;for(let n=0;n<s.length;n++){if(i==null)return;i=i[s[n]]}return i}var t_=["dateTimeString","dateString","text","number","boolean","date"],r_=class extends ee{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===K.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:r}){return{cellEditorParams:{useFormatter:!0},comparator:(s,i)=>{const n=t.getColDefCol(r),o=n==null?void 0:n.getColDef();if(!n||!o)return 0;const a=s==null?"":e({column:n,node:null,value:s}),l=i==null?"":e({column:n,node:null,value:i});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes(),t={},r={},s=u=>d=>{const{column:h,node:f,value:p}=d;let g=h.getColDef().valueFormatter;return g===u.groupSafeValueFormatter&&(g=u.valueFormatter),this.beans.valueSvc.formatValue(h,f,p,g)};for(const u of Object.keys(e)){const d=e[u],h={...d,groupSafeValueFormatter:E0(d,this.gos)};t[u]=h,r[u]=s(h)}const i=this.gos.get("dataTypeDefinitions")??{},n={};for(const u of Object.keys(i)){const d=i[u],h=this.processDataTypeDefinition(d,i,[u],e);h&&(t[u]=h,d.dataTypeMatcher&&(n[u]=d.dataTypeMatcher),r[u]=s(h))}const{valueParser:o,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:c}=t.object;this.hasObjectValueParser=l!==o,this.hasObjectValueFormatter=c!==a,this.formatValueFuncs=r,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(n,e)}sortKeysInMatchers(e,t){const r={...e};for(const s of t_)delete r[s],r[s]=e[s]??t[s].dataTypeMatcher;return r}processDataTypeDefinition(e,t,r,s){let i;const n=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=s[n];const a=t[n];if(o&&a&&(o=a),!R0(e,o,n))return;i=F0(o,e)}else{if(r.includes(n)){oe(44);return}const o=t[n];if(!R0(e,o,n))return;const a=this.processDataTypeDefinition(o,t,[...r,n],s);if(!a)return;i=F0(a,e)}return{...i,groupSafeValueFormatter:E0(i,this.gos)}}updateColDefAndGetColumnType(e,t,r){let{cellDataType:s}=t;const{field:i}=t;if(s===void 0&&(s=e.cellDataType),(s==null||s===!0)&&(s=this.canInferCellDataType(e,t)?this.inferCellDataType(i,r):!1),!s){e.cellDataType=!1;return}const n=this.dataTypeDefinitions[s];if(!n){oe(47,{cellDataType:s});return}return e.cellDataType=s,n.groupSafeValueFormatter&&(e.valueFormatter=n.groupSafeValueFormatter),n.valueParser&&(e.valueParser=n.valueParser),n.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,s,n,r),n.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const r=s=>{t.add(s.key)};e.__addEventListener("columnStateUpdated",r),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",r))}canInferCellDataType(e,t){const{gos:r}=this;if(!wt(r))return!1;const s={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(Ed(t,s))return!1;const i=t.type===null?e.type:t.type;if(i){const n=r.get("columnTypes")??{};if(Ac(i).some(a=>{const l=n[a.trim()];return l&&Ed(l,s)}))return!1}return!Ed(e,s)}inferCellDataType(e,t){if(!e)return;let r;const s=this.getInitialData();if(s){const n=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");r=ta(s,e,n)}else this.initWaitForRowData(t);return r==null?void 0:Object.keys(this.dataTypeMatchers).find(n=>this.dataTypeMatchers[n](r))??"object"}getInitialData(){var t;const e=this.gos.get("rowData");if(e!=null&&e.length)return e[0];if(this.initialData)return this.initialData;{const r=(t=this.beans.rowModel.rootNode)==null?void 0:t._leafs;if(r!=null&&r.length)return r[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:r,eventSvc:s}=this.beans;t&&r&&(r.shouldQueueResizeOperations=!0);const[i]=this.addManagedEventListeners({rowDataUpdateStarted:n=>{const{firstRowData:o}=n;o&&(i==null||i(),this.isPendingInference=!1,this.processColumnsPendingInference(o,t),this.columnStateUpdatesPendingInference={},t&&(r==null||r.processResizeOperations()),s.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const r=[];this.destroyColumnStateUpdateListeners();const s={},i={};for(const n of Object.keys(this.columnStateUpdatesPendingInference)){const o=this.columnStateUpdatesPendingInference[n],a=this.colModel.getCol(n);if(!a)return;const l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const u=i_(a,o);u.rowGroup&&u.rowGroupIndex==null&&(s[n]=u),u.pivot&&u.pivotIndex==null&&(i[n]=u),r.push(u)}}t&&r.push(...this.generateColumnStateForRowGroupAndPivotIndexes(s,i)),r.length&&ts(this.beans,{state:r},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const r={},{rowGroupColsSvc:s,pivotColsSvc:i}=this.beans;return s==null||s.restoreColumnOrder(r,e),i==null||i.restoreColumnOrder(r,t),Object.values(r)}resetColDefIntoCol(e,t){const r=e.getUserProvidedColDef();if(!r)return!1;const s=ph(this.beans,r,e.getColId());return e.setColDef(s,r,t),!0}getDateStringTypeDefinition(e){const{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){var t;return(t=this.getDataTypeDefinition(e))==null?void 0:t.baseDataType}checkType(e,t){var s,i;if(t==null)return!0;const r=(s=this.getDataTypeDefinition(e))==null?void 0:s.dataTypeMatcher;return!r||e.getColDef().allowFormula&&((i=this.beans.formula)!=null&&i.isFormula(t))?!0:r(t)}validateColDef(e){const t=r=>oe(48,{property:r});if(e.cellDataType==="object"){const{object:r}=this.dataTypeDefinitions;e.valueFormatter===r.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===r.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){var o;const t=e.cellDataType;if(!t||typeof t!="string")return;const{dataTypeDefinitions:r,beans:s,formatValueFuncs:i}=this,n=r[t];n&&((o=s.colFilter)==null||o.setColDefPropsForDataType(e,n,i[t]))}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,r,s){const i=this.formatValueFuncs[t],n=this.columnDefinitionPropsPerDataType[r.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:r,colId:s,formatValue:i});Object.assign(e,n)}getDateObjectTypeDef(e){const t=this.getLocaleTextFunc(),r=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:s=>xr(s.newValue&&String(s.newValue)),valueFormatter:s=>s.value==null?"":!(s.value instanceof Date)||isNaN(s.value.getTime())?t("invalidDate","Invalid Date"):kr(s.value,r)??"",dataTypeMatcher:s=>s instanceof Date}}getDateStringTypeDef(e){const t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:r=>xr(r)??void 0,dateFormatter:r=>kr(r??null,t)??void 0,valueParser:r=>ec(String(r.newValue))?r.newValue:null,valueFormatter:r=>ec(String(r.value))?String(r.value):"",dataTypeMatcher:r=>typeof r=="string"&&ec(r)}}getDefaultDataTypes(){const e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>{var r,s;return((s=(r=t.newValue)==null?void 0:r.trim)==null?void 0:s.call(r))===""?null:Number(t.newValue)},valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:oh(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>{var r,s;return t.newValue==null?t.newValue:((s=(r=t.newValue)==null?void 0:r.trim)==null?void 0:s.call(r))===""?null:String(t.newValue).toLowerCase()==="true"},valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:{...this.getDateStringTypeDef("dateTimeString"),dataTypeMatcher:t=>typeof t=="string"&&qk(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>oh(t.value)??""}}}destroyColumnStateUpdateListeners(){for(const e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function F0(e,t){const r={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(r.columnTypes=[...Ac(e.columnTypes),...Ac(t.columnTypes)]),r}function R0(e,t,r){return t?t.baseDataType!==e.baseDataType?(oe(46),!1):!0:(oe(45,{parentCellDataType:r}),!1)}function E0(e,t){if(e.valueFormatter)return r=>{var s,i;if((s=r.node)!=null&&s.group){const n=(r.colDef.pivotValueColumn??r.column).getAggFunc();if(n){if(n==="first"||n==="last")return e.valueFormatter(r);if(e.baseDataType==="number"&&n!=="count"){if(typeof r.value=="number")return e.valueFormatter(r);if(typeof r.value=="object"){if(!r.value)return;if("toNumber"in r.value)return e.valueFormatter({...r,value:r.value.toNumber()});if("value"in r.value)return e.valueFormatter({...r,value:r.value.value})}}return}}else if(t.get("groupHideOpenParents")&&r.column.isRowGroupActive()&&typeof r.value=="string"&&!((i=e.dataTypeMatcher)!=null&&i.call(e,r.value)))return;return e.valueFormatter(r)}}function s_(e,t,r,s){if(!t[r])return!1;const i=e[r];return i===null?(t[r]=!1,!1):s===void 0?!!i:i===s}function Ed(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([r,s])=>s_(e,t,r,s))}function i_(e,t){const r=sw(e);for(const s of t)delete r[s],s==="rowGroup"?delete r.rowGroupIndex:s==="pivot"&&delete r.pivotIndex;return r}var n_={moduleName:"DataType",version:we,beans:[r_],dependsOn:[DM]},o_={moduleName:"ColumnFlex",version:we,beans:[e_]},lx={moduleName:"ColumnApi",version:we,beans:[QM],apiFunctions:{getColumnDef:IM,getDisplayNameForColumn:_M,getColumn:LM,getColumns:OM,applyColumnState:NM,getColumnState:BM,resetColumnState:HM,isPinning:VM,isPinningLeft:GM,isPinningRight:WM,getDisplayedColAfter:zM,getDisplayedColBefore:UM,setColumnsVisible:jM,setColumnsPinned:$M,getAllGridColumns:KM,getDisplayedLeftColumns:qM,getDisplayedCenterColumns:XM,getDisplayedRightColumns:YM,getAllDisplayedColumns:JM,getAllDisplayedVirtualColumns:ZM,getColumnDefs:MM}};function a_(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,r=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(r,"$1 $2$3").replace(/\./g," ").split(" ").map(i=>i.substring(0,1).toUpperCase()+(i.length>1?i.substring(1,i.length):"")).join(" ")}var l_=class extends ee{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,r=!1){if(!e)return null;const s=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:i}=this.beans;return r&&i?i.getHeaderName(e,s):s}getDisplayNameForProvidedColumnGroup(e,t,r){const s=t==null?void 0:t.getColGroupDef();return s?this.getHeaderName(s,null,e,t,r):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,r,s,i){var o;const n=e.headerValueGetter;if(n){const a=ke(this.gos,{colDef:e,column:t,columnGroup:r,providedColumnGroup:s,location:i});return typeof n=="function"?n(a):typeof n=="string"?((o=this.beans.expressionSvc)==null?void 0:o.evaluate(n,a))??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return a_(e.field)}return""}},c_=class extends ee{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,r=!1){const{visibleCols:s}=this,i=s.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!i)){if(this.scrollWidth=e,this.scrollPosition=t,s.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const o=s.bodyWidth;this.viewportLeft=o-t-e,this.viewportRight=o-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(r)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let r;switch(e){case"left":r=this.rowsOfHeadersToRenderLeft[t];break;case"right":r=this.rowsOfHeadersToRenderRight[t];break;default:r=this.rowsOfHeadersToRenderCenter[t];break}return r??[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||u_(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,r=t+e.getActualWidth(),s=this.viewportLeft-200,i=this.viewportRight+200,n=t<s&&r<s,o=t>i&&r>i;return!n&&!o}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=n=>{const o=n.getLeft();return Ce(o)&&o>this.viewportLeft},r=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:s}=this,i=s.centerCols;return s.getColsForRow(e,i,r,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){const{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;const r=s=>{const i=new Set,n={};for(const o of s){let a=o.getParent();const l=o.isSpanHeaderHeight();for(;a&&!i.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}const u=a.getProvidedColumnGroup().getLevel();n[u]??(n[u]=[]),n[u].push(a),i.add(a),a=a.getParent()}}return n};this.rowsOfHeadersToRenderLeft=r(e),this.rowsOfHeadersToRenderRight=r(t),this.rowsOfHeadersToRenderCenter=r(this.headerColsWithinViewport)}extractViewport(){const e=s=>`${s.getId()}-${s.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),r=this.colsWithinViewportHash!==t;return r&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),r}};function u_(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var d_=class extends ee{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class r{refresh(){return!1}getGui(){return this.eGui}init(i){const n=t(i),o=typeof n;if(o==="string"||o==="number"||o==="boolean"){this.eGui=wf("<span>"+n+"</span>");return}if(n==null){this.eGui=jr({tag:"span"});return}this.eGui=n}}return r}},h_={moduleName:"CellRendererFunction",version:we,beans:[d_]},f_=class extends WP{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(e!=null)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:r,dynamicBeans:s,selectors:i}=e;if(r){const n=(o,a,l,c)=>{this.agGridDefaults[o]=a,(l||c)&&(this.agGridDefaultOverrides[o]={params:l,processParams:c})};for(const o of Object.keys(r)){let a=r[o];if(Dk(a)&&(a=a.getComp(this.beans)),typeof a=="object"){const{classImp:l,params:c,processParams:u}=a;n(o,l,c,u)}else n(o,a)}}this.registerDynamicBeans(s);for(const n of i??[])this.selectors[n.selector]=n;if(t)for(const n of Object.keys(t))this.icons[n]=t[n]}getUserComponent(e,t){var a;const r=(l,c,u,d)=>({componentFromFramework:c,component:l,params:u,processParams:d}),{frameworkOverrides:s}=this.beans,i=s.frameworkComponent(t,this.gos.get("components"));if(i!=null)return r(i,!0);const n=this.jsComps[t];if(n){const l=s.isFrameworkComponent(n);return r(n,l)}const o=this.agGridDefaults[t];if(o){const l=this.agGridDefaultOverrides[t];return r(o,!1,l==null?void 0:l.params,l==null?void 0:l.processParams)}return(a=this.beans.validation)==null||a.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){var r;return t?Rs(279,{name:e}):((r=this.beans.validation)==null?void 0:r.missingDynamicBean(e))??Rs(256)}},g_=23,p_=class extends ee{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){var e,t;this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(const r of this.readyCallbacks)r(this.params);this.readyCallbacks.length=0}},((t=(e=this.beans.frameworkOverrides).runWhenReadyAsync)==null?void 0:t.call(e))??!1)}updateReady(){const e=Object.values(this.params);this.ready=e.length===g_&&e.every(t=>(t==null?void 0:t.isAlive())??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const r=this.readyCallbacks.indexOf(t);r>=0&&this.readyCallbacks.splice(r,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:r}=this.params;return[e,r,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},m_='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}.ag-drag-handle-disabled{opacity:.35;pointer-events:none}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-row-drag-indicator-color);border-radius:calc(var(--ag-row-drag-indicator-width)/2);content:"";height:var(--ag-row-drag-indicator-width);pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-exporting-wrapper,.ag-overlay-loading-wrapper,.ag-overlay-modal-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label,:where(.ag-header-group-cell-selectable) .ag-header-cell-comp-wrapper{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{color:var(--ag-subtle-text-color)}}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{margin-right:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{margin-left:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{color:var(--ag-subtle-text-color)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{margin-left:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{margin-right:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-column-drag-indicator-color);border-radius:calc(var(--ag-column-drag-indicator-width)/2);content:"";height:100%;position:absolute;top:0;width:var(--ag-column-drag-indicator-width)}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}:where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}}:where(.ag-ltr) :where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){&:after{right:-1px}}:where(.ag-rtl) :where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){&:after{left:-1px}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',v_={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:mr,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Os,rangeSelectionBackgroundColor:ms(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:ms(.5),rangeHeaderHighlightColor:yP(.08),rowNumbersSelectedColor:ms(.5),rowHoverColor:ms(.08),columnHoverColor:ms(.05),selectedRowBackgroundColor:ms(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:mr,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:Or(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:Or(.1),iconButtonActiveColor:Os,iconButtonActiveBackgroundColor:ms(.28),iconButtonActiveIndicatorColor:Os,menuBorder:{color:Or(.2)},menuBackgroundColor:Gr(.03),menuTextColor:Gr(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:Or(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Os},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:Or(.2)},panelBackgroundColor:mr,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:Or(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:Or(.13)},selectCellBackgroundColor:Or(.07),selectCellBorder:{color:Or(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:mr,filterPanelApplyButtonBackgroundColor:Os,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:Bn,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:Bn,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:Or(.15),statusBarLabelColor:Bn,statusBarLabelFontWeight:500,statusBarValueColor:Bn,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"},rowDragIndicatorColor:{ref:"rangeSelectionBorderColor"},rowDragIndicatorWidth:2,columnDragIndicatorColor:{ref:"accentColor"},columnDragIndicatorWidth:2},C_=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",cx={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},w_={...cx,cellBatchEditTextColor:"#f3d0b3"},x_=()=>Ts({feature:"batchEditStyle",params:cx,css:C_}),y_=x_(),S_=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",b_={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},F_=()=>Ts({feature:"buttonStyle",params:{...b_,buttonBackgroundColor:mr,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Os}},css:S_}),R_=F_(),E_=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}",T_=()=>Ts({feature:"columnDropStyle",css:E_}),ux=T_(),k_={warn:(...e)=>{oe(e[0],e[1])},error:(...e)=>{Qe(e[0],e[1])},preInitErr:(...e)=>{zo(e[0],e[2],e[1])}},P_=()=>IP(k_).withParams(v_).withPart(R_).withPart(ux).withPart(y_),D_='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',A_=()=>Ts({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:mr,checkboxUncheckedBorderColor:Gr(.3),checkboxCheckedBackgroundColor:Os,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:mr,checkboxIndeterminateBackgroundColor:Gr(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:mr,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:D_}),I_=A_(),dx=()=>({...Lc,...w_,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:Gr(.05),rowHoverColor:ms(.15),selectedRowBackgroundColor:ms(.2),menuBackgroundColor:Gr(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:Bn,findMatchColor:mr,findActiveMatchColor:mr,checkboxUncheckedBorderColor:Gr(.4),toggleButtonOffBackgroundColor:Gr(.4),rowBatchEditBackgroundColor:Gr(.1)}),M_=()=>({...dx(),backgroundColor:"#1f2836"}),__=()=>Ts({feature:"colorScheme",params:Lc,modeParams:{light:Lc,dark:dx(),"dark-blue":M_()}}),L_=__(),hx={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>'},fx={aasc:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.2012 8.07928C13.6346 8.0793 14.0128 8.15365 14.3359 8.30193C14.6609 8.45018 14.9141 8.65595 15.0947 8.9201C15.2754 9.18439 15.3683 9.49109 15.374 9.83904H14.1904C14.1676 9.60898 14.0695 9.4303 13.8965 9.30291C13.7235 9.1756 13.4889 9.1115 13.1924 9.1115C12.9909 9.1115 12.8204 9.1404 12.6816 9.19744C12.543 9.25255 12.4364 9.32917 12.3623 9.42791C12.2901 9.52678 12.2539 9.63933 12.2539 9.76482C12.2501 9.8692 12.272 9.9604 12.3193 10.0383C12.3688 10.1162 12.4369 10.1843 12.5225 10.2414C12.6079 10.2964 12.7064 10.3451 12.8184 10.3869C12.9304 10.4268 13.0505 10.4609 13.1777 10.4894L13.7031 10.6144C13.9578 10.6715 14.1914 10.7479 14.4043 10.8429C14.6173 10.938 14.8021 11.0547 14.958 11.1935C15.1138 11.3323 15.2348 11.4957 15.3203 11.6838C15.4077 11.8719 15.4522 12.088 15.4541 12.3312C15.4522 12.6885 15.3611 12.9986 15.1807 13.2609C15.0019 13.5214 14.7427 13.7248 14.4043 13.8693C14.0678 14.0118 13.6617 14.0832 13.1865 14.0832C12.7153 14.0832 12.3048 14.0107 11.9551 13.8664C11.6071 13.7219 11.3345 13.5071 11.1387 13.2238C10.9449 12.9387 10.8435 12.5862 10.834 12.1662H12.0283C12.0416 12.362 12.0984 12.5252 12.1973 12.6564C12.298 12.7857 12.4323 12.8838 12.5996 12.9504C12.7688 13.0149 12.96 13.047 13.1729 13.047C13.3817 13.047 13.563 13.0169 13.7168 12.9562C13.8727 12.8954 13.9935 12.8106 14.0791 12.7023C14.1647 12.5939 14.208 12.469 14.208 12.3283C14.2079 12.1974 14.1686 12.0875 14.0908 11.9982C14.0148 11.9089 13.9022 11.8324 13.7539 11.7697C13.6076 11.707 13.4276 11.6501 13.2148 11.5988L12.5791 11.4387C12.0869 11.3189 11.6982 11.1318 11.4131 10.8771C11.128 10.6224 10.9855 10.2793 10.9873 9.84783C10.9854 9.49418 11.0804 9.18439 11.2705 8.9201C11.4625 8.65603 11.7261 8.45015 12.0605 8.30193C12.3951 8.15369 12.7754 8.07928 13.2012 8.07928Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5.8125 14.0002H4.48926L4.05664 12.6681H1.94824L1.51465 14.0002H0.19043L2.20703 8.15935H3.79883L5.8125 14.0002ZM2.26172 11.7043H3.74316L3.02539 9.49334H2.98047L2.26172 11.7043Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8.45215 8.15935C8.88165 8.15935 9.24031 8.22251 9.52734 8.34978C9.81445 8.47717 10.0303 8.65477 10.1748 8.88103C10.3192 9.10536 10.3916 9.36368 10.3916 9.65642C10.3916 9.88452 10.3461 10.085 10.2549 10.258C10.1637 10.4289 10.0384 10.5696 9.87891 10.6799C9.72117 10.7882 9.54024 10.8657 9.33691 10.9113V10.9679C9.55917 10.9775 9.76716 11.0406 9.96094 11.1564C10.1568 11.2724 10.3158 11.4356 10.4375 11.6447C10.5591 11.8519 10.6201 12.099 10.6201 12.3859C10.6201 12.6958 10.5427 12.9727 10.3887 13.216C10.2366 13.4573 10.0113 13.6486 9.71289 13.7892C9.41443 13.9299 9.04655 14.0002 8.60938 14.0002H6.11426V8.15935H8.45215ZM7.34863 12.9904H8.35547C8.69943 12.9904 8.95057 12.9252 9.1084 12.7941C9.26621 12.661 9.34473 12.4834 9.34473 12.2629C9.34468 12.1014 9.30643 11.9587 9.22852 11.8351C9.15056 11.7116 9.03903 11.6145 8.89453 11.5441C8.75195 11.4738 8.58148 11.4387 8.38379 11.4387H7.34863V12.9904ZM7.34863 10.6037H8.26465C8.43369 10.6036 8.58376 10.5737 8.71484 10.5148C8.84793 10.454 8.95227 10.3683 9.02832 10.258C9.10628 10.1477 9.14551 10.0155 9.14551 9.8615C9.14546 9.65055 9.07008 9.48001 8.91992 9.35076C8.77165 9.22169 8.56064 9.15741 8.28711 9.1574H7.34863V10.6037Z" fill="black"/><path d="M7.16602 0.377127C7.44584 0.189493 7.82551 0.20905 8.08496 0.442557L11.418 3.44256C11.7257 3.71966 11.7507 4.19428 11.4736 4.50213C11.1966 4.80961 10.7228 4.83441 10.415 4.55779L7.60938 2.03338L5.11328 4.53045C4.82042 4.82326 4.34562 4.82322 4.05273 4.53045C3.75986 4.23757 3.75989 3.7628 4.05273 3.4699L7.05273 0.4699L7.16602 0.377127Z" fill="black"/></svg>',adesc:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.3867 11.4697C10.6796 11.1771 11.1544 11.1769 11.4473 11.4697C11.7399 11.7626 11.7399 12.2374 11.4473 12.5303L8.44727 15.5303L8.33398 15.623C8.05425 15.8106 7.67449 15.7909 7.41504 15.5576L4.08203 12.5576C3.77415 12.2805 3.74927 11.8059 4.02637 11.498C4.30342 11.1907 4.77722 11.1657 5.08496 11.4424L7.89062 13.9668L10.3867 11.4697Z" fill="black"/><path d="M13.2012 3.0791C13.6346 3.07912 14.0128 3.1535 14.3359 3.30176C14.6611 3.45006 14.9141 3.65661 15.0947 3.9209C15.2752 4.18513 15.3683 4.49104 15.374 4.83887H14.1904C14.1676 4.60882 14.0695 4.43012 13.8965 4.30273C13.7235 4.17546 13.4889 4.11133 13.1924 4.11133C12.9909 4.11133 12.8204 4.14023 12.6816 4.19727C12.5431 4.25236 12.4364 4.32902 12.3623 4.42773C12.2901 4.52659 12.2539 4.63919 12.2539 4.76465C12.2501 4.86901 12.272 4.96023 12.3193 5.03809C12.3688 5.11604 12.4369 5.18417 12.5225 5.24121C12.6079 5.29623 12.7064 5.34496 12.8184 5.38672C12.9304 5.42661 13.0505 5.46075 13.1777 5.48926L13.7031 5.61426C13.9578 5.67128 14.1914 5.74776 14.4043 5.84277C14.6172 5.93784 14.8021 6.05457 14.958 6.19336C15.1139 6.33216 15.2348 6.49633 15.3203 6.68457C15.4076 6.8727 15.4522 7.08885 15.4541 7.33203C15.4521 7.68929 15.3612 7.99944 15.1807 8.26172C15.0019 8.52216 14.7427 8.72465 14.4043 8.86914C14.0678 9.01165 13.6617 9.08301 13.1865 9.08301C12.7153 9.08299 12.3048 9.01057 11.9551 8.86621C11.6072 8.72173 11.3345 8.50786 11.1387 8.22461C10.9447 7.9394 10.8435 7.58622 10.834 7.16602H12.0283C12.0416 7.36176 12.0985 7.52509 12.1973 7.65625C12.298 7.78554 12.4323 7.88365 12.5996 7.9502C12.7688 8.01477 12.96 8.04785 13.1729 8.04785C13.3817 8.04781 13.5629 8.01678 13.7168 7.95605C13.8727 7.89522 13.9935 7.81051 14.0791 7.70215C14.1646 7.59387 14.2079 7.46965 14.208 7.3291C14.208 7.19796 14.1687 7.08739 14.0908 6.99805C14.0148 6.90868 13.9022 6.83228 13.7539 6.76953C13.6076 6.70685 13.4276 6.64993 13.2148 6.59863L12.5791 6.43848C12.0868 6.31871 11.6982 6.13163 11.4131 5.87695C11.1279 5.62221 10.9855 5.27916 10.9873 4.84766C10.9854 4.49404 11.0804 4.18517 11.2705 3.9209C11.4625 3.65661 11.7259 3.45006 12.0605 3.30176C12.3951 3.15353 12.7754 3.0791 13.2012 3.0791Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5.8125 9H4.48926L4.05664 7.66797H1.94824L1.51465 9H0.19043L2.20703 3.15918H3.79883L5.8125 9ZM2.26172 6.7041H3.74316L3.02539 4.49414H2.98047L2.26172 6.7041Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8.45215 3.15918C8.88181 3.15918 9.24025 3.22322 9.52734 3.35059C9.81445 3.47798 10.0303 3.6546 10.1748 3.88086C10.3193 4.10518 10.3916 4.36351 10.3916 4.65625C10.3916 4.88432 10.3461 5.08484 10.2549 5.25781C10.1636 5.4289 10.0386 5.57039 9.87891 5.68066C9.72118 5.78898 9.54022 5.86549 9.33691 5.91113V5.96875C9.55913 5.9783 9.76719 6.04044 9.96094 6.15625C10.1568 6.27223 10.3158 6.43538 10.4375 6.64453C10.5591 6.85173 10.6201 7.09875 10.6201 7.38574C10.6201 7.69567 10.5427 7.97245 10.3887 8.21582C10.2366 8.45719 10.0113 8.64841 9.71289 8.78906C9.41442 8.9297 9.04658 8.99999 8.60938 9H6.11426V3.15918H8.45215ZM7.34863 7.99023H8.35547C8.69948 7.99023 8.95057 7.92504 9.1084 7.79395C9.26621 7.66085 9.34473 7.48325 9.34473 7.2627C9.34466 7.10125 9.3064 6.95844 9.22852 6.83496C9.15056 6.71143 9.03899 6.61427 8.89453 6.54395C8.75196 6.47365 8.58145 6.43848 8.38379 6.43848H7.34863V7.99023ZM7.34863 5.60352H8.26465C8.43369 5.60347 8.58376 5.57354 8.71484 5.51465C8.84791 5.45381 8.95228 5.36807 9.02832 5.25781C9.10623 5.14755 9.14551 5.01529 9.14551 4.86133C9.14542 4.65046 9.07002 4.48078 8.91992 4.35156C8.77163 4.22228 8.56087 4.15724 8.28711 4.15723H7.34863V5.60352Z" fill="black"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>'},O_=(e={})=>{let t="";for(const r of[...Object.keys(hx),...Object.keys(fx)]){const s=N_(r,e.strokeWidth);t+=`.ag-icon-${r}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(s)}'); }
`}return t},N_=(e,t=1.5)=>{const r=fx[e];if(r)return r;const s=hx[e];if(!s)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+s+"</svg>"},B_=(e={})=>Ts({feature:"iconSet",css:()=>O_(e)}),H_=B_(),V_=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',G_=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}",W_={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4},z_=()=>Ts({feature:"inputStyle",params:{...W_,inputBackgroundColor:mr,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Os},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:Gr(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>V_+G_}),U_=z_(),j_='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',$_={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},K_=()=>Ts({feature:"tabStyle",params:{...$_,tabBarBorder:!0,tabBarBackgroundColor:Or(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:mr},css:j_}),q_=K_(),X_=()=>P_().withPart(I_).withPart(L_).withPart(H_).withPart(q_).withPart(U_).withPart(ux).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),Y_=X_(),J_={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},Z_={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},Q_={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},T0={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},k0={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},Td={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},P0={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function eL(e,t){for(const r of t.sort((s,i)=>s.moduleName.localeCompare(i.moduleName))){const s=r.css;s&&e.set(`module-${r.moduleName}`,s)}}var tL=class extends VP{initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(T0),this.getSizeEl(k0),this.getSizeEl(Td),this.getSizeEl(P0),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(P0)}getRowBorderWidth(){return this.getCSSVariablePixelValue(Td)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(T0)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(k0)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(J_)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(Z_),r=this.getCSSVariablePixelValue(Q_);return e-1+r*t}getCellPadding(){const e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}refreshRowHeightVariable(){const{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),r=this.gos.get("rowHeight");if(r==null||isNaN(r)||!isFinite(r))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;const s=`${r}px`;return t!=s?(e.style.setProperty("--ag-line-height",s),r):t!=""?Number.parseFloat(t):-1}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),super.fireStylesChangedEvent(e)}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue(Td);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&Qe(t?106:239)}getAdditionalCss(){const e=new Map;return e.set("core",[m_]),eL(e,Array.from(ZT())),e}getDefaultTheme(){return Y_}varError(e){oe(9,{variable:e})}themeError(e){Qe(240,{theme:e})}shadowRootError(){Qe(293)}},rL=class extends zP{postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function gx(e,t,r){const s=e.visibleCols.headerGroupRowCount;if(r>=s)return{column:t,headerRowIndex:r};let i=t.getParent();for(;i&&i.getProvidedColumnGroup().getLevel()>r;)i=i.getParent();const n=t.isSpanHeaderHeight();return!i||n&&i.isPadding()?{column:t,headerRowIndex:s}:{column:i,headerRowIndex:i.getProvidedColumnGroup().getLevel()}}var sL=class extends ee{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,r=>{this.gridBodyCon=r.gridBodyCtrl});const t=Gt(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let r;const{colModel:s,colGroupSvc:i,ctrlsSvc:n}=this.beans;if(typeof e=="string"?(r=s.getCol(e),r||(r=(i==null?void 0:i.getColumnGroup(e))??null)):r=e,!r)return null;const o=n.getHeaderRowContainerCtrl(),a=o==null?void 0:o.getAllCtrls(),l=nt(a||[]).type==="filter",c=ys(this.beans)-1;let u=-1,d=r;for(;d;)u++,d=d.getParent();let h=u;return t&&l&&h===c-1&&h++,h===-1?null:{headerRowIndex:h,column:r}}navigateVertically(e,t){const{focusSvc:r,visibleCols:s}=this.beans,{focusedHeader:i}=r;if(!i)return!1;const{headerRowIndex:n}=i,o=i.column,a=ys(this.beans),l=this.getHeaderRowType(n),c=s.headerGroupRowCount;let{headerRowIndex:u,column:d,headerRowIndexWithoutSpan:h}=e==="UP"?iL(l,o,n):nL(o,n,c),f=!1;return u<0&&(u=0,d=o,f=!0),u>=a?(u=-1,this.currentHeaderRowWithoutSpan=-1):h!==void 0&&(this.currentHeaderRowWithoutSpan=h),!f&&!d?!1:r.focusHeaderPosition({headerPosition:{headerRowIndex:u,column:d},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,r){const{focusSvc:s,gos:i}=this.beans,n={...s.focusedHeader};let o,a;this.currentHeaderRowWithoutSpan!==-1?n.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=n.headerRowIndex,e==="LEFT"!==i.get("enableRtl")?(a="Before",o=this.findHeader(n,a)):(a="After",o=this.findHeader(n,a));const l=i.getCallback("tabToNextHeader");if(t&&l){const c=s.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a});if(c){const{headerRowIndex:u}=s.focusedHeader||{};u!=null&&u!=n.headerRowIndex&&(this.currentHeaderRowWithoutSpan=u)}return c}return o||!t?s.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:r}):this.focusNextHeaderRow(n,a,r)}focusNextHeaderRow(e,t,r){const s=this.beans,i=e.headerRowIndex;let n=null,o;const a=ys(s),l=this.beans.visibleCols.allCols;if(t==="Before"){if(i<=0)return!1;n=nt(l),o=i-1,this.currentHeaderRowWithoutSpan-=1}else n=l[0],o=i+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:c,headerRowIndex:u}=gx(this.beans,n,o);return u>=a&&(u=-1),s.focusSvc.focusHeaderPosition({headerPosition:{column:c,headerRowIndex:u},direction:t,fromTab:!0,allowUserOverride:!0,event:r})}scrollToColumn(e,t="After"){if(e.getPinned())return;let r;if(kt(e)){const s=e.getDisplayedLeafColumns();r=t==="Before"?nt(s):s[0]}else r=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(r)}findHeader(e,t){const{colGroupSvc:r,visibleCols:s}=this.beans;let i=e.column;if(i instanceof Ra){const l=i.getDisplayedLeafColumns();i=t==="Before"?l[0]:l[l.length-1]}const n=t==="Before"?s.getColBefore(i):s.getColAfter(i);if(!n)return;const o=s.headerGroupRowCount;if(e.headerRowIndex>=o)return{headerRowIndex:e.headerRowIndex,column:n};const a=r==null?void 0:r.getColGroupAtLevel(n,e.headerRowIndex);return a?a.isPadding()&&n.isSpanHeaderHeight()?{headerRowIndex:s.headerGroupRowCount,column:n}:{headerRowIndex:e.headerRowIndex,column:a??n}:{headerRowIndex:n instanceof xn&&n.isSpanHeaderHeight()?s.headerGroupRowCount:e.headerRowIndex,column:n}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function iL(e,t,r){const s=r-1;if(e!=="filter"){const i=t instanceof xn&&t.isSpanHeaderHeight();let n=t.getParent();for(;n&&(n.getProvidedColumnGroup().getLevel()>s||i&&n.isPadding());)n=n.getParent();if(n)return i?{column:n,headerRowIndex:n.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:s}:{column:n,headerRowIndex:s,headerRowIndexWithoutSpan:s}}return{column:t,headerRowIndex:s,headerRowIndexWithoutSpan:s}}function nL(e,t,r){const s=t+1,i={column:e,headerRowIndex:s,headerRowIndexWithoutSpan:s};if(e instanceof Ra){if(s>=r)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:r,headerRowIndexWithoutSpan:s};let o=e.getDisplayedChildren()[0];if(o instanceof Ra&&o.isPadding()){const l=o.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(o=l)}i.column=o,o instanceof xn&&o.isSpanHeaderHeight()&&(i.headerRowIndex=r,i.headerRowIndexWithoutSpan=s)}return i}var oL=class extends ee{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(Gk(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(pt(this.beans),Jw)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){const e=pt(this.beans);return this.isDomDataPresentInHierarchy(e,Oc)?!0:this.isDomDataPresentInHierarchy(e,Nc)}isDomDataPresentInHierarchy(e,t){let r=e;for(;r;){if(BC(this.gos,r,t))return!0;r=r.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:r,column:s}=e,i={rowIndex:t,rowPinned:r,column:s,isFullWidthCell:!1},n=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r});return n&&(i.isFullWidthCell=n.isFullWidth()),i}clearFocusedCell(){if(this.focusedCell==null)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:r,rowPinned:s,forceBrowserFocus:i=!1,preventScrollOnBrowserFocus:n=!1,sourceEvent:o}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:r,rowPinned:Vs(s),column:a};const l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent({type:"cellFocused",...l,...this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams},forceBrowserFocus:i,preventScrollOnBrowserFocus:n,sourceEvent:o}),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:$f(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;const{column:t,rowCtrl:{rowIndex:r,pinned:s}}=e,{column:i,headerRowIndex:n}=this.focusedHeader;return t===i&&r===n&&s==i.getPinned()}focusHeaderPosition(e){var c;if(this.setFocusRecovered(),Yi(this.beans))return!1;const{direction:t,fromTab:r,allowUserOverride:s,event:i,fromCell:n,rowWithoutSpanValue:o,scroll:a=!0}=e;let{headerPosition:l}=e;if(n&&((c=this.filterManager)!=null&&c.isAdvFilterHeaderActive()))return this.focusAdvancedFilter(l);if(s){const u=this.focusedHeader,d=ys(this.beans);if(r){const h=this.gos.getCallback("tabToNextHeader");h&&(l=this.getHeaderPositionFromUserFunc({userFunc:h,direction:t,currentPosition:u,headerPosition:l,headerRowCount:d}))}else{const h=this.gos.getCallback("navigateToNextHeader");if(h&&i){const f={key:i.key,previousHeaderPosition:u,nextHeaderPosition:l,headerRowCount:d,event:i};l=h(f)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:i,fromCell:n,rowWithoutSpanValue:o,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(Yi(this.beans))return!1;const{userFunc:t,headerPosition:r,direction:s,event:i}=e,n=this.focusedHeader,o=ys(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:s,currentPosition:n,headerPosition:r,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:s,event:i})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:r,currentPosition:s,headerPosition:i,headerRowCount:n}=e,a=t({backwards:r==="Before",previousHeaderPosition:s,nextHeaderPosition:i,headerRowCount:n});return a===!0?s:a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:r,fromCell:s,rowWithoutSpanValue:i,event:n,scroll:o=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:c,ctrlsSvc:u,headerNavigation:d}=this.beans;if(this.focusedHeader&&pA(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return c!=null&&c.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:n});o&&(d==null||d.scrollToColumn(a,r));const h=u.getHeaderRowContainerCtrl(a.getPinned()),f=(h==null?void 0:h.focusHeader(t.headerRowIndex,a,n))||!1;return d&&f&&(i!=null||s)&&(d.currentHeaderRowWithoutSpan=i??-1),f}focusFirstHeader(){var r;if((r=this.overlays)!=null&&r.exclusive&&this.focusOverlay())return!0;const e=this.visibleCols.allCols[0];if(!e)return!1;const t=gx(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){var s;if((s=this.overlays)!=null&&s.exclusive&&this.focusOverlay(!0))return!0;const t=ys(this.beans)-1,r=nt(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:r},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){var t;return(t=this.filterManager)!=null&&t.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===Vs(t)}focusOverlay(e){var r,s;const t=((r=this.overlays)==null?void 0:r.isVisible())&&((s=this.overlays.eWrapper)==null?void 0:s.getGui());return!!t&&ln(t,e)}focusGridView(e){var n,o,a,l,c,u;const{backwards:t=!1,canFocusOverlay:r=!0,event:s}=e;if((n=this.overlays)!=null&&n.exclusive)return r&&this.focusOverlay(t);if(Fu(this.beans))return t&&!Yi(this.beans)?this.focusLastHeader():r&&this.focusOverlay(t)?!0:t?!1:fo(this.beans,t);const i=t?oA(this.beans):nA(this.beans);if(i){const d=e.column??((o=this.focusedHeader)==null?void 0:o.column),{rowIndex:h,rowPinned:f}=i,p=Ys(this.beans,i);if(!d||!p||h==null)return!1;if(d.isSuppressNavigable(p)){const g=this.gos.get("enableRtl");let m;return!s||s.key===K.TAB?m=g?K.LEFT:K.RIGHT:m=s.key,(a=this.beans.navigation)==null||a.navigateToNextCell(null,m,{rowIndex:h,column:d,rowPinned:f||null},!0),!0}if((l=this.navigation)==null||l.ensureCellVisible({rowIndex:h,column:d,rowPinned:f}),t){const g=this.rowRenderer.getRowByPosition(i);if(g!=null&&g.isFullWidth()&&((c=this.navigation)!=null&&c.tryToFocusFullWidthRow(i,t)))return!0}return this.setFocusedCell({rowIndex:h,column:d,rowPinned:Vs(f),forceBrowserFocus:!0}),(u=this.beans.rangeSvc)==null||u.setRangeToCell({rowIndex:h,rowPinned:f,column:d}),!0}return!!(r&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){var t;return this.advFilterFocusColumn=e==null?void 0:e.column,((t=this.beans.advancedFilter)==null?void 0:t.getCtrl().focusHeaderComp())??!1}focusNextFromAdvancedFilter(e,t){var s;const r=(t?void 0:this.advFilterFocusColumn)??((s=this.visibleCols.allCols)==null?void 0:s[0]);return e?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:ys(this.beans)-1}}):this.focusGridView({column:r})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},aL=class extends ee{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e!=null&&e.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){var r;const e=this.ctrlsSvc.get("center");if(!e||(r=this.colAnimation)!=null&&r.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),r=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==r)&&(this.horizontalScrollGap=t,this.verticalScrollGap=r,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=this.gos.get("scrollbarWidth"),r=typeof e=="number"&&e>=0?e:Bk();r!=null&&(this.scrollbarWidth=r,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},lL=class extends ee{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){var s;if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:r}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:(e==null?void 0:e.getState())??{}}),this.destroyCalled=!0,(s=t.get("gridCtrl"))==null||s.destroyGridUi(),r.destroy(),super.destroy()}},nc=new Set(["gridPreDestroyed","fillStart","pasteStart"]),cL=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"],Jf=cL.reduce((e,t)=>(e[t]=y2(t),e),{}),eo={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agExportingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agNoMatchingRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function D0(e){return`"${e}"`}var uL=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),dL={allowFormula:"Formula",aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?eo[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:eo[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?eo[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{var r;const t=["columnsMenuTab","generalMenuTab"];return(r=e.menuTabs)!=null&&r.some(s=>t.includes(s))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},hL=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:r})=>r?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},allowFormula:{supportedRowModels:["clientSide"]},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,r)=>r.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{const r=t.headerValueGetter;return typeof r=="function"||typeof r=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return Rs(262);if(t.smallLeft)return Rs(263);if(t.smallRight)return Rs(264)}return null}},sort:{validate:t=>Xn(t.sort)||pi(t.sort)?null:`sort must be of type (SortDirection | SortDef), currently it is ${typeof t.sort=="object"?JSON.stringify(t.sort):Xl(t.sort)}`},initialSort:{validate:t=>Xn(t.initialSort)||pi(t.initialSort)?null:`initialSort must be of non-null type (SortDirection | SortDef), currently it is ${typeof t.initialSort=="object"?JSON.stringify(t.initialSort):Xl(t.initialSort)}`},sortingOrder:{validate:t=>{const r=t.sortingOrder;if(Array.isArray(r)&&r.length>0){const s=r.filter(i=>!(Xn(i)||pi(i)));if(s.length>0)return`sortingOrder must be an array of type non-null (SortDirection | SortDef)[], incorrect items are: [${s.map(i=>typeof i=="string"||i==null?Xl(i):JSON.stringify(i)).join(", ")}]`}else if(!Array.isArray(r)||!r.length)return`sortingOrder must be an array with at least one element, currently it is [${r}]`;return null}},type:{validate:t=>{const r=t.type;return r instanceof Array?r.some(i=>typeof i!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof r=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:r})=>r?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:r,cellSelection:s,suppressRowTransform:i,enableCellSpan:n,rowDragEntireRow:o,enableCellTextSelection:a})=>typeof r=="object"&&(r==null?void 0:r.mode)==="singleRow"&&r!=null&&r.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":s?"colDef.spanRows is not supported with cellSelection.":i?"colDef.spanRows is not supported with suppressRowTransform.":n?o?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:r={}},s){var o;const i=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),n=[];for(const a of t.groupHierarchy??[]){if(typeof a=="object"){(o=s.validation)==null||o.validateColDef(a);continue}!i.has(a)&&!(a in r)&&n.push(D0(a))}if(n.length>0){const a=`The following parts of colDef.groupHierarchy are not recognised: ${n.join(", ")}.`,l=`Choose one of ${[...i].map(D0).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${a}
${l}`}return null}}}),fL={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0,allowFormula:void 0},gL=()=>Object.keys(fL),pL=()=>({objectName:"colDef",allProperties:gL(),docsUrl:"column-properties/",deprecations:uL(),validations:hL()}),mL=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],vL=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","overlayComponentParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","activeOverlayParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","formulaDataSource","formulaFuncs","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],CL=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector","suppressOverlays"],px=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],wL=["theme","rowSelection"],xL=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],mx=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","refreshAfterGroupEdit","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows","animateColumnResizing"],yL=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","overlayComponent","loadingOverlayComponent","noRowsOverlayComponent","overlayComponentSelector","activeOverlay","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],SL=()=>[...CL,...vL,...mL,...px,...yL,...mx,...xL,...wL],bL=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function us(e,t,r){return typeof t=="number"||t==null?t==null||t>=r?null:`${e}: value should be greater than or equal to ${r}`:`${e}: value should be a number`}var FL={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",refreshAfterGroupEdit:["RowGrouping","TreeData"],rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},RL=()=>{const e={autoSizePadding:{validate({autoSizePadding:r}){return us("autoSizePadding",r,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:r}){return us("cacheBlockSize",r,1)}},cacheOverflowSize:{validate({cacheOverflowSize:r}){return us("cacheOverflowSize",r,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:r=>{const s=r.domLayout,i=["autoHeight","normal","print"];return s&&!i.includes(s)?`domLayout must be one of [${i.join()}], currently it's ${s}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,pinnedTopRowData:s,pinnedBottomRowData:i}){return r&&(s||i)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,isRowPinnable:s,pinnedTopRowData:i,pinnedBottomRowData:n}){return s&&(i||n)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!r&&s?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,isRowPinned:s,pinnedTopRowData:i,pinnedBottomRowData:n}){return s&&(i||n)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!r&&s?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:r={}},s,i){var n;for(const o of Object.keys(r))(n=i.validation)==null||n.validateColDef(r[o]);return null}},icons:{validate:({icons:r})=>{if(r){if(r.smallDown)return Rs(262);if(r.smallLeft)return Rs(263);if(r.smallRight)return Rs(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:r}){return us("infiniteInitialRowCount",r,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:r=>{if(typeof r.ssrmExpandAllAffectsAllRows=="boolean"){if(r.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(r.ssrmExpandAllAffectsAllRows&&typeof r.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:r}){return us("keepDetailRowsCount",r,1)}},paginationPageSize:{validate({paginationPageSize:r}){return us("paginationPageSize",r,1)}},paginationPageSizeSelector:{validate:r=>{const s=r.paginationPageSizeSelector;return typeof s=="boolean"||s==null||s.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:r}){return us("rowBuffer",r,0)}},rowClass:{validate:r=>typeof r.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:r}){return r&&typeof r=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':r&&typeof r!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":r&&r.mode!=="multiRow"&&r.mode!=="singleRow"?`Selection mode "${r.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:r=>{const s=r.rowStyle;return s&&typeof s=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:r}){return us("serverSideInitialRowCount",r,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:r=>{const s=r.sortingOrder;if(Array.isArray(s)&&s.length>0){const i=s.filter(n=>!Zr(n));if(i.length>0)return`sortingOrder must be an array of type (SortDirection | SortDef)[], incorrect items are: ${i.map(n=>typeof n=="string"||n==null?Xl(n):JSON.stringify(n))}]`}else if(!Array.isArray(s)||!s.length)return`sortingOrder must be an array with at least one element, currently it's ${s}`;return null}},tooltipHideDelay:{validate:r=>r.tooltipHideDelay&&r.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:r=>r.tooltipShowDelay&&r.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:r=>{const s=r.rowModelType??"clientSide";switch(s){case"clientSide":{const{treeDataChildrenField:i,treeDataParentIdField:n,getDataPath:o,getRowId:a}=r;if(!i&&!n&&!o)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(i){if(o)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(n)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(n){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(o)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{const i=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${s} row model.`;return r.isServerSideGroup&&r.getServerSideGroupKey?null:i}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:r}){return us("viewportRowModelBufferSize",r,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:r}){return us("viewportRowModelPageSize",r,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:r,showOpenedGroup:s}){return r!=null&&r.field&&s?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":r!=null&&r.valueGetter&&s?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:r=>{const s=r.renderingMode,i=["default","legacy"];return s&&!i.includes(s)?`renderingMode must be one of [${i.join()}], currently it's ${s}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:r})=>{if(!r)return null;const s=["fitCellContents","fitGridWidth","fitProvidedWidth"],i=r.type;return i!=="fitCellContents"&&i!=="fitGridWidth"&&i!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${s.map(n=>'"'+n+'"').join(", ")}, currently it's ${i}`:i==="fitProvidedWidth"&&typeof r.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${r.width}`:null}}},t={};for(const r of mx)t[r]={expectedType:"boolean"};for(const r of px)t[r]={expectedType:"number"};return cr(t,e),t},EL=()=>({objectName:"gridOptions",allProperties:[...SL(),...Object.values(Jf)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:bL(),validations:RL()}),TL=0,kL=0,A0="__ag_grid_instance",PL=class extends ee{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=kL++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new sn,this.globalEventHandlerFactory=e=>(t,r)=>{if(!this.isAlive())return;const s=nc.has(t);if(s&&!e||!s&&e||!DL(t))return;const i=(n,o)=>{const a=Jf[n],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(o))};if(this.gridReadyFired)i(t,r);else if(t==="gridReady"){i(t,r),this.gridReadyFired=!0;for(const n of this.queueEvents)i(n.eventName,n.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:r})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??TC[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return Ce(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(r=>e(this.addCommon(r)))}updateGridOptions({options:e,force:t,source:r="api"}){const s={id:TL++,properties:[]},i=[],{gridOptions:n,validation:o}=this;for(const a of Object.keys(e)){const l=Rf.applyGlobalGridOption(a,e[a]);o==null||o.warnOnInitialPropertyUpdate(r,a);const c=t||typeof l=="object"&&r==="api",u=n[a];if(c||u!==l){n[a]=l;const d={type:a,currentValue:l,previousValue:u,changeSet:s,source:r};i.push(d)}}this.validateGridOptions(this.gridOptions),s.properties=i.map(a=>a.type);for(const a of i)on(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(const r of Object.keys(e)){const s=e[r];if(s==null||s===!1)continue;let i=t[r];typeof i=="function"&&(i=i(e,this.gridOptions,this.beans)),i&&this.assertModuleRegistered(i,r)}}validateGridOptions(e){var t;this.validateOptions(e,FL),(t=this.validation)==null||t.processGridOptions(e)}validateColDef(e,t,r){var s,i;(r||!((s=this.beans.dataTypeSvc)!=null&&s.isColPendingInference(t)))&&(this.validateOptions(e,dL),(i=this.validation)==null||i.validateColDef(e))}assertModuleRegistered(e,t){const r=Array.isArray(e)?e.some(s=>this.isModuleRegistered(s)):this.isModuleRegistered(e);return r||Qe(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),r}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:Ef(),rowModelType:this.get("rowModelType"),isUmd:IC()}}isModuleRegistered(e){return uh(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[A0]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){const r=t[A0];if(Ce(r))return r===this.instanceId;t=t.parentElement}return!1}};function DL(e){return!!Jf[e]}var AL=class extends ee{constructor(e,t){super(),this.column=e,this.eGui=t,this.lastMovingChanged=0}postConstruct(){this.addManagedElementListeners(this.eGui,{click:e=>e&&this.onClick(e)}),this.addManagedListeners(this.column,{movingChanged:()=>{this.lastMovingChanged=Date.now()}})}onClick(e){const{sortSvc:t,rangeSvc:r,gos:s}=this.beans;if(!(qn(s)?e.altKey:!0))r==null||r.handleColumnSelection(this.column,e);else if(this.column.isSortable()){const n=this.column.isMoving(),a=Date.now()-this.lastMovingChanged<50;n||a||t==null||t.progressSortFromEvent(this.column,e)}}};function IL(e,t){const r={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:r},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:r},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[e?{tag:"span",ref:"eColRef",cls:"ag-header-col-ref"}:null,{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:r},t?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var ML=class extends Rt{constructor(){super(...arguments),this.eFilter=be,this.eFilterButton=be,this.eSortIndicator=be,this.eMenu=be,this.eLabel=be,this.eText=be,this.eColRef=be,this.eSortOrder=be,this.eSortAsc=be,this.eSortDesc=be,this.eSortMixed=be,this.eSortNone=be,this.eSortAbsoluteAsc=be,this.eSortAbsoluteDesc=be,this.isLoadingInnerComponent=!1}refresh(e){var r,s,i;const t=this.params;if(this.params=e,this.workOutTemplate(e,!!((r=this.beans)!=null&&r.sortSvc))!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||e.column.formulaRef!=this.currentRef||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const n={...e};cr(n,e.innerHeaderComponentParams),(i=(s=this.innerHeaderComponent).refresh)==null||i.call(s,n)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const{formula:r}=this.beans,s=e.template;return s?s!=null&&s.trim?s.trim():s:IL(!!(r!=null&&r.active),t)}init(e){this.params=e;const{sortSvc:t,touchSvc:r,rowNumbersSvc:s,userCompFactory:i}=this.beans,n=t==null?void 0:t.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!n),this.setTemplate(this.currentTemplate,n?[n]:void 0),this.eLabel&&(this.mouseListener??(this.mouseListener=this.createManagedBean(new AL(e.column,this.eLabel)))),r==null||r.setupForHeader(this),this.setMenu(),this.setupSort(),this.setupColumnRefIndicator(),s==null||s.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(i,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const r=wk(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(s=>{this.isLoadingInnerComponent=!1,s&&(this.isAlive()?(this.innerHeaderComponent=s,this.eText&&this.eText.appendChild(s.getGui())):this.destroyBean(s))}))}setDisplayName(e){const{displayName:t}=e,r=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||r===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=So(t))}addInIcon(e,t,r){const s=vr(e,this.beans,r);s&&t.appendChild(s)}workOutShowMenu(){var e;return this.params.enableMenu&&!!((e=this.beans.menuSvc)!=null&&e.isHeaderMenuButtonEnabled())}shouldSuppressMenuHide(){var e;return!!((e=this.beans.menuSvc)!=null&&e.isHeaderMenuButtonAlwaysShowEnabled())}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){vi(this.eMenu),this.eMenu=void 0;return}const{gos:e,eMenu:t,params:r}=this,s=Tr(e);this.addInIcon(s?"menu":"menuAlt",t,r.column),t.classList.toggle("ag-header-menu-icon",!s);const i=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=i,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(i)}toggleMenuAlwaysShow(e){var t;(t=this.eMenu)==null||t.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:r}=this;t||this.toggleMenuAlwaysShow(!0),r.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){var l;const{params:t,gos:r,beans:s,eMenu:i,eFilterButton:n}=this,o=t.column,a=Tr(r);if(e&&!a){if((l=s.menuSvc)!=null&&l.isFilterMenuInHeaderEnabled(o))return t.showFilter(n??i??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(i??n??this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:r}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:s,eSortOrder:i,eSortAsc:n,eSortDesc:o,eSortMixed:a,eSortNone:l,eSortAbsoluteAsc:c,eSortAbsoluteDesc:u}=this;s.attachCustomElements(i,n,o,a,l,c,u)}this.eSortIndicator.setupSort(r),this.currentSort&&e.setupHeader(this,r)}setupColumnRefIndicator(){const{eColRef:e,beans:{editModelSvc:t},params:r}=this;e&&(this.currentRef=r.column.formulaRef,e.textContent=this.currentRef,it(e,!1),this.addManagedEventListeners({cellEditingStarted:()=>{const s=t==null?void 0:t.getEditPositions(),i=!!this.currentRef&&!!(s!=null&&s.some(n=>n.column.isAllowFormula()));it(e,i)},cellEditingStopped:()=>{it(e,!1)}}))}setupFilterIcon(){const{eFilter:e,params:t}=this;if(!e)return;const r=()=>{const s=t.column.isFilterActive();it(e,s,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,r,"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,r,s){if(!e)return vi(t),!1;const i=this.params.column;return this.addInIcon(s,t,i),this.addManagedListeners(i,{filterChanged:r}),r(),!0}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){const{eFilterButton:t,eMenu:r}=this;return e?t??r??this.getGui():r??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent=this.destroyBean(this.innerHeaderComponent),this.mouseListener=this.destroyBean(this.mouseListener)}},_L={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},LL=class extends Rt{constructor(){super(_L),this.agOpened=be,this.agClosed=be,this.agLabel=be,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t,touchSvc:r}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),r==null||r.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&oe(89)}workOutInnerHeaderGroupComponent(e,t){const r=yk(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(s=>{this.isLoadingInnerComponent=!1,s&&(this.isAlive()?(this.innerHeaderGroupComponent=s,this.agLabel.appendChild(s.getGui())):this.destroyBean(s))}))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:r},beans:{colGroupSvc:s}}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const i=l=>{if(zs(l))return;const c=!r.isExpanded();s.setColumnGroupOpened(r.getProvidedColumnGroup(),c,"uiColumnExpanded")};this.addTouchAndClickListeners(t,i),this.addTouchAndClickListeners(e,i);const n=l=>{cn(l)};this.addManagedElementListeners(t,{dblclick:n}),this.addManagedElementListeners(e,{dblclick:n}),this.addManagedElementListeners(this.getGui(),{dblclick:i}),this.updateIconVisibility();const o=r.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(o,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t){var r;(r=this.beans.touchSvc)==null||r.setupForHeaderGroupElement(this,e,t),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:r}}=this;if(r.isExpandable()){const s=r.isExpanded();it(e,s),it(t,!s)}else it(e,!1),it(t,!1)}addInIcon(e,t){const r=vr(e,this.beans,null);r&&t.appendChild(r)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:t,agClosed:r}=this;it(t,!1),it(r,!1)}}setupLabel(e){var o;const{displayName:t,columnGroup:r}=e,{innerHeaderGroupComponent:s,isLoadingInnerComponent:i}=this,n=s||i;Ce(t)&&!n&&(this.agLabel.textContent=So(t)),this.toggleCss("ag-sticky-label",!((o=r.getColGroupDef())!=null&&o.suppressStickyLabel))}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},OL={moduleName:"ColumnHeaderComp",version:we,userComponents:{agColumnHeader:ML},icons:{menu:"menu",menuAlt:"menu-alt"}},NL={moduleName:"ColumnGroupHeaderComp",version:we,userComponents:{agColumnGroupHeader:LL},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},BL=class extends ee{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&oe(92)}createTask(e,t,r,s,i=!1){this.verify();let n=r;s&&this.batchFrameworkComps&&(n="f1");const o={task:e,index:t,createOrder:++this.taskCount,deferred:i};this.addTaskToList(this[n],o),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((r,s)=>r.deferred!==s.deferred?r.deferred?-1:1:r.index!==s.index?t*(s.index-r.index):s.createOrder-r.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:r,f1:s,destroyTasks:i,beans:n}=this,{ctrlsSvc:o,frameworkOverrides:a}=n,l=t.list,c=r.list,u=s.list,d=Date.now();let h=0;const f=e<=0,p=o.getScrollFeature();for(;f||h<e;){if(!p.scrollGridIfNeeded()){let m;if(l.length)this.sortTaskList(t),m=l.pop().task;else if(c.length)this.sortTaskList(r),m=c.pop().task;else if(u.length)a.wrapOutgoing(()=>{for(;(f||h<e)&&!p.scrollGridIfNeeded();){if(u.length)this.sortTaskList(s),m=u.pop().task,m();else break;h=Date.now()-d}}),m=()=>{};else if(i.length)m=i.pop();else break;m()}h=Date.now()-d}l.length||c.length||u.length||i.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);ti(this.beans,e)}isQueueEmpty(){return!this.ticking}},HL={moduleName:"AnimationFrame",version:we,beans:[BL]},VL=class extends ee{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return vr(e,this.beans,t==null?void 0:t.column)}},GL=class extends ee{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!Xi())return;const t=(r,s,i)=>{var a;const{rowCtrl:n,cellCtrl:o}=e.getControlsForEventTarget((i==null?void 0:i.target)??null);o!=null&&o.column&&o.dispatchCellContextMenuEvent(i??null),(a=this.beans.contextMenuSvc)==null||a.handleContextMenuMouseEvent(void 0,i,n,o)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!Xi()||SC("dblclick"))return!1;const s=Date.now(),i=s-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=s,i})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){const{gos:t,sortSvc:r,menuSvc:s}=this.beans;if(t.get("suppressTouch"))return;const{params:i,eMenu:n,eFilterButton:o}=e,a=new Hi(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());const l=e.shouldSuppressMenuHide(),c=l&&Ce(n)&&i.enableMenu;let u=a;if(c&&(u=new Hi(n,!0),e.addDestroyFunc(()=>u.destroy())),i.enableMenu||s!=null&&s.isHeaderContextMenuEnabled(i.column)){const d=c?"tap":"longTap",h=f=>i.showColumnMenuAfterMouseClick(f.touchStart);e.addManagedListeners(u,{[d]:h}),e.addManagedListeners(a,{longTap:h})}if(i.enableSorting){const d=h=>{const f=h.touchStart.target;l&&(n!=null&&n.contains(f)||o!=null&&o.contains(f))||r==null||r.progressSort(i.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:d})}if(i.enableFilterButton&&o){const d=new Hi(o,!0);e.addManagedListeners(d,{tap:()=>i.showFilter(o)}),e.addDestroyFunc(()=>d.destroy())}}setupForHeaderGroup(e){var r;const t=e.params;if((r=this.beans.menuSvc)!=null&&r.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){const s=new Hi(t.eGridHeader,!0),i=n=>t.showColumnMenuAfterMouseClick(n.touchStart);e.addManagedListeners(s,{longTap:i}),e.addDestroyFunc(()=>s.destroy())}}setupForHeaderGroupElement(e,t,r){const s=new Hi(t,!0);e.addManagedListeners(s,{tap:r}),e.addDestroyFunc(()=>s.destroy())}mockContextMenu(e,t,r){if(!Xi())return;const s=new Hi(t),i=n=>{xa(this.beans,n.touchEvent)&&r(void 0,n.touchStart,n.touchEvent)};e.addManagedListeners(s,{longTap:i}),e.addDestroyFunc(()=>s.destroy())}},WL={moduleName:"Touch",version:we,beans:[GL]},zL=class extends ee{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,r=!1){return r?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const r=e===K.UP,s=e===K.DOWN,i=e===K.LEFT;let n,o;const{pageBounds:a,gos:l,visibleCols:c,pinnedRowModel:u}=this.beans,{rowPinned:d}=t;if(r||s)d&&u?r?o=0:o=d==="top"?u.getPinnedTopRowCount()-1:u.getPinnedBottomRowCount()-1:o=r?a.getFirstRow():a.getLastRow(),n=t.column;else{const h=l.get("enableRtl");o=t.rowIndex,n=(i!==h?c.allCols:[...c.allCols].reverse()).find(p=>this.isCellGoodToFocusOn({rowIndex:o,rowPinned:null,column:p}))}return n?{rowIndex:o,rowPinned:d,column:n}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let r=t,s=!1;for(;!s;){switch(e){case K.UP:r=this.getCellAbove(r);break;case K.DOWN:r=this.getCellBelow(r);break;case K.RIGHT:r=this.gos.get("enableRtl")?this.getCellToLeft(r):this.getCellToRight(r);break;case K.LEFT:r=this.gos.get("enableRtl")?this.getCellToRight(r):this.getCellToLeft(r);break;default:r=null,oe(8,{key:e});break}r?s=this.isCellGoodToFocusOn(r):s=!0}return r}isCellGoodToFocusOn(e){const t=e.column;let r;const{pinnedRowModel:s,rowModel:i}=this.beans;switch(e.rowPinned){case"top":r=s==null?void 0:s.getPinnedTopRow(e.rowIndex);break;case"bottom":r=s==null?void 0:s.getPinnedBottomRow(e.rowIndex);break;default:r=i.getRow(e.rowIndex);break}return r?!this.isSuppressNavigable(t,r):!1}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){var s;if(!e)return null;const t=((s=this.rowSpanSvc)==null?void 0:s.getCellEnd(e))??e,r=l0(this.beans,t,!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getCellAbove(e){var s;if(!e)return null;const t=((s=this.rowSpanSvc)==null?void 0:s.getCellStart(e))??e,r=Bc(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const{visibleCols:t,pagination:r}=this.beans,s=t.allCols;let i=e.rowIndex,n=e.rowPinned,o=t.getColAfter(e.column);if(!o){o=s[0];const a=l0(this.beans,e,!0);if(ct(a)||!a.rowPinned&&!((r==null?void 0:r.isRowInPage(a.rowIndex))??!0))return null;i=a?a.rowIndex:null,n=a?a.rowPinned:null}return{rowIndex:i,column:o,rowPinned:n}}getNextTabbedCellBackwards(e){const{beans:t}=this,{visibleCols:r,pagination:s}=t,i=r.allCols;let n=e.rowIndex,o=e.rowPinned,a=r.getColBefore(e.column);if(!a){a=nt(i);const l=Bc(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(ct(l)||!l.rowPinned&&!((s==null?void 0:s.isRowInPage(l.rowIndex))??!0))return null;n=l?l.rowIndex:null,o=l?l.rowPinned:null}return{rowIndex:n,column:a,rowPinned:o}}isSuppressNavigable(e,t){const{suppressNavigable:r}=e.colDef;if(typeof r=="boolean")return r;if(typeof r=="function"){const s=e.createColumnFunctionCallbackParams(t);return r(s)}return!1}};function UL(e){return e.focusSvc.getFocusedCell()}function jL(e){return e.focusSvc.clearFocusedCell()}function $L(e,t,r,s){e.focusSvc.setFocusedCell({rowIndex:t,column:r,rowPinned:s,forceBrowserFocus:!0})}function KL(e,t){var r;return((r=e.navigation)==null?void 0:r.tabToNextCell(!1,t))??!1}function qL(e,t){var r;return((r=e.navigation)==null?void 0:r.tabToNextCell(!0,t))??!1}function XL(e,t,r=!1){var i;const s=(i=e.headerNavigation)==null?void 0:i.getHeaderPositionForColumn(t,r);s&&e.focusSvc.focusHeaderPosition({headerPosition:s})}var YL=class extends ee{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new vx,this.rowValidations=new Cx,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;const r=this.getEditRow(e);t?r.delete(t):r.clear(),r.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;const r=e&&this.edits.get(e);if(r)return r;if(t.checkSiblings){const s=e.pinnedSibling;if(s)return this.getEditRow(s)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;const r=this.getEditRow(e),s=e.pinnedSibling,i=t&&s&&this.getEditRow(s);if(!r&&!i)return;const n=Object.assign({},e.data),o=(a,l)=>a.forEach(({pendingValue:c},u)=>{c!==$r&&(l[u.getColId()]=c)});return r&&o(r,n),i&&o(i,n),n}getEdit(e,t){const r=this._getEdit(e);return t&&r?{...r}:r}_getEdit(e){var t;if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&((t=this.getEditRow(e.rowNode))==null?void 0:t.get(e.column))}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;const t=new Map;return this.edits.forEach((r,s)=>{const i=new Map;r.forEach(({editorState:n,...o},a)=>i.set(a,{...o})),t.set(s,i)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,r)=>{const s=new Map;t.forEach((i,n)=>s.set(n,{...i})),this.edits.set(r,s)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);const r=this._getEdit(e),s=Object.assign({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0},...r,...t});return this.getEditRow(e.rowNode).set(e.column,s),s}clearEditValue(e){var s;const{rowNode:t,column:r}=e;if(t)if(r){const i=this._getEdit(e);i&&(i.editorValue=void 0,i.pendingValue=i.sourceValue,i.state="changed")}else(s=this.getEditRow(t))==null||s.forEach(i=>{i.editorValue=void 0,i.pendingValue=i.sourceValue,i.state="changed"})}getState(e){var t;if(!this.suspendEdits)return(t=this.getEdit(e))==null?void 0:t.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];const t=[];return(e??this.edits).forEach((r,s)=>{for(const i of r.keys()){const{editorState:n,...o}=r.get(i);t.push({rowNode:s,column:i,...o})}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){var n;if(this.suspendEdits||this.edits.size===0)return!1;const{rowNode:r,column:s}=e,{withOpenEditor:i}=t;if(r){const o=this.getEditRow(r,t);return o?s?i?((n=this.getEdit(e))==null?void 0:n.state)==="editing":o.has(s)??!1:o.size!==0?i?Array.from(o.values()).some(({state:a})=>a==="editing"):!0:!1:!1}return i?this.getEditPositions().some(({state:o})=>o==="editing"):this.edits.size>0}start(e){const t=this.getEditRow(e.rowNode)??new Map,{rowNode:r,column:s}=e;s&&!t.has(s)&&t.set(s,{editorValue:void 0,pendingValue:$r,sourceValue:this.beans.valueSvc.getValue(s,r,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(r,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(const e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},vx=class{constructor(){this.cellValidations=new Map}getCellValidation(e){var s,i;const{rowNode:t,column:r}=e||{};return(i=(s=this.cellValidations)==null?void 0:s.get(t))==null?void 0:i.get(r)}hasCellValidation(e){return!(e!=null&&e.rowNode)||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){const{rowNode:r,column:s}=e;this.cellValidations.has(r)||this.cellValidations.set(r,new Map),this.cellValidations.get(r).set(s,t)}clearCellValidation(e){var s;const{rowNode:t,column:r}=e;(s=this.cellValidations.get(t))==null||s.delete(r)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},Cx=class{constructor(){this.rowValidations=new Map}getRowValidation(e){const{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e!=null&&e.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function Zf(e,t={}){var c;const{rowIndex:r,rowId:s,rowCtrl:i,rowPinned:n}=t;if(i)return i;const{rowModel:o,rowRenderer:a}=e;let{rowNode:l}=t;return l||(s?l=aA(e,s,n):r!=null&&(l=o.getRow(r))),(c=a.getRowCtrls(l?[l]:[]))==null?void 0:c[0]}function ft(e,t={}){var u;const{cellCtrl:r,colId:s,columnId:i,column:n}=t;if(r)return r;const o=e.colModel.getCol(s??i??Ih(n)),a=t.rowCtrl??Zf(e,t),l=(a==null?void 0:a.getCellCtrl(o))??void 0;if(l)return l;const c=t.rowNode??(a==null?void 0:a.rowNode);if(c)return(u=e.rowRenderer.getCellCtrls([c],[o]))==null?void 0:u[0]}function I0(e){const{editSvc:t}=e;t!=null&&t.isBatchEditing()?(di(e,{persist:!0}),to(e)):t==null||t.stopEditing(void 0,{source:"api"})}function JL(e,t,r){const{gos:s,popupSvc:i}=t;if(!s.get("stopEditingWhenCellsLoseFocus"))return;const n=o=>{const a=o.relatedTarget;if(Ch(a)===null){I0(t);return}let l=r.some(c=>c.contains(a))&&s.isElementInThisInstance(a);l||(l=!!i&&(i.getActivePopups().some(c=>c.contains(a))||i.isElementWithinCustomPopup(a))),l||I0(t)};for(const o of r)e.addManagedElementListeners(o,{focusout:n})}function Ih(e){if(e)return typeof e=="string"?e:e.getColId()}var $r=Symbol("unedited");function wx(e,t={}){var i;const r=[],s=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(const n of s){const o=(i=n.comp)==null?void 0:i.getCellEditor();o&&r.push({ctrl:n,editor:ba(o)})}return r}var ZL=(e,t={})=>wx(e,t).map(r=>r.editor);function QL(e,t,r,s,i,n){var d;t.length===0&&(r!=null&&r.rowNode)&&(r!=null&&r.column)&&go(e,r,{key:s,event:i,cellStartedEdit:n});const{valueSvc:o,editSvc:a,editModelSvc:l}=e,{rowNode:c,column:u}=r??{};for(const h of t){const{rowNode:f,column:p}=h,g=ft(e,h);if(!g){if(f&&p){const v=o.getValue(p,f,void 0,"api"),y=((r==null?void 0:r.rowNode)===f&&(r==null?void 0:r.column)===p&&s||void 0)??(a==null?void 0:a.getCellDataValue(h,!1))??((d=o.getValueForDisplay({column:p,node:f}))==null?void 0:d.value)??v??$r;l==null||l.setEdit(h,{pendingValue:po(e,y,!1,p),sourceValue:v,state:"editing"})}continue}const m=n&&c===g.rowNode&&g.column===u;go(e,{rowNode:c,column:g.column},{key:m?s:null,event:m?i:null,cellStartedEdit:m&&n})}}function Ss({pendingValue:e,sourceValue:t}){return e===$r&&(e=t),e!==t}function go(e,t,r){var I,z,U;const{key:s,event:i,cellStartedEdit:n,silent:o}=r??{},{editModelSvc:a,editSvc:l,gos:c,userCompFactory:u}=e,d=ft(e,t),h=(I=d==null?void 0:d.comp)==null?void 0:I.getCellEditor(),f=yx(e,t,s,n&&!o),p=t.column.isAllowFormula(),g=a==null?void 0:a.getEdit(t),m=f.value??(g==null?void 0:g.sourceValue);if(h){a==null||a.setEdit(t,{editorValue:po(e,m,!0,t.column),state:"editing"}),(z=h.refresh)==null||z.call(h,f);return}const v=t.column.getColDef(),w=aw(u,p?{...v,cellEditor:"agTextCellEditor"}:v,f);if(!w)return;const{popupFromSelector:C,popupPositionFromSelector:y}=w,b=C??!!v.cellEditorPopup,F=y??v.cellEditorPopupPosition;if(Sx(w.params,i),!d)return;const{rangeFeature:S,rowCtrl:D,comp:T,onEditorAttachedFuncs:V}=d;a==null||a.setEdit(t,{editorValue:po(e,m,!0,t.column),state:"editing"}),d.editCompDetails=w,V.push(()=>S==null?void 0:S.unsetComp()),T==null||T.setEditDetails(w,b,F,c.get("reactiveCustomComponents")),D==null||D.refreshRow({suppressFlash:!0});const _=a==null?void 0:a.getEdit(t,!0);!o&&!((U=_==null?void 0:_.editorState)!=null&&U.cellStartedEditing)&&(l==null||l.dispatchCellEvent(t,i,"cellEditingStarted",{value:m}),a==null||a.setEdit(t,{editorState:{cellStartedEditing:!0}}))}function xx(e,t,r){var n,o;const s={editorValueExists:!1};if(Qf(e)){const a=(n=t.getValidationErrors)==null?void 0:n.call(t);if(((a==null?void 0:a.length)??0)>0)return s}if(r!=null&&r.isCancelling)return s;if(r!=null&&r.isStopping){const a=(o=t==null?void 0:t.isCancelAfterEnd)==null?void 0:o.call(t);if(a)return{...s,isCancelAfterEnd:a}}return{editorValue:t.getValue(),editorValueExists:!0}}function yx(e,t,r,s){var C,y,b,F,S,D;const{valueSvc:i,gos:n,editSvc:o}=e,a=e.gos.get("enableGroupEdit"),l=ft(e,t),c=((C=t.rowNode)==null?void 0:C.rowIndex)??void 0,u=o==null?void 0:o.isBatchEditing(),d=e.colModel.getCol(t.column.getId()),{rowNode:h,column:f}=t,p=(y=l.comp)==null?void 0:y.getCellEditor(),g=o==null?void 0:o.getCellDataValue(t,!1),m=g===void 0?p?(b=xx(e,p))==null?void 0:b.editorValue:void 0:g,v=m===$r?(F=i.getValueForDisplay({column:d,node:h}))==null?void 0:F.value:m;let w=a?m:v;return f.isAllowFormula()&&((S=e.formula)!=null&&S.isFormula(w))&&(w=((D=e.formula)==null?void 0:D.normaliseFormula(w,!0))??w),ke(n,{value:w,eventKey:r??null,column:f,colDef:f.getColDef(),rowIndex:c,node:h,data:h.data,cellStartedEdit:s??!1,onKeyDown:l==null?void 0:l.onKeyDown.bind(l),stopEditing:T=>{o.stopEditing(t,{source:u?"ui":"api",suppressNavigateAfterEdit:T}),Vc(e,t)},eGridCell:l==null?void 0:l.eGui,parseValue:T=>i.parseValue(d,h,T,l==null?void 0:l.value),formatValue:l==null?void 0:l.formatValue.bind(l),validate:()=>{o==null||o.validateEdit()}})}function oc(e,t){const{editModelSvc:r}=e;r==null||r.getEditMap().forEach((s,i)=>{s.forEach((n,o)=>{!t&&(n.state==="editing"||n.pendingValue===$r)||!Ss(n)&&(n.state!=="editing"||t)&&(r==null||r.removeEdits({rowNode:i,column:o}))})})}function eO(e,t){var c;const r=(c=t.comp)==null?void 0:c.getCellEditor();if(!(r!=null&&r.refresh))return;const{eventKey:s,cellStartedEdit:i}=t.editCompDetails.params,{column:n}=t,o=yx(e,t,s,i),a=n.getColDef(),l=aw(e.userCompFactory,a,o);r.refresh(Sx(l.params,s))}function Sx(e,t){var r;return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes((t==null?void 0:t.key)??"")||e.suppressPreventDefault:(r=t==null?void 0:t.preventDefault)==null||r.call(t),e}function di(e,t){var r,s,i;for(const n of((r=e.editModelSvc)==null?void 0:r.getEditPositions())??[]){const o=ft(e,n);if(!o)continue;const a=(s=o.comp)==null?void 0:s.getCellEditor();if(!a)continue;const{editorValue:l,editorValueExists:c,isCancelAfterEnd:u}=xx(e,a,t);u&&((i=e.editModelSvc)==null||i.setEdit(n,{editorState:{isCancelAfterEnd:u}})),ac(e,n,l,void 0,!c,t)}}function ac(e,t,r,s,i,n){const{editModelSvc:o,valueSvc:a}=e;if(!o)return;const{rowNode:l,column:c}=t;if(!(l&&c))return;let u=o.getEdit(t,!0);if(!(u!=null&&u.sourceValue)){const d={sourceValue:a.getValue(c,l,void 0,"api"),pendingValue:u?po(e,u.editorValue,!1,c):$r};n!=null&&n.persist&&(d.state="changed"),u=o.setEdit(t,d)}o.setEdit(t,{editorValue:i?po(e,u.sourceValue,!0,c):r}),n!=null&&n.persist&&tO(e,t)}function po(e,t,r,s){const{formula:i}=e;return s.isAllowFormula()&&(i!=null&&i.isFormula(t))?(i==null?void 0:i.normaliseFormula(t,r))??t:t}function tO(e,t){const{editModelSvc:r}=e,s=r==null?void 0:r.getEdit(t,!0);r==null||r.setEdit(t,{pendingValue:po(e,s==null?void 0:s.editorValue,!1,t.column)})}function to(e,t,r){var s;t||(t=(s=e.editModelSvc)==null?void 0:s.getEditPositions());for(const i of t??[])Vc(e,i,r)}function Vc(e,t,r){var c,u;const s=e.gos.get("enableGroupEdit"),{editModelSvc:i}=e,n=ft(e,t),o=i==null?void 0:i.getEdit(t,!0);if(!n){o&&(i==null||i.setEdit(t,{state:"changed"}));return}const{comp:a}=n;if(a&&!a.getCellEditor()){if(n==null||n.refreshCell(),o){i==null||i.setEdit(t,{state:"changed"});const d=s?M0(r,o):{valueChanged:!1,newValue:void 0,oldValue:o.sourceValue};_0(e,t,d,r)}return}if(Qf(e)){const d=(u=(c=a==null?void 0:a.getCellEditor())==null?void 0:c.getValidationErrors)==null?void 0:u.call(c),h=i==null?void 0:i.getCellValidationModel();d!=null&&d.length?h==null||h.setCellValidation(t,{errorMessages:d}):h==null||h.clearCellValidation(t)}i==null||i.setEdit(t,{state:"changed"}),a==null||a.setEditDetails(),a==null||a.refreshEditStyles(!1,!1),n==null||n.refreshCell({force:!0,suppressFlash:!0});const l=i==null?void 0:i.getEdit(t);if(l&&l.state==="changed"){const d=s?M0(r,l):{valueChanged:Ss(l)&&!(r!=null&&r.cancel),newValue:r!=null&&r.cancel||l.editorState.isCancelAfterEnd?void 0:(l==null?void 0:l.editorValue)??(o==null?void 0:o.pendingValue),oldValue:l==null?void 0:l.sourceValue};_0(e,t,d,r)}}function M0(e,t){return e!=null&&e.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:Ss(t),oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function _0(e,t,r,{silent:s,event:i}={}){const{editSvc:n,editModelSvc:o}=e,a=o==null?void 0:o.getEdit(t),{editorState:l}=a||{},{isCancelBeforeStart:c}=l||{};!s&&!c&&(n==null||n.dispatchCellEvent(t,i,"cellEditingStopped",r),o==null||o.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function Qf(e){var o;const{gos:t,colModel:r}=e,s=!!t.get("getFullRowEditValidationErrors"),i=(o=r.getColumnDefs())==null?void 0:o.filter(a=>a.editable).some(({cellEditorParams:a})=>{const{minLength:l,maxLength:c,getValidationErrors:u,min:d,max:h}=a||{};return l!==void 0||c!==void 0||u!==void 0||d!==void 0||h!==void 0}),n=e.gridApi.getCellEditorInstances().some(a=>a.getValidationElement||a.getValidationErrors);return i||s||n}function un(e,t){var h,f,p,g,m,v,w,C;if(!(t||Qf(e)))return;const r=wx(e),s=new vx,{ariaAnnounce:i,localeSvc:n,editModelSvc:o,gos:a}=e,l=a.get("editType")==="fullRow",u=FC(n)("ariaValidationErrorPrefix","Cell Editor Validation");for(const y of r){const{ctrl:b,editor:F}=y,{rowNode:S,column:D}=b,T=((h=F.getValidationErrors)==null?void 0:h.call(F))??[],V=((f=F.getValidationElement)==null?void 0:f.call(F,!1))||!((p=F.isPopup)!=null&&p.call(F))&&b.eGui;if(V){const _=T!=null&&T.length>0,I=_?T.join(". "):"";mf(V,_),_&&i.announceValue(`${u} ${T}`,"editorValidation"),V instanceof HTMLInputElement?V.setCustomValidity(I):V.classList.toggle("invalid",_)}(T==null?void 0:T.length)>0&&s.setCellValidation({rowNode:S,column:D},{errorMessages:T})}di(e,{persist:!1}),o==null||o.setCellValidationModel(s);const d=new Set;for(const{ctrl:y}of r)d.add(y.rowCtrl);if(l){const y=rO(e);o==null||o.setRowValidationModel(y)}for(const y of d.values()){(g=y.rowEditStyleFeature)==null||g.applyRowStyles();for(const b of y.getAllCellCtrls())(m=b.tooltipFeature)==null||m.refreshTooltip(!0),(v=b.editorTooltipFeature)==null||v.refreshTooltip(!0),(C=(w=b.editStyleFeature)==null?void 0:w.applyCellStyles)==null||C.call(w)}}var rO=e=>{var i;const t=new Cx,r=e.gos.get("getFullRowEditValidationErrors"),s=(i=e.editModelSvc)==null?void 0:i.getEditMap();if(!s)return t;for(const n of s.keys()){const o=s.get(n);if(!o)continue;const a=[],{rowIndex:l,rowPinned:c}=n;for(const d of o.keys()){const h=o.get(d);if(!h)continue;const{editorValue:f,pendingValue:p,sourceValue:g}=h,m=f??(p===$r?void 0:p)??g;a.push({column:d,colId:d.getColId(),rowIndex:l,rowPinned:c,oldValue:g,newValue:m})}const u=(r==null?void 0:r({editorsState:a}))??[];u.length>0&&t.setRowValidation({rowNode:n},{errorMessages:u})}return t};function sO(e){var s;un(e,!0);const t=(s=e.editModelSvc)==null?void 0:s.getCellValidationModel().getCellValidationMap();if(!t)return null;const r=[];return t.forEach((i,n)=>{i.forEach(({errorMessages:o},a)=>{r.push({column:a,rowIndex:n.rowIndex,rowPinned:n.rowPinned,messages:o??null})})}),r}function iO(e,t,r,{rowNode:s,column:i},n){return ke(e.gos,{type:r,node:s,data:s.data,value:n,column:i,colDef:i.getColDef(),rowPinned:s.rowPinned,event:t,rowIndex:s.rowIndex})}function nO(e,t=!1){return e===K.DELETE?!0:!t&&e===K.BACKSPACE?uw():!1}var oO=class extends ee{constructor(e,t,r,s){super(),this.cellCtrl=e,this.rowNode=r,this.rowCtrl=s,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case K.ENTER:this.onEnterKeyDown(e);break;case K.F2:this.onF2KeyDown(e);break;case K.ESCAPE:this.onEscapeKeyDown(e);break;case K.TAB:this.onTabKeyDown(e);break;case K.BACKSPACE:case K.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case K.DOWN:case K.UP:case K.RIGHT:case K.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){var i,n;const{cellCtrl:r,beans:s}=this;if(!((i=s.editSvc)!=null&&i.isEditing(r,{withOpenEditor:!0}))){if(e.shiftKey&&r.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const o=r.getFocusedCellPosition();(n=s.navigation)==null||n.navigateToNextCell(e,t,o,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:r}=this.beans;if(!t)return;const s=t.extendLatestRangeInDirection(e);s&&(e.key===K.LEFT||e.key===K.RIGHT?r==null||r.ensureColumnVisible(s.column):r==null||r.ensureRowVisible(s.rowIndex))}onTabKeyDown(e){var t;(t=this.beans.navigation)==null||t.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){var c;const{cellCtrl:r,beans:s,rowNode:i}=this,{gos:n,rangeSvc:o,eventSvc:a,editSvc:l}=s;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),nO(e,n.get("enableCellEditingOnBackspace"))&&!(l!=null&&l.isEditing(r,{withOpenEditor:!0}))){if(o&&wi(n))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(r.isCellEditable()){const{column:u}=r,d=this.beans.valueSvc.getDeleteValue(u,i);i.setDataValue(u,d,"cellClear")}}else l!=null&&l.isEditing(r,{withOpenEditor:!0})||(c=s.editSvc)==null||c.startEditing(r,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){var c;const{cellCtrl:t,beans:r}=this,{editSvc:s,navigation:i}=r,n=s==null?void 0:s.isEditing(t,{withOpenEditor:!0}),o=t.rowNode,a=s==null?void 0:s.isRowEditing(o,{withOpenEditor:!0}),l=u=>{(s==null?void 0:s.startEditing(u,{startedEdit:!0,event:e,source:"edit"}))&&e.preventDefault()};if(n||a){if(this.isCtrlEnter(e)){s==null||s.applyBulkEdit(t,((c=r==null?void 0:r.rangeSvc)==null?void 0:c.getCellRanges())||[]);return}if(un(r),(s==null?void 0:s.checkNavWithValidation(void 0,e))==="block-stop")return;s!=null&&s.isEditing(t,{withOpenEditor:!0})?s==null||s.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?s==null||s.stopEditing({rowNode:o},{event:e,source:"edit"}):l(t)}else if(r.gos.get("enterNavigatesVertically")){const u=e.shiftKey?K.UP:K.DOWN;i==null||i.navigateToNextCell(null,u,t.cellPosition,!1)}else{if(s!=null&&s.hasValidationErrors())return;s!=null&&s.hasValidationErrors(t)&&s.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===K.ENTER}onF2KeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;r!=null&&r.isEditing()&&(un(this.beans),(r==null?void 0:r.checkNavWithValidation(void 0,e))==="block-stop")||r==null||r.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;(r==null?void 0:r.checkNavWithValidation(t,e))==="block-stop"&&r.revertSingleCellEdit(t),setTimeout(()=>{r==null||r.stopEditing(t,{event:e,cancel:!0})})}processCharacter(e){var o;const r=e.target!==this.eGui,{beans:{editSvc:s},cellCtrl:i}=this;if(r||s!=null&&s.isEditing(i,{withOpenEditor:!0}))return;if(e.key===K.SPACE)this.onSpaceKeyDown(e);else if(s!=null&&s.isCellEditable(i,"ui")){if(s!=null&&s.hasValidationErrors()&&!(s!=null&&s.hasValidationErrors(i)))return;s==null||s.startEditing(i,{startedEdit:!0,event:e,source:"api"});const a=i.editCompDetails;!((o=a==null?void 0:a.params)!=null&&o.suppressPreventDefault)&&e.preventDefault()}}onSpaceKeyDown(e){var i;const{gos:t,editSvc:r}=this.beans,{rowNode:s}=this.cellCtrl;!(r!=null&&r.isEditing(this.cellCtrl,{withOpenEditor:!0}))&&Ki(t)&&((i=this.beans.selectionSvc)==null||i.handleSelectionEvent(e,s,"spaceKey")),e.preventDefault()}},aO=class extends ee{constructor(e,t,r){super(),this.cellCtrl=e,this.column=r,this.beans=t}onMouseEvent(e,t){if(!zs(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){var g;if((g=this.beans.touchSvc)!=null&&g.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:r,editSvc:s,editModelSvc:i,frameworkOverrides:n,gos:o}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:c,cellPosition:u,rowNode:d}=l,h=rc(o,c,d,e);r&&a&&!h&&r.getCellRangeCount(u)>1&&r.intersectLastRange(!0);const f=l.createEvent(e,"cellClicked");f.isEventHandlingSuppressed=h,t.dispatchEvent(f);const p=c.getColDef();if(p.onCellClicked&&window.setTimeout(()=>{n.wrapOutgoing(()=>{p.onCellClicked(f)})},0),!h&&(i==null?void 0:i.getState(l))!=="editing"){const m=s==null?void 0:s.isEditing(),v=(i==null?void 0:i.getCellValidationModel().getCellValidationMap().size)??0,w=(i==null?void 0:i.getRowValidationModel().getRowValidationMap().size)??0;if(m&&(v>0||w>0))return;s!=null&&s.shouldStartEditing(l,e)?s==null||s.startEditing(l,{event:e}):s!=null&&s.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?s==null||s.stopEditing(l,{event:e,source:"edit"}):s==null||s.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){const{column:t,beans:r,cellCtrl:s}=this,{eventSvc:i,frameworkOverrides:n,editSvc:o,editModelSvc:a,gos:l}=r,c=rc(l,s.column,s.rowNode,e),u=t.getColDef(),d=s.createEvent(e,"cellDoubleClicked");if(d.isEventHandlingSuppressed=c,i.dispatchEvent(d),typeof u.onCellDoubleClicked=="function"&&window.setTimeout(()=>{n.wrapOutgoing(()=>{u.onCellDoubleClicked(d)})},0),!c&&o!=null&&o.shouldStartEditing(s,e)&&(a==null?void 0:a.getState(s))!=="editing"){const h=o==null?void 0:o.isEditing(),f=(a==null?void 0:a.getCellValidationModel().getCellValidationMap().size)??0,p=(a==null?void 0:a.getRowValidationModel().getRowValidationMap().size)??0;if(h&&(f>0||p>0))return;o==null||o.startEditing(s,{event:e})}}onMouseDown(e){const{shiftKey:t}=e,r=e.target,{cellCtrl:s,beans:i}=this,{eventSvc:n,rangeSvc:o,rowNumbersSvc:a,focusSvc:l,gos:c,editSvc:u}=i,{column:d,rowNode:h,cellPosition:f}=s,p=rc(c,d,h,e),g=()=>{const C=s.createEvent(e,"cellMouseDown");C.isEventHandlingSuppressed=p,n.dispatchEvent(C)};if(p){g();return}if(this.isRightClickInExistingRange(e))return;const m=o&&!o.isEmpty(),v=this.containsWidget(r),w=Gs(d);if(!(a&&w&&!a.handleMouseDownOnCell(f,e))){if(!t||!m){const C=u==null?void 0:u.isEditing(s),b=c.get("enableCellTextSelection")&&e.defaultPrevented,F=(ki()||b)&&!C&&!Yo(r)&&!v;s.focusCell(F,e)}if(t&&m&&!l.isCellFocused(f)){e.preventDefault();const C=l.getFocusedCell();if(C){const{column:y,rowIndex:b,rowPinned:F}=C;u!=null&&u.isEditing(C)&&(u==null||u.stopEditing(C)),l.setFocusedCell({column:y,rowIndex:b,rowPinned:F,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}v||(o==null||o.handleCellMouseDown(e,f),g())}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const r=t.isCellInAnyRange(this.cellCtrl.cellPosition),s=F2(this.beans,e);if(r&&s)return!0}return!1}containsWidget(e){return ji(e,"ag-selection-checkbox",3)||ji(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),r==null||r.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),r==null||r.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,r=t.contains(e.target),s=t.contains(e.relatedTarget);return r&&s}},lO=class extends ee{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){const t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){const t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Ei(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,r=e.getColSpan(t),s=[];if(r===1)s.push(e);else{let i=e;const n=e.getPinned();for(let o=0;i&&o<r&&(s.push(i),i=this.beans.visibleCols.getColAfter(i),!(!i||ct(i)||n!==i.getPinned()));o++);}return s}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=nt(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;const{visibleCols:t}=this.beans,r=t.getColsLeftWidth();if(this.column.getPinned()==="right"){const s=t.bodyWidth;return r+s+(e||0)}return r+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;const r=qi(this.beans)*this.rowSpan;this.eContent.style.height=`${r}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},cO="ag-cell",uO="ag-cell-auto-height",dO="ag-cell-normal-height",hO="ag-cell-focus",fO="ag-cell-first-right-pinned",gO="ag-cell-last-left-pinned",pO="ag-cell-not-inline-editing",mO="ag-cell-wrap-text",vO=0,ro=class extends ee{constructor(e,t,r,s){super(),this.column=e,this.rowNode=t,this.rowCtrl=s,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.formulaTooltipFeature=void 0,this.beans=r,this.gos=r.gos,this.editSvc=r.editSvc,this.hasEdit=!!r.editSvc;const{colId:i}=e;this.instanceId=i+"-"+vO++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){var s,i;const{beans:e}=this;this.positionFeature=new lO(this,e),this.customStyleFeature=(s=e.cellStyles)==null?void 0:s.createCellCustomStyleFeature(this),this.editStyleFeature=(i=e.editSvc)==null?void 0:i.createCellStyleFeature(this),this.mouseListener=new aO(this,e,this.column),this.keyboardListener=new oO(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature(),this.enableFormulaTooltipFeature();const{rangeSvc:t}=e;t&&wi(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(this)),Gs(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature(),this.disableFormulaTooltipFeature()}enableTooltipFeature(e,t){var r;this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.enableCellTooltipFeature(this,e,t)}enableFormulaTooltipFeature(){var e;this.formulaTooltipFeature=(e=this.beans.tooltipSvc)==null?void 0:e.setupFormulaTooltip(this)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}disableFormulaTooltipFeature(){this.formulaTooltipFeature=this.beans.context.destroyBean(this.formulaTooltipFeature)}enableEditorTooltipFeature(e){var t;this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=(t=this.beans.tooltipSvc)==null?void 0:t.setupCellEditorTooltip(this,e),un(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,r,s,i,n,o){var a,l,c,u,d,h,f,p,g;if(this.comp=e,this.eGui=t,this.printLayout=i,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(s,o),this.refreshFirstAndLastStyles(),this.checkFormulaError(),this.refreshAriaColIndex(),(a=this.positionFeature)==null||a.init(),(l=this.customStyleFeature)==null||l.setComp(e),(c=this.editStyleFeature)==null||c.setComp(e),(u=this.tooltipFeature)==null||u.refreshTooltip(),(d=this.keyboardListener)==null||d.init(),(h=this.rangeFeature)==null||h.setComp(e),(f=this.rowResizeFeature)==null||f.refreshRowResizer(),n&&this.isCellEditable()||this.hasEdit&&((p=this.editSvc)!=null&&p.isEditing(this,{withOpenEditor:!0}))?(g=this.editSvc)==null||g.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(const m of this.onCompAttachedFuncs)m();this.onCompAttachedFuncs=[]}}checkFormulaError(){var t,r;const e=!!((t=this.beans.formula)!=null&&t.getFormulaError(this.column,this.rowNode));this.eGui.classList.toggle("formula-error",e),(r=this.formulaTooltipFeature)==null||r.refreshTooltip(),e?this.disableTooltipFeature():this.enableTooltipFeature()}setupAutoHeight(e,t){var r;this.isAutoHeight=((r=this.beans.rowAutoHeight)==null?void 0:r.setupCellAutoHeight(this,e,t))??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){var l,c;const{beans:e,column:t}=this,{userCompFactory:r,ctrlsSvc:s,eventSvc:i}=e,n=t.getColDef(),o=this.createCellRendererParams();o.deferRender=!0;const a=Up(r,n,o);if((c=(l=s.getGridBodyCtrl())==null?void 0:l.scrollFeature)!=null&&c.isScrolling()){let u;const d=new Ue(f=>{u=f}),[h]=this.addManagedListeners(i,{bodyScrollEnd:()=>{u(),h()}});return{loadingComp:a,onReady:d}}return{loadingComp:a,onReady:Ue.resolve()}}showValue(e,t){var d,h,f,p;const{beans:r,column:s,rowNode:i,rangeFeature:n}=this,{userCompFactory:o}=r;let a=this.getValueToDisplay(),l;const c=i.stub&&((d=i.groupData)==null?void 0:d[s.getId()])==null,u=s.getColDef();if(c||this.isCellRenderer()){const g=this.createCellRendererParams();!c||Gs(s)?l=zp(o,u,g):l=Up(o,u,g)}if(!l&&!c&&((h=r.findSvc)!=null&&h.isMatch(i,s))){const g=this.createCellRendererParams();l=zp(o,{...s.getColDef(),cellRenderer:"agFindCellRenderer"},g)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(i,{checkSiblings:!0})){const g=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});g&&(g.compDetails?l=g.compDetails:g.valueToDisplay&&(a=g.valueToDisplay))}this.comp.setRenderDetails(l,a,e),(f=this.customRowDragComp)==null||f.refreshVisibility(),!t&&n&&ti(r,()=>n==null?void 0:n.refreshHandle()),(p=this.rowResizeFeature)==null||p.refreshRowResizer()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){const e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer";let r="";return t&&(r=" ag-allow-overflow"),`${e}${r}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&Za(this.rowNode))&&!!e}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:r}=this.beans.gridOptions,s=Ec(t),i=Ti(this.column);return r==="custom"&&s!=="selectionColumn"&&i?!1:e.checkboxSelection||i&&typeof t=="object"&&Kn(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),r=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),s=this.includeDndSource!=this.isIncludeControl(e.dndSource),i=this.isAutoHeight!=this.column.isAutoHeight();return t||r||s||i}onPopupEditorClosed(){const{editSvc:e}=this.beans;e!=null&&e.isEditing(this,{withOpenEditor:!0})&&(e==null||e.stopEditing(this,{source:e!=null&&e.isBatchEditing()?"ui":"api"}))}stopEditing(e=!1){const{editSvc:t}=this.beans;return(t==null?void 0:t.stopEditing(this,{cancel:e,source:t!=null&&t.isBatchEditing()?"ui":"api"}))??!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:r,rowNode:s,comp:i,eGui:n,beans:{valueSvc:o,gos:a,editSvc:l}}=this;return ke(a,{value:e,valueFormatted:t,getValue:()=>o.getValueForDisplay({column:r,node:s}).value,setValue:u=>(l==null?void 0:l.setDataValue({rowNode:s,column:r},u))||s.setDataValue(r,u),formatValue:this.formatValue.bind(this),data:s.data,node:s,pinned:r.getPinned(),colDef:r.getColDef(),column:r,refreshCell:this.refreshCell.bind(this),eGridCell:n,eParentOfValue:i.getParentOfValue(),registerRowDragger:(u,d,h,f)=>this.registerRowDragger(u,d,f),setTooltip:(u,d)=>{var h;a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(u,d),(h=this.tooltipFeature)==null||h.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){var t;if(this.refreshShouldDestroy()?(t=this.rowCtrl)==null||t.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){const{editSvc:r,comp:s}=this;!(s!=null&&s.getCellEditor())&&r.isEditing(this,{withOpenEditor:!0})&&r.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:r}={}){var b;const{editStyleFeature:s,customStyleFeature:i,rowCtrl:{rowEditStyleFeature:n},beans:{cellFlashSvc:o,filterManager:a},column:l,comp:c,suppressRefreshCell:u,tooltipFeature:d}=this;if(u)return;const{field:h,valueGetter:f,showRowGroup:p,enableCellChangeFlash:g}=l.getColDef(),m=h==null&&f==null&&p==null,v=e||m||r,w=!!c,C=this.updateAndFormatValue(w),y=v||C;if(w){if(y){this.showValue(!!r,!1);const F=a==null?void 0:a.isSuppressFlashingCellsBecauseFiltering();!t&&!F&&g&&(o==null||o.flashCell(this)),(b=s==null?void 0:s.applyCellStyles)==null||b.call(s),i==null||i.applyUserStyles(),i==null||i.applyClassesFromColDef(),n==null||n.applyRowStyles(),this.checkFormulaError()}d==null||d.refreshTooltip(),i==null||i.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,r=this.valueFormatted,{value:s,valueFormatted:i}=this.beans.valueSvc.getValueForDisplay({column:this.column,node:this.rowNode,includeValueFormatted:!0});return this.value=s,this.valueFormatted=i,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=r:!0}valuesAreEqual(e,t){const r=this.column.getColDef();return r.equals?r.equals(e,t):e===t}addDomData(e){const t=this.eGui;an(this.beans.gos,t,Oc,this),e.addDestroyFunc(()=>an(this.beans.gos,t,Oc,null))}createEvent(e,t){const{rowNode:r,column:s,value:i,beans:n}=this;return iO(n,e,t,{rowNode:r,column:s},i)}processCharacter(e){var t;(t=this.keyboardListener)==null||t.processCharacter(e)}onKeyDown(e){var t;(t=this.keyboardListener)==null||t.onKeyDown(e)}onMouseEvent(e,t){var r;(r=this.mouseListener)==null||r.onMouseEvent(e,t)}getColSpanningList(){var e;return((e=this.positionFeature)==null?void 0:e.getColSpanningList())??[]}onLeftChanged(){var e;this.comp&&((e=this.positionFeature)==null||e.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:r}=this;Kw(e,t,r.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);pC(this.eGui,e)}onWidthChanged(){var e;return(e=this.positionFeature)==null?void 0:e.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){var e;this.comp&&((e=this.rangeFeature)==null||e.updateRangeBordersIfRangeCount())}onCellSelectionChanged(){var e;this.comp&&((e=this.rangeFeature)==null||e.onCellSelectionChanged())}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){var s;const r=(s=this.editSvc)==null?void 0:s.allowedFocusTargetOnValidation(this);r&&r!==this||this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e,sourceEvent:t})}restoreFocus(e=!1){const{beans:{editSvc:t,focusSvc:r},comp:s}=this;if(!s||t!=null&&t.isEditing(this)||!this.isCellFocused()||!r.shouldTakeFocus())return;const i=()=>{if(!this.isAlive())return;const n=s.getFocusableElement();this.isCellFocused()&&n.focus({preventScroll:!0})};if(e){setTimeout(i,0);return}i()}onRowIndexChanged(){var e,t;this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),(e=this.rangeFeature)==null||e.onCellSelectionChanged(),(t=this.rowResizeFeature)==null||t.refreshRowResizer()}onSuppressCellFocusChanged(e){const t=this.eGui;t&&(Gs(this.column)&&(e=!0),pr(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.toggleCss(fO,e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.toggleCss(gO,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){var i;const{beans:t}=this;if(Fu(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}const r=this.isCellFocused(),s=((i=t.editSvc)==null?void 0:i.isEditing(this))??!1;if(this.comp.toggleCss(hO,r),r&&(e!=null&&e.forceBrowserFocus)){let n=this.comp.getFocusableElement();if(s){const o=Jn(n,null,!0);o.length&&(n=o[0])}n.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}r&&e&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:Vs(t),column:this.column}}applyStaticCssClasses(){const{comp:e}=this;e.toggleCss(cO,!0),e.toggleCss(pO,!0);const t=this.column.isAutoHeight()==!0;e.toggleCss(uO,t),e.toggleCss(dO,!t)}onColumnHover(){var e;(e=this.beans.colHover)==null||e.onCellColumnHover(this.column,this.comp)}onColDefChanged(){var e,t;this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),(e=this.editSvc)!=null&&e.isEditing(this)?(t=this.editSvc)==null||t.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(mO,e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),r=this.createEvent(e,"cellContextMenu"),{beans:s}=this;s.eventSvc.dispatchEvent(r),t.onCellContextMenu&&window.setTimeout(()=>{s.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(r)})},0)}getCellRenderer(){var e;return((e=this.comp)==null?void 0:e.getCellRenderer())??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){var e;return((e=this.eGui)==null?void 0:e.contains(pt(this.beans)))??!1}createSelectionCheckbox(){var t;const e=(t=this.beans.selectionSvc)==null?void 0:t.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,r){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}const s=this.createRowDragComp(e,t,r);s&&(this.customRowDragComp=s,this.addDestroyFunc(()=>{this.beans.context.destroyBean(s),this.customRowDragComp=null}),s.refreshVisibility())}createRowDragComp(e,t,r){var i;const s=(i=this.beans.rowDragSvc)==null?void 0:i.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,r);if(s)return this.beans.context.createBean(s),s}cellEditorAttached(){for(const e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function eg(e,t,r,s,i,n){if(r==null&&t==null)return;const o={},a={},l=(c,u)=>{for(const d of c.split(" "))d.trim()!=""&&u(d)};if(r){const c=Object.keys(r);for(let u=0;u<c.length;u++){const d=c[u],h=r[d];let f;typeof h=="string"?f=e?e.evaluate(h,s):!0:typeof h=="function"&&(f=h(s)),l(d,p=>{f?o[p]=!0:a[p]=!0})}}if(t&&n)for(const c of Object.keys(t))l(c,u=>{o[u]||(a[u]=!0)});n&&Object.keys(a).forEach(n),Object.keys(o).forEach(i)}function L0(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var CO=class extends ee{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){const r=this.gos,s=o=>{if(typeof o=="string")e.push(o);else if(Array.isArray(o))for(const a of o)e.push(a)},i=r.get("rowClass");i&&s(i);const n=r.getCallback("getRowClass");if(n){const o={data:t.data,node:t,rowIndex:t.rowIndex},a=n(o);s(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,r=>{e.push(r)},()=>{})}processRowClassRules(e,t,r){const{gos:s,expressionSvc:i}=this.beans,n=ke(s,{data:e.data,node:e,rowIndex:e.rowIndex});eg(i,void 0,s.get("rowClassRules"),n,t,r)}processStylesFromGridOptions(e){const t=this.gos,r=t.get("rowStyle"),s=t.getCallback("getRowStyle");let i;if(s){const n={data:e.data,node:e,rowIndex:e.rowIndex};i=s(n)}if(i||r)return Object.assign({},r,i)}},wO=0,Gc=class extends ee{constructor(e,t,r,s,i){var n,o;super(),this.rowNode=e,this.useAnimationFrameForCreate=s,this.printLayout=i,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=((n=t.pagination)==null?void 0:n.getCurrentPage())??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+wO++,this.rowId=Xo(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=L0(this.rowNode),this.setRowType(),this.setAnimateFlags(r),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=(o=t.editSvc)==null?void 0:o.createRowStyleFeature(this),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Xo(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,r,s){var d,h;const{context:i,focusSvc:n}=this.beans;s=Ka(this,i,s);const o={rowComp:e,element:t,containerType:r,compBean:s};this.allRowGuis.push(o),this.updateGui(r,o),this.initialiseRowComp(o);const a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,c=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!c&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const u=(d=this.fullWidthGui)==null?void 0:d.element;u&&!((h=this.beans.editSvc)!=null&&h.isEditing(this))&&n.isRowFocused(a.rowIndex,a.rowPinned)&&n.shouldTakeFocus()&&setTimeout(()=>u.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";for(const r of this.allRowGuis)r.element.style.display=t}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),Ki(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const r=e.rowComp,s=this.getInitialRowClasses(e.containerType);for(const i of s)r.toggleCss(i,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&ah(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(r),this.setRowCompRowBusinessKey(r),an(t,e.element,Nc,this),e.compBean.addDestroyFunc(()=>an(t,e.element,Nc,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=Xo(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(ch(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(ch(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){var s;const t=(s=this.beans.rowDragSvc)==null?void 0:s.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const r=this.createBean(t,this.beans.context);this.rowDragComps.push(r),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(i=>i!==r),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(r,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),r=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(r)}getFullWidthCellRenderers(){var e,t;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(r=>{var s;return(s=r==null?void 0:r.rowComp)==null?void 0:s.getFullWidthCellRenderer()}):[(t=(e=this.fullWidthGui)==null?void 0:e.rowComp)==null?void 0:t.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:r,beans:{visibleCols:s}}=this,i=!!e||!s.isPinningLeft(),n=!!t,o=!!r||!s.isPinningRight();return i&&n&&o}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){const{rowNode:e,gos:t,beans:{colModel:r}}=this,s=e.stub&&!t.get("suppressServerSideFullWidthLoadingRow")&&!t.get("groupHideOpenParents"),i=this.isNodeFullWidthCell(),n=t.get("masterDetail")&&e.detail,o=r.isPivotMode(),a=WC(t,e,o);s?this.rowType="FullWidthLoading":n?this.rowType="FullWidthDetail":i?this.rowType="FullWidth":a?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;const{animationFrameSvc:r}=this.beans;if(!(r!=null&&r.active)||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(r.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){var r;if(!((r=this.beans.rowSpanSvc)!=null&&r.isCellSpanning(e,this.rowNode)))return new ro(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){var t;return!((t=this.beans.rowSpanSvc)!=null&&t.isCellSpanning(e.column,this.rowNode))}createCellCtrls(e,t,r=null){const s={list:[],map:{}},i=(c,u,d)=>{d!=null?s.list.splice(d,0,u):s.list.push(u),s.map[c]=u},n=[];for(const c of t){const u=c.getInstanceId();let d=e.map[u];d&&!this.isCorrectCtrlForSpan(d)&&(d.destroy(),d=void 0),d||(d=this.getNewCellCtrl(c)),d&&i(u,d)}for(const c of e.list){const u=c.column.getInstanceId();if(s.map[u]!=null)continue;!this.isCellEligibleToBeRemoved(c,r)?n.push([u,c]):c.destroy()}if(n.length)for(const[c,u]of n){const d=s.list.findIndex(f=>f.column.getLeft()>u.column.getLeft()),h=d===-1?void 0:Math.max(d-1,0);i(c,u,h)}const{focusSvc:o,visibleCols:a}=this.beans,l=o.getFocusedCell();if(l&&l.column.getPinned()==r){const c=l.column.getInstanceId();if(!s.map[c]&&a.allCols.includes(l.column)){const d=this.createFocusedCellCtrl();if(d){const h=s.list.findIndex(p=>p.column.getLeft()>d.column.getLeft()),f=h===-1?void 0:Math.max(h-1,0);i(c,d,f)}}}return s}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,r=e.getFocusedCell();if(!r)return;const s=t==null?void 0:t.getCellSpan(r.column,this.rowNode);if(s){if(s.firstNode!==this.rowNode||!s.doesSpanContain(r))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(r.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(const t of this.allRowGuis){const r=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(r,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const r=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r);const s=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,s,"left");const i=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,i,"right")}}isCellEligibleToBeRemoved(e,t){const{column:i}=e;if(i.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;const{visibleCols:n,editSvc:o}=this.beans,a=o==null?void 0:o.isEditing(e),l=e.isCellFocused();return a||l?!(n.allCols.indexOf(i)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||qt(this.gos,"print")}listenOnDomOrder(e){const t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=Ce(this.rowNode.oldRowTop),{visibleCols:r}=this.beans,s=r.isPinningLeft(),i=r.isPinningRight();if(t){const{slideInAnimation:n}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){n.fullWidth=!0;return}n.center=!0,n.left=s,n.right=i}else{const{fadeInAnimation:n}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){n.fullWidth=!0;return}n.center=!0,n.left=s,n.right=i}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(o,a)=>o?o.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(o.element,a).params):!0,t=e(this.fullWidthGui,null),r=e(this.centerGui,null),s=e(this.leftGui,"left"),i=e(this.rightGui,"right");return t&&r&&s&&i}addListeners(){const{beans:e,gos:t,rowNode:r}=this,{expansionSvc:s,eventSvc:i,context:n,rowSpanSvc:o}=e;this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...(s==null?void 0:s.getRowExpandedListeners(this))??{}}),r.detail&&this.addManagedListeners(r.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(r,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(i,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),o&&this.addManagedListeners(o,{spannedCellsUpdated:({pinned:a})=>{a&&!r.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,n),this.tooltipFeature=this.destroyBean(this.tooltipFeature,n),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,n)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(const l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,n)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(const e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(const t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(const e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(const r of this.getAllCellCtrls())r.refreshCell(e);for(const r of this.allRowGuis)this.setRowCompRowId(r.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(r.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){var e;this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),(e=this.rowEditStyleFeature)==null||e.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.beans.rowDropHighlightSvc,t=(e==null?void 0:e.row)===this.rowNode?e.position:"none",r=t==="above",s=t==="inside",i=t==="below",n=t!=="none",o=r||i,a=this.rowNode.uiLevel,l=o&&a>0,c=l?a.toString():"0";for(const u of this.allRowGuis){const d=u.rowComp;d.toggleCss("ag-row-highlight-above",r),d.toggleCss("ag-row-highlight-inside",s),d.toggleCss("ag-row-highlight-below",i),d.toggleCss("ag-row-highlight-indent",l),n?u.element.style.setProperty("--ag-row-highlight-level",c):u.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){const e=this.rowNode.dragging;for(const t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){var e;this.updateColumnLists(!0),(e=this.beans.rowAutoHeight)==null||e.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Vs(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:r,column:s}=t;if(!(r.element===e.target))return;const o=this.rowNode,{focusSvc:a,navigation:l}=this.beans,c=a.getFocusedCell(),u={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:(c==null?void 0:c.column)??s};l==null||l.navigateToNextCell(e,e.key,u,!0),e.preventDefault()}onTabKeyDown(e){var a;if(e.defaultPrevented||zs(e))return;const t=this.allRowGuis.find(l=>l.element.contains(e.target)),r=t?t.element:null,s=r===e.target,i=pt(this.beans);let n=!1;r&&i&&(n=r.contains(i)&&i.classList.contains("ag-cell"));let o=null;!s&&!n&&(o=yn(this.beans,r,!1,e.shiftKey)),(this.isFullWidth()&&s||!o)&&((a=this.beans.navigation)==null||a.onTabKeyDown(this,e))}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var t;const e=(t=this.allRowGuis.find(r=>Qs(r.element)))==null?void 0:t.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(const r of this.allRowGuis)pr(r.element,"tabindex",t)}onFullWidthRowFocused(e){var i,n,o;const t=this.rowNode,r=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1;let s;if(this.fullWidthGui)s=this.fullWidthGui.element;else{const a=this.beans.colModel.getCol(e==null?void 0:e.column),l=a==null?void 0:a.pinned;l?s=l==="right"?(i=this.rightGui)==null?void 0:i.element:(n=this.leftGui)==null?void 0:n.element:s=(o=this.centerGui)==null?void 0:o.element}s&&(s.classList.toggle("ag-full-width-focus",r),r&&(e!=null&&e.forceBrowserFocus)&&s.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const r={list:[],map:{}};for(const s of e.list)s!==t&&(r.list.push(s),r.map[s.column.getInstanceId()]=s);return r}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){const{rowNode:r}=this;return ke(this.gos,{type:e,node:r,data:r.data,rowIndex:r.rowIndex,rowPinned:r.rowPinned,event:t})}createRowEventWithSource(e,t){const r=this.createRowEvent(e,t);return r.source=this,r}onRowDblClick(e){if(zs(e))return;const t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),r=this.getColumnForFullWidth(t);if(!(!t||!r))return{rowGui:t,column:r}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e==null?void 0:e.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=ji(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;const{rangeSvc:t,focusSvc:r}=this.beans;t==null||t.removeAllCellRanges();const s=this.findFullWidthInfoForEvent(e);if(!s)return;const{rowGui:i,column:n}=s,o=i.element,a=e.target,l=this.rowNode;let c=e.defaultPrevented||ki();o&&o.contains(a)&&Yo(a)&&(c=!1),r.setFocusedCell({rowIndex:l.rowIndex,column:n,rowPinned:l.rowPinned,forceBrowserFocus:c})}isSuppressMouseEvent(e){const{gos:t,rowNode:r}=this;if(this.isFullWidth()){const i=this.findFullWidthRowGui(e.target);return TD(t,i==null?void 0:i.rowComp.getFullWidthCellRendererParams(),r,e)}const s=jf(t,e.target);return s!=null&&rc(t,s.column,r,e)}onRowClick(e){if(zs(e)||this.lastMouseDownOnDragger)return;const r=this.isSuppressMouseEvent(e),{eventSvc:s,selectionSvc:i}=this.beans,n=this.createRowEventWithSource("rowClicked",e);n.isEventHandlingSuppressed=r,s.dispatchEvent(n),!r&&(i==null||i.handleSelectionEvent(e,this.rowNode,"rowClicked"))}setupDetailRowAutoHeight(e){var t;this.rowType==="FullWidthDetail"&&((t=this.beans.masterDetailSvc)==null||t.setupDetailRowAutoHeight(this,e))}createFullWidthCompDetails(e,t){const{gos:r,rowNode:s}=this,i=ke(r,{fullWidth:!0,data:s.data,node:s,value:s.key,valueFormatted:s.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(o,a,l,c)=>this.addFullWidthRowDragging(o,a,l,c),setTooltip:(o,a)=>{r.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(o,a)}}),n=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return Rk(n,i);case"FullWidthGroup":{const{value:o,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay({node:this.rowNode,includeValueFormatted:!0});return i.value=o,i.valueFormatted=a,Fk(n,i)}case"FullWidthLoading":return bk(n,i);default:return Sk(n,i)}}setupFullWidthRowTooltip(e,t){var r;this.fullWidthGui&&(this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,r="",s){const{rowDragSvc:i,context:n}=this.beans;if(!i||!this.isFullWidth())return;const o=i.createRowDragComp(()=>r,this.rowNode,void 0,e,t,s);this.createBean(o,n),this.addDestroyFunc(()=>{this.destroyBean(o,n)})}onUiLevelChanged(){const e=L0(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,r="ag-row-level-"+this.rowLevel;for(const s of this.allRowGuis)s.rowComp.toggleCss(t,!0),s.rowComp.toggleCss(r,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){var t;const e=[];if((t=this.beans.rowStyleSvc)==null||t.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(const r of e)for(const s of this.allRowGuis)s.rowComp.toggleCss(r,!0)}postProcessRowClassRules(){var e;(e=this.beans.rowStyleSvc)==null||e.processRowClassRules(this.rowNode,t=>{for(const r of this.allRowGuis)r.rowComp.toggleCss(t,!0)},t=>{for(const r of this.allRowGuis)r.rowComp.toggleCss(t,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,r=>r.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){var a,l;const t=this.getPinnedForContainer(e),r=this.isFullWidth(),{rowNode:s,beans:i}=this,n=[];n.push("ag-row"),n.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&n.push("ag-opacity-zero"),n.push(s.rowIndex%2===0?"ag-row-even":"ag-row-odd"),s.isRowPinned()&&(n.push("ag-row-pinned"),(a=i.pinnedRowModel)!=null&&a.isManual()&&n.push("ag-row-pinned-manual")),!s.isRowPinned()&&s.pinnedSibling&&n.push("ag-row-pinned-source"),s.isSelected()&&n.push("ag-row-selected"),s.footer&&n.push("ag-row-footer"),n.push("ag-row-level-"+this.rowLevel),s.stub&&n.push("ag-row-loading"),r&&n.push("ag-full-width-row"),(l=i.expansionSvc)==null||l.addExpandedCss(n,s),s.dragging&&n.push("ag-row-dragging");const{rowStyleSvc:o}=i;return o&&(o.processClassesFromGridOptions(n,s),o.preProcessRowClassRules(n,s)),n.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&n.push("ag-row-first"),this.isLastRowOnPage()&&n.push("ag-row-last"),r&&(t==="left"&&n.push("ag-cell-last-left-pinned"),t==="right"&&n.push("ag-cell-first-right-pinned")),n}processStylesFromGridOptions(){var e;return((e=this.beans.rowStyleSvc)==null?void 0:e.processStylesFromGridOptions(this.rowNode))??this.emptyStyle}onRowSelected(e){var t;(t=this.beans.selectionSvc)==null||t.onRowCtrlSelected(this,r=>{(r===this.centerGui||r===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){var e;(e=this.beans.selectionSvc)==null||e.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:r}=e,{rowNode:s,beans:i,gos:n}=this;r.addManagedListeners(t,{pointerenter:o=>{o.pointerType==="mouse"&&s.dispatchRowEvent("mouseEnter")},pointerleave:o=>{o.pointerType==="mouse"&&s.dispatchRowEvent("mouseLeave")}}),r.addManagedListeners(s,{mouseEnter:()=>{var o;!((o=i.dragSvc)!=null&&o.dragging)&&!n.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),s.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map(r=>r.element);for(const r of t)r.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),r=this.applyPaginationOffset(t.top,!0)-100,s=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(r,e),s)}forEachGui(e,t){if(e)t(e);else for(const r of this.allRowGuis)t(r)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const t=this.rowNode.rowHeight,r=this.beans.environment.getDefaultRowHeight(),i=NC(this.gos)?Ci(this.beans,this.rowNode).height:void 0,n=i?`${Math.min(r,i)-2}px`:void 0;this.forEachGui(e,o=>{o.element.style.height=`${t}px`,n&&o.element.style.setProperty("--ag-line-height",n)})}destroyFirstPass(e=!1){var s;this.active=!1;const{rowNode:t}=this;if(!e&&$n(this.gos)&&!t.sticky)if(t.rowTop!=null){const n=this.roundRowTopToBounds(t.rowTop);this.setRowTop(n)}else for(const n of this.allRowGuis)n.rowComp.toggleCss("ag-opacity-zero",!0);(s=this.fullWidthGui)!=null&&s.element.contains(pt(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const r=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(r),this.beans.eventSvc.dispatchEvent(r),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;const e=t=>{for(const r of t.list)r.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){var t;const e=((t=this.beans.pagination)==null?void 0:t.getCurrentPage())??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const r=this.beans.pageBounds.getPixelOffset();return e+r*(t?1:-1)}setRowTop(e){if(!this.printLayout&&Ce(e)){const t=this.applyPaginationOffset(e),i=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(i)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let r;if(t.sticky)r=t.stickyRowTop;else{const s=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,i=this.applyPaginationOffset(s);r=t.isRowPinned()?i:this.beans.rowContainerHeight.getRealPixelPosition(i)}return r+"px"}setRowTopStyle(e){for(const t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let r=null;for(const s of this.getAllCellCtrls())s.column==e&&(r=s);if(r!=null||t)return r;for(const s of this.getAllCellCtrls())(s==null?void 0:s.getColSpanningList().indexOf(e))>=0&&(r=s);return r}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){var n,o;const t=this.rowNode.getRowIndexString();if(t===null)return;const r=(((n=this.beans.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:n.getRowCount())??0)+(((o=this.beans.filterManager)==null?void 0:o.getHeaderRowCount())??0),s=this.rowNode.rowIndex%2===0,i=r+this.rowNode.rowIndex+1;this.forEachGui(e,a=>{a.rowComp.setRowIndex(t),a.rowComp.toggleCss("ag-row-even",s),a.rowComp.toggleCss("ag-row-odd",!s),gC(a.element,i)})}},xO=class extends ee{constructor(){super(),this.beanName="navigation",this.onPageDown=_p(this.onPageDown,100),this.onPageUp=_p(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const r=e.key,s=e.altKey,i=e.ctrlKey||e.metaKey,n=!!this.beans.rangeSvc&&e.shiftKey,o=KD(this.gos,e);let a=!1;switch(r){case K.PAGE_HOME:case K.PAGE_END:!i&&!s&&(this.onHomeOrEndKey(r),a=!0);break;case K.LEFT:case K.RIGHT:case K.UP:case K.DOWN:if(!o)return!1;i&&!s&&!n&&(this.onCtrlUpDownLeftRight(r,o),a=!0);break;case K.PAGE_DOWN:case K.PAGE_UP:!i&&!s&&(a=this.handlePageUpDown(r,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,r){return r&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===K.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:r,focusIndex:s,focusColumn:i,isAsync:n,rowPinned:o}){const{scrollFeature:a}=this.gridBodyCon;Ce(r)&&!r.isPinned()&&a.ensureColumnVisible(r),Ce(e)&&a.ensureIndexVisible(e,t),n||a.ensureIndexVisible(s);const{focusSvc:l,rangeSvc:c}=this.beans;l.setFocusedCell({rowIndex:s,column:i,rowPinned:o,forceBrowserFocus:!0}),c==null||c.setRangeToCell({rowIndex:s,rowPinned:o,column:i})}onPageDown(e){const t=this.beans,r=kd(t),s=this.getViewportHeight(),{pageBounds:i,rowModel:n,rowAutoHeight:o}=t,a=i.getPixelOffset(),l=r.top+s,c=n.getRowIndexAtPixel(l+a);o!=null&&o.active?this.navigateToNextPageWithAutoHeight(e,c):this.navigateToNextPage(e,c)}onPageUp(e){const t=this.beans,r=kd(t),{pageBounds:s,rowModel:i,rowAutoHeight:n}=t,o=s.getPixelOffset(),a=r.top,l=i.getRowIndexAtPixel(a+o);n!=null&&n.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,r=!1){const{pageBounds:s,rowModel:i}=this.beans,n=this.getViewportHeight(),o=s.getFirstRow(),a=s.getLastRow(),l=s.getPixelOffset(),c=i.getRow(e.rowIndex),u=r?(c==null?void 0:c.rowHeight)-n-l:n-l,d=(c==null?void 0:c.rowTop)+u;let h=i.getRowIndexAtPixel(d+l);if(h===e.rowIndex){const p=r?-1:1;t=h=e.rowIndex+p}let f;r?(f="bottom",h<o&&(h=o),t<o&&(t=o)):(f="top",h>a&&(h=a),t>a&&(t=a)),this.isRowTallerThanView(i.getRow(h))&&(t=h,f="top"),this.navigateTo({scrollIndex:t,scrollType:f,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,r=!1){this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const s=this.getNextFocusIndexForAutoHeight(e,r);this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:s,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const r=t?-1:1,s=this.getViewportHeight(),{pageBounds:i,rowModel:n}=this.beans,o=i.getLastRow();let a=0,l=e.rowIndex;for(;l>=0&&l<=o;){const c=n.getRow(l);if(c){const u=c.rowHeight??0;if(a+u>s)break;a+=u}l+=r}return Math.max(0,Math.min(l,o))}getViewportHeight(){const e=this.beans,t=kd(e),r=this.beans.scrollVisibleSvc.getScrollbarWidth();let s=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(s-=r),s}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const r=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),s=this.getNormalisedPosition(r),{rowIndex:i,rowPinned:n,column:o}=s??r,a=o;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:a,focusIndex:i,focusColumn:a,rowPinned:n})}onHomeOrEndKey(e){const t=e===K.PAGE_HOME,{visibleCols:r,pageBounds:s,rowModel:i}=this.beans,n=r.allCols,o=t?s.getFirstRow():s.getLastRow(),a=i.getRow(o);if(!a)return;const l=(t?n:[...n].reverse()).find(c=>!c.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:l,focusIndex:o,focusColumn:l})}onTabKeyDown(e,t){const r=t.shiftKey,s=this.tabToNextCellCommon(e,r,t),i=this.beans,{ctrlsSvc:n,pageBounds:o,focusSvc:a,gos:l}=i;if(s!==!1){s?t.preventDefault():s===null&&n.get("gridCtrl").allowFocusForNextCoreContainer(r);return}if(r){const{rowIndex:c,rowPinned:u}=e.getRowPosition();(u?c===0:c===o.getFirstRow())&&(l.get("headerHeight")===0||Yi(i)?fo(i,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof ro&&e.focusCell(!0),(a.focusOverlay(!1)||fo(i,r))&&t.preventDefault()}tabToNextCell(e,t){const r=this.beans,{focusSvc:s,rowRenderer:i}=r,n=s.getFocusedCell();if(!n)return!1;let o=Vn(r,n);return!o&&(o=i.getRowByPosition(n),!(o!=null&&o.isFullWidth()))?!1:!!this.tabToNextCellCommon(o,e,t,"api")}tabToNextCellCommon(e,t,r,s="ui"){var l;const{editSvc:i,focusSvc:n}=this.beans;let o;const a=e instanceof ro?e:(l=e.getAllCellCtrls())==null?void 0:l[0];return i!=null&&i.isEditing()?o=i==null?void 0:i.moveToNextCell(a,t,r,s):o=this.moveToNextCellNotEditing(e,t,r),o===null?o:o||!!n.focusedHeader}moveToNextCellNotEditing(e,t,r){const s=this.beans.visibleCols.allCols;let i;if(e instanceof Gc){if(i={...e.getRowPosition(),column:t?s[0]:nt(s)},this.gos.get("embedFullWidthRows")&&r){const o=e.findFullWidthInfoForEvent(r);o&&(i.column=o.column)}}else i=e.getFocusedCellPosition();const n=this.findNextCellToFocusOn(i,{backwards:t,startEditing:!1});if(n===!1)return null;if(n instanceof ro)n.focusCell(!0);else if(n)return this.tryToFocusFullWidthRow(n,t);return Ce(n)}findNextCellToFocusOn(e,{backwards:t,startEditing:r,skipToNextEditableCell:s}){let i=e;const n=this.beans,{cellNavigation:o,gos:a,focusSvc:l,rowRenderer:c,rangeSvc:u}=n;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=o.getNextTabbedCell(i,t);const d=a.getCallback("tabToNextCell");if(Ce(d)){const g=d({backwards:t,editing:r,previousCellPosition:e,nextCellPosition:i||null});if(g===!0)i=e;else{if(g===!1)return!1;i={rowIndex:g.rowIndex,column:g.column,rowPinned:g.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const p=ys(n);return l.focusHeaderPosition({headerPosition:{headerRowIndex:p+i.rowIndex,column:i.column},fromCell:!0}),null}const h=a.get("editType")==="fullRow";if(r&&(!h||s)&&!this.isCellEditable(i))continue;this.ensureCellVisible(i);const f=Vn(n,i);if(!f){const p=c.getRowByPosition(i);if(!p||!p.isFullWidth()||r)continue;return{...p.getRowPosition(),column:i==null?void 0:i.column}}if(!o.isSuppressNavigable(f.column,f.rowNode))return f.setFocusedCellPosition(i),u==null||u.setRangeToCell(i),f}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){const{pinnedRowModel:r,rowModel:s}=this.beans;return t==="top"?r==null?void 0:r.getPinnedTopRow(e):t==="bottom"?r==null?void 0:r.getPinnedBottomRow(e):s.getRow(e)}navigateToNextCell(e,t,r,s){let i=r,n=!1;const o=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=o;for(;i&&(i===r||!this.isValidNavigateCell(i));)c.get("enableRtl")?t===K.LEFT&&(i=this.getLastCellOfColSpan(i)):t===K.RIGHT&&(i=this.getLastCellOfColSpan(i)),i=a.getNextCellToFocus(t,i),n=ct(i);if(n&&e&&e.key===K.UP&&(i={rowIndex:-1,rowPinned:null,column:r.column}),s){const d=c.getCallback("navigateToNextCell");if(Ce(d)){const f=d({key:t,previousCellPosition:r,nextCellPosition:i||null,event:e});Ce(f)?i={rowPinned:f.rowPinned,rowIndex:f.rowIndex,column:f.column}:i=null}}if(!i)return;if(i.rowIndex<0){const d=ys(o);l.focusHeaderPosition({headerPosition:{headerRowIndex:d+i.rowIndex,column:r.column},event:e||void 0,fromCell:!0});return}const u=this.getNormalisedPosition(i);u?this.focusPosition(u):this.tryToFocusFullWidthRow(i)}getNormalisedPosition(e){var s;if(!!((s=this.beans.spannedRowRenderer)!=null&&s.getCellByPosition(e)))return e;this.ensureCellVisible(e);const r=Vn(this.beans,e);return r?(e=r.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:r,rowRenderer:s,focusSvc:i,eventSvc:n}=this.beans,o=r.allCols,a=s.getRowByPosition(e);if(!(a!=null&&a.isFullWidth()))return!1;const l=i.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?nt(o):o[0])};this.focusPosition(c);const u=t??(l!=null&&sA(c,l));return n.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:u}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:r}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),r==null||r.setRangeToCell(e)}isValidNavigateCell(e){return!!Ys(this.beans,e)}getLastCellOfColSpan(e){const t=Vn(this.beans,e);if(!t)return e;const r=t.getColSpanningList();return r.length===1?e:{rowIndex:e.rowIndex,column:nt(r),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=HC(this.gos),r=this.beans.rowModel.getRow(e.rowIndex),s=t&&(r==null?void 0:r.sticky),{scrollFeature:i}=this.gridBodyCon;!s&&ct(e.rowPinned)&&i.ensureIndexVisible(e.rowIndex),e.column.isPinned()||i.ensureColumnVisible(e.column)}ensureColumnVisible(e){const t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function kd(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var yO={moduleName:"KeyboardNavigation",version:we,beans:[xO,zL,sL],apiFunctions:{getFocusedCell:UL,clearFocusedCell:jL,setFocusedCell:$L,setFocusedHeader:XL,tabToNextCell:KL,tabToPreviousCell:qL}},SO=class extends ee{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:(e==null?void 0:e.animate)??!1,newData:(e==null?void 0:e.newData)??!1,newPage:(e==null?void 0:e.newPage)??!1,newPageSize:(e==null?void 0:e.newPageSize)??!1,keepRenderedRows:(e==null?void 0:e.keepRenderedRows)??!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:r}=this.beans;t?t.calculatePages():e.calculateBounds(0,r.getRowCount()-1)}},bO=class extends ee{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){var e;return((e=this.topRowBounds)==null?void 0:e.rowIndex)??-1}getLastRow(){var e;return((e=this.bottomRowBounds)==null?void 0:e.rowIndex)??-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){const{topRowBounds:e,bottomRowBounds:t}=this,r=(e==null?void 0:e.rowTop)??0,s=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:r,pageLastPixel:s}}calculateBounds(e,t){const{rowModel:r}=this.beans,s=r.getRowBounds(e);s&&(s.rowIndex=e),this.topRowBounds=s;const i=r.getRowBounds(t);i&&(i.rowIndex=t),this.bottomRowBounds=i,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){var t;const e=((t=this.topRowBounds)==null?void 0:t.rowTop)??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},FO=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",RO=class extends ee{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const r of this.elements)r&&(it(r,t),Fs(r,e))}},EO=class extends ee{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:r}=this.beans,s=qt(e,"print"),i=s?0:t.getColsLeftWidth(),n=s?0:t.getDisplayedColumnsRightWidth();i!=this.leftWidth&&(this.leftWidth=i,r.dispatchEvent({type:"leftPinnedWidthChanged"})),n!=this.rightWidth&&(this.rightWidth=n,r.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.eBodyViewport,t=wa(e);if(t<=50)return;const r=this.getPinnedColumnsOverflowingViewport(t-50),s=this.gos.getCallback("processUnpinnedColumns"),{columns:i,hasLockedPinned:n}=r;let o=i;!o.length&&!n||(s&&(o=s({columns:o,viewportWidth:t})),o!=null&&o.length&&(o=o.filter(a=>!Gs(a)),this.setColsPinned(o,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new RO(e,t)}setColsPinned(e,t,r){const{colModel:s,colAnimation:i,visibleCols:n,gos:o}=this.beans;if(!s.cols||!(e!=null&&e.length))return;if(qt(o,"print")){oe(37);return}i==null||i.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;const l=[];for(const c of e){if(!c)continue;const u=s.getCol(c);u&&u.getPinned()!==a&&(this.setColPinned(u,a),l.push(u))}l.length&&(n.refresh(r),tw(this.eventSvc,l,r)),i==null||i.finish()}initCol(e){const{pinned:t,initialPinned:r}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,r)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;const r=e.pinned==="left",s=e.pinned==="right";e.hidden=!0;const i=()=>{const n=r?this.leftWidth:this.rightWidth;if(n==null)return;const o=n==0,a=e.hidden!==o,l=this.gos.get("enableRtl"),c=t.getScrollbarWidth(),d=t.verticalScrollShowing&&(l&&r||!l&&s)?n+c:n;e.comp.setPinnedContainerWidth(`${d}px`),e.comp.setDisplayed(!o),a&&(e.hidden=o,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:i,rightPinnedWidthChanged:i,scrollVisibilityChanged:i,scrollbarWidthChanged:i})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:s,rightWidth:i}=this,n=wa(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(s+i+e>n)if(n>s+i)e=n-s-i;else return 0}return e}getPinnedColumnsOverflowingViewport(e){const t=this.rightWidth??0,r=this.leftWidth??0,s=t+r;let i=!1;if(s<e)return{columns:[],hasLockedPinned:i};const{visibleCols:n}=this.beans,o=[...n.leftCols],a=[...n.rightCols];let l=0,c=0;const u=0,d=[];let h=s-u-e;for(;(c<o.length||l<a.length)&&h>0;){if(l<a.length){const f=a[l++];if(f.colDef.lockPinned){i=!0;continue}h-=f.getActualWidth(),d.push(f)}if(c<o.length&&h>0){const f=o[c++];if(f.colDef.lockPinned){i=!0;continue}h-=f.getActualWidth(),d.push(f)}}return{columns:d,hasLockedPinned:i}}},TO={moduleName:"PinnedColumn",version:we,beans:[EO],css:[FO]},kO=class extends hr{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=Wt(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=Gt(e),r=this.descriptionContainer=t.createElement("div");r.classList.add("ag-aria-description-container"),hC(r,"polite"),pT(r,"additions text"),gT(r,!0),e.eRootDiv.appendChild(r)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}â€‹`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(wr(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},PO=class extends kO{},DO={moduleName:"Aria",version:we,beans:[PO]},AO=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",O0="ag-delay-render",IO=class extends ee{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(O0)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;const{renderStatus:t,ctrlsSvc:r}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}r.getGridBodyCtrl().eGridBody.classList.remove(O0),this.alreadyRevealed=!0}},MO={moduleName:"ColumnDelayRender",version:we,beans:[IO],css:[AO]};function _O(e){var t;(t=e.overlays)==null||t.showLoadingOverlay()}function LO(e){var t;(t=e.overlays)==null||t.showNoRowsOverlay()}function OO(e){var t;(t=e.overlays)==null||t.hideOverlay()}var NO=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-exporting-wrapper,.ag-overlay-loading-wrapper,.ag-overlay-modal-wrapper{pointer-events:all}.ag-overlay-exporting-center,.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);display:flex;padding:var(--ag-spacing)}",BO={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},bx=class extends Rt{constructor(){super(BO),this.eOverlayWrapper=be,this.activeOverlay=null,this.activePromise=null,this.activeCssClass=null,this.elToFocusAfter=null,this.overlayExclusive=!1,this.oldWrapperPadding=null,this.registerCSS(NO)}handleKeyDown(e){if(e.key!==K.TAB||e.defaultPrevented||zs(e))return;const{beans:t,eOverlayWrapper:r}=this;if(r&&yn(t,r,!1,e.shiftKey))return;let i=!1;e.shiftKey?i=t.focusSvc.focusGridView({column:nt(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):i=fo(t,!1),i&&e.preventDefault()}updateLayoutClasses(e,t){const r=this.eOverlayWrapper;if(!r)return;const s=r.classList,{AUTO_HEIGHT:i,NORMAL:n,PRINT:o}=tc;s.toggle(i,t.autoHeight),s.toggle(n,t.normal),s.toggle(o,t.print)}postConstruct(){this.createManagedBean(new zf(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setWrapperComp(this,!1),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)}),this.addManagedEventListeners({gridSizeChanged:this.refreshWrapperPadding.bind(this)})}setWrapperTypeClass(e){var r;const t=(r=this.eOverlayWrapper)==null?void 0:r.classList;if(!t){this.activeCssClass=null;return}this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,r){if(this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,this.overlayExclusive=r,!e)return this.refreshWrapperPadding(),Ue.resolve();if(this.setWrapperTypeClass(t),this.setDisplayed(!0,{skipAriaHidden:!0}),this.refreshWrapperPadding(),r&&this.isGridFocused()){const s=pt(this.beans);s&&!gf(this.beans)&&(this.elToFocusAfter=s)}return e.then(s=>{const i=this.eOverlayWrapper;if(!i){this.destroyBean(s);return}if(this.activePromise!==e){this.activeOverlay!==s&&(this.destroyBean(s),s=null);return}this.activePromise=null,s&&(this.activeOverlay!==s&&(i.appendChild(s.getGui()),this.activeOverlay=s),r&&this.isGridFocused()&&ln(i))}),e}refreshWrapperPadding(){var r;if(!this.eOverlayWrapper){this.oldWrapperPadding=null;return}const e=!!this.activeOverlay||!!this.activePromise;let t=0;e&&!this.overlayExclusive&&(t=((r=this.beans.ctrlsSvc.get("gridHeaderCtrl"))==null?void 0:r.headerHeight)||0),t!==this.oldWrapperPadding&&(this.oldWrapperPadding=t,this.eOverlayWrapper.style.setProperty("padding-top",`${t}px`))}destroyActiveOverlay(){var s;this.activePromise=null;const e=this.activeOverlay;if(!e){this.overlayExclusive=!1,this.elToFocusAfter=null,this.refreshWrapperPadding();return}let t=this.elToFocusAfter;this.elToFocusAfter=null,this.activeOverlay=null,this.overlayExclusive=!1,t&&!this.isGridFocused()&&(t=null),this.destroyBean(e);const r=this.eOverlayWrapper;r&&wr(r),(s=t==null?void 0:t.focus)==null||s.call(t,{preventScroll:!0}),this.refreshWrapperPadding()}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=pt(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setWrapperComp(this,!0),super.destroy(),this.eOverlayWrapper=null}},HO={selector:"AG-OVERLAY-WRAPPER",component:bx},VO=["refresh"],Qa=e=>({name:e,optionalMethods:VO}),Vi={id:"agLoadingOverlay",overlayType:"loading",comp:Qa("loadingOverlayComponent"),wrapperCls:"ag-overlay-loading-wrapper",exclusive:!0,compKey:"loadingOverlayComponent",paramsKey:"loadingOverlayComponentParams",isSuppressed:e=>{const t=e.get("loading");return t===!1||e.get("suppressLoadingOverlay")===!0&&t!==!0}},Gn={id:"agNoRowsOverlay",overlayType:"noRows",comp:Qa("noRowsOverlayComponent"),wrapperCls:"ag-overlay-no-rows-wrapper",compKey:"noRowsOverlayComponent",paramsKey:"noRowsOverlayComponentParams",isSuppressed:e=>e.get("suppressNoRowsOverlay")},tg={id:"agNoMatchingRowsOverlay",overlayType:"noMatchingRows",comp:Qa("noMatchingRowsOverlayComponent"),wrapperCls:"ag-overlay-no-matching-rows-wrapper"},Wc={id:"agExportingOverlay",overlayType:"exporting",comp:Qa("exportingOverlayComponent"),wrapperCls:"ag-overlay-exporting-wrapper",exclusive:!0},lc={id:"activeOverlay",comp:Qa("activeOverlay"),wrapperCls:"ag-overlay-modal-wrapper",exclusive:!0},GO=e=>e?{agLoadingOverlay:Vi,agNoRowsOverlay:Gn,agNoMatchingRowsOverlay:tg,agExportingOverlay:Wc}[e]??lc:null,WO=e=>e?{loading:Vi,noRows:Gn,noMatchingRows:tg,exporting:Wc}[e]:null,zO=class extends ee{constructor(){super(...arguments),this.beanName="overlays",this.eWrapper=void 0,this.exclusive=!1,this.oldExclusive=!1,this.currentDef=null,this.showInitialOverlay=!0,this.userForcedNoRows=!1,this.exportsInProgress=0,this.newColumnsLoadedCleanup=null}postConstruct(){const e=this.gos;this.showInitialOverlay=wt(e);const t=()=>{this.userForcedNoRows||this.updateOverlay(!1)},[r,s,i,n]=this.addManagedEventListeners({newColumnsLoaded:t,rowCountReady:()=>{this.disableInitialOverlay(),t(),s()},rowDataUpdated:t,modelUpdated:t});this.newColumnsLoadedCleanup=r,this.addManagedPropertyListeners(["loading","activeOverlay","activeOverlayParams","overlayComponentParams","loadingOverlayComponentParams","noRowsOverlayComponentParams"],o=>{var a;return this.onPropChange(new Set((a=o.changeSet)==null?void 0:a.properties))})}destroy(){this.doHideOverlay(),super.destroy(),this.eWrapper=void 0}setWrapperComp(e,t){this.isAlive()&&(t?this.eWrapper===e&&(this.eWrapper=void 0):this.eWrapper=e,this.updateOverlay(!1))}isVisible(){return!!this.currentDef}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos;if(!this.eWrapper||e.get("activeOverlay")||this.isDisabled(Vi))return;const t=e.get("loading");!t&&t!==void 0||this.doShowOverlay(Vi)}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;!this.eWrapper||e.get("activeOverlay")||e.get("loading")||this.isDisabled(Gn)||(this.userForcedNoRows=!0,this.doShowOverlay(Gn))}async showExportOverlay(e){const{gos:t,beans:r}=this;if(!this.eWrapper||t.get("activeOverlay")||t.get("loading")||this.isDisabled(Wc)||this.userForcedNoRows&&this.currentDef===Gn){e();return}const s=this.getDesiredDefWithOverride(Wc);if(!s){e();return}this.exportsInProgress++,this.focusedCell=r.focusSvc.getFocusedCell(),await this.doShowOverlay(s),await new Promise(n=>setTimeout(()=>n()));const i=Date.now();try{e()}finally{const n=Date.now()-i,o=Math.max(0,300-n),a=()=>{this.exportsInProgress--,this.exportsInProgress===0&&(this.updateOverlay(!1),dA(r,this.focusedCell),this.focusedCell=null)};o>0?setTimeout(()=>a(),o):a()}}hideOverlay(){const e=this.gos;this.showInitialOverlay=!1;const t=this.userForcedNoRows;if(this.userForcedNoRows=!1,e.get("loading")){oe(99);return}if(e.get("activeOverlay")){oe(296);return}if(this.currentDef===tg){oe(297);return}this.doHideOverlay(),t&&this.getOverlayDef()!==Gn&&this.updateOverlay(!1)}getOverlayWrapperSelector(){return HO}getOverlayWrapperCompClass(){return bx}onPropChange(e){var i,n,o;const t=e.has("activeOverlay");if((t||e.has("loading"))&&this.updateOverlay(t))return;const r=this.currentDef,s=(i=this.eWrapper)==null?void 0:i.activeOverlay;if(s&&r){const a=e.has("activeOverlayParams");if(r===lc)a&&((n=s.refresh)==null||n.call(s,this.makeCompParams(!0)));else{const l=r.paramsKey;(e.has("overlayComponentParams")||l&&e.has(l))&&((o=s.refresh)==null||o.call(s,this.makeCompParams(!1,l,r.overlayType)))}}}updateOverlay(e){const t=this.eWrapper;if(!t)return this.currentDef=null,!1;const r=this.getDesiredDefWithOverride(),s=this.currentDef,i=r===lc&&e;return r!==s?r?(this.doShowOverlay(r),!0):(this.disableInitialOverlay(),this.doHideOverlay()):i&&r?(t.hideOverlay(),this.doShowOverlay(r),!0):(r||this.disableInitialOverlay(),!1)}getDesiredDefWithOverride(e){const{gos:t}=this;let r=GO(t.get("activeOverlay"));return r||(r=e??this.getOverlayDef(),r&&this.isDisabled(r)&&(r=null)),r}getOverlayDef(){const{gos:e,beans:t}=this,{colModel:r,rowModel:s}=t,i=e.get("loading");if(i!==void 0){if(this.disableInitialOverlay(),i)return Vi}else if(this.showInitialOverlay){if(!this.isDisabled(Vi)&&(!e.get("columnDefs")||!r.ready||!e.get("rowData")))return Vi;this.disableInitialOverlay()}else this.disableInitialOverlay();const o=s.getOverlayType();return WO(o)}disableInitialOverlay(){var e;this.showInitialOverlay=!1,(e=this.newColumnsLoadedCleanup)==null||e.call(this),this.newColumnsLoadedCleanup=null}doShowOverlay(e){var u;const{gos:t,beans:r}=this,{userCompFactory:s}=r;this.currentDef=e;const i=e!==lc,n=!!e.exclusive;this.exclusive=n;let o;(e.paramsKey&&t.get(e.paramsKey)||e.compKey&&t.get(e.compKey))&&(o=e.paramsKey);let a;i&&(t.get("overlayComponent")||t.get("overlayComponentSelector"))&&(a=s.getCompDetailsFromGridOptions({name:"overlayComponent",optionalMethods:["refresh"]},void 0,this.makeCompParams(!1,e.paramsKey,e.overlayType))),a??(a=s.getCompDetailsFromGridOptions(e.comp,i?e.id:void 0,this.makeCompParams(!i,o,e.overlayType),!1));const l=(a==null?void 0:a.newAgStackInstance())??null,c=this.eWrapper?this.eWrapper.showOverlay(l,e.wrapperCls,n):Ue.resolve();return(u=this.eWrapper)==null||u.refreshWrapperPadding(),this.setExclusive(n),c}makeCompParams(e,t,r){const{gos:s}=this,i=e?s.get("activeOverlayParams"):{...s.get("overlayComponentParams"),...t&&s.get(t)||null,overlayType:r};return ke(s,i??{})}doHideOverlay(){let e=!1;this.currentDef&&(this.currentDef=null,e=!0),this.exclusive=!1;const t=this.eWrapper;return t&&(t.hideOverlay(),t.refreshWrapperPadding(),this.setExclusive(!1)),e}setExclusive(e){this.oldExclusive!==e&&(this.oldExclusive=e,this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"}))}isDisabled(e){var r,s;const{gos:t}=this;return e.overlayType&&((r=t.get("suppressOverlays"))==null?void 0:r.includes(e.overlayType))||((s=e.isSuppressed)==null?void 0:s.call(e,t))===!0}},UO={moduleName:"Overlay",version:we,userComponents:{agLoadingOverlay:FA,agNoRowsOverlay:kA,agNoMatchingRowsOverlay:DA,agExportingOverlay:EA},apiFunctions:{showLoadingOverlay:_O,showNoRowsOverlay:LO,hideOverlay:OO},icons:{overlayLoading:"loading",overlayExporting:"loading"},beans:[zO]},jO=class extends ee{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=Nk(),on(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;on(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),r=e/t;return this.maxScrollY*r}},$O=400,KO=class extends ee{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{for(const n of this.getAllCellCtrls())n.onCellSelectionChanged()},t=()=>{for(const n of this.getAllCellCtrls())n.updateRangeBordersIfRangeCount()},r=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},s=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>s()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{wi(this.gos)?r():s()}),wi(this.gos)&&r()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",s=>this.onSuppressCellFocusChanged(s.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:s,previousValue:i})=>{(!i&&s||i&&!s)&&this.redrawRows()});const{stickyRowSvc:e,gos:t,showRowGroupCols:r}=this.beans;if(r&&this.addManagedPropertyListener("showOpenedGroup",()=>{const s=r.columns;s.length&&this.refreshCells({columns:s,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const s=this.gridBodyCtrl;s.setStickyTopHeight(0),s.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=qt(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new qO(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){var e;return((e=this.stickyRowFeature)==null?void 0:e.stickyTopRowCtrls)??[]}getStickyBottomRowCtrls(){var e;return((e=this.stickyRowFeature)==null?void 0:e.stickyBottomRowCtrls)??[]}updateAllRowCtrls(){var s;const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),r=((s=this.cachedRowCtrls)==null?void 0:s.getEntries())??[];t.length>0||r.length>0?this.allRowCtrls=[...e,...t,...r]:this.allRowCtrls=e}isCellBeingRendered(e,t){var i;const r=this.rowCtrlsByRowIndex[e];return!t||!r?!!r:r.isFullWidth()?!0:!!((i=this.beans.spannedRowRenderer)==null?void 0:i.getCellByPosition({rowIndex:e,column:t,rowPinned:null}))||!!r.getCellCtrl(t)||!r.isRowRendered()}updateCellFocus(e){for(const t of this.getAllCellCtrls())t.onCellFocused(e);for(const t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if((e==null?void 0:e.rowIndex)!=null&&!e.rowPinned){const t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(const t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(const t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;if(t)for(const r of this.getAllCellCtrls())t.onFlashCells(r,e)},columnHoverChanged:()=>{for(const e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(const e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(const e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(const e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();const e=this.colModel.getCols();for(const t of e){const r=l=>{for(const c of this.getAllCellCtrls())c.column===t&&l(c)},s=()=>{r(l=>l.onLeftChanged())},i=()=>{r(l=>l.onWidthChanged())},n=()=>{r(l=>l.onFirstRightPinnedChanged())},o=()=>{r(l=>l.onLastLeftPinnedChanged())},a=()=>{r(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",s),t.__addEventListener("widthChanged",i),t.__addEventListener("firstRightPinnedChanged",n),t.__addEventListener("lastLeftPinnedChanged",o),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",s),t.__removeEventListener("widthChanged",i),t.__removeEventListener("firstRightPinnedChanged",n),t.__removeEventListener("lastLeftPinnedChanged",o),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){const e=qt(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),r=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,r&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){var r;const t=[];for(const s of this.getAllRowCtrls()){const i=(r=s.getCellCtrl(e,!0))==null?void 0:r.eGui;i&&t.push(i)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,r){const{pinnedRowModel:s,beans:i,printLayout:n}=this,o=Object.fromEntries(e.map(l=>[l.rowNode.id,l]));s==null||s.forEachPinnedRow(t,(l,c)=>{const u=e[c];u&&s.getPinnedRowById(u.rowNode.id,t)===void 0&&(u.destroyFirstPass(),u.destroySecondPass()),l.id in o&&r?(e[c]=o[l.id],delete o[l.id]):e[c]=new Gc(l,i,!1,!1,n)});const a=(t==="top"?s==null?void 0:s.getPinnedTopRowCount():s==null?void 0:s.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){var r,s;if(e.sticky)(r=this.stickyRowFeature)==null||r.refreshStickyNode(e);else if((s=this.cachedRowCtrls)!=null&&s.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const i=n=>{const o=n[e.rowIndex];o&&o.rowNode===e&&(o.destroyFirstPass(),o.destroySecondPass(),n[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){const{editSvc:t}=this.beans;if(t!=null&&t.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(const s of e??[])this.redrawRow(s,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){var a;this.getLockOnRefresh();const t=(a=this.beans.focusSvc)==null?void 0:a.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const r=!e.domLayoutChanged&&!!e.recycleRows,s=e.animate&&$n(this.gos),i=r?this.getRowsToRecycle():null;r||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:n,gos:o}=this;if(n){n.checkStickyRows();const l=n.extraTopHeight+n.extraBottomHeight;l&&this.updateContainerHeights(l)}this.recycleRows(i,s),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(o.get("enableRowPinning")?r:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){var s;const t=e.newData||e.newPage,r=this.gos.get("suppressScrollOnNewData");t&&!r&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),(s=this.stickyRowFeature)==null||s.resetOffsets())}updateContainerHeights(e=0){const{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let r=this.pageBounds.getCurrentPageHeight();r===0&&(r=1),t.setModelHeight(r+e)}getLockOnRefresh(){var e,t;if(this.refreshInProgress)throw new Error(Rs(252));this.refreshInProgress=!0,(t=(e=this.beans.frameworkOverrides).getLockOnRefresh)==null||t.call(e)}releaseLockOnRefresh(){var e,t;this.refreshInProgress=!1,(t=(e=this.beans.frameworkOverrides).releaseLockOnRefresh)==null||t.call(e)}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,r=this.findPositionToFocus(e);if(!r){t.focusHeaderPosition({headerPosition:{headerRowIndex:ys(this.beans)-1,column:e.column}});return}if(e.rowIndex!==r.rowIndex||e.rowPinned!=r.rowPinned){t.setFocusedCell({...r,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0});return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(ke(this.gos,{...r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}findPositionToFocus(e){const{pagination:t,pageBounds:r}=this.beans;let s=e;for(s.rowPinned==null&&t&&r&&!t.isRowInPage(s.rowIndex)&&(s={rowPinned:null,rowIndex:r.getFirstRow()});s;){if(s.rowPinned==null&&r)if(s.rowIndex<r.getFirstRow()){if(s=Bc(this.beans,{rowPinned:null,rowIndex:0}),!s)return null}else s.rowIndex>r.getLastRow()&&(s={rowPinned:null,rowIndex:r.getLastRow()});const i=this.getRowByPosition(s);if(i!=null&&i.isAlive())return{...i.getRowPosition(),column:e.column};s=Bc(this.beans,s)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),r=t.length;for(let s=0;s<r;s++){const i=t[s].getAllCellCtrls(),n=i.length;for(let o=0;o<n;o++)e.push(i[o])}return e}getAllRowCtrls(){const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),r=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...r,...(e==null?void 0:e.getCtrls("top"))??[],...(e==null?void 0:e.getCtrls("bottom"))??[],...(e==null?void 0:e.getCtrls("center"))??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,r){const s=this.rowCtrlsByRowIndex[t];s&&s.addEventListener(e,r)}refreshCells({rowNodes:e,columns:t,force:r,suppressFlash:s}={}){const i={force:r,newData:!1,suppressFlash:s};for(const n of this.getCellCtrls(e,t))n.refreshOrDestroyCell(i);this.refreshFullWidth(e)}refreshRows(e={}){for(const t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const r of this.getRowCtrls(e)){if(!r.isFullWidth())continue;r.refreshFullWidth()||(t=!0,this.redrawRow(r.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=Mh(e),r=this.getAllRowCtrls();return!e||!t?r:r.filter(s=>{const i=s.rowNode;return _h(i,t)})}getCellCtrls(e,t){let r;Ce(t)&&(r={},t.forEach(i=>{const n=this.colModel.getCol(i);Ce(n)&&(r[n.getId()]=!0)}));const s=[];for(const i of this.getRowCtrls(e))for(const n of i.getAllCellCtrls()){const o=n.column.getId();r&&!r[o]||s.push(n)}return s}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){var r;const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),(r=this.stickyRowFeature)==null||r.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const r of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[r].rowNode.id==null&&e.push(r);this.removeRowCtrls(e);const t={};for(const r of Object.values(this.rowCtrlsByRowIndex)){const s=r.rowNode;t[s.id]=r}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(const r of e){const s=this.rowCtrlsByRowIndex[r];s&&(s.destroyFirstPass(t),s.destroySecondPass()),delete this.rowCtrlsByRowIndex[r]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{focusSvc:t,animationFrameSvc:r}=this.beans,{afterScroll:s}=e;let i;const n=this.stickyRowFeature;n&&(i=(t==null?void 0:t.getFocusCellToUseAfterRefresh())||void 0);const o=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(n){l=n.checkStickyRows();const u=n.extraTopHeight+n.extraBottomHeight;u&&this.updateContainerHeights(u)}const c=this.firstRenderedRow!==o||this.lastRenderedRow!==a;if(!(s&&!l&&!c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,s),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(s&&!l),i!=null)){const u=t==null?void 0:t.getFocusCellToUseAfterRefresh();i!=null&&u==null&&(r==null||r.flushAllFrames(),this.restoreFocusedCell(i))}}removeRowCompsNotToDraw(e,t){const r={};for(const n of e)r[n]=!0;const i=Object.keys(this.rowCtrlsByRowIndex).filter(n=>!r[n]);this.removeRowCtrls(i,t)}calculateIndexesToDraw(e){var o,a;const t=[];for(let l=this.firstRenderedRow;l<=this.lastRenderedRow;l++)t.push(l);const r=this.beans.pagination,s=(a=(o=this.beans.focusSvc)==null?void 0:o.getFocusedCell())==null?void 0:a.rowIndex;s!=null&&(s<this.firstRenderedRow||s>this.lastRenderedRow)&&(!r||r.isRowInPage(s))&&s<this.rowModel.getRowCount()&&t.push(s);const i=l=>{const c=l.rowNode.rowIndex;c==null||c===s||(c<this.firstRenderedRow||c>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(l)&&t.push(c)};for(const l of Object.values(this.rowCtrlsByRowIndex))i(l);if(e)for(const l of Object.values(e))i(l);t.sort((l,c)=>l-c);const n=[];for(let l=0;l<t.length;l++){const c=t[l],u=this.rowModel.getRow(c);u&&!u.sticky&&n.push(c)}return n}recycleRows(e,t=!1,r=!1){const s=this.calculateIndexesToDraw(e);(this.printLayout||r)&&(t=!1),this.removeRowCompsNotToDraw(s,!t);for(const i of s)this.createOrUpdateRowCtrl(i,e,t,r);if(e){const{animationFrameSvc:i}=this.beans;(i==null?void 0:i.active)&&r&&!this.printLayout?i.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),r=e.isPinningRight();(this.pinningLeft!==t||r!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=r,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];for(const t of this.getFullWidthRowCtrls()){const r=t.rowNode.rowIndex;e.push(r.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=Mh(e);return this.getAllRowCtrls().filter(r=>{if(!r.isFullWidth())return!1;const s=r.rowNode;return!(t!=null&&!_h(s,t))})}createOrUpdateRowCtrl(e,t,r,s){let i,n=this.rowCtrlsByRowIndex[e];if(n||(i=this.rowModel.getRow(e),Ce(i)&&Ce(t)&&t[i.id]&&i.alreadyRendered&&(n=t[i.id],t[i.id]=null)),!n)if(i||(i=this.rowModel.getRow(e)),Ce(i))n=this.createRowCon(i,r,s);else return;i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=n}destroyRowCtrls(e,t){const r=[];if(e){for(const s of Object.values(e))if(s){if(this.cachedRowCtrls&&s.isCacheable()){this.cachedRowCtrls.addRow(s);continue}if(s.destroyFirstPass(!t),t){const i=s.instanceId;this.zombieRowCtrls[i]=s,r.push(()=>{s.destroySecondPass(),delete this.zombieRowCtrls[i]})}else s.destroySecondPass()}}t&&(r.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(const s of r)s()},$O))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=qi(this.beans);return e*t}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:r}=this;e.updateOffset();let s,i;if(!r.isRowsToRender())s=0,i=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),s=t.getFirstRow(),i=t.getLastRow();else{const u=this.getRowBufferInPixels(),d=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation");let f=!1,p,g;do{const y=t.getPixelOffset(),{pageFirstPixel:b,pageLastPixel:F}=t.getCurrentPagePixelRange(),S=e.divStretchOffset,D=d.getVScrollPosition(),T=D.top,V=D.bottom;h?(p=b+S,g=F+S):(p=Math.max(T+y-u,b)+S,g=Math.min(V+y+u,F)+S),this.firstVisibleVPixel=Math.max(T+y,b)+S,this.lastVisibleVPixel=Math.min(V+y,F)+S,f=this.ensureAllRowsInRangeHaveHeightsCalculated(p,g)}while(f);let m=r.getRowIndexAtPixel(p),v=r.getRowIndexAtPixel(g);const w=t.getFirstRow(),C=t.getLastRow();m<w&&(m=w),v>C&&(v=C),s=m,i=v}const n=qt(this.gos,"normal"),o=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);n&&!o&&i-s>a&&(i=s+a);const l=s!==this.firstRenderedRow,c=i!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=s,this.lastRenderedRow=i,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:s,lastRow:i}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,ti(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){var a,l;const r=(a=this.pinnedRowModel)==null?void 0:a.ensureRowHeightsValid(),s=(l=this.stickyRowFeature)==null?void 0:l.ensureRowHeightsValid(),{pageBounds:i,rowModel:n}=this,o=n.ensureRowHeightsValid(e,t,i.getFirstRow(),i.getLastRow());return(o||s)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),s||o||r?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){var c;const s=e.rowNode,i=this.focusSvc.isRowFocused(s.rowIndex,s.rowPinned),n=(c=this.editSvc)==null?void 0:c.isEditing(e),o=s.detail;return i||n||o?!!this.isRowPresent(s):!1}isRowPresent(e){var t;return this.rowModel.isRowPresent(e)?((t=this.beans.pagination)==null?void 0:t.isRowInPage(e.rowIndex))??!0:!1}createRowCon(e,t,r){var o,a;const s=((o=this.cachedRowCtrls)==null?void 0:o.getRow(e))??null;if(s)return s;const i=r&&!this.printLayout&&!!((a=this.beans.animationFrameSvc)!=null&&a.active);return new Gc(e,this.beans,t,i,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map(s=>s.rowNode),t=this.getStickyTopRowCtrls().map(s=>s.rowNode),r=this.getStickyBottomRowCtrls().map(s=>s.rowNode);return[...t,...e,...r]}getRowByPosition(e){let t;const{rowIndex:r}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[r];break;case"bottom":t=this.bottomRowCtrls[r];break;default:t=this.rowCtrlsByRowIndex[r],t||(t=this.getStickyTopRowCtrls().find(s=>s.rowNode.rowIndex===r)||null,t||(t=this.getStickyBottomRowCtrls().find(s=>s.rowNode.rowIndex===r)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const s=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!s}},qO=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if((e==null?void 0:e.id)==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,r=this.entriesMap[t];delete this.entriesMap[t],Es(this.entriesList,r)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],Es(this.entriesList,e)}getEntries(){return this.entriesList}};function Mh(e){if(!e)return;const t={top:{},bottom:{},normal:{}};for(const r of e){const s=r.id;switch(r.rowPinned){case"top":t.top[s]=r;break;case"bottom":t.bottom[s]=r;break;default:t.normal[s]=r;break}}return t}function _h(e,t){const r=e.id;switch(e.rowPinned){case"top":return t.top[r]!=null;case"bottom":return t.bottom[r]!=null;default:return t.normal[r]!=null}}var XO=class extends ee{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){const{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=Cs(e),this.firstLeaf=wt(e)?Hc:YO,this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=Cs(e))}doFullSort(e,t){const r=e.map((s,i)=>({currentPos:i,rowNode:s}));return r.sort(this.compareRowNodes.bind(this,t)),r.map(s=>s.rowNode)}compareRowNodes(e,t,r){const s=t.rowNode,i=r.rowNode;for(let n=0,o=e.length;n<o;n++){const a=e[n],l=a.sort==="desc",c=this.getValue(s,a.column),u=this.getValue(i,a.column);let d;const h=this.getComparator(a,s);if(h)d=h(c,u,s,i,l);else{const p={accentedCompare:this.isAccentedSort};a.type==="absolute"&&(p.transform=JO),d=aT(c,u,p)}if(!isNaN(d)&&d!==0)return a.sort==="asc"?d:d*-1}return t.currentPos-r.currentPos}getComparator(e,t){const r=e.column.getColDef(),s=this.getComparatorFromColDef(r,e);if(s)return s;if(!r.showRowGroup)return;const i=!t.group&&r.field;if(!i)return;const n=this.beans.colModel.getColDefCol(i);if(n)return this.getComparatorFromColDef(n.getColDef(),e)}getComparatorFromColDef(e,t){const r=e.comparator;if(r!=null)return typeof r=="object"?r[Xs(t.type)]:r}getValue(e,t){if(this.primaryColumnsSortGroups&&e.rowGroupColumn===t)return this.getGroupDataValue(e,t);if(e.group&&t.getColDef().showRowGroup)return;const{valueSvc:r,formula:s}=this.beans,i=r.getValue(t,e,!1);return t.isAllowFormula()&&(s!=null&&s.isFormula(i))?s.resolveValue(t,e):i}getGroupDataValue(e,t){var l;const{gos:r,valueSvc:s,colModel:i,showRowGroupCols:n}=this.beans;if(GC(r,i.isPivotActive())){const c=this.firstLeaf(e);return c&&s.getValue(t,c,!1)}const a=n==null?void 0:n.getShowRowGroupCol(t.getId());if(a)return(l=e.groupData)==null?void 0:l[a.getId()]}},YO=e=>{if(e.data)return e;let t=e.childrenAfterGroup;for(;t!=null&&t.length;){const r=t[0];if(r.data)return r;t=r.childrenAfterGroup}};function JO(e){if(!e)return e;const t=Number(e);return isNaN(t)?e:Math.abs(t)}function ZO(e){var t;(t=e.sortSvc)==null||t.onSortChanged("api")}var Ni=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),QO={tag:"span",cls:"ag-sort-indicator-container",children:[Ni("Order","order"),Ni("Asc","ascending-icon"),Ni("Desc","descending-icon"),Ni("Mixed","mixed-icon"),Ni("AbsoluteAsc","absolute-ascending-icon"),Ni("AbsoluteDesc","absolute-descending-icon"),Ni("None","none-icon")]},rg=class extends Rt{constructor(e){super(),this.eSortOrder=be,this.eSortAsc=be,this.eSortDesc=be,this.eSortMixed=be,this.eSortNone=be,this.eSortAbsoluteAsc=be,this.eSortAbsoluteDesc=be,e||this.setTemplate(QO)}attachCustomElements(e,t,r,s,i,n,o){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=r,this.eSortMixed=s,this.eSortNone=i,this.eSortAbsoluteAsc=n,this.eSortAbsoluteDesc=o}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addInIcon("sortAbsoluteAscending",this.eSortAbsoluteAsc,e),this.addInIcon("sortAbsoluteDescending",this.eSortAbsoluteDesc,e);const r=this.updateIcons.bind(this),s=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",r),this.addManagedEventListeners({newColumnsLoaded:r,sortChanged:s,columnRowGroupChanged:s}),this.onSortChanged()}addInIcon(e,t,r){if(t==null)return;const s=vr(e,this.beans,r);s&&t.appendChild(s)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortAbsoluteAsc:r,eSortAbsoluteDesc:s,eSortNone:i,column:n,gos:o,beans:a}=this,l=a.sortSvc.getDisplaySortForColumn(n),c=Xs(l==null?void 0:l.type),u=wu(l==null?void 0:l.direction),d=n.getAvailableSortTypes(),h=d.has("default"),f=d.has("absolute"),p=c==="absolute",g=c==="default",m=u==="asc",v=u==="desc";if(e&&it(e,m&&g&&h,{skipAriaHidden:!0}),t&&it(t,v&&g&&h,{skipAriaHidden:!0}),i){const w=!n.getColDef().unSortIcon&&!o.get("unSortIcon");it(i,!w&&!u,{skipAriaHidden:!0})}r&&it(r,m&&p&&f,{skipAriaHidden:!0}),s&&it(s,v&&p&&f,{skipAriaHidden:!0})}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:r}=this;this.addInIcon("sortUnSort",e,t);const s=t.getColDef().showRowGroup;Cs(r)&&s&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){var s;const{eSortMixed:e,beans:t,column:r}=this;if(e){const i=((s=t.sortSvc.getDisplaySortForColumn(r))==null?void 0:s.direction)==="mixed";it(e,i,{skipAriaHidden:!0})}}updateSortOrder(){const{eSortOrder:e,column:t,beans:{sortSvc:r}}=this;if(!e)return;const s=r.getColumnsWithSortingOrdered(),i=r.getDisplaySortIndexForColumn(t)??-1,n=s.some(a=>r.getDisplaySortIndexForColumn(a)??!1),o=i>=0&&n;it(e,o,{skipAriaHidden:!0}),i>=0?e.textContent=(i+1).toString():wr(e)}},e4={selector:"AG-SORT-INDICATOR",component:rg},t4=class extends ee{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,r){const s=this.getNextSortDirection(e);this.setSortForColumn(e,s,t,r)}progressSortFromEvent(e,t){const s=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,s,"uiColumnSorted")}setSortForColumn(e,t,r,s){var u;const{gos:i,showRowGroupCols:n}=this.beans,o=Cs(i);let a=[e];if(o&&e.getColDef().showRowGroup){const d=(u=n==null?void 0:n.getSourceColumnsForGroupColumn)==null?void 0:u.call(n,e),h=d==null?void 0:d.filter(f=>f.isSortable());h&&(a=[e,...h])}for(const d of a)this.setColSort(d,t,s);const l=(r||i.get("alwaysMultiSort"))&&!i.get("suppressMultiSort"),c=[];if(!l){const d=this.clearSortBarTheseColumns(a,s);c.push(...d)}this.updateSortIndex(e),c.push(...a),this.dispatchSortChangedEvents(s,c)}updateSortIndex(e){const{gos:t,colModel:r,showRowGroupCols:s}=this.beans,i=Cs(t),n=s==null?void 0:s.getShowRowGroupCol(e.getId()),o=i&&n||e,a=this.getColumnsWithSortingOrdered();r.forAllCols(u=>this.setColSortIndex(u,null));const l=a.filter(u=>i&&u.getColDef().showRowGroup?!1:u!==o);(o.getSortDef()?[...l,o]:l).forEach((u,d)=>this.setColSortIndex(u,d))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{if(t.getSortDef())return e=!0,!0}),e}dispatchSortChangedEvents(e,t){const r={type:"sortChanged",source:e};t&&(r.columns=t),this.eventSvc.dispatchEvent(r)}clearSortBarTheseColumns(e,t){const r=[];return this.beans.colModel.forAllCols(s=>{e.includes(s)||(s.getSortDef()&&r.push(s),this.setColSort(s,void 0,t))}),r}getNextSortDirection(e){const t=e.getSortingOrder(),r=e.getSortDef();let i=t.findIndex(n=>Zl(n,r))+1;return i>=t.length&&(i=0),Zr(t[i])}getIndexedSortMap(){const{gos:e,colModel:t,showRowGroupCols:r,rowGroupColsSvc:s}=this.beans;let i=[];if(t.forAllCols(c=>{c.getSortDef()&&i.push(c)}),t.isPivotMode()){const c=Cs(e);i=i.filter(u=>{const d=!!u.getAggFunc(),h=!u.isPrimary(),f=c?r==null?void 0:r.getShowRowGroupCol(u.getId()):u.getColDef().showRowGroup;return d||h||f})}const n=(s==null?void 0:s.columns.filter(c=>!!c.getSortDef()))??[],o={};i.forEach((c,u)=>o[c.getId()]=u),i.sort((c,u)=>{const d=c.getSortIndex(),h=u.getSortIndex();if(d!=null&&h!=null)return d-h;if(d==null&&h==null){const f=o[c.getId()],p=o[u.getId()];return f>p?1:-1}else return h==null?-1:1});const a=Cs(e)&&!!n.length;a&&(i=[...new Set(i.map(c=>(r==null?void 0:r.getShowRowGroupCol(c.getId()))??c))]);const l=new Map;if(i.forEach((c,u)=>l.set(c,u)),a)for(const c of n){const u=r.getShowRowGroupCol(c.getId());l.set(c,l.get(u))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}collectSortItems(e=!1){var s,i;const t=[],r=this.getColumnsWithSortingOrdered();for(const n of r){const o=(s=n.getSortDef())==null?void 0:s.direction;if(!o)continue;const a=Xs((i=n.getSortDef())==null?void 0:i.type),l={sort:o,type:a};e?l.colId=n.getId():l.column=n,t.push(l)}return t}getSortModel(){return this.collectSortItems(!0)}getSortOptions(){return this.collectSortItems()}canColumnDisplayMixedSort(e){const t=Cs(this.gos),r=!!e.getColDef().showRowGroup;return t&&r}getDisplaySortForColumn(e){var o,a;const t=(o=this.beans.showRowGroupCols)==null?void 0:o.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(t!=null&&t.length))return e.getSortDef();const s=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,i=s[0].getSortDef();return s.every(l=>Zl(l.getSortDef(),i))?i:{type:Xs((a=e.getSortDef())==null?void 0:a.type),direction:"mixed"}}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t){const r=()=>{var n;const{type:s,direction:i}=Zr(t.getSortDef());if(e.toggleCss("ag-header-cell-sorted-asc",i==="asc"),e.toggleCss("ag-header-cell-sorted-desc",i==="desc"),e.toggleCss("ag-header-cell-sorted-abs-asc",s==="absolute"&&i==="asc"),e.toggleCss("ag-header-cell-sorted-abs-desc",s==="absolute"&&i==="desc"),e.toggleCss("ag-header-cell-sorted-none",!i),t.getColDef().showRowGroup){const o=(n=this.beans.showRowGroupCols)==null?void 0:n.getSourceColumnsForGroupColumn(t),l=!(o==null?void 0:o.every(c=>{var u;return i==((u=c.getSortDef())==null?void 0:u.direction)}));e.toggleCss("ag-header-cell-sorted-mixed",l)}};e.addManagedEventListeners({sortChanged:r,columnRowGroupChanged:r})}initCol(e){const{sortIndex:t,initialSortIndex:r}=e.colDef,s=XC(e.colDef);s&&e.setSortDef(s,!0),t!==void 0?t!==null&&(e.sortIndex=t):r!==null&&(e.sortIndex=r)}updateColSort(e,t,r){t!==void 0&&this.setColSort(e,Zr(t),r)}setColSort(e,t,r){Zl(e.getSortDef(),t)||(e.setSortDef(Zr(t),t===void 0),e.dispatchColEvent("sortChanged",r)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new rg(e)}getSortIndicatorSelector(){return e4}},Fx={moduleName:"Sort",version:we,beans:[t4,XO],apiFunctions:{onSortChanged:ZO},userComponents:{agSortIndicator:rg},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",sortAbsoluteAscending:"aasc",sortAbsoluteDescending:"adesc"}},r4=class extends ee{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){const{colModel:t,rowModel:r}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),r.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),on(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,Yn(e.source))}}};function s4(e){var t;(t=e.valueCache)==null||t.expire()}function i4(e,t){const{colKey:r,rowNode:s,useFormatter:i}=t,n=e.colModel.getColDefCol(r)??e.colModel.getCol(r);if(ct(n))return null;const o=e.valueSvc.getValueForDisplay({column:n,node:s,includeValueFormatted:i});return i?o.valueFormatted??So(o.value):o.value}var n4="paste",o4=class extends ee{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;wt(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:r}=this.beans;if(e.source===n4||t.get("suppressChangeDetection"))return;const s=e.node,i=[s],n=this.clientSideRowModel,o=n==null?void 0:n.rootNode;if(o&&!s.isRowPinned()){const a=t.get("aggregateOnlyChangedColumns"),l=new Ea(a,o);l.addParentNode(s.parent,[e.column]),n.doAggregate(l),l.forEachChangedNodeDepthFirst(c=>{i.push(c),c.sibling&&i.push(c.sibling)})}r.refreshCells({rowNodes:i})}},a4=class extends ee{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);Qe(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(r){return Qe(16,{expression:e,params:t,e:r}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const r=this.createFunctionBody(e),s=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",r);return t[e]=s,s}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},l4=class extends ee{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){const e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,r){if(this.active){const s=this.cacheVersion;e.__cacheVersion!==s&&(e.__cacheVersion=s,e.__cacheData={}),e.__cacheData[t]=r}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},c4={moduleName:"ValueCache",version:we,beans:[l4],apiFunctions:{expireValueCache:s4}},u4={moduleName:"Expression",version:we,beans:[a4]},d4={moduleName:"ChangeDetection",version:we,beans:[o4]},h4={moduleName:"CellApi",version:we,apiFunctions:{getCellValue:i4}},f4=class extends ee{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc,this.formulaDataSvc=e.formulaDataSvc}postConstruct(){this.initialised||this.init()}init(){const{gos:e,valueCache:t}=this;this.executeValueGetter=t?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=bo(e),this.cellExpressions=e.get("enableCellExpressions"),this.isTreeData=e.get("treeData"),this.initialised=!0;const r=s=>this.callColumnCellValueChangedHandler(s);this.eventSvc.addListener("cellValueChanged",r,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",r,!0)),this.addManagedPropertyListener("treeData",s=>this.isTreeData=s.currentValue)}getValueForDisplay(e){const{column:t,node:r,includeValueFormatted:s,useRawFormula:i,exporting:n,source:o="ui"}=e,{showRowGroupColValueSvc:a}=this.beans,l=!t&&r.group,c=t==null?void 0:t.colDef.showRowGroup,u=!this.isTreeData||r.footer;if(a&&u&&(l||c)){const C=a.getGroupValue(r,t);if(C==null)return{value:null,valueFormatted:null};if(!s)return{value:C.value,valueFormatted:null};const y=a.formatAndPrefixGroupColValue(C,t,n);return{value:C.value,valueFormatted:y}}if(!t)return{value:r.key,valueFormatted:null};const d=r.leafGroup&&this.colModel.isPivotMode(),h=r.group&&r.expanded&&!r.footer&&!d,f=this.gos.get("groupSuppressBlankHeader")||!r.sibling,p=h&&!f;let g=this.getValue(t,r,p,o),m=g;const{formula:v}=this.beans,w=s&&!(n&&t.colDef.useValueFormatterForExport===!1);return t.isAllowFormula()&&(v!=null&&v.isFormula(g))&&(i?(g=v.normaliseFormula(g,!0),m=v.resolveValue(t,r)):(g=v.resolveValue(t,r),m=g)),{value:g,valueFormatted:w?this.formatValue(t,r,m):null}}getValue(e,t,r=!1,s="ui"){var a;if(this.initialised||this.init(),!t)return;if(this.hasEditSvc&&s==="ui"){const l=this.editSvc;if(l.isEditing()){const c=l.getCellDataValue({rowNode:t,column:e},!0);if(c!==void 0)return c}}const n=e.getColDef().showRowGroup;if(typeof n=="string"&&(((a=this.beans.rowGroupColsSvc)==null?void 0:a.getColumnIndex(n))??-1)>t.level)return null;let o=this.resolveValue(e,t,r);if(this.cellExpressions&&Ap(o)){const l=o.substring(1);o=this.executeValueGetter(l,t.data,e,t)}return o}getFormulaFromDataSource(e,t){const r=this.formulaDataSvc;if(!(r!=null&&r.hasDataSource())||!e.isAllowFormula())return;const s=r.getFormula({column:e,rowNode:t});return Ap(s)?s:void 0}resolveValue(e,t,r){const s=e.getColDef(),i=e.getColId(),n=this.isTreeData,o=this.getFormulaFromDataSource(e,t);if(o!==void 0)return o;const a=!r&&t.aggData&&t.aggData[i]!==void 0;if(n&&a)return t.aggData[i];const l=t.data,c=s.field;if(n&&s.valueGetter)return this.executeValueGetter(s.valueGetter,l,e,t);if(n&&c&&l)return ta(l,c,e.isFieldContainsDots());const u=t.groupData;if(u&&i in u)return t.groupData[i];if(a)return t.aggData[i];const h=s.showRowGroup,f=typeof h!="string"||!t.group,p=this.isSsrm&&r&&!!s.aggFunc,g=this.isSsrm&&t.footer&&t.field&&(h===!0||h===t.field);if(s.valueGetter&&!p)return f?this.executeValueGetter(s.valueGetter,l,e,t):void 0;if(g)return ta(l,t.field,e.isFieldContainsDots());if(c&&l&&!p)return f?ta(l,c,e.isFieldContainsDots()):void 0}parseValue(e,t,r,s){var o,a;const i=e.getColDef();if(i.allowFormula&&((o=this.beans.formula)!=null&&o.isFormula(r)))return r;const n=i.valueParser;if(Ce(n)){const l=ke(this.gos,{node:t,data:t==null?void 0:t.data,oldValue:s,newValue:r,colDef:i,column:e});return typeof n=="function"?n(l):(a=this.expressionSvc)==null?void 0:a.evaluate(n,l)}return r}getDeleteValue(e,t){return Ce(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay({column:e,node:t}).value)??null:null}formatValue(e,t,r,s,i=!0){const{expressionSvc:n}=this.beans;let o=null,a;const l=e.getColDef();if(s?a=s:i&&(a=l.valueFormatter),a){const c=t?t.data:null,u=ke(this.gos,{value:r,node:t,data:c,colDef:l,column:e});typeof a=="function"?o=a(u):o=n?n.evaluate(a,u):null}else if(l.refData)return l.refData[r]||"";return o==null&&Array.isArray(r)&&(o=r.join(", ")),o}setValue(e,t,r,s){const i=this.colModel.getColDefCol(t);if(!e||!i)return!1;this.ensureRowData(e);const n=i.getColDef();if(!this.isSetValueSupported({column:i,newValue:r,colDef:n}))return!1;const o=ke(this.gos,{node:e,data:e.data,oldValue:this.getValue(i,e,void 0,s),newValue:r,colDef:n,column:i});o.newValue=r;const a=this.handleExternalFormulaChange({column:i,eventSource:s,newValue:r,setterParams:o,rowNode:e});if(a!==null)return a;let l=this.computeValueChange({column:i,newValue:r,params:o,rowData:e.data,valueSetter:n.valueSetter,field:n.field});return l===void 0&&(l=!0),l?this.finishValueChange(e,i,o,s):!1}finishValueChange(e,t,r,s){var n;e.resetQuickFilterAggregateText(),(n=this.valueCache)==null||n.onDataChanged();const i=this.getValue(t,e);return this.dispatchCellValueChangedEvent(e,r,i,s),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,r,i,s),!0}ensureRowData(e){ct(e.data)&&(e.data={})}isSetValueSupported(e){var c;const{column:t,newValue:r,colDef:s}=e,{field:i,valueSetter:n}=s,o=this.beans.formula,a=t.isAllowFormula()&&(o==null?void 0:o.isFormula(r)),l=!!((c=this.formulaDataSvc)!=null&&c.hasDataSource());return ct(i)&&ct(n)&&!(l&&a)?(oe(17),!1):this.dataTypeSvc&&!this.dataTypeSvc.checkType(t,r)?(oe(135),!1):!0}handleExternalFormulaChange(e){const{column:t,rowNode:r,newValue:s,eventSource:i,setterParams:n}=e,o=this.beans.formula,a=this.formulaDataSvc;if(!(a!=null&&a.hasDataSource())||!t.isAllowFormula())return null;const l=o==null?void 0:o.isFormula(s),c=a.getFormula({column:t,rowNode:r});if(l){if(!(c!==s))return!1;a.setFormula({column:t,rowNode:r,formula:s});const d=o==null?void 0:o.resolveValue(t,r),h=t.getColDef();if(Ce(h.valueSetter)||!ct(h.field)){const f={...n,newValue:d};this.computeValueChange({column:t,newValue:d,params:f,rowData:r.data,valueSetter:h.valueSetter,field:h.field})}return this.finishValueChange(r,t,n,i)}return c!==void 0&&a.setFormula({column:t,rowNode:r,formula:void 0}),null}computeValueChange(e){var a;const{valueSetter:t,params:r,rowData:s,field:i,column:n,newValue:o}=e;return Ce(t)?typeof t=="function"?t(r):(a=this.expressionSvc)==null?void 0:a.evaluate(t,r):this.setValueUsingField(s,i,o,n.isFieldContainsDots())}dispatchCellValueChangedEvent(e,t,r,s){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:r,value:r,source:s})}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,r,s){if(!t)return!1;let i=!1;if(!s)i=e[t]===r,i||(e[t]=r);else{const n=t.split(".");let o=e;for(;n.length>0&&o;){const a=n.shift();n.length===0?(i=o[a]===r,i||(o[a]=r)):o=o[a]}}return!i}executeValueGetterWithValueCache(e,t,r,s){const i=r.getColId(),n=this.valueCache.getValue(s,i);if(n!==void 0)return n;const o=this.executeValueGetterWithoutValueCache(e,t,r,s);return this.valueCache.setValue(s,i,o),o}executeValueGetterWithoutValueCache(e,t,r,s){var o;const i=ke(this.gos,{data:t,node:s,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,s)});let n;return typeof e=="function"?n=e(i):n=(o=this.expressionSvc)==null?void 0:o.evaluate(e,i),n}getValueCallback(e,t){const r=this.colModel.getColDefCol(t);return r?this.getValue(r,e):null}getKeyForNode(e,t){const r=this.getValue(e,t),s=e.getColDef().keyCreator;let i=r;if(s){const n=ke(this.gos,{value:r,colDef:e.getColDef(),column:e,node:t,data:t.data});i=s(n)}return typeof i=="string"||i==null||(i=String(i),i==="[object Object]"&&oe(121)),i}},g4={moduleName:"CommunityCore",version:we,beans:[lL,lI,f_,tk,jO,RM,rL,PL,J2,bO,SO,KO,f4,oL,tL,aL,p_,r4,l_,c_,VL],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:cI,destroy:uI,isDestroyed:dI,getGridOption:hI,setGridOption:fI,updateGridOptions:rx,isModuleRegistered:gI},dependsOn:[n_,sM,uM,Fx,OL,TM,NL,UO,d4,HL,yO,TO,DO,WL,h_,o_,u4,AM,MO]},Rx={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1,Formula:1},Pd=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],p4={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:Pd,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...Pd,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...Pd,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},m4={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function v4(e,t){const r=[];for(const s of Array.isArray(e)?e:[e]){const i=p4[s];if(i)for(const n of i){const o=m4[n];(!o||o===t)&&r.push(n)}else r.push(s)}return r}var Ex=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,C4=e=>{const t=e.map(s=>`import { ${ra(s)} } from '${Rx[s]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(s=>s==="IntegratedCharts"||s==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(s=>ra(s,!0)).join(", ")} ]); 

For more info see: ${jn}/modules/`};function ra(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function w4(e,t){const r=t.filter(n=>n==="IntegratedCharts"||n==="Sparklines");let s="";return!(globalThis==null?void 0:globalThis.agCharts)&&r.length>0?s=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(n=>Rx[n])&&(s=s+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),s}function Tx({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var N0=({reasonOrId:e,moduleName:t,gridScoped:r,gridId:s,rowModelType:i,additionalText:n,isUmd:o})=>{const a=v4(t,i),l=typeof e=="string"?e:b4[e];if(o)return w4(l,a);const c=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),u=c.length>0?`${c.map(h=>ra(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>ra(h)).join(", "):ra(a[0])} is not registered${r?" for gridId: "+s:""}. ${u} Check if you have registered the module:
`}
${C4(a)}`+(n?` 

${n}`:"")},B0=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,x4=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,y4={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e==null?void 0:e.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e==null?void 0:e.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:r})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",r],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${x4(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:r,pageSizeOptions:s})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${r?"":" the default"} paginationPageSizeSelector=[${s==null?void 0:s.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:r,jsComps:s})=>{const i=[],n=[...Object.keys(r??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(s??[]).filter(a=>!!s[a])],o=yh({inputValue:t,allSuggestions:n,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return i.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),o.length>0&&i.push(`         Did you mean: [${o.slice(0,3)}]?
`),i.push("If using a custom component check it has been registered correctly."),i},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${jn}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{const r=yh({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,r.length>0?`         Did you mean: [${r.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:r})=>["duplicate group keys for row data, keys should be unique",e,t,...r??[]],187:({rowId:e,firstData:t,secondData:r})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",r],188:e=>`getRowId callback must be provided for Server Side Row Model ${(e==null?void 0:e.feature)||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:N0,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${jn}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e==null?void 0:e.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>B0("IntegratedChartsModule"),258:()=>B0("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:r,gridId:s,rowModelType:i})=>N0({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:eo[t],gridId:s,gridScoped:r,rowModelType:i}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${jn}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>Ex(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:Tx,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`,293:()=>"The grid was initialised detached from the DOM and was then inserted into a Shadow Root. Theme styles are probably broken. Pass the themeStyleContainer grid option to let the grid know where in the document to insert theme CSS.",294:()=>"When using the `agRichSelectCellEditor` setting `filterListAsync = true` requires `allowTyping = true` and the `values()` callback must return a Promise of filtered values.",295:({blockedService:e})=>`colDef.allowFormula is not supported with ${e}. Formulas has been turned off.`,296:()=>"Since v35, `api.hideOverlay()` does not hide the overlay when `activeOverlay` is set. Set `activeOverlay=null` instead.",297:()=>'`api.hideOverlay()` does not hide the no matching rows overlay as it is only controlled by grid state. Set `suppressOverlays=["noMatchingRows"] to not show it.'};function S4(e,t){const r=y4[e];if(!r)return[`Missing error text for error id ${e}!`];const s=r(t),n=`
See ${LC(e,t)}`;return Array.isArray(s)?s.concat(n):[s,n]}var b4={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},H0=new WeakMap,V0=new WeakMap,F4=1,R4=class{create(e,t,r,s,i,n){const o=Rf.applyGlobalGridOptions(t),a=o.gridId??String(F4++),l=this.getRegisteredModules(i,a,o.rowModelType),c=this.createBeansList(o.rowModelType,l,a),u=this.createProvidedBeans(e,o,i);if(!c)return;const h={providedBeanInstances:u,beanClasses:c,id:a,beanInitComparator:iI,beanDestroyComparator:nI,derivedBeans:[rI],destroyCallback:()=>{V0.delete(p),H0.delete(e),YT(a),n==null||n()}},f=new BP(h);this.registerModuleFeatures(f,l),r(f),f.getBean("syncSvc").start(),s==null||s(f);const p=f.getBean("gridApi");return H0.set(e,p),V0.set(p,e),p}getRegisteredModules(e,t,r){var s;return ya(g4,void 0,!0),(s=e==null?void 0:e.modules)==null||s.forEach(i=>ya(i,t)),JT(t,G0(r))}registerModuleFeatures(e,t){const r=e.getBean("registry"),s=e.getBean("apiFunctionSvc");for(const i of t){r.registerModule(i);const n=i.apiFunctions;if(n){const o=Object.keys(n);for(const a of o)s==null||s.addFunction(a,n[a])}}}createProvidedBeans(e,t,r){let s=r?r.frameworkOverrides:null;ct(s)&&(s=new ex);const i={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:r?r.globalListener:null,globalSyncListener:r?r.globalSyncListener:null,frameworkOverrides:s};return r!=null&&r.providedBeanInstances&&Object.assign(i,r.providedBeanInstances),i}createBeansList(e,t,r){const s={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},i=G0(e),n=s[i];if(!n){zo(201,{rowModelType:i},`Unknown rowModelType ${i}.`);return}if(!e2()){zo(272,void 0,Ex());return}if(!e){const a=Object.entries(s).filter(([l,c])=>uh(c,r,l));if(a.length==1){const[l,c]=a[0];if(l!==i){const u={moduleName:c,rowModelType:l};zo(275,u,Tx(u));return}}}if(!uh(n,r,i)){const a=IC(),l=`rowModelType = '${i}'`,c=`Missing module ${n}Module for rowModelType ${i}.`;zo(200,{reasonOrId:l,moduleName:n,gridScoped:Ef(),gridId:r,rowModelType:i,isUmd:a},c);return}const o=new Set;for(const a of t)for(const l of a.beans??[])o.add(l);return Array.from(o)}};function G0(e){return e??"clientSide"}function Pi(e){const t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function Tu(e){const t=e.rowModel;return t.getType()==="infinite"?t:void 0}function E4(e){const t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var T4=class extends ee{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){const e=this.gos,t=e.getCallback("getLocaleText");return t?HT(t):VT(e.get("localeText"))}};function k4(e,t=!1){const r=[],s=[],i=[],n=[],o=[],a=[],l=[],c=[],u=[];let d=0;for(let h=0;h<e.length;h++){const{colId:f,sort:p,sortType:g,sortIndex:m,rowGroup:v,rowGroupIndex:w,aggFunc:C,pivot:y,pivotIndex:b,pinned:F,hide:S,width:D,flex:T}=e[h];u.push(f),p&&(r[m??d++]={colId:f,sort:p,type:g}),v&&(s[w??0]=f),typeof C=="string"&&i.push({colId:f,aggFunc:C}),y&&(n[b??0]=f),F&&(F==="right"?a:o).push(f),S&&l.push(f),(T!=null||D)&&c.push({colId:f,flex:T??void 0,width:D===null?void 0:D})}return{sort:r.length?{sortModel:Dd(r)}:void 0,rowGroup:s.length?{groupColIds:Dd(s)}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:n.length||t?{pivotMode:t,pivotColIds:Dd(n)}:void 0,columnPinning:o.length||a.length?{leftColIds:o,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:c.length?{columnSizingModel:c}:void 0,columnOrder:u.length?{orderedColIds:u}:void 0}}function Dd(e){return e.filter(t=>t!=null)}function P4(e){const t=[];for(const{groupId:r,open:s}of e)s&&t.push(r);return t.length?{openColumnGroupIds:t}:void 0}var D4=class{wrap(e,t,r,s){const i=this.createWrapper(e,s);for(const n of t??[])this.createMethod(i,n,!0);for(const n of r??[])this.createMethod(i,n,!1);return i}createMethod(e,t,r){e.addMethod(t,this.createMethodProxy(e,t,r))}createMethodProxy(e,t,r){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(r&&oe(49,{methodName:t}),null)}}};function Ad(e){return e.get("tooltipShowMode")==="whenTruncated"}function A4(e,t){if(typeof e!="number")return"";const r=t(),s=r("thousandSeparator",","),i=r("decimalSeparator",".");return e.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${s}`)}var I4=class extends ee{getFileName(e){const t=this.getDefaultFileExtension();return e!=null&&e.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){return this.beans.gridSerializer.serialize(this.createSerializingSession(e),e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},M4=class{constructor(e){const{colModel:t,rowGroupColsSvc:r,colNames:s,valueSvc:i,gos:n,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.colModel=t,this.rowGroupColsSvc=r,this.colNames=s,this.valueSvc=i,this.gos=n,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e){var p;const{column:t,node:r,currentColumnIndex:s,accumulatedRowIndex:i,type:n,useRawFormula:o}=e,a=s===0&&WC(this.gos,r,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||r.group)&&(t.isRowGroupDisplayed(((p=r.rowGroupColumn)==null?void 0:p.getColId())??"")||a))return{value:this.processRowGroupCallback(ke(this.gos,{column:t,node:r}))??""};if(this.processCellCallback)return{value:this.processCellCallback(ke(this.gos,{accumulatedRowIndex:i,column:t,node:r,value:this.valueSvc.getValueForDisplay({column:t,node:r}).value,type:n,parseValue:g=>this.valueSvc.parseValue(t,r,g,this.valueSvc.getValue(t,r,void 0)),formatValue:g=>this.valueSvc.formatValue(t,r,g)??g}))??""};const l=this.gos.get("treeData"),c=this.valueSvc,u=r.level===-1&&r.footer,d=t.colDef.showRowGroup===!0&&(r.group||l);if(!u&&(a||d)){let g="",m=r;for(;m&&m.level!==-1;){const{value:v,valueFormatted:w}=c.getValueForDisplay({column:a?void 0:t,node:m,includeValueFormatted:!0,exporting:!0});g=` -> ${w??v??""}${g}`,m=m.parent}return{value:g,valueFormatted:g}}const{value:h,valueFormatted:f}=c.getValueForDisplay({column:t,node:r,includeValueFormatted:!0,exporting:!0,useRawFormula:o});return{value:h??"",valueFormatted:f}}getHeaderName(e,t){return e?e(ke(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function _4(e,t){const r=document.defaultView||window;if(!r){oe(52);return}const s=document.createElement("a"),i=r.URL.createObjectURL(t);s.setAttribute("href",i),s.setAttribute("download",e),s.style.display="none",document.body.appendChild(s),s.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:r})),s.remove(),r.setTimeout(()=>{r.URL.revokeObjectURL(i)},0)}var L4={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,overlayComponent:!0,suppressOverlays:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},fr="clientSide",Yt="serverSide",Pn="infinite",O4={onGroupExpandedOrCollapsed:[fr],refreshClientSideRowModel:[fr],isRowDataEmpty:[fr],forEachLeafNode:[fr],forEachNodeAfterFilter:[fr],forEachNodeAfterFilterAndSort:[fr],resetRowHeights:[fr,Yt],applyTransaction:[fr],applyTransactionAsync:[fr],flushAsyncTransactions:[fr],getBestCostNodeSelection:[fr],getServerSideSelectionState:[Yt],setServerSideSelectionState:[Yt],applyServerSideTransaction:[Yt],applyServerSideTransactionAsync:[Yt],applyServerSideRowData:[Yt],retryServerSideLoads:[Yt],flushServerSideAsyncTransactions:[Yt],refreshServerSide:[Yt],getServerSideGroupLevelState:[Yt],refreshInfiniteCache:[Pn],purgeInfiniteCache:[Pn],getInfiniteRowCount:[Pn],isLastRowIndexKnown:[Pn,Yt],expandAll:[fr,Yt],collapseAll:[fr,Yt],onRowHeightChanged:[fr,Yt],setRowCount:[Pn,Yt],getCacheBlockState:[Pn,Yt]},N4={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function B4(e,t,r){const s=N4[e];if(s){const{version:n,new:o,old:a,message:l}=s,c=a??e;return(...u)=>{const d=o?`Please use ${o} instead. `:"";return Zo(`Since ${n} api.${c} is deprecated. ${d}${l??""}`),t.apply(t,u)}}const i=O4[e];return i?(...n)=>{const o=r.rowModel.getType();if(!i.includes(o)){Un(`api.${e} can only be called when gridOptions.rowModelType is ${i.join(" or ")}`);return}return t.apply(t,n)}:t}var H4={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},V4={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,aasc:1,adesc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},G4={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",overlayLoading:"Overlay",overlayExporting:"Overlay",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",richSelectLoading:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortAbsoluteAscending:["MenuCore","Sort"],sortAbsoluteDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},W4=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),z4=class extends ee{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,r2(S4)}warnOnInitialPropertyUpdate(e,t){e==="api"&&L4[t]&&oe(22,{key:t})}processGridOptions(e){this.processOptions(e,EL())}validateApiFunction(e,t){return B4(e,t,this.beans)}missingUserComponent(e,t,r,s){const i=eo[t];i?this.gos.assertModuleRegistered(i,`AG Grid '${e}' component: ${t}`):oe(101,{propertyName:e,componentName:t,agGridDefaults:r,jsComps:s})}missingDynamicBean(e){const t=H4[e];return t?Rs(200,{...this.gos.getModuleErrorParams(),moduleName:t,reasonOrId:e}):void 0}checkRowEvents(e){j4.has(e)&&oe(10,{eventType:e})}validateIcon(e){if(W4.has(e)&&oe(43,{iconName:e}),V4[e])return;const t=G4[e];if(t){Qe(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:Ef(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}oe(134,{iconName:e})}isProvidedUserComp(e){return!!eo[e]}validateColDef(e){this.processOptions(e,pL())}processOptions(e,t){const{validations:r,deprecations:s,allProperties:i,propertyExceptions:n,objectName:o,docsUrl:a}=t;i&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...n??[],...Object.keys(s)],i,o,a);const l=new Set;if(Object.keys(e).forEach(u=>{const d=s[u];if(d){const{message:w,version:C}=d;l.add(`As of v${C}, ${String(u)} is deprecated. ${w??""}`)}const h=e[u];if(h==null||h===!1)return;const f=r[u];if(!f)return;const{dependencies:p,validate:g,supportedRowModels:m,expectedType:v}=f;if(v){const w=typeof h;if(w!==v){l.add(`${String(u)} should be of type '${v}' but received '${w}' (${h}).`);return}}if(m){const w=this.gridOptions.rowModelType??"clientSide";if(!m.includes(w)){l.add(`${String(u)} is not supported with the '${w}' row model. It is only valid with: ${m.join(", ")}.`);return}}if(p){const w=this.checkForRequiredDependencies(u,p,e);if(w){l.add(w);return}}if(g){const w=g(e,this.gridOptions,this.beans);if(w){l.add(w);return}}}),l.size>0)for(const u of l)Zo(u)}checkForRequiredDependencies(e,t,r){const i=Object.entries(t).filter(([n,o])=>{const a=r[n];return!o.required.includes(a)});return i.length===0?null:i.map(([n,o])=>`'${String(e)}' requires '${n}' to be one of [${o.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${o.reason??""}`).join(`
           `)}checkProperties(e,t,r,s,i){const n=["__ob__","__v_skip","__metadata__"],o=U4(Object.getOwnPropertyNames(e),[...n,...t,...r],r),a=Object.keys(o);for(const l of a){const c=o[l];let u=`invalid ${s} property '${l}' did you mean any of these: ${c.slice(0,8).join(", ")}.`;r.includes("context")&&(u+=`
If you are trying to annotate ${s} with application data, use the '${s}.context' property instead.`),Zo(u)}if(a.length>0&&i){const l=this.beans.frameworkOverrides.getDocLink(i);Zo(`to see all the valid ${s} properties please check: ${l}`)}}};function U4(e,t,r){const s={},i=e.filter(n=>!t.some(o=>o===n));if(i.length>0)for(const n of i)s[n]=yh({inputValue:n,allSuggestions:r}).values;return s}var j4=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),$4={moduleName:"Validation",version:we,beans:[z4]};function Lh(e){const t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var K4=class extends ee{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){var r,s;const t=!!((r=this.filterManager)!=null&&r.isChildFilterPresent());(s=this.beans.formula)!=null&&s.active?this.softFilter(t,e):this.filterNodes(t,e)}filterNodes(e,t){const r=(s,i)=>{s.hasChildren()&&e&&!i?s.childrenAfterFilter=s.childrenAfterGroup.filter(n=>{const o=n.childrenAfterFilter&&n.childrenAfterFilter.length>0,a=n.data&&this.filterManager.doesRowPassFilter({rowNode:n});return o||a}):s.childrenAfterFilter=s.childrenAfterGroup,Lh(s)};if(this.doingTreeDataFiltering()){const s=(n,o)=>{if(n.childrenAfterGroup)for(let a=0;a<n.childrenAfterGroup.length;a++){const l=n.childrenAfterGroup[a],c=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?s(n.childrenAfterGroup[a],c):r(l,c)}r(n,o)},i=n=>s(n,!1);t.executeFromRootNode(i)}else{const s=i=>r(i,!1);t.forEachChangedNodeDepthFirst(s,!0)}}softFilter(e,t){const r=s=>{if(s.childrenAfterFilter=s.childrenAfterGroup,s.hasChildren())for(const i of s.childrenAfterGroup)i.softFiltered=e&&!(i.data&&this.filterManager.doesRowPassFilter({rowNode:i}));Lh(s)};t.forEachChangedNodeDepthFirst(r,!0)}doingTreeDataFiltering(){const{gos:e}=this;return e.get("treeData")&&!e.get("excludeChildrenWhenTreeDataFiltering")}},q4=class extends Yf{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,r,s,i){this.comp=e;const n=Ka(this,this.beans.context,i);this.eButtonShowMainFilter=r,this.eFloatingFilterBody=s,this.setGui(t,n),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(n),this.setupLeft(n),this.setupHover(n),this.setupFocus(n),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(n),this.setupUi(),n.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(n);const o=()=>this.onColDefChanged(n);n.addManagedListeners(this.column,{colDefChanged:o}),n.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&o()}}),n.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return ke(t.gos,{colDef:r,column:e,floatingFilter:!0})}setupActive(){const e=this.column.getColDef(),t=!!e.filter,r=!!e.floatingFilter;this.active=t&&r}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=vr("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Xa(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.getLocaleTextFunc();lo(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){var o;const{beans:t}=this;if(pt(t)===this.eGui)return;const i=yn(t,this.eGui,null,e.shiftKey);if(i){(o=t.headerNavigation)==null||o.scrollToColumn(this.column),e.preventDefault(),i.focus();return}const n=this.findNextColumnWithFloatingFilter(e.shiftKey);n&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:n},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleCols;let r=this.column;do if(r=e?t.getColBefore(r):t.getColAfter(r),!r)break;while(!r.getColDef().filter||!r.getColDef().floatingFilter);return r}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case K.UP:case K.DOWN:case K.LEFT:case K.RIGHT:if(t)return;cn(e);case K.ENTER:t&&ln(this.eGui)&&e.preventDefault();break;case K.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const r=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),s=!!e.relatedTarget&&ji(e.relatedTarget,"ag-floating-filter");if(r&&s&&e.target===this.eGui){const i=this.lastFocusEvent,n=!!(i&&i.key===K.TAB);if(i&&n){const o=i.shiftKey;ln(this.eGui,o)}}this.focusThis()}setupHover(e){var t;(t=this.beans.colHover)==null||t.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){const t=new Xf(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){var e;this.suppressFilterButton=!((e=this.beans.menuSvc)!=null&&e.isFloatingFilterButtonEnabled(this.column)),this.highlightFilterButtonWhenActive=!Tr(this.gos)}setupUserComp(){var t;if(!this.active)return;const e=(t=this.beans.colFilter)==null?void 0:t.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){var t;const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;(t=this.beans.menuSvc)==null||t.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{beans:{colFilter:t},column:r,gos:s}=this,i=n=>{if((n==null?void 0:n.source)==="filterDestroyed"&&(!this.isAlive()||!(t!=null&&t.isAlive())))return;const o=this.comp.getFloatingFilterComp();o&&o.then(a=>{if(a){if(s.get("enableFilterHandlers")){const u=n;let d="filter";u!=null&&u.afterFloatingFilter?d="ui":u!=null&&u.afterDataChange?d="dataChanged":(n==null?void 0:n.source)==="api"&&(d="api"),this.updateFloatingFilterParams(this.userCompDetails,d);return}const l=t==null?void 0:t.getCurrentFloatingFilterParentModel(r),c=n?{...n,columns:n.columns??[],source:n.source==="api"?"api":"columnFilter"}:null;a.onParentModelChanged(l,c)}})};[this.destroySyncListener]=e.addManagedListeners(r,{filterChanged:i}),t!=null&&t.isFilterActive(r)&&i(null)}setupWidth(e){const t=()=>{const r=`${this.column.getActualWidth()}px`;this.comp.setWidth(r)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){var e;if(!this.suppressFilterButton&&this.comp){const t=!!((e=this.beans.filterManager)!=null&&e.isFilterAllowed(this.column));this.comp.setButtonWrapperDisplayed(t),this.highlightFilterButtonWhenActive&&t&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const r=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const s=this.beans.colFilter,i=this.active?s==null?void 0:s.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,n=this.comp.getFloatingFilterComp();!n||!i?this.updateCompDetails(e,i,r):n.then(o=>{!o||s!=null&&s.areFilterCompsDifferent(this.userCompDetails??null,i)?this.updateCompDetails(e,i,r):this.updateFloatingFilterParams(i,"colDef")})}updateCompDetails(e,t,r){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),r&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){var s;if(!e)return;let r=e.params;(s=this.comp.getFloatingFilterComp())==null||s.then(i=>{var n;typeof(i==null?void 0:i.refresh)=="function"&&(this.gos.get("enableFilterHandlers")&&(r={...r,model:Bt(((n=this.beans.colFilter)==null?void 0:n.model)??{},this.column.getColId()),source:t}),i.refresh(r))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function X4(e,t){var s;const r=e.colModel.getCol(t);if(!r){Qe(12,{colKey:t});return}(s=e.menuSvc)==null||s.showColumnMenu({column:r,positionBy:"auto"})}function Y4(e){var t;(t=e.menuSvc)==null||t.hidePopupMenu()}var J4={moduleName:"SharedMenu",version:we,beans:[yA],apiFunctions:{showColumnMenu:X4,hidePopupMenu:Y4}},Z4=class extends XP{getDefaultPopupParent(){return this.beans.ctrlsSvc.get("gridCtrl").getGui()}callPostProcessPopup(e,t,r,s,i){const n=this.gos.getCallback("postProcessPopup");if(n){const{column:o,rowNode:a}=e??{};n({column:o,rowNode:a,ePopup:r,type:t,eventSource:s,mouseEvent:i})}}getActivePopups(){return this.popupList.map(e=>e.element)}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return zs(e)}},ku={moduleName:"Popup",version:we,beans:[Z4]},Q4=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function eN(e){const t=e.filterManager;return!!(t!=null&&t.isColumnFilterPresent())||!!(t!=null&&t.isAggregateFilterPresent())}function tN(e,t){var r;return((r=e.filterManager)==null?void 0:r.getColumnFilterInstance(t))??Promise.resolve(void 0)}function rN(e,t){var s;const r=e.colModel.getColDefCol(t);if(r)return(s=e.colFilter)==null?void 0:s.destroyFilter(r,"api")}function sN(e,t){e.frameworkOverrides.wrapIncoming(()=>{var r;return(r=e.filterManager)==null?void 0:r.setFilterModel(t)})}function iN(e){var t;return((t=e.filterManager)==null?void 0:t.getFilterModel())??{}}function nN(e,t,r){const{gos:s,colModel:i,colFilter:n}=e;r&&!s.get("enableFilterHandlers")&&(oe(288),r=!1);const o=i.getColDefCol(t);return o?(n==null?void 0:n.getModelForColumn(o,r))??null:null}function oN(e,t,r){var s;return((s=e.filterManager)==null?void 0:s.setColumnFilterModel(t,r))??Promise.resolve()}function aN(e,t){var s;const r=e.colModel.getCol(t);if(!r){Qe(12,{colKey:t});return}(s=e.menuSvc)==null||s.showFilterMenu({column:r,containerType:"columnFilter",positionBy:"auto"})}function lN(e){var t;(t=e.menuSvc)==null||t.hideFilterMenu()}function cN(e,t){var s;const r=e.colModel.getCol(t);if(!r){Qe(12,{colKey:t});return}return(s=e.colFilter)==null?void 0:s.getHandler(r,!0)}function uN(e,t){const{colModel:r,colFilter:s,gos:i}=e;if(!i.get("enableFilterHandlers")){oe(287);return}const{colId:n,action:o}=t;if(n){const a=r.getColById(n);a&&(s==null||s.updateModel(a,o))}else s==null||s.updateAllModels(o)}var dN={filterHandler:()=>({doesFilterPass:()=>!0})},hN=class extends ee{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap={...Mw},this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){var r,s;this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});const e=this.gos,t={...((s=(r=e.get("initialState"))==null?void 0:r.filter)==null?void 0:s.filterModel)??{}};this.initialModel=t,this.model={...t},e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",r){const{colModel:s,dataTypeSvc:i,filterManager:n}=this.beans;if(i!=null&&i.isPendingInference){this.modelUpdates.push({model:e,source:t});return}const o=[],a=this.getModel(!0);if(e){const l=new Set(Object.keys(e));this.allColumnFilters.forEach((c,u)=>{const d=e[u];o.push(this.setModelOnFilterWrapper(c,d)),l.delete(u)}),l.forEach(c=>{const u=s.getColDefCol(c)||s.getCol(c);if(!u){oe(62,{colId:c});return}if(!u.isFilterAllowed()){oe(63,{colId:c});return}const d=this.getOrCreateFilterWrapper(u,!0);if(!d){oe(64,{colId:c});return}o.push(this.setModelOnFilterWrapper(d,e[c],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{o.push(this.setModelOnFilterWrapper(l,null))});Ue.all(o).then(()=>{const l=this.getModel(!0),c=[];this.allColumnFilters.forEach((u,d)=>{const h=a?a[d]:null,f=l?l[d]:null;ma(h,f)||c.push(u.column)}),c.length>0?n==null||n.onFilterChanged({columns:c,source:t}):r&&this.updateActive("filterChanged")})}getModel(e){var n;const t={},{allColumnFilters:r,initialModel:s,beans:{colModel:i}}=this;if(r.forEach((o,a)=>{const l=this.getModelFromFilterWrapper(o);Ce(l)&&(t[a]=l)}),!e)for(const o of Object.keys(s)){const a=s[o];Ce(a)&&!r.has(o)&&((n=i.getCol(o))!=null&&n.isFilterAllowed())&&(t[o]=a)}return t}setState(e,t,r="api"){if(this.state.clear(),t)for(const s of Object.keys(t)){const i=t[s];this.state.set(s,{model:Bt(this.model,s),state:i})}this.setModel(e,r,!0)}getState(){const e=this.state;if(!e.size)return;const t={};let r=!1;return e.forEach((s,i)=>{const n=s.state;n!=null&&(r=!0,t[i]=n)}),r?t:void 0}getModelFromFilterWrapper(e){const r=e.column.getColId();if(e.isHandler)return Bt(this.model,r);const s=e.filter;return s?typeof s.getModel!="function"?(oe(66),null):s.getModel():Bt(this.initialModel,r)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};const{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){const e=c=>c?c.isFilterActive?c.isFilterActive():(oe(67),!1):!1,{colModel:t,gos:r}=this.beans,s=!!fh(r),i=c=>{if(!c.isPrimary())return!0;const d=!t.isPivotActive();return!c.isValueActive()||!d?!1:t.isPivotMode()?!0:s},n=[],o=[],a=(c,u,d)=>{u&&(i(c)?n.push(d):o.push(d))},l=[];return this.allColumnFilters.forEach(c=>{const u=c.column,d=u.getColId();if(c.isHandler)l.push(Ue.resolve().then(()=>{a(u,this.isHandlerActive(u),{colId:d,isHandler:!0,handler:c.handler,handlerParams:c.handlerParams})}));else{const h=ai(c);h&&l.push(h.then(f=>{a(u,e(f),{colId:d,isHandler:!1,comp:f})}))}}),Ue.all(l).then(()=>{this.activeAggregateFilters=n,this.activeColumnFilters=o})}updateFilterFlagInColumns(e,t){var s;const r=[];return this.allColumnFilters.forEach(i=>{const n=i.column;if(i.isHandler)r.push(Ue.resolve().then(()=>{this.setColFilterActive(n,this.isHandlerActive(n),e,t)}));else{const o=ai(i);o&&r.push(o.then(a=>{this.setColFilterActive(n,a.isFilterActive(),e,t)}))}}),(s=this.beans.groupFilter)==null||s.updateFilterFlags(e,t),Ue.all(r)}doFiltersPass(e,t,r){const{data:s,aggData:i}=e,n=r?this.activeAggregateFilters:this.activeColumnFilters,o=r?i:s,a=this.model;for(let l=0;l<n.length;l++){const c=n[l],{colId:u,isHandler:d}=c;if(u!==t)if(d){const{handler:h,handlerParams:f}=c;if(!h.doesFilterPass({node:e,data:o,model:Bt(a,u),handlerParams:f}))return!1}else{const h=c.comp;if(typeof h.doesFilterPass!="function"){Qe(91);continue}if(!h.doesFilterPass({node:e,data:o}))return!1}}return!0}getHandlerParams(e){const t=this.allColumnFilters.get(e.getColId());return t!=null&&t.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){const{rowRenderer:t,filterManager:r}=this.beans,s=()=>{this.isAlive()&&(r==null||r.onFilterChanged(e))};t.isRefreshInProgress()?setTimeout(s,0):s()}updateBeforeFilterChanged(e={}){const{column:t,additionalEventAttributes:r}=e,s=t==null?void 0:t.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",r).then(()=>{this.allColumnFilters.forEach(i=>{var a,l,c;const{column:n,isHandler:o}=i;s!==n.getColId()&&(o&&((l=(a=i.handler).onAnyFilterChanged)==null||l.call(a)),(c=ai(i,o))==null||c.then(u=>{typeof(u==null?void 0:u.onAnyFilterChanged)=="function"&&u.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){const t=[];this.allColumnFilters.forEach(r=>{var n,o;const s=r.isHandler;s&&((o=(n=r.handler).onNewRowsLoaded)==null||o.call(n));const i=ai(r,s);i&&t.push(i.then(a=>{var l;(l=a.onNewRowsLoaded)==null||l.call(a)}))}),Ue.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){const{filterValueSvc:r,colModel:s}=this.beans;return(i,n)=>{const o=n?s.getCol(n):e;return o?r.getValue(o,i,t):void 0}}isFilterActive(e){const t=this.cachedFilter(e);if(t!=null&&t.isHandler)return this.isHandlerActive(e);const r=t==null?void 0:t.filter;return r?r.isFilterActive():Bt(this.initialModel,e.getColId())!=null}isHandlerActive(e){const t=Ce(Bt(this.model,e.getColId()));if(t)return t;const r=this.beans.groupFilter;return r!=null&&r.isGroupFilter(e)?r.isFilterActive(e):!1}getOrCreateFilterUi(e){const t=this.getOrCreateFilterWrapper(e,!0);return t?ai(t):null}getFilterUiForDisplay(e){const t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;const r=ai(t);return r?r.then(s=>({comp:s,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){const r=this.getOrCreateFilterWrapper(e,t);return r!=null&&r.isHandler?r.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let r=this.cachedFilter(e);return!r&&t&&(r=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,r)),r}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>{var r;return(r=this.beans.dataTypeSvc)==null?void 0:r.getBaseDataType(e)},t)}getDefaultFilterFromDataType(e,t=!1){return w2(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":yD(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,r,s,i,n){const o=()=>{const c=this.createFilterCompParams(e,i,n),u=s(c,i);return Ek(this.beans.userCompFactory,t,u,r)},a=o();return a?{compDetails:a,createFilterUi:c=>(c?o():a).newAgStackInstance()}:null}createFilterInstance(e,t,r,s){var d,h;const i=this.beans.selectableFilter;i!=null&&i.isSelectable(t)&&(t=i.getFilterDef(e,t));const{handler:n,handlerParams:o,handlerGenerator:a}=this.createHandler(e,t,r)??{},l=this.createFilterComp(e,t,r,s,!!n,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:n,handlerGenerator:a,handlerParams:o};const{compDetails:c,createFilterUi:u}=l;return this.isGlobalButtons&&((h=(d=c.params)==null?void 0:d.buttons)!=null&&h.length||oe(281,{colId:e.getColId()})),{compDetails:c,handler:n,handlerGenerator:a,handlerParams:o,createFilterUi:u}}createBaseFilterParams(e,t){const{filterManager:r,rowModel:s}=this.beans;return ke(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:i=>(r==null?void 0:r.doesRowPassOtherFilters(e.getColId(),i))??!0,rowModel:s})}createFilterCompParams(e,t,r,s){const i=this.filterChangedCallbackFactory(e),n=this.createBaseFilterParams(e,s);if(n.filterChangedCallback=i,n.filterModifiedCallback=s?()=>{}:o=>this.filterModified(e,o),t){const o=n,a=e.getColId(),l=Bt(this.model,a);o.model=l,o.state=this.state.get(a)??{model:l},o.onModelChange=(c,u)=>{this.updateStoredModel(a,c),this.refreshHandlerAndUi(e,c,"ui",!1,u).then(()=>{i({...u,source:"columnFilter"})})},o.onStateChange=c=>{this.updateState(e,c),this.updateOrRefreshFilterUi(e)},o.onAction=(c,u,d)=>{this.updateModel(e,c,u),this.dispatchLocalEvent({type:"filterAction",column:e,action:c,event:d})},o.getHandler=()=>this.getHandler(e,!0),o.onUiChange=c=>this.filterUiChanged(e,c),o.source=r}return n}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,r){const s=t(),i={created:!0,create:t,filterParams:e.params,compDetails:e,promise:s};return s.then(r),i}createFilterWrapper(e){var a;const{compDetails:t,handler:r,handlerGenerator:s,handlerParams:i,createFilterUi:n}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),l=>l),o=e.getColId();if(r)return delete this.initialModel[o],(a=r.init)==null||a.call(r,{...i,source:"init",model:Bt(this.model,o)}),{column:e,isHandler:!0,handler:r,handlerGenerator:s,handlerParams:i,filterUi:this.createFilterUiForHandler(t,n)};if(n){const l={column:e,filterUi:null,isHandler:!1};return l.filterUi=this.createFilterUiLegacy(t,n,c=>{l.filter=c??void 0}),l}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,r){var f;const{gos:s,frameworkOverrides:i,registry:n}=this.beans;let o;const a=p=>{const g=p.filter;if(nw(g)){const m=g.handler;return m||(o=g.doesFilterPass,o?()=>({doesFilterPass:o}):void 0)}return typeof g=="string"?g:void 0},l=s.get("enableFilterHandlers"),c=l?a(t):void 0,u=p=>()=>this.createBean(n.createDynamicBean(p,!0));let d,h;if(typeof c=="string"){const p=(f=s.get("filterHandlers"))==null?void 0:f[c];p!=null?d=p:cD.has(c)&&(d=u(c),h=c)}else d=c;if(!d){let p;const{compName:g,jsComp:m,fwComp:v}=lw(i,t);g?p=g:m==null&&v==null&&t.filter===!0&&(p=r),h=this.handlerMap[p],h&&(d=u(h))}return d?{filterHandler:d,handlerNameOrCallback:o??h}:l?(wt(s)&&oe(277,{colId:e.getColId()}),dN):void 0}createHandler(e,t,r){const s=this.createHandlerFunc(e,t,r);if(!s)return;const i=sd(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:n,filterHandler:o}=s,{handler:a,handlerParams:l}=this.createHandlerFromFunc(e,o,i);return{handler:a,handlerParams:l,handlerGenerator:n??o}}createHandlerFromFunc(e,t,r){const s=e.getColDef(),i=t(ke(this.gos,{column:e,colDef:s})),n=this.createHandlerParams(e,r);return{handler:i,handlerParams:n}}createHandlerParams(e,t){const r=e.getColDef(),s=e.getColId(),i=this.filterChangedCallbackFactory(e);return ke(this.gos,{colDef:r,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:n=>{var o;return((o=this.beans.filterManager)==null?void 0:o.doesRowPassOtherFilters(s,n))??!0},onModelChange:(n,o)=>{this.updateStoredModel(s,n),this.refreshHandlerAndUi(e,n,"handler",!1,o).then(()=>{i({...o,source:"columnFilter"})})},filterParams:t})}onColumnsChanged(){const e=[],{colModel:t,filterManager:r,groupFilter:s}=this.beans;this.allColumnFilters.forEach((n,o)=>{let a;n.column.isPrimary()?a=t.getColDefCol(o):a=t.getCol(o),!(a&&a===n.column)&&(e.push(n.column),this.disposeFilterWrapper(n,"columnChanged"),this.disposeColumnListener(o))});const i=s&&e.every(n=>s.isGroupFilter(n));e.length>0&&!i&&(r==null||r.onFilterChanged({columns:e,source:"api"}))}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const r=this.beans.groupFilter;return r!=null&&r.isGroupFilter(e)?r.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){const{userCompFactory:r,frameworkOverrides:s,selectableFilter:i,gos:n}=this.beans,o=f=>{const p=this.getOrCreateFilterUi(e);p==null||p.then(g=>{f(ba(g))})},a=e.getColDef(),l=i!=null&&i.isSelectable(a)?i.getFilterDef(e,a):a,c=FD(s,l,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",u=n.get("enableFilterHandlers"),d=sd(r,l,this.createFilterCompParams(e,u,"init",!0)),h=ke(n,{column:e,filterParams:d,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:o,showParentFilter:t});if(u){const f=h,p=e.getColId(),g=this.filterChangedCallbackFactory(e);f.onUiChange=m=>this.floatingFilterUiChanged(e,m),f.model=Bt(this.model,p),f.onModelChange=(m,v)=>{this.updateStoredModel(p,m),this.refreshHandlerAndUi(e,m,"floating",!0,v).then(()=>{g({...v,source:"columnFilter"})})},f.getHandler=()=>this.getHandler(e,!0),f.source="init"}return Pk(r,a,h,c)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,r,s){const i="paramsUpdated";if(e.isHandler){const n=t.getColId();delete this.initialModel[n],this.state.delete(n);const o=e.filterUi,a=this.createFilterUiForHandler(r,s);e.filterUi=a;const l=this.eventSvc;o!=null&&o.created?o.promise.then(c=>{this.destroyBean(c),l.dispatchEvent({type:"filterDestroyed",source:i,column:t})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:i,column:t})}else this.destroyFilter(t,i)}destroyFilter(e,t="api"){const r=e.getColId(),s=this.allColumnFilters.get(r);this.disposeColumnListener(r),delete this.initialModel[r],s&&this.disposeFilterWrapper(s,t).then(i=>{var n;i&&this.isAlive()&&((n=this.beans.filterManager)==null||n.onFilterChanged({columns:[e],source:"api"}))})}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let r=!1;const{column:s,isHandler:i,filterUi:n}=e,o=s.getColId();i&&(r=this.isHandlerActive(s),this.destroyBean(e.handler),delete this.model[o],this.state.delete(o));const a=()=>{this.setColFilterActive(s,!1,"filterDestroyed"),this.allColumnFilters.delete(o),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:s})};if(n){if(n.created)return n.promise.then(l=>(r=i?r:!!(l!=null&&l.isFilterActive()),this.destroyBean(l),a(),r));a()}return Ue.resolve(r)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:(t==null?void 0:t.source)??"columnFilter"})}}filterParamsChanged(e,t="api"){var m,v,w,C,y,b;const r=this.allColumnFilters.get(e);if(!r)return;const s=this.beans,i=r.column,n=i.getColDef(),o=i.isFilterAllowed(),a=this.getDefaultFilter(i),l=s.selectableFilter,c=l!=null&&l.isSelectable(n)?l.getFilterDef(i,n):n,u=o?this.createHandlerFunc(i,c,this.getDefaultFilter(i)):void 0,d=!!u,h=r.isHandler;if(h!=d){this.destroyFilter(i,"paramsUpdated");return}const{compDetails:f,createFilterUi:p}=(o?this.createFilterComp(i,c,a,F=>F,d,"colDef"):null)??{compDetails:null,createFilterUi:null},g=(f==null?void 0:f.params)??sd(s.userCompFactory,c,this.createFilterCompParams(i,d,"colDef"));if(h){const F=(u==null?void 0:u.handlerNameOrCallback)??(u==null?void 0:u.filterHandler),S=Bt(this.model,e);if(r.handlerGenerator!=F){const D=r.handler,{handler:T,handlerParams:V}=this.createHandlerFromFunc(i,u.filterHandler,g);r.handler=T,r.handlerParams=V,r.handlerGenerator=F,delete this.model[e],(m=T.init)==null||m.call(T,{...V,source:"init",model:null}),this.destroyBean(D),S!=null&&((v=this.beans.filterManager)==null||v.onFilterChanged({columns:[i],source:t}))}else{const D=this.createHandlerParams(i,f==null?void 0:f.params);r.handlerParams=D,(C=(w=r.handler).refresh)==null||C.call(w,{...D,source:"colDef",model:S})}}if(this.areFilterCompsDifferent(((y=r.filterUi)==null?void 0:y.compDetails)??null,f)||!r.filterUi||!f){this.destroyFilterUi(r,i,f,p);return}r.filterUi.filterParams=g,(b=ai(r,h))==null||b.then(F=>{(F!=null&&F.refresh?F.refresh(g):!0)===!1?this.destroyFilterUi(r,i,f,p):this.dispatchLocalEvent({type:"filterParamsChanged",column:i,params:g})})}refreshHandlerAndUi(e,t,r,s,i){const n=this.cachedFilter(e);if(!n)return s&&this.getOrCreateFilterWrapper(e,!0),Ue.resolve();if(!n.isHandler)return Ue.resolve();const{filterUi:o,handler:a,handlerParams:l}=n;return uD(()=>{if(o){const{created:c,filterParams:u}=o;if(c)return o.promise.then(d=>d?{filter:d,filterParams:u}:void 0);o.refreshed=!0}return Ue.resolve(void 0)},a,l,t,this.state.get(e.getColId())??{model:t},r,i)}setColumnFilterWrapper(e,t){const r=e.getColId();this.allColumnFilters.set(r,t),this.allColumnListeners.set(r,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(r)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:r}=e,{componentClass:s}=t;return!(r===s||(r==null?void 0:r.render)&&(s==null?void 0:s.render)&&r.render===s.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){const t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);const r=this.getOrCreateFilterUi(t);return r?new Promise(s=>{r.then(i=>{s(ba(i))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:r})=>{this.setModelForColumn(e,t).then(()=>r())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){const{state:s,model:i}=this,n=e.getColId(),o=s.get(n);return o?o.model??null:Bt(i,n)}const r=this.cachedFilter(e);return r?this.getModelFromFilterWrapper(r):null}setModelForColumn(e,t){var r;if((r=this.beans.dataTypeSvc)!=null&&r.isPendingInference){let s=()=>{};const i=new Promise(n=>{s=n});return this.columnModelUpdates.push({key:e,model:t,resolve:s}),i}return new Promise(s=>{this.setModelForColumnLegacy(e,t).then(i=>s(i))})}getStateForColumn(e){return this.state.get(e)??{model:Bt(this.model,e)}}setModelForColumnLegacy(e,t){const r=this.beans.colModel.getColDefCol(e),s=r?this.getOrCreateFilterWrapper(r,!0):null;return s?this.setModelOnFilterWrapper(s,t):Ue.resolve()}setColDefPropsForDataType(e,t,r){var u;const s=e.filter,i=s===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):s;if(typeof i!="string")return;let n,o;const a=this.beans,{filterParams:l,filterValueGetter:c}=e;i==="agMultiColumnFilter"?{filterParams:n,filterValueGetter:o}=((u=a.multiFilter)==null?void 0:u.getParamsForDataType(l,c,t,r))??{}:{filterParams:n,filterValueGetter:o}=CD(i,l,c,t,r,a,this.getLocaleTextFunc()),e.filterParams=n,o&&(e.filterValueGetter=o)}setColFilterActive(e,t,r,s){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",r)),e.dispatchColEvent("filterChanged",r,s)}setModelOnFilterWrapper(e,t,r){return new Ue(s=>{if(e.isHandler){const n=e.column,o=n.getColId(),a=this.model[o];if(this.updateStoredModel(o,t),r&&t===a){s();return}this.refreshHandlerAndUi(n,t,"api").then(()=>s());return}const i=ai(e);if(i){i.then(n=>{if(typeof(n==null?void 0:n.setModel)!="function"){oe(65),s();return}(n.setModel(t)||Ue.resolve()).then(()=>s())});return}s()})}updateStoredModel(e,t){Ce(t)?this.model[e]=t:delete this.model[e];const r=this.state.get(e),s={model:t,state:r==null?void 0:r.state};this.state.set(e,s)}filterModified(e,t){var r;(r=this.getOrCreateFilterUi(e))==null||r.then(s=>{this.eventSvc.dispatchEvent({type:"filterModified",column:e,filterInstance:s,...t})})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"filterUiChanged",column:e,...t})}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"floatingFilterUiChanged",column:e,...t})}updateModel(e,t,r){var o,a;const s=e.getColId(),i=this.cachedFilter(e),n=()=>i==null?void 0:i.filterUi;t0({action:t,filterParams:(o=i==null?void 0:i.filterUi)==null?void 0:o.filterParams,getFilterUi:n,getModel:()=>Bt(this.model,s),getState:()=>this.state.get(s),updateState:l=>this.updateState(e,l),updateModel:l=>{var c,u;return(u=(c=n())==null?void 0:c.filterParams)==null?void 0:u.onModelChange(l,{...r,fromAction:t})},processModelToApply:i!=null&&i.isHandler?(a=i.handler.processModelToApply)==null?void 0:a.bind(i.handler):void 0})}updateAllModels(e,t){const r=[];this.allColumnFilters.forEach((s,i)=>{var o,a;const n=this.beans.colModel.getColDefCol(i);n&&t0({action:e,filterParams:(o=s.filterUi)==null?void 0:o.filterParams,getFilterUi:()=>s.filterUi,getModel:()=>Bt(this.model,i),getState:()=>this.state.get(i),updateState:l=>this.updateState(n,l),updateModel:l=>{this.updateStoredModel(i,l),this.dispatchLocalEvent({type:"filterAction",column:n,action:e}),r.push(this.refreshHandlerAndUi(n,l,"ui"))},processModelToApply:s!=null&&s.isHandler?(a=s.handler.processModelToApply)==null?void 0:a.bind(s.handler):void 0})}),r.length&&Ue.all(r).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){const t=e.getColId();Lw(()=>{var r;return(r=this.cachedFilter(e))==null?void 0:r.filterUi},()=>Bt(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){const{state:e,model:t,activeFilterComps:r}=this;for(const i of r)if(i.source==="COLUMN_MENU")return!1;let s=!1;for(const i of e.keys()){const n=e.get(i);if(n.valid===!1)return!1;(n.model??null)!==Bt(t,i)&&(s=!0)}return s}hasUnappliedModel(e){var s;const{model:t,state:r}=this;return(((s=r.get(e))==null?void 0:s.model)??null)!==Bt(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;const r=this.beans.filterPanelSvc;return r!=null&&r.isActive?!!r.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function fN(e){var t;return!!((t=e.filterManager)!=null&&t.isAnyFilterPresent())}function gN(e,t="api"){var r;(r=e.filterManager)==null||r.onFilterChanged({source:t})}var pN=class extends ee{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:s})=>this.onAdvFilterEnabledChanged(s),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});const{gos:r}=this;this.alwaysPassFilter=r.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=r.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,r="api"){var s;this.isAdvFilterEnabled()||(s=this.colFilter)==null||s.setState(e,t,r)}setFilterModel(e,t="api",r){var s;if(this.isAdvFilterEnabled()){r||this.warnAdvFilters();return}(s=this.colFilter)==null||s.setModel(e,t)}getFilterModel(){var e;return((e=this.colFilter)==null?void 0:e.getModel())??{}}getFilterState(){var e;return(e=this.colFilter)==null?void 0:e.getState()}isColumnFilterPresent(){var e;return!!((e=this.colFilter)!=null&&e.isFilterPresent())}isAggregateFilterPresent(){var e;return!!((e=this.colFilter)!=null&&e.isAggFilterPresent())}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){var t,r;e?(t=this.colFilter)!=null&&t.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):(r=this.advancedFilter)!=null&&r.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){var e;return!!((e=this.advancedFilter)!=null&&e.isEnabled())}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){fh(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:r,columns:s=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):Ue.resolve()).then(()=>{var n;const i={source:t,type:"filterChanged",columns:s};r&&cr(i,r),this.eventSvc.dispatchEvent(i),(n=this.colFilter)==null||n.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){var e;return!!((e=this.colFilter)!=null&&e.isSuppressFlashingCellsBecauseFiltering())}isQuickFilterPresent(){var e;return!!((e=this.quickFilter)!=null&&e.isFilterPresent())}updateAggFiltering(){this.aggFiltering=!!fh(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){var r;const{rowNode:t}=e;return(r=this.alwaysPassFilter)!=null&&r.call(this,t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){var r;const{rowNode:t}=e;return(r=this.alwaysPassFilter)!=null&&r.call(this,t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){var t;return this.isAdvFilterEnabled()?!1:!!((t=this.colFilter)!=null&&t.isFilterAllowed(e))}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){var r;if(this.isAdvFilterEnabled()){if((r=this.beans.dataTypeSvc)!=null&&r.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){var e;return this.isAdvFilterEnabled()?!1:!!((e=this.colFilter)!=null&&e.hasFloatingFilters())}getColumnFilterInstance(e){var t;return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):((t=this.colFilter)==null?void 0:t.getFilterInstance(e))??Promise.resolve(void 0)}warnAdvFilters(){oe(68)}setupAdvFilterHeaderComp(e){var t;(t=this.advancedFilter)==null||t.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(const e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){var r;return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):((r=this.colFilter)==null?void 0:r.setModelForColumn(e,t))??Promise.resolve()}},mN=class extends ee{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){var e;(e=this.hidePopup)==null||e.call(this)}showMenuAfterMouseEvent(e,t,r,s){e&&!e.isColumn||this.showPopup(e,i=>{var n;(n=this.popupSvc)==null||n.positionPopupUnderMouseEvent({additionalParams:{column:e},type:r,mouseEvent:t,ePopup:i})},r,t.target,Tr(this.gos),s)}showMenuAfterButtonClick(e,t,r,s){if(e&&!e.isColumn)return;let i=-1,n="left";const o=Tr(this.gos);!o&&this.gos.get("enableRtl")&&(i=1,n="right");const a=o?void 0:4*i,l=o?void 0:4;this.showPopup(e,c=>{var u;(u=this.popupSvc)==null||u.positionPopupByComponent({type:r,eventSource:t,ePopup:c,nudgeX:a,nudgeY:l,alignSide:n,keepWithinBounds:!0,position:"under",additionalParams:{column:e}})},r,t,o,s)}showPopup(e,t,r,s,i,n){var g;const o=e?this.createBean(new mD(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,!(o!=null&&o.hasFilter())||!e){Qe(57);return}const a=jr({tag:"div",cls:`ag-menu${i?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:m=>this.trapFocusWithin(m,a)}),a.appendChild(o==null?void 0:o.getGui());let l;const c=()=>o==null?void 0:o.afterGuiDetached(),u=x2(this.gos)?s??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,d=m=>{u0(e,!1,"contextMenu");const v=m instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),v&&s&&Qs(s)){const w=gw(s);w==null||w.focus({preventScroll:!0})}c(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,r,e),n==null||n()},h=this.getLocaleTextFunc(),f=i&&r!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),p=(g=this.popupSvc)==null?void 0:g.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:d,positionCallback:()=>t(a),anchorToElement:u,ariaLabel:f});p&&(this.hidePopup=l=p.hideFunc),o.afterInit().then(()=>{t(a),o.afterGuiAttached({container:r,hidePopup:l})}),u0(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,r,e)}trapFocusWithin(e,t){e.key!==K.TAB||e.defaultPrevented||yn(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),ln(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,r){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:r??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},vN=class extends ee{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,r){if(!t)return;const s=e.getColDef(),{selectableFilter:i,valueSvc:n,formula:o}=this.beans,a=r??(i==null?void 0:i.getFilterValueGetter(e.getColId()))??s.filterValueGetter;if(a)return this.executeFilterValueGetter(a,t.data,e,t,s);const l=n.getValue(e,t);return e.isAllowFormula()&&(o!=null&&o.isFormula(l))?o.resolveValue(e,t):l}executeFilterValueGetter(e,t,r,s,i){const{expressionSvc:n,valueSvc:o}=this.beans,a=ke(this.gos,{data:t,node:s,column:r,colDef:i,getValue:o.getValueCallback.bind(o,s)});return typeof e=="function"?e(a):n==null?void 0:n.evaluate(e,a)}},CN={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},wN=class extends Rt{constructor(){super(CN,[yu]),this.eFloatingFilterText=be}init(e){this.params=e;const t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){const r=e,s=r.getHandler();if(s.getModelAsString){const i=s.getModelAsString(r.model);this.eFloatingFilterText.setValue(i)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const r=t.getModelAsString(e);this.eFloatingFilterText.setValue(r)}})}refresh(e){this.init(e)}},sg=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){const r=e.filterOptions??t;this.filterOptions!==r&&(this.filterOptions=r,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){const{filterOptions:e}=this;if(e)for(const t of e){if(typeof t=="string")continue;const r=[["displayKey"],["displayName"],["predicate","test"]],s=i=>i.some(n=>t[n]!=null)?!0:(oe(72,{keys:i}),!1);if(!r.every(s)){this.filterOptions=e.filter(i=>i===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){const{filterOptions:t}=this;if(e)return e;if(t.length>=1){const r=t[0];if(typeof r=="string")return r;if(r.displayKey)return r.displayKey;oe(73)}else oe(74)}getCustomOption(e){return this.customFilterOptions[e]}};function sa(e,t,r){return r==null?e.splice(t):e.splice(t,r)}function zc(e){return e==null||typeof e=="string"&&e.trim().length===0}function xN(e){return e==="AND"||e==="OR"?e:"AND"}function yN(e,t,r){if(e==null)return;const{predicate:s}=e;if(s!=null&&!t.some(i=>i==null))return s(t,r)}function SN(e,t){let r=e.length;return r>t&&(e.splice(t),oe(78),r=t),r}function Ta(e,t){const r=t.getCustomOption(e);if(r){const{numberOfInputs:i}=r;return i??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var ig=class extends bD{constructor(e,t,r){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=r,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);const t=new sg;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=xN(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions(),pr(this.getGui(),"tabindex",this.isReadOnly()?"-1":null)}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,r)=>{const s=r===0?e:this.optionsFactory.defaultOption;t.setValue(s,!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){const{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){const r=!e.operator,s=!t.operator;if(!r&&s||r&&!s)return!1;let n;if(r){const o=e,a=t;n=this.areSimpleModelsEqual(o,a)}else{const o=e,a=t;n=o.operator===a.operator&&Ei(o.conditions,a.conditions,(l,c)=>this.areSimpleModelsEqual(l,c))}return n}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),Ue.resolve();if(e.operator){const s=e;let i=s.conditions;i==null&&(i=[],oe(77));const n=SN(i,this.maxNumConditions),o=this.getNumConditions();if(n<o)this.removeConditionsAndOperators(n);else if(n>o)for(let l=o;l<n;l++)this.createJoinOperatorPanel(),this.createOption();const a=s.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),i.forEach((l,c)=>{this.eTypes[c].setValue(l.type,!0),this.setConditionIntoUi(l,c)})}else{const s=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(s.type,!0),this.setConditionIntoUi(s,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),Ue.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(oe(79),t=1),this.maxNumConditions=t;let r=e.numAlwaysVisibleConditions??1;r<1&&(oe(80),r=1),r>t&&(oe(81),r=t),this.numAlwaysVisibleConditions=r}createOption(){const e=this.getGui(),t=this.createManagedBean(new Of);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());const r=this.createEValue();this.eConditionBodies.push(r),e.appendChild(r),this.putOptionsIntoDropdown(t),this.resetType(t);const s=this.getNumConditions()-1;this.forEachPositionInput(s,i=>this.resetInput(i)),this.addChangedListeners(t,s)}createJoinOperatorPanel(){const e=jr({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);const t=this.createJoinOperator(this.eJoinAnds,e,"and"),r=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);const s=this.eJoinPanels.length-1,i=this.joinOperatorId++;this.resetJoinOperatorAnd(t,s,i),this.resetJoinOperatorOr(r,s,i),this.isReadOnly()||(t.onValueChange(this.listener),r.onValueChange(this.listener))}createJoinOperator(e,t,r){const s=this.createManagedBean(new Qk);e.push(s);const i="ag-filter-condition-operator";return s.addCss(i),s.addCss(`${i}-${r}`),t.appendChild(s.getGui()),s}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){const{filterListOptions:t}=this;for(const r of t)e.addOption(r);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,r=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:r?this.getLocaleTextFunc()(r.displayKey,r.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const r=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<r){this.removeConditionsAndOperators(r+1);const s=e+1,i=r-s;i>0&&this.removeConditionsAndOperators(s,i),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((s,i)=>{const n=this.isConditionDisabled(i,e);s.setDisabled(n||this.filterListOptions.length<=1),i===1&&(Ca(this.eJoinPanels[0],n),this.eJoinAnds[0].setDisabled(n),this.eJoinOrs[0].setDisabled(n))}),this.eConditionBodies.forEach((s,i)=>{it(s,this.isConditionBodyVisible(i))});const r=(t??this.getJoinOperator())==="OR";for(const s of this.eJoinAnds)s.setValue(!r,!0);for(const s of this.eJoinOrs)s.setValue(r,!0);this.forEachInput((s,i,n,o)=>{this.setElementDisplayed(s,i<o),this.setElementDisabled(s,this.isConditionDisabled(n,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;const{eTypes:r,eConditionBodies:s,eJoinPanels:i,eJoinAnds:n,eJoinOrs:o}=this;this.removeComponents(r,e,t),this.removeElements(s,e,t),this.removeEValues(e,t);const a=Math.max(e-1,0);this.removeElements(i,a,t),this.removeComponents(n,a,t),this.removeComponents(o,a,t)}removeElements(e,t,r){const s=sa(e,t,r);for(const i of s)vi(i)}removeComponents(e,t,r){const s=sa(e,t,r);for(const i of s)vi(i.getGui()),this.destroyBean(i)}afterGuiAttached(e){var t;if(super.afterGuiAttached(e),this.resetPlaceholder(),!(e!=null&&e.suppressFocus)){let r;if(!this.isReadOnly()){const s=this.getInputs(0)[0];s instanceof zi&&this.isConditionBodyVisible(0)?r=s.getInputElement():r=(t=this.eTypes[0])==null?void 0:t.getFocusableElement()}(r??this.getGui()).focus({preventScroll:!0})}}shouldKeepInvalidInputState(){return!1}afterGuiDetached(){var o;super.afterGuiDetached();const e=this.params;if((o=this.beans.colFilter)!=null&&o.shouldKeepStateOnDetach(e.column)||this.shouldKeepInvalidInputState())return;e.onStateChange({model:e.model});let t=-1,r=-1,s=!1;const i=this.getJoinOperator();for(let a=this.getNumConditions()-1;a>=0;a--)if(this.isConditionUiComplete(a))t===-1&&(t=a,r=a);else{const l=a>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(a-1),c=a<t;(l||c)&&(this.removeConditionsAndOperators(a,1),s=!0,c&&r--)}let n=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),n=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),n=!0),n&&this.updateConditionStatusesAndValues(r,i),s&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r}getModelAsString(e){var t,r;return((r=(t=this.params.getHandler())==null?void 0:t.getModelAsString)==null?void 0:r.call(t,e))??""}resetPlaceholder(){const e=this.getLocaleTextFunc(),{filterPlaceholder:t,eTypes:r}=this;this.forEachInput((s,i,n,o)=>{if(!(s instanceof zi))return;const a=i===0&&o>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",l=i===0&&o>1?e("ariaFilterFromValue","Filter from value"):i===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value"),c=r[n].getValue(),u=Ow(this,t,a,c);s.setInputPlaceholder(u),s.setInputAriaLabel(l)})}setElementValue(e,t,r){e instanceof zi&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){Wp(e)&&it(e.getGui(),t)}setElementDisabled(e,t){Wp(e)&&Ca(e.getGui(),t)}attachElementOnChange(e,t){e instanceof zi&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,r)=>{this.forEachPositionTypeInput(r,t,e)})}forEachPositionInput(e,t){const r=this.getConditionType(e);this.forEachPositionTypeInput(e,r,t)}forEachPositionTypeInput(e,t,r){const s=Ta(t,this.optionsFactory),i=this.getInputs(e);for(let n=0;n<i.length;n++){const o=i[n];o!=null&&r(o,n,e,s)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return Ta(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(r=>r==null)||this.positionHasInvalidInputs(e))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,r)=>this.resetJoinOperatorAnd(t,r,this.joinOperatorId+r)),this.eJoinOrs.forEach((t,r)=>this.resetJoinOperatorOr(t,r,this.joinOperatorId+r)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){const r=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(r).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,r){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),r)}resetJoinOperatorOr(e,t,r){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),r)}resetJoinOperator(e,t,r,s,i){this.updateJoinOperatorDisabled(e.setValue(r,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${i}`).setLabel(s),t)}updateJoinOperatorsDisabled(){const e=(t,r)=>this.updateJoinOperatorDisabled(t,r);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const r=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((s,i,n)=>{n===t&&this.setElementValue(s,r[i]!=null?r[i]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,r,s)=>{this.setElementValue(t,r===0&&s===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,r=>{this.attachElementOnChange(r,this.listener)}))}hasInvalidInputs(){return!1}positionHasInvalidInputs(e){return!1}isReadOnly(){return!!this.params.readOnly}},W0=".ag-input-field-input",kx=class{constructor(e,t,r,s,i,n){this.context=e,this.eParent=i,this.alive=!0,this.debouncedReport=Wt({isAlive:()=>this.alive},z0,500),this.timeoutHandle=null;const o=Tk(t,r,s);o==null||o.newAgStackInstance().then(a=>{var u,d;if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;i.appendChild(a.getGui()),(u=a==null?void 0:a.afterGuiAttached)==null||u.call(a);const{tempValue:l,disabled:c}=this;l&&a.setDate(l),c!=null&&((d=a.setDisabled)==null||d.call(a,c)),n==null||n(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){const t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){var r;const t=this.dateComp;t?(r=t.setDisabled)==null||r.call(t,e):this.disabled=e}setDisplayed(e){it(this.eParent,e)}setInputPlaceholder(e){var t,r;(r=(t=this.dateComp)==null?void 0:t.setInputPlaceholder)==null||r.call(t,e)}setInputAriaLabel(e){var t,r;(r=(t=this.dateComp)==null?void 0:t.setInputAriaLabel)==null||r.call(t,e)}afterGuiAttached(e){var t,r;(r=(t=this.dateComp)==null?void 0:t.afterGuiAttached)==null||r.call(t,e)}updateParams(e){var t,r;(r=(t=this.dateComp)==null?void 0:t.refresh)==null||r.call(t,e)}setCustomValidity(e,t=!1){var s;const r=(s=this.dateComp)==null?void 0:s.getGui().querySelector(W0);if(r&&"setCustomValidity"in r){const i=e.length>0;r.setCustomValidity(e),i?t?this.timeoutHandle=this.debouncedReport(r):z0(r):this.timeoutHandle&&window.clearTimeout(this.timeoutHandle),mf(r,i)}}getValidity(){var e,t;return(t=(e=this.dateComp)==null?void 0:e.getGui().querySelector(W0))==null?void 0:t.validity}};function z0(e){e.reportValidity()}var ng=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function Px(e,t){const{dateFrom:r,dateTo:s,type:i}=e||{};return[r&&xr(r,void 0,!0)||null,s&&xr(s,void 0,!0)||null].slice(0,Ta(i,t))}var U0=1e3,j0=1/0,bN=class extends ig{constructor(){super("dateFilter",Px,ng),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=U0,this.maxValidYear=j0,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e),this.refreshInputValidation()}shouldKeepInvalidInputState(){return!Fa()&&this.hasInvalidInputs()&&this.getConditionTypes().includes("inRange")}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);const t=(l,c)=>{const u=e[l];if(u!=null)if(isNaN(u))oe(82,{param:l});else return u==null?c:Number(u);return c},r=t("minValidYear",U0),s=t("maxValidYear",j0);this.minValidYear=r,this.maxValidYear=s,r>s&&oe(83);const{minValidDate:i,maxValidDate:n}=e,o=i instanceof Date?i:xr(i);this.minValidDate=o;const a=n instanceof Date?n:xr(n);this.maxValidDate=a,o&&a&&o>a&&oe(84)}refreshInputValidation(){for(let e=0;e<this.dateConditionFromComps.length;e++)this.refreshInputPairValidation(e,!1,!0)}refreshInputPairValidation(e,t=!1,r=!1){const{dateConditionFromComps:s,dateConditionToComps:i,beans:n}=this,o=s[e],a=i[e],l=o.getDate(),c=a.getDate(),u=FN(l,c,t),d=u?this.translate(u,[String(t?c:l)]):"",h=!Fa()&&!r;(t?o:a).setCustomValidity(d,h),(t?a:o).setCustomValidity("",h),d.length>0&&n.ariaAnnounce.announceValue(d,"dateFilter")}createDateCompWrapper(e,t,r){const{beans:{userCompFactory:s,context:i,gos:n},params:o}=this,a=r==="from",l=new kx(i,s,o.colDef,ke(n,{onDateChanged:()=>{this.refreshInputPairValidation(t,a),this.onUiChanged()},onFocusIn:()=>this.refreshInputPairValidation(t,a),filterParams:o,location:"filter"}),e);return this.addDestroyFunc(()=>l.destroy()),l}getState(){return{isInvalid:this.hasInvalidInputs()}}areStatesEqual(e,t){return((e==null?void 0:e.isInvalid)??!1)===((t==null?void 0:t.isInvalid)??!1)}setElementValue(e,t){e.setDate(t),t||e.setCustomValidity("")}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){const e=jr({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,r,s){const i=jr({tag:"div",cls:`ag-filter-${s} ag-filter-date-${s}`});t.push(i),e.appendChild(i),r.push(this.createDateCompWrapper(i,t.length-1,s))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),sa(this.eConditionPanelsFrom,e,t),sa(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,r){const s=sa(e,t,r);for(const i of s)i.destroy()}isValidDateValue(e){if(e===null)return!1;const{minValidDate:t,maxValidDate:r,minValidYear:s,maxValidYear:i}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<s)return!1;if(r){if(e>r)return!1}else if(e.getUTCFullYear()>i)return!1;return!0}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{var r;return e||(e=t.getDate()!=null&&!(((r=t.getValidity())==null?void 0:r.valid)??!0))}),e}positionHasInvalidInputs(e){let t=!1;return this.forEachPositionInput(e,r=>{var s;return t||(t=!(((s=r.getValidity())==null?void 0:s.valid)??!0))}),t}canApply(e){return!this.hasInvalidInputs()}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachPositionInput(e,(r,s,i,n)=>{!t||s>=n||t&&(t=this.isValidDateValue(r.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),r={},s=this.getValues(e),i=this.params.useIsoSeparator?"T":" ";return s.length>0&&(r.dateFrom=kr(s[0],!0,i)),s.length>1&&(r.dateTo=kr(s[1],!0,i)),{dateFrom:null,dateTo:null,filterType:this.filterType,type:t,...r}}removeConditionsAndOperators(e,t){if(!this.hasInvalidInputs())return super.removeConditionsAndOperators(e,t)}resetPlaceholder(){const e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),r=e("ariaFilterValue","Filter Value");this.forEachInput(s=>{s.setInputPlaceholder(t),s.setInputAriaLabel(r)})}getInputs(e){const{dateConditionFromComps:t,dateConditionToComps:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,s,i,n)=>{s<n&&t.push(r.getDate())}),t}translate(e,t){let r=e;return e==="lessThan"?r="before":e==="greaterThan"&&(r="after"),super.translate(r,t)}};function FN(e,t,r){return e!=null&&t!=null&&e>=t?`${r?"max":"min"}DateValidation`:null}var Dx=class extends ee{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){const t=e.filterParams,r=new sg;this.optionsFactory=r,r.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(r,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){const t=e.filterParams,r=this.optionsFactory;r.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:r,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){const t=e.model;if(t==null)return!0;const{operator:r}=t,s=[];if(r){const o=t;s.push(...o.conditions??[])}else s.push(t);const i=r&&r==="OR"?"some":"every",n=this.params.getValue(e.node);return s[i](o=>this.individualConditionPasses(e,o,n))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){const{model:t,filterParams:{filterOptions:r,maxNumConditions:s}}=e;if(t==null)return;let n=Bw(t)?t.conditions:[t];const o=(r==null?void 0:r.map(u=>typeof u=="string"?u:u.displayKey))??this.defaultOptions;if(!(!n||n.every(u=>o.find(d=>d===u.type)!==void 0))){this.params={...e,model:null},e.onModelChange(null);return}let l=!1;const c=this.filterType;if((n&&!n.every(u=>u.filterType===c)||t.filterType!==c)&&(n=n.map(u=>({...u,filterType:c})),l=!0),typeof s=="number"&&n&&n.length>s&&(n=n.slice(0,s),l=!0),l){const u=n.length>1?{...t,filterType:c,conditions:n}:{...n[0],filterType:c};this.params={...e,model:u},e.onModelChange(u)}}individualConditionPasses(e,t,r){const s=this.optionsFactory,i=this.mapValuesFromModel(t,s),n=s.getCustomOption(t.type),o=yN(n,i,r);return o??(r==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,r,t,e))}},Ax=class extends Dx{evaluateNullValue(e){const{includeBlanksInEquals:t,includeBlanksInNotEqual:r,includeBlanksInGreaterThan:s,includeBlanksInLessThan:i,includeBlanksInRange:n}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(r)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(s)return!0;break;case"lessThan":case"lessThanOrEqual":if(i)return!0;break;case"inRange":if(n)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,r){const s=r.type;if(!this.isValid(t))return s==="notEqual"||s==="notBlank";const i=this.comparator(),n=e[0]!=null?i(e[0],t):0;switch(s){case"equals":return n===0;case"notEqual":return n!==0;case"greaterThan":return n>0;case"greaterThanOrEqual":return n>=0;case"lessThan":return n<0;case"lessThanOrEqual":return n<=0;case"inRange":{const o=i(e[1],t);return this.params.filterParams.inRangeInclusive?n>=0&&o<=0:n>0&&o<0}case"blank":return zc(t);case"notBlank":return!zc(t);default:return oe(76,{filterModelType:s}),!0}}},Ix={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},RN={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},og=class extends ee{constructor(e,t,r){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=r}getModelAsString(e,t){const r=this.getLocaleTextFunc(),s=t==="filterToolPanel";if(!e)return s?xs(this,"filterSummaryInactive"):null;if(e.operator!=null){const n=e,a=(n.conditions??[]).map(c=>this.getModelAsString(c,t)),l=n.operator==="AND"?"andCondition":"orCondition";return a.join(` ${xs(this,l)} `)}else{if(e.type==="blank"||e.type==="notBlank")return s?xs(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):r(e.type,e.type);{const n=e,o=this.optionsFactory.getCustomOption(n.type),{displayKey:a,displayName:l,numberOfInputs:c}=o||{};return a&&l&&c===0?r(a,l):this.conditionToString(n,s,n.type==="inRange"||c===2,a,l)}}}updateParams(e){const{optionsFactory:t,filterParams:r}=e;this.optionsFactory=t,this.filterParams=r}conditionForToolPanel(e,t,r,s,i,n){let o;const a=this.getTypeKey(e);return a&&(o=xs(this,a)),i&&n&&(o=this.getLocaleTextFunc()(i,n)),o!=null?t?`${o} ${xs(this,"filterSummaryInRangeValues",[r(),s()])}`:`${o} ${r()}`:null}getTypeKey(e){const t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){const t=this.valueFormatter;return t?t(e??null)??"":String(e)}},Mx=class extends og{constructor(e,t){super(e,t,r=>{const{dataTypeSvc:s,valueSvc:i}=this.beans,n=t.column,o=s==null?void 0:s.getDateFormatterFunction(n),a=o?o(r??void 0):r;return i.formatValue(n,null,a)}),this.filterTypeKeys=Ix}conditionToString(e,t,r,s,i){const{type:n}=e,o=xr(e.dateFrom),a=xr(e.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,c=t?this.formatValue.bind(this):h=>xh(h,l),u=()=>o!==null?c(o):"null",d=()=>a!==null?c(a):"null";if(t){const h=this.conditionForToolPanel(n,r,u,d,s,i);if(h!=null)return h}return r?`${u()}-${d()}`:o!=null?c(o):`${n}`}};function EN(e,t){const r=t;return r<e?-1:r>e?1:0}var TN=class extends Ax{constructor(){super(Px,ng),this.filterType="date",this.FilterModelFormatterClass=Mx}comparator(){return this.params.filterParams.comparator??EN}isValid(e){const t=this.params.filterParams.isValidDate;return!t||t(e)}},_x=class extends Rt{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}const t=e.operator;let r;t?r=e.conditions[0]:r=e,this.lastType=r.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const r=e;return this.isTypeEditable(r.type)}init(e){this.params=e;const t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){const r=e;this.onModelUpdated(r.model)}}setParams(e){const t=new sg;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){const r=this.optionsFactory.defaultOption;t||(this.lastType=r),this.readOnly=!!e.filterParams.readOnly;const s=this.isTypeEditable(r);this.setEditable(s)}refresh(e){this.params=e;const t=e,r=this.reactive;if((!r||t.source==="colDef")&&this.updateParams(e),r){const{source:s,model:i}=t;if(s==="dataChanged"||s==="ui")return;this.onModelUpdated(i)}}updateParams(e){const t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t!=null&&t.afterFloatingFilter||t!=null&&t.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){var r;const t=(r=this.optionsFactory.getCustomOption(e))==null?void 0:r.numberOfInputs;return t==null||t==1}isTypeEditable(e){const t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},kN={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},PN=class extends _x{constructor(){super(kN,[yu]),this.eReadOnlyText=be,this.eDateWrapper=be,this.FilterModelFormatterClass=Mx,this.filterType="date",this.defaultOptions=ng}setParams(e){super.setParams(e),this.createDateComponent();const t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){const r=e?xr(e.dateFrom):null;this.dateComp.setDate(r),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){it(this.eDateWrapper,e),it(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){const e=this.dateComp.getDate();if(this.reactive){const t=this.params;t.onUiChange();const r=t.model,s=kr(e),i=s==null?null:{...r??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption},dateFrom:s};t.onModelChange(i,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t==null||t.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){const{filterParams:e}=this.params,t=Gf(e,this.defaultDebounceMs);return ke(this.gos,{onDateChanged:Wt(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){const{beans:{context:e,userCompFactory:t},eDateWrapper:r,params:{column:s}}=this;this.dateComp=new kx(e,t,s.getColDef(),this.getDateComponentParams(),r,i=>{i.setInputAriaLabel(this.getAriaLabel(s))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},DN={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},AN=class extends Rt{constructor(){super(DN,[yu]),this.eDateInput=be,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this),focusin:this.handleFocusIn.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}handleFocusIn(){var e,t;(t=(e=this.params).onFocusIn)==null||t.call(e)}setParams(e){var h;const t=this.eDateInput.getInputElement(),r=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=r&&ki();const{minValidYear:s,maxValidYear:i,minValidDate:n,maxValidDate:o,buttons:a,includeTime:l,colDef:c}=e.filterParams||{},u=this.beans.dataTypeSvc,d=l??((h=u==null?void 0:u.getDateIncludesTimeFlag)==null?void 0:h.call(u,c.cellDataType))??!1;if(r?d?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",n&&s&&oe(85),o&&i&&oe(86),n&&o){const[f,p]=[n,o].map(g=>g instanceof Date?g:xr(g));f&&p&&f.getTime()>p.getTime()&&oe(87)}n?n instanceof Date?t.min=xh(n):t.min=n:s&&(t.min=`${s}-01-01`),o?o instanceof Date?t.max=xh(o):t.max=o:i&&(t.max=`${i}-12-31`),this.isApply=e.location==="floatingFilter"&&!!(a!=null&&a.includes("apply"))}refresh(e){this.params=e,this.setParams(e)}getDate(){return xr(this.eDateInput.getValue())}setDate(e){var s;const t=this.params.filterParams.colDef.cellDataType,r=((s=this.beans.dataTypeSvc)==null?void 0:s.getDateIncludesTimeFlag(t))??!1;this.eDateInput.setValue(kr(e,r))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e!=null&&e.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){var t;return((t=e==null?void 0:e.filterParams)==null?void 0:t.browserDatePicker)??!0}},ag=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function Oh(e){return(e==null?void 0:e.allowedCharPattern)??null}function Uc(e){return e==null||isNaN(e)?null:e}function Lx(e,t){const{filter:r,filterTo:s,type:i}=e||{};return[Uc(r),Uc(s)].slice(0,Ta(i,t))}var IN=class extends ig{constructor(){super("numberFilter",Lx,ag),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}afterGuiAttached(e){super.afterGuiAttached(e),this.refreshInputValidation()}shouldKeepInvalidInputState(){return!Fa()&&this.hasInvalidInputs()&&this.getConditionTypes().includes("inRange")}refreshInputValidation(){for(let e=0;e<this.eValuesFrom.length;e++){const t=this.eValuesFrom[e],r=this.eValuesTo[e];this.refreshInputPairValidation(t,r)}}refreshInputPairValidation(e,t,r=!1){const s=this.params.numberParser,i=$0(s,e),n=$0(s,t),o=MN(i,n,r),a=o?this.translate(o,[String(r?n:i)]):"";(r?e:t).setCustomValidity(a),(r?t:e).setCustomValidity(""),a.length>0&&this.beans.ariaAnnounce.announceValue(a,"dateFilter")}getState(){return{isInvalid:this.hasInvalidInputs()}}areStatesEqual(e,t){return((e==null?void 0:e.isInvalid)??!1)===((t==null?void 0:t.isInvalid)??!1)}refresh(e){const t=super.refresh(e),{state:r,additionalEventAttributes:s}=e,i=this.state,n=s==null?void 0:s.fromAction;return(n&&n!="apply"||r.model!==i.model||!this.areStatesEqual(r.state,i.state))&&this.refreshInputValidation(),t}setElementValue(e,t,r){const{numberFormatter:s}=this.params,i=!r&&s?s(t??null):t;super.setElementValue(e,i),i===null&&e.setCustomValidity("")}createEValue(){const{params:e,eValuesFrom:t,eValuesTo:r}=this,s=Oh(e),i=jr({tag:"div",cls:"ag-filter-body",role:"presentation"}),n=this.createFromToElement(i,t,"from",s),o=this.createFromToElement(i,r,"to",s),a=(u,d,h)=>()=>this.refreshInputPairValidation(u,d,h),l=a(n,o,!0);n.onValueChange(l),n.addGuiEventListener("focusin",l);const c=a(n,o,!1);return o.onValueChange(c),o.addGuiEventListener("focusin",c),i}createFromToElement(e,t,r,s){const i=this.createManagedBean(s?new Sn({allowedCharPattern:s}):new Lf);return i.addCss(`ag-filter-${r}`),i.addCss("ag-filter-filter"),t.push(i),e.appendChild(i.getGui()),i}removeEValues(e,t){const r=s=>this.removeComponents(s,e,t);r(this.eValuesFrom),r(this.eValuesTo)}getValues(e){const t=[];return this.forEachPositionInput(e,(r,s,i,n)=>{s<n&&t.push(Uc(Ox(this.params.numberParser,r.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},s=this.getValues(e);return s.length>0&&(r.filter=s[0]),s.length>1&&(r.filterTo=s[1]),r}removeConditionsAndOperators(e,t){if(!this.hasInvalidInputs())return super.removeConditionsAndOperators(e,t)}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>e||(e=!t.getInputElement().validity.valid)),e}positionHasInvalidInputs(e){let t=!1;return this.forEachPositionInput(e,r=>t||(t=!r.getInputElement().validity.valid)),t}canApply(e){return!this.hasInvalidInputs()}};function Ox(e,t){if(typeof t=="number")return t;let r=Vs(t);return r!=null&&r.trim()===""&&(r=null),e?e(r):r==null||r.trim()==="-"?null:Number.parseFloat(r)}function $0(e,t){return Uc(Ox(e,t.getValue(!0)))}function MN(e,t,r){return e!=null&&t!=null&&e>=t?`strict${r?"Max":"Min"}ValueValidation`:null}var Nx=class extends og{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=Ix}conditionToString(e,t,r,s,i){const{filter:n,filterTo:o,type:a}=e,l=this.formatValue.bind(this);if(t){const c=this.conditionForToolPanel(a,r,()=>l(n),()=>l(o),s,i);if(c!=null)return c}return r?`${l(n)}-${l(o)}`:n!=null?l(n):`${a}`}},_N=class extends Ax{constructor(){super(Lx,ag),this.filterType="number",this.FilterModelFormatterClass=Nx}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},Bx=class extends ee{constructor(e){super(),this.params=e,this.eInput=be,this.onValueChanged=()=>{}}setupGui(e){var s;this.eInput=this.createManagedBean(new Sn((s=this.params)==null?void 0:s.config));const t=this.eInput.getGui();e.appendChild(t);const r=i=>this.onValueChanged(i);this.addManagedListeners(t,{input:r,keydown:r})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t,placeholder:r}){const{eInput:s}=this;s.setInputAriaLabel(e),t!==void 0&&s.setAutoComplete(t),s.toggleCss("ag-floating-filter-search-icon",!!r),s.setInputPlaceholder(r)}};function Nh(e){const t=e==null?void 0:e.trim();return t===""?e:t}function Hx(e,t){const{filter:r,filterTo:s,type:i}=e||{};return[r||null,s||null].slice(0,Ta(i,t))}var LN={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},Vx=class extends _x{constructor(){super(...arguments),this.eFloatingFilterInputContainer=be,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(LN)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){const{inputSvc:t,defaultDebounceMs:r,readOnly:s}=this,{filterPlaceholder:i,column:n,browserAutoComplete:o,filterParams:a}=e,l=this.lastType??this.optionsFactory.defaultOption,c=e.filterParams.filterPlaceholder,u=i===!0?Ow(this,c,"filterOoo",l):i||void 0;if(t.setParams({ariaLabel:this.getAriaLabel(n),autoComplete:o??!1,placeholder:u}),this.applyActive=bu(a),!s){const d=Gf(a,r);t.setValueChangedListener(Wt(this,this.syncUpWithParentFilter.bind(this),d))}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const{inputSvc:t}=this,r=t.getValue();wr(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(r,!0)}syncUpWithParentFilter(e){const t=e.key===K.ENTER,r=this.reactive;if(r&&this.params.onUiChange(),this.applyActive&&!t)return;const{inputSvc:s,params:i,lastType:n}=this;let o=s.getValue();if(i.filterParams.trimInput&&(o=Nh(o),s.setValue(o,!0)),r){const a=i,l=a.model,c=this.convertValue(o),u=c==null?null:{...l??{filterType:this.filterType,type:n??this.optionsFactory.defaultOption},filter:c};a.onModelChange(u,{afterFloatingFilter:!0})}else i.parentFilterInstance(a=>{a==null||a.onFloatingFilterChanged(n||null,o||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},ON=class extends ee{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new Lf),this.eTextInput=this.createManagedBean(new Sn),this.eTextInput.setDisabled(!0);const t=this.eNumberInput.getGui(),r=this.eTextInput.getGui();e.appendChild(t),e.appendChild(r),this.setupListeners(t,s=>this.onValueChanged(s)),this.setupListeners(r,s=>this.onValueChanged(s))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams({ariaLabel:e,autoComplete:t,placeholder:r}){this.setAriaLabel(e),t!==void 0&&this.setAutoComplete(t),this.setPlaceholder(this.eNumberInput,r),this.setPlaceholder(this.eTextInput,r)}setPlaceholder(e,t){e.toggleCss("ag-floating-filter-search-icon",!!t),e.setInputPlaceholder(t)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},NN=class extends Vx{constructor(){super(...arguments),this.FilterModelFormatterClass=Nx,this.filterType="number",this.defaultOptions=ag}updateParams(e){Oh(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=Oh(e.filterParams),this.allowedCharPattern?this.createManagedBean(new Bx({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new ON)}convertValue(e){return e?Number(e):null}},lg=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],BN=class extends ig{constructor(){super("textFilter",Hx,lg),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},s=this.getValues(e);return s.length>0&&(r.filter=s[0]),s.length>1&&(r.filterTo=s[1]),r}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,s,i,n)=>{s<n&&t.push(Vs(r.getValue()))}),t}createEValue(){const e=jr({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:r}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,r,"to"),e}createFromToElement(e,t,r){const s=this.createManagedBean(new Sn);s.addCss(`ag-filter-${r}`),s.addCss("ag-filter-filter"),t.push(s),e.appendChild(s.getGui())}removeEValues(e,t){const r=n=>this.removeComponents(n,e,t),{eValuesFrom:s,eValuesTo:i}=this;r(s),r(i)}},Gx=class extends og{constructor(){super(...arguments),this.filterTypeKeys=RN}conditionToString(e,t,r,s,i){const{filter:n,filterTo:o,type:a}=e;if(t){const l=u=>()=>xs(this,"filterSummaryTextQuote",[u]),c=this.conditionForToolPanel(a,r,l(n),l(o),s,i);if(c!=null)return c}return r?`${n}-${o}`:n!=null?`${n}`:`${a}`}},HN=({filterOption:e,value:t,filterText:r})=>{if(r==null)return!1;switch(e){case"contains":return t.includes(r);case"notContains":return!t.includes(r);case"equals":return t===r;case"notEqual":return t!=r;case"startsWith":return t.indexOf(r)===0;case"endsWith":{const s=t.lastIndexOf(r);return s>=0&&s===t.length-r.length}default:return!1}},VN=e=>e,GN=e=>e==null?null:e.toString().toLowerCase(),WN=class extends Dx{constructor(){super(Hx,lg),this.filterType="text",this.FilterModelFormatterClass=Gx}updateParams(e){super.updateParams(e);const t=e.filterParams;this.matcher=t.textMatcher??HN,this.formatter=t.textFormatter??(t.caseSensitive?VN:GN)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,r,s){const i=e.map(h=>this.formatter(h))||[],n=this.formatter(t),{api:o,colDef:a,column:l,context:c,filterParams:{textFormatter:u}}=this.params;if(r.type==="blank")return zc(t);if(r.type==="notBlank")return!zc(t);const d={api:o,colDef:a,column:l,context:c,node:s.node,data:s.data,filterOption:r.type,value:n,textFormatter:u};return i.some(h=>this.matcher({...d,filterText:h}))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){const t=r=>{const s={...r},{filter:i,filterTo:n}=r;return i&&(s.filter=Nh(i)??null),n&&(s.filterTo=Nh(n)??null),s};return Bw(e)?{...e,conditions:e.conditions.map(t)}:t(e)}return e}},zN=class extends Vx{constructor(){super(...arguments),this.FilterModelFormatterClass=Gx,this.filterType="text",this.defaultOptions=lg}createFloatingFilterInputService(){return this.createManagedBean(new Bx)}};function UN(e){var t;return!!((t=e.quickFilter)!=null&&t.isFilterPresent())}function jN(e){var t;return(t=e.quickFilter)==null?void 0:t.getText()}function $N(e){var t;(t=e.quickFilter)==null||t.resetCache()}var KN=class extends ee{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){const e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",r=>this.setFilter(r.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){var l;const{autoColSvc:e,colModel:t,gos:r,pivotResultCols:s}=this.beans,i=t.isPivotMode(),n=e==null?void 0:e.getColumns(),o=t.getColDefCols();let a=(i&&!r.get("applyQuickFilterBeforePivotOrAgg")?(l=s==null?void 0:s.getPivotResultCols())==null?void 0:l.list:o)??[];n&&(a=a.concat(n)),this.colsToUse=r.get("includeHiddenColumnsInQuickFilter")?a:a.filter(c=>c.isVisible()||c.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(r=>t?this.doesRowPassCache(e,r):this.doesRowPassNoCache(e,r))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return Ce(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){oe(70,{newFilter:e});return}const t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),r=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,r&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(r=>{const s=this.getTextForColumn(r,e);return Ce(s)&&s.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let r;e?(this.checkGenerateAggText(t),r=t.quickFilterAggregateText):r=this.getAggText(t);const{quickFilterParts:s,matcher:i}=this;return i(s,r)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let r=this.beans.filterValueSvc.getValue(e,t);const s=e.getColDef();if(s.getQuickFilterText){const i=ke(this.gos,{value:r,node:t,data:t.data,column:e,colDef:s});r=s.getQuickFilterText(i)}return Ce(r)?r.toString().toUpperCase():null}getAggText(e){const t=[];for(const r of this.colsToUse){const s=this.getTextForColumn(r,e);Ce(s)&&t.push(s)}return t.join(`
`)}},qN={moduleName:"ClientSideRowModelFilter",version:we,rowModels:["clientSide"],beans:[K4]},cg={moduleName:"FilterCore",version:we,beans:[pN],apiFunctions:{isAnyFilterPresent:fN,onFilterChanged:gN},css:[Q4],dependsOn:[qN]},Wx={moduleName:"FilterValue",version:we,beans:[vN]},Pu={moduleName:"ColumnFilter",version:we,beans:[hN,mN],dynamicBeans:{headerFilterCellCtrl:q4},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:eN,getColumnFilterInstance:tN,destroyFilter:rN,setFilterModel:sN,getFilterModel:iN,getColumnFilterModel:nN,setColumnFilterModel:oN,showColumnFilter:aN,hideColumnFilter:lN,getColumnFilterHandler:cN,doFilterAction:uN},dependsOn:[cg,ku,Wx,J4]},XN={moduleName:"CustomFilter",version:we,userComponents:{agReadOnlyFloatingFilter:wN},dependsOn:[Pu]},YN={moduleName:"TextFilter",version:we,dependsOn:[Pu],userComponents:{agTextColumnFilter:{classImp:BN,params:{useForm:!0}},agTextColumnFloatingFilter:zN},dynamicBeans:{agTextColumnFilterHandler:WN}},JN={moduleName:"NumberFilter",version:we,dependsOn:[Pu],userComponents:{agNumberColumnFilter:{classImp:IN,params:{useForm:!0}},agNumberColumnFloatingFilter:NN},dynamicBeans:{agNumberColumnFilterHandler:_N}},ZN={moduleName:"DateFilter",version:we,dependsOn:[Pu],userComponents:{agDateColumnFilter:{classImp:bN,params:{useForm:!0}},agDateInput:AN,agDateColumnFloatingFilter:PN},dynamicBeans:{agDateColumnFilterHandler:TN}},QN={moduleName:"QuickFilterCore",version:we,rowModels:["clientSide"],beans:[KN],dependsOn:[cg,Wx]},e3={moduleName:"QuickFilter",version:we,apiFunctions:{isQuickFilterPresent:UN,getQuickFilter:jN,resetQuickFilter:$N},dependsOn:[QN]},t3={moduleName:"ExternalFilter",version:we,dependsOn:[cg]},r3=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip),&:where(.ag-cell-formula-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",Id=(e,t,r)=>{var a,l,c;const{editModelSvc:s}=e,i=(l=(a=s==null?void 0:s.getCellValidationModel())==null?void 0:a.getCellValidation(t))==null?void 0:l.errorMessages,n=(c=s==null?void 0:s.getRowValidationModel().getRowValidation(t))==null?void 0:c.errorMessages,o=i||n;return o!=null&&o.length?o.join(r("tooltipValidationErrorSeparator",". ")):void 0},s3=class extends ee{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,r,s){e&&t.destroyBean(e);const i=this.gos,n=Ad(i),{column:o,eGui:a}=t,l=o.getColDef();!s&&n&&!l.headerComponent&&(s=jl(()=>a.querySelector(".ag-header-cell-text")));const c="header",d=this.beans.colNames.getDisplayNameForColumn(o,"header",!0),h=r??d,f={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>{var g;return r??((g=l==null?void 0:l.headerTooltipValueGetter)==null?void 0:g.call(l,ke(i,{location:c,colDef:l,column:o,value:h,valueFormatted:d})))??(l==null?void 0:l.headerTooltip)},shouldDisplayTooltip:s,getAdditionalParams:()=>({column:o,colDef:o.getColDef()})};let p=this.createTooltipFeature(f);return p&&(p=t.createBean(p),t.setRefreshFunction("tooltip",()=>p.refreshTooltip())),p}setupHeaderGroupTooltip(e,t,r,s){e&&t.destroyBean(e);const i=this.gos,n=Ad(i),{column:o,eGui:a}=t,l=o.getColGroupDef();!s&&n&&!(l!=null&&l.headerGroupComponent)&&(s=jl(()=>a.querySelector(".ag-header-group-text")));const c="headerGroup",d=this.beans.colNames.getDisplayNameForColumnGroup(o,"header"),h=r??d,f={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>{var g;return r??((g=l==null?void 0:l.headerTooltipValueGetter)==null?void 0:g.call(l,ke(i,{location:c,colDef:l,column:o,value:h,valueFormatted:d})))??(l==null?void 0:l.headerTooltip)},shouldDisplayTooltip:s,getAdditionalParams:()=>{const g={column:o};return l&&(g.colDef=l),g}},p=this.createTooltipFeature(f);return p&&t.createBean(p)}enableCellTooltipFeature(e,t,r){const{beans:s}=this,{gos:i,editSvc:n}=s,{column:o,rowNode:a}=e;let l="cell";const c=()=>{const f=!!!(n!=null&&n.isEditing(e))&&Id(s,e,this.getLocaleTextFunc());if(f)return l="cellEditor",f;l="cell";const p=o.getColDef(),g=a.data;if(p.tooltipField&&Ce(g))return ta(g,p.tooltipField,o.isTooltipFieldContainsDots());const m=p.tooltipValueGetter;return m?m(ke(i,{location:"cell",colDef:o.getColDef(),column:o,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},u=Ad(i);r||(u&&!e.isCellRenderer()?r=()=>{const h=!!(n!=null&&n.isEditing(e));if(!h&&Id(s,e,this.getLocaleTextFunc()))return!0;if(!o.isTooltipEnabled())return!1;const g=jl(()=>{const m=e.eGui;return m.children.length===0?m:m.querySelector(".ag-cell-value")});return!h&&g()}:r=()=>!(n!=null&&n.isEditing(e)));const d={getGui:()=>e.eGui,getLocation:()=>l,getTooltipValue:t!=null?()=>t:c,shouldDisplayTooltip:r,getAdditionalParams:()=>({column:o,colDef:o.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(d,s)}setupFullWidthRowTooltip(e,t,r,s){const i={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>r,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:s},n=this.beans,o=n.context;e&&t.destroyBean(e,o);const a=this.createTooltipFeature(i,n);if(a)return t.createBean(a,o)}setupFormulaTooltip(e){var o;const{beans:t}=this,{context:r,formula:s}=t;if(!((o=this.beans.formula)!=null&&o.active)||!e.column.isAllowFormula())return;const i={getGui:()=>e.eGui,getTooltipValue:()=>{const a=s==null?void 0:s.getFormulaError(e.column,e.rowNode);return a?a.message:void 0},getLocation:()=>"cellFormula",shouldDisplayTooltip:()=>!!(s==null?void 0:s.getFormulaError(e.column,e.rowNode))},n=this.createTooltipFeature(i,t);if(n)return e.createBean(n,r)}setupCellEditorTooltip(e,t){var a,l;const{beans:r}=this,{context:s}=r,i=((a=t.getValidationElement)==null?void 0:a.call(t,!0))||!((l=t.isPopup)!=null&&l.call(t))&&e.eGui;if(!i)return;const n={getGui:()=>i,getTooltipValue:()=>Id(r,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{var p,g;const{editModelSvc:c}=r,u=(p=c==null?void 0:c.getRowValidationModel())==null?void 0:p.getRowValidationMap(),d=(g=c==null?void 0:c.getCellValidationModel())==null?void 0:g.getCellValidationMap(),h=!!u&&u.size>0,f=!!d&&d.size>0;return h||f}},o=this.createTooltipFeature(n,r);if(o)return e.createBean(o,s)}initCol(e){const{colDef:t}=e;e.tooltipEnabled=Ce(t.tooltipField)||Ce(t.tooltipValueGetter)||Ce(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},i3=class extends $P{createTooltipComp(e,t){const r=kk(this.beans.userCompFactory,e);r==null||r.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){var e;(e=this.onColumnMovedEventCallback)==null||e.call(this),this.onColumnMovedEventCallback=void 0}},zx={moduleName:"Tooltip",version:we,beans:[s3],dynamicBeans:{tooltipFeature:Pw,highlightTooltipFeature:KP,tooltipStateManager:i3},userComponents:{agTooltipComponent:YP},dependsOn:[ku],css:[r3]},Ln=class{constructor(e){this.cellValueChanges=e}},Md=class extends Ln{constructor(e,t,r,s){super(e),this.initialRange=t,this.finalRange=r,this.ranges=s}},n3=10,K0=class{constructor(e){this.actionStack=[],this.maxStackSize=e||n3,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},o3=class extends ee{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},r=this.activeCellEdit!==null&&$f(this.activeCellEdit,t),s=this.activeRowEdit!==null&&iA(this.activeRowEdit,t);if(!(r||s||this.isPasting||this.isRangeInAction))return;const{rowPinned:n,rowIndex:o,column:a,oldValue:l,value:c}=e,u={rowPinned:n,rowIndex:o,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(u)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){const{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;const r=e.get("undoRedoCellEditingLimit");if(r<=0)return;this.undoStack=new K0(r),this.redoStack=new K0(r),this.addListeners();const s=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:i=>{i.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:s,newColumnsLoaded:s,columnGroupOpened:s,columnRowGroupChanged:s,columnMoved:s,columnPinned:s,columnVisible:s,rowDragEnd:s}),t.whenReady(this,i=>{this.gridBodyCtrl=i.gridBodyCtrl})}getCurrentUndoStackSize(){var e;return((e=this.undoStack)==null?void 0:e.getCurrentStackSize())??0}getCurrentRedoStackSize(){var e;return((e=this.redoStack)==null?void 0:e.getCurrentStackSize())??0}undo(e){const{eventSvc:t,undoStack:r,redoStack:s}=this;t.dispatchEvent({type:"undoStarted",source:e});const i=this.undoRedo(r,s,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:i})}redo(e){const{eventSvc:t,undoStack:r,redoStack:s}=this;t.dispatchEvent({type:"redoStarted",source:e});const i=this.undoRedo(s,r,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:i})}undoRedo(e,t,r,s,i){if(!e)return!1;const n=e.pop();return n!=null&&n.cellValueChanges?(this.processAction(n,o=>o[s],i),n instanceof Md?this.processRange(n.ranges||[n[r]]):this.processCell(n.cellValueChanges),t.push(n),!0):!1}processAction(e,t,r){for(const s of e.cellValueChanges){const{rowIndex:i,rowPinned:n,columnId:o}=s,a={rowIndex:i,rowPinned:n},l=Ys(this.beans,a);l.displayed&&l.setDataValue(o,t(s),r)}}processRange(e){let t;const r=this.beans.rangeSvc;r.removeAllCellRanges(!0),e.forEach((s,i)=>{if(!s)return;const n=s.startRow,o=s.endRow;i===e.length-1&&(t={rowPinned:n.rowPinned,rowIndex:n.rowIndex,columnId:s.startColumn.getColId()},this.setLastFocusedCell(t));const a={rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:s.startColumn,columns:s.columns};r.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:r,rowPinned:s}=t,i={rowIndex:r,rowPinned:s},n=Ys(this.beans,i),o={rowPinned:t.rowPinned,rowIndex:n.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o)}setLastFocusedCell(e){const{rowIndex:t,columnId:r,rowPinned:s}=e,{colModel:i,focusSvc:n,rangeSvc:o}=this.beans,a=i.getCol(r);if(!a)return;const{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);const c={rowIndex:t,column:a,rowPinned:s};n.setFocusedCell({...c,forceBrowserFocus:!0}),o==null||o.setRangeToCell(c)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new Ln(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const r=new Ln(this.cellValueChanges);this.pushActionsToUndoStack(r)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new Ln(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new Md(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;const{rangeSvc:t,gos:r}=this.beans;t&&wi(r)?e=new Md(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new Ln(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),(t==null?void 0:t.length)===0))return;const r=new Ln(t??[]);this.pushActionsToUndoStack(r),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},a3=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",l3={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},c3=class extends Ru{constructor(){super(l3,[_f]),this.eEditor=be}initialiseEditor(e){const t=e.value??void 0,r=this.eEditor;r.setValue(t),r.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(r,{fieldValueChanged:i=>this.setAriaLabel(i.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.getLocaleTextFunc(),r=vu(t,e),s=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${s} (${r})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{getValidationErrors:t}=e,r=this.getValue();return t?t({value:r,internalErrors:null,cellEditorParams:e}):null}},Du=class extends Ru{constructor(e){super(),this.cellEditorInput=e,this.eEditor=be}initialiseEditor(e){const{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());const{eEditor:r}=this,{cellStartedEdit:s,eventKey:i,suppressPreventDefault:n}=e;r.getInputElement().setAttribute("title",""),t.init(r,e);let o,a=!0;s?(this.focusAfterAttached=!0,i===K.BACKSPACE||i===K.DELETE?o="":i&&i.length===1?n?a=!1:o=i:(o=t.getStartValue(),i!==K.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,o=t.getStartValue()),a&&o!=null&&r.setStartValue(o),this.addGuiEventListener("keydown",l=>{const{key:c}=l;(c===K.PAGE_UP||c===K.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){var s,i;const e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;ki()||t.getFocusableElement().focus();const r=t.getInputElement();this.highlightAllOnFocus?r.select():(i=(s=this.cellEditorInput).setCaret)==null||i.call(s)}focusIn(){const{eEditor:e}=this,t=e.getFocusableElement(),r=e.getInputElement();t.focus(),r.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},u3={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},d3=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return u3}getAgComponents(){return[xw]}init(e,t){var o,a;this.eEditor=e,this.params=t;const{min:r,max:s,step:i,colDef:n}=t;r!=null&&e.setMin(r),s!=null&&e.setMax(s),i!=null&&e.setStep(i),this.includeTime=t.includeTime??((a=(o=this.getDataTypeService())==null?void 0:o.getDateIncludesTimeFlag)==null?void 0:a.call(o,n.cellDataType)),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const t=this.eEditor.getInputElement().valueAsDate,{params:r}=this,{min:s,max:i,getValidationErrors:n}=r;let o=[];const a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(s){const l=s instanceof Date?s:new Date(s);if(t<l){const c=l.toLocaleDateString();o.push(a("minDateValidation",`Date must be after ${c}`,[c]))}}if(i){const l=i instanceof Date?i:new Date(i);if(t>l){const c=l.toLocaleDateString();o.push(a("maxDateValidation",`Date must be before ${c}`,[c]))}}}return o.length||(o=null),n?n({value:t,cellEditorParams:r,internalErrors:o}):o}getValue(){const{eEditor:e,params:t}=this,r=e.getDate();return!Ce(r)&&!Ce(t.value)?t.value:r??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return kr(e,this.includeTime??!1)}},h3=class extends Du{constructor(){super(new d3(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},f3={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},g3=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return f3}getAgComponents(){return[xw]}init(e,t){var o,a;this.eEditor=e,this.params=t;const{min:r,max:s,step:i,colDef:n}=t;r!=null&&e.setMin(r),s!=null&&e.setMax(s),i!=null&&e.setStep(i),this.includeTime=t.includeTime??((a=(o=this.getDataTypeService())==null?void 0:o.getDateIncludesTimeFlag)==null?void 0:a.call(o,n.cellDataType)),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const{eEditor:e,params:t}=this,r=e.getInputElement().value,s=this.formatDate(this.parseDate(r??void 0)),{min:i,max:n,getValidationErrors:o}=t;let a=[];if(s){const l=new Date(s),c=this.getLocaleTextFunc();if(i){const u=new Date(i);if(l<u){const d=u.toLocaleDateString();a.push(c("minDateValidation",`Date must be after ${d}`,[d]))}}if(n){const u=new Date(n);if(l>u){const d=u.toLocaleDateString();a.push(c("maxDateValidation",`Date must be before ${d}`,[d]))}}}return a.length||(a=null),o?o({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){const{params:e,eEditor:t}=this,r=this.formatDate(t.getDate());return!Ce(r)&&!Ce(e.value)?e.value:e.parseValue(r??"")}getStartValue(){return kr(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):xr(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):kr(e??null,this.includeTime??!1)??void 0}},p3=class extends Du{constructor(){super(new g3(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},m3={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},v3=class extends Ru{constructor(){super(m3,[tP]),this.eEditor=be}initialiseEditor(e){const{eEditor:t}=this,{cellStartedEdit:r,eventKey:s,maxLength:i,cols:n,rows:o}=e;this.focusAfterAttached=r,t.getInputElement().setAttribute("title",""),t.setMaxLength(i||200).setCols(n||60).setRows(o||10);let a;r?(this.focusAfterAttached=!0,s===K.BACKSPACE||s===K.DELETE?a="":s&&s.length===1?a=s:(a=this.getStartValue(e),s!==K.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){const{value:t}=e;return(t==null?void 0:t.toString())??t}onKeyDown(e){const t=e.key;(t===K.LEFT||t===K.UP||t===K.RIGHT||t===K.DOWN||e.shiftKey&&t===K.ENTER)&&e.stopPropagation()}afterGuiAttached(){const{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:r}=this,s=this.getLocaleTextFunc();e.setInputAriaLabel(s("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),r&&e.getInputElement().select())}getValue(){const{eEditor:e,params:t}=this,{value:r}=t,s=e.getValue();return!Ce(s)&&!Ce(r)?r:t.parseValue(s)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:r}=e,s=this.getLocaleTextFunc(),i=this.getValue();let n=[];return typeof i=="string"&&t!=null&&i.length>t&&n.push(s("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),n.length||(n=null),r?r({value:i,internalErrors:n,cellEditorParams:e}):n}},C3={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},w3=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return C3}getAgComponents(){return[rP]}init(e,t){this.eEditor=e,this.params=t;const{max:r,min:s,precision:i,step:n}=t;r!=null&&e.setMax(r),s!=null&&e.setMin(s),i!=null&&e.setPrecision(i),n!=null&&e.setStep(n);const o=e.getInputElement();t.preventStepping?e.addManagedElementListeners(o,{keydown:this.preventStepping}):t.showStepperButtons&&o.classList.add("ag-number-field-input-stepper")}getValidationErrors(){const{params:e}=this,{min:t,max:r,getValidationErrors:s}=e,n=this.eEditor.getInputElement().valueAsNumber,o=this.getLocaleTextFunc();let a=[];return typeof n=="number"&&(t!=null&&n<t&&a.push(o("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),r!=null&&n>r&&a.push(o("maxValueValidation",`Must be less than or equal to ${r}.`,[String(r)]))),a.length||(a=null),s?s({value:n,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===K.UP||e.key===K.DOWN)&&e.preventDefault()}getValue(){const{eEditor:e,params:t}=this,r=e.getValue();if(!Ce(r)&&!Ce(t.value))return t.value;let s=t.parseValue(r);if(s==null)return s;if(typeof s=="string"){if(s==="")return null;s=Number(s)}return isNaN(s)?null:s}getStartValue(){return this.params.value}setCaret(){ki()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},x3=class extends Du{constructor(){super(new w3(()=>this.getLocaleTextFunc()))}},y3={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},S3=class extends Ru{constructor(){super(y3,[fP]),this.eEditor=be,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;const{eEditor:t,valueSvc:r,gos:s}=this,{values:i,value:n,eventKey:o}=e;if(ct(i)){oe(58);return}this.startedByEnter=o!=null?o===K.ENTER:!1;let a=!1;i.forEach(d=>{const h={value:d},f=r.formatValue(e.column,null,d),p=f!=null;h.text=p?f:d,t.addOption(h),a=a||n===d}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:u}=e;l!=null&&t.setPickerGap(l),u!=null&&t.setPickerMaxHeight(u),c!=null&&t.setPickerMaxWidth(c),s.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){const{params:e}=this,{values:t,getValidationErrors:r}=e,s=this.getValue();let i=[];if(t&&!t.includes(s)){const n=this.getLocaleTextFunc();i.push(n("invalidSelectionValidation","Invalid selection."))}else i=null;return r?r({value:s,internalErrors:i,cellEditorParams:e}):i}},b3={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},F3=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return b3}getAgComponents(){return[yu]}init(e,t){this.eEditor=e,this.params=t;const r=t.maxLength;r!=null&&e.setMaxLength(r)}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:r}=e,s=this.getValue(),i=this.getLocaleTextFunc();let n=[];return t!=null&&typeof s=="string"&&s.length>t&&n.push(i("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),n.length||(n=null),r?r({value:s,cellEditorParams:e,internalErrors:n}):n}getValue(){const{eEditor:e,params:t}=this,r=e.getValue();return!Ce(r)&&!Ce(t.value)?t.value:t.parseValue(r)}getStartValue(){const e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){ki()&&this.eEditor.getInputElement().focus({preventScroll:!0});const e=this.eEditor,t=e.getValue(),r=Ce(t)&&t.length||0;r&&e.getInputElement().setSelectionRange(r,r)}},q0=class extends Du{constructor(){super(new F3(()=>this.getLocaleTextFunc()))}};function R3(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function E3(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function Ux(e,t,r="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,r),"ensureVisible")}function jx(e,t,r){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,r),"ensureVisible")}function T3(e,t,r=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,r),"ensureVisible")}function k3(e){var t;(t=e.undoRedo)==null||t.undo("api")}function P3(e){var t;(t=e.undoRedo)==null||t.redo("api")}function D3(e,t){var r;return(r=e.editModelSvc)==null?void 0:r.getEditRowDataValue(t,{checkSiblings:!0})}function A3(e){var s;const t=(s=e.editModelSvc)==null?void 0:s.getEditMap(),r=[];return t==null||t.forEach((i,n)=>{const{rowIndex:o,rowPinned:a}=n;i.forEach((l,c)=>{const{editorValue:u,pendingValue:d,sourceValue:h,state:f}=l,p=Ss(l);let g=u??d;g===$r&&(g=void 0);const m={newValue:g,oldValue:h,state:f,column:c,colId:c.getColId(),colKey:c.getColId(),rowIndex:o,rowPinned:a};(f==="editing"||f==="changed"&&p)&&r.push(m)})}),r}function I3(e,t=!1){var s;const{editSvc:r}=e;if(r!=null&&r.isBatchEditing()){if(t)for(const i of((s=e.editModelSvc)==null?void 0:s.getEditPositions())??[])i.state==="editing"&&r.revertSingleCellEdit(i);else di(e,{persist:!0});to(e,void 0,{cancel:t})}else r==null||r.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function M3(e,t){var s;const r=ft(e,t);return((s=e.editSvc)==null?void 0:s.isEditing(r))??!1}function _3(e,t){const{key:r,colKey:s,rowIndex:i,rowPinned:n}=t,{editSvc:o,colModel:a}=e,l=a.getCol(s);if(!l){oe(12,{colKey:s});return}const u=Ys(e,{rowIndex:i,rowPinned:n||null});if(!u){oe(290,{rowIndex:i,rowPinned:n});return}if(!(o!=null&&o.isCellEditable({rowNode:u,column:l},"api")))return;n==null&&jx(e,i),Ux(e,s),o==null||o.startEditing({rowNode:u,column:l},{event:r?new KeyboardEvent("keydown",{key:r}):void 0,source:"api"})}function L3(e){var t;return((t=e.editSvc)==null?void 0:t.validateEdit())||null}function O3(e){var t;return((t=e.undoRedo)==null?void 0:t.getCurrentUndoStackSize())??0}function N3(e){var t;return((t=e.undoRedo)==null?void 0:t.getCurrentRedoStackSize())??0}var B3={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},H3=class extends Af{constructor(e){super(B3),this.params=e}postConstruct(){an(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params,r=s=>{Eh(this.gos,s,t.node,t.column,!0)||t.onKeyDown(s)};this.addManagedElementListeners(e,{keydown:r})}};function V3(e,{column:t},r,s,i="ui"){var c;if(r instanceof KeyboardEvent&&(r.key===K.TAB||r.key===K.ENTER||r.key===K.F2||r.key===K.BACKSPACE&&s))return!0;if((r==null?void 0:r.shiftKey)&&((c=e.rangeSvc)==null?void 0:c.getCellRanges().length)!=0)return!1;const o=t==null?void 0:t.getColDef(),a=G3(e.gos,o),l=r==null?void 0:r.type;return l==="click"&&(r==null?void 0:r.detail)===1&&a===1||l==="dblclick"&&(r==null?void 0:r.detail)===2&&a===2?!0:i==="api"?s??!1:!1}function G3(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t!=null&&t.singleClickEdit?1:2}function Bh(e,{rowNode:t,column:r},s="ui"){const i=r.getColDef().editable,n=e.editModelSvc;return r.isColumnFunc(t,i)||!!n&&n.hasEdits({rowNode:t,column:r},{withOpenEditor:!0})}function W3(e,t,r="ui"){const s=Bh(e,t,r);return s===!0||r==="ui"?s:e.colModel.getCols().some(n=>Bh(e,{rowNode:t.rowNode,column:n},r))}var jc=(e,t=!1)=>{if(e!==void 0)return Ss(e)||t&&e.state==="editing"};function $x(e,t,r=!1){var s;return jc((s=e.editModelSvc)==null?void 0:s.getEdit(t),r)}var Kx=(e,t,r)=>{if(e)for(let s=0,i=e.length;s<i;++s){const n=e[s];if(n.data&&(jc(t==null?void 0:t.getEdit({rowNode:n,column:r}))||jc(t==null?void 0:t.getEdit({rowNode:n.pinnedSibling,column:r})))||Kx(n.childrenAfterGroup,t,r))return!0}};function qx(e,t){const{column:r,rowNode:s}=t;return e.gos.get("groupTotalRow")&&!(s!=null&&s.footer)?!1:Kx(s==null?void 0:s.childrenAfterGroup,e.editModelSvc,r)}function Xx(e,{rowNode:t,column:r}){var s;if(t=t.pinnedSibling,!!t)return jc((s=e.editModelSvc)==null?void 0:s.getEdit({rowNode:t,column:r}))}var z3=class extends ee{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){var i;const{cellCtrl:e,editSvc:t,beans:r}=this;if(t!=null&&t.isBatchEditing()&&t.isEditing()){const n=$x(r,e)||qx(r,e)||Xx(r,e);this.applyBatchingStyle(n)}else this.applyBatchingStyle(!1);const s=!!((i=this.editModelSvc)!=null&&i.getCellValidationModel().hasCellValidation(this.cellCtrl));this.cellComp.toggleCss("ag-cell-editing-error",s)}applyBatchingStyle(e){var t;this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&((t=this.editSvc)==null?void 0:t.isBatchEditing()))??!1)}},U3=class extends ee{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){var o;const{rowCtrl:e,editModelSvc:t,beans:r}=this;let s=e.rowNode,i=t==null?void 0:t.getEditRow(s);const n=(o=this.editModelSvc)==null?void 0:o.getRowValidationModel().hasRowValidation({rowNode:s});if(!i&&s.pinnedSibling&&(s=s.pinnedSibling,i=t==null?void 0:t.getEditRow(s)),i){const a=Array.from(i.keys()).some(l=>{const c={rowNode:s,column:l};return $x(r,c,!0)||qx(r,c)||Xx(r,c)});this.applyStyle(n,a);return}this.applyStyle(n)}applyStyle(e=!1,t=!1){var i,n;const r=((i=this.editSvc)==null?void 0:i.isBatchEditing())??!1,s=this.gos.get("editType")==="fullRow";(n=this.rowCtrl)==null||n.forEachGui(void 0,({rowComp:o})=>{o.toggleCss("ag-row-editing",s&&t),o.toggleCss("ag-row-batch-edit",s&&t&&r),o.toggleCss("ag-row-inline-editing",t),o.toggleCss("ag-row-not-inline-editing",!t),o.toggleCss("ag-row-editing-invalid",s&&t&&e)})}},j3=({rowModel:e,pinnedRowModel:t,editModelSvc:r},s)=>{const i=new Set;e.forEachNode(n=>s.has(n)&&i.add(n)),t==null||t.forEachPinnedRow("top",n=>s.has(n)&&i.add(n)),t==null||t.forEachPinnedRow("bottom",n=>s.has(n)&&i.add(n));for(const n of s)i.has(n)||r.removeEdits({rowNode:n});return i},$3=({editModelSvc:e},t,r)=>{var s;for(const i of t)(s=e==null?void 0:e.getEditRow(i))==null||s.forEach((n,o)=>!r.has(o)&&e.removeEdits({rowNode:i,column:o}))},K3=e=>()=>{const t=new Set(e.colModel.getCols()),r=e.editModelSvc.getEditMap(!0),s=new Set(r.keys());$3(e,j3(e,s),t)},q3=new Set(["undo","redo","paste","bulk","rangeSvc"]),X3=new Set(["ui","api"]),Yx={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},Y3=new Set(Object.keys(Yx)),J3=new Set(["paste","rangeSvc","cellClear","redo","undo"]),Tl={cancel:!0,source:"api"},Z3={cancel:!1,source:"api"},No={checkSiblings:!0},Bo={force:!0,suppressFlash:!0},Q3=class extends ee{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){const{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:s})=>{this.stopEditing(void 0,Tl),this.createStrategy(s)});const t=K3(e),r=()=>{const s=this.model.getCellValidationModel().getCellValidationMap().size>0,i=this.model.getRowValidationModel().getRowValidationMap().size>0;return s||i?this.stopEditing(void 0,Tl):this.isEditing()&&(this.batch?to(e,this.model.getEditPositions()):this.stopEditing(void 0,Z3)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:r,filterChanged:r,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,Tl)):(this.stopEditing(void 0,Tl),this.batch=!1)}createStrategy(e){const{beans:t,gos:r,strategy:s}=this,i=X0(r,e);if(s){if(s.beanName===i)return s;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(i,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,r,s="ui"){const i=V3(this.beans,e,t,r,s);return i&&(this.strategy??(this.strategy=this.createStrategy())),i}shouldStopEditing(e,t,r="ui"){var s;return((s=this.strategy)==null?void 0:s.shouldStop(e,t,r))??null}shouldCancelEditing(e,t,r="ui"){var s;return((s=this.strategy)==null?void 0:s.shouldCancel(e,t,r))??null}validateEdit(){return sO(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??No)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){const{startedEdit:r=!0,event:s=null,source:i="ui",ignoreEventKey:n=!1,silent:o}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;const a=ft(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}const l=this.shouldStartEditing(e,s,r,i);if(l===!1&&i!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,i)&&!t.continueEditing&&this.stopEditing(void 0,{source:i}),l&&this.batch&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:s,source:i,ignoreEventKey:n,startedEdit:r,silent:o})}stopEditing(e,t){const r=this.prepareStopContext(e,t);if(!r)return!1;this.stopping=!0;let s=!1,{edits:i}=r;try{const n=this.processStopRequest(r);return s||(s=n.res),i=n.edits,this.finishStopEditing({...r,edits:i,params:t,position:e,res:s}),s}finally{this.stopping=!1}}prepareStopContext(e,t){const{event:r,cancel:s,source:i="ui",forceCancel:n,forceStop:o}=t||{};if(Y3.has(i)&&this.batch)return this.bulkRefresh(e),null;const a=this.committing?Yx[i]:i;if(!(this.committing||this.isEditing(e)||this.batch&&this.model.hasEdits(e,No))||!this.strategy||this.stopping)return null;const c=ft(this.beans,e);c&&(c.onEditorAttachedFuncs=[]);const u=!s&&(!!this.shouldStopEditing(e,r,a)||(this.committing||i==="paste")&&!this.batch)||(o??!1),d=s&&!!this.shouldCancelEditing(e,r,a)||(n??!1);return{cancel:s,cellCtrl:c??void 0,edits:this.model.getEditMap(!0),event:r,forceCancel:n,forceStop:o,position:e,source:i,treatAsSource:a,willCancel:d,willStop:u}}processStopRequest(e){var n;const{event:t,position:r,willCancel:s,willStop:i}=e;return i||s?this.handleStopOrCancel(e):this.shouldHandleMidBatchKey(t,r)?{res:!1,edits:this.handleMidBatchKey(t,r,e)}:(di(this.beans,{persist:!0}),this.batch&&((n=this.strategy)==null||n.cleanupEditors(r)),{res:!1,edits:this.model.getEditMap()})}handleStopOrCancel(e){var d;const{beans:t,model:r}=this,{cancel:s,edits:i,event:n,source:o,willCancel:a,willStop:l}=e;di(t,{persist:!0,isCancelling:a||s,isStopping:l});const c=r.getEditMap(),u=this.processEdits(c,s,o);(d=this.strategy)==null||d.stop(s,n),this.clearValidationIfNoOpenEditors();for(const h of u)r.clearEditValue(h);this.bulkRefresh(void 0,i);for(const h of r.getEditPositions(c)){const f=ft(t,h),p=Ss(h);f==null||f.refreshCell({force:!0,suppressFlash:!p})}return{res:l,edits:c}}shouldHandleMidBatchKey(e,t){var r;return e instanceof KeyboardEvent&&this.batch&&!!((r=this.strategy)!=null&&r.midBatchInputsAllowed(t))&&this.isEditing(t,{withOpenEditor:!0})}handleMidBatchKey(e,t,r){var d;const{beans:s,model:i}=this,{cellCtrl:n,edits:o}=r,{key:a}=e,l=a===K.ENTER,c=a===K.ESCAPE,u=a===K.TAB;return l||u||c?(l||u?di(s,{persist:!0}):c&&this.revertSingleCellEdit(n),this.batch?(d=this.strategy)==null||d.cleanupEditors():to(s,i.getEditPositions(),{event:e,cancel:c}),e.preventDefault(),this.bulkRefresh(t,o,{suppressFlash:!0}),i.getEditMap()):o}finishStopEditing({cellCtrl:e,edits:t,params:r,position:s,res:i,willCancel:n,willStop:o}){const a=this.beans;i&&s&&this.model.removeEdits(s),this.navigateAfterEdit(r,e==null?void 0:e.cellPosition),oc(a),this.clearValidationIfNoOpenEditors(),this.bulkRefresh();const{rowRenderer:l,formula:c}=a;n&&l.refreshRows({rowNodes:Array.from(t.keys())}),this.batch&&(c?c.refreshFormulas(!0):l.refreshRows({suppressFlash:!0,force:!0}),i&&o&&this.dispatchBatchEvent("batchEditingStopped",t))}clearValidationIfNoOpenEditors(){this.model.hasEdits(void 0,{withOpenEditor:!0})||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap())}navigateAfterEdit(e,t){var c;if(!e||!t)return;const{event:r,suppressNavigateAfterEdit:s}=e;if(!(r instanceof KeyboardEvent)||s)return;const{key:n,shiftKey:o}=r,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(n!==K.ENTER||!a)return;const l=o?K.UP:K.DOWN;(c=this.beans.navigation)==null||c.navigateToNextCell(null,l,t,!1)}processEdits(e,t=!1,r){const s=Array.from(e.keys()),i=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,n=[];for(const o of s){const a=e.get(o);for(const l of a.keys()){const c=a.get(l),u={rowNode:o,column:l},d=Ss(c);!t&&d&&!i&&(this.setNodeDataValue(o,l,c.pendingValue,void 0,r)||n.push(u))}}return n}setNodeDataValue(e,t,r,s,i="edit"){const{beans:n}=this,o=ft(n,{rowNode:e,column:t}),a=X3.has(i)?"edit":i;o&&(o.suppressRefreshCell=!0),this.committing=!0;const l=e.setDataValue(t,r,a);return this.committing=!1,o&&(o.suppressRefreshCell=!1),s&&(o==null||o.refreshCell(Bo)),l}setEditMap(e,t){var s;this.strategy??(this.strategy=this.createStrategy()),(s=this.strategy)==null||s.setEditMap(e,t),this.bulkRefresh();let r=Bo;t!=null&&t.forceRefreshOfEditCellsOnly&&(r={...eB(e),...Bo}),this.beans.rowRenderer.refreshCells(r)}dispatchEditValuesChanged({rowNode:e,column:t},r={}){if(!e||!t||!r)return;const{pendingValue:s,sourceValue:i}=r,{rowIndex:n,rowPinned:o,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:n,rowPinned:o,column:t,source:"api",data:a,newValue:s,oldValue:i,value:s,colDef:t.getColDef()})}bulkRefresh(e={},t,r={}){var a;const{beans:s,gos:i}=this,{editModelSvc:n,rowModel:o}=s;wt(i)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),r):t&&((a=n==null?void 0:n.getEditMap(!1))==null||a.forEach((l,c)=>{for(const u of l.keys())this.refCell({rowNode:c,column:u},l.get(u),r)})))}refCell({rowNode:e,column:t},r,s={}){var d,h,f;const{beans:i,gos:n}=this,o=new Set([e]),a=new Set,l=e.pinnedSibling;l&&o.add(l);const c=e.sibling;c&&a.add(c);let u=e.parent;for(;u;)(d=u.sibling)!=null&&d.footer&&n.get("groupTotalRow")||!u.parent&&u.sibling&&n.get("grandTotalRow")?a.add(u.sibling):a.add(u),u=u.parent;for(const p of o)this.dispatchEditValuesChanged({rowNode:p,column:t},r);for(const p of o)(h=ft(i,{rowNode:p,column:t}))==null||h.refreshCell(s);for(const p of a)(f=ft(i,{rowNode:p,column:t}))==null||f.refreshCell(s)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){const{rowNode:r}=e,{gos:s,beans:i}=this;if(r.group){if(s.get("treeData")){if(!r.data&&!s.get("enableGroupEdit"))return!1}else if(!s.get("enableGroupEdit"))return!1}const n=X0(s)==="fullRow"?W3(i,e,t):Bh(i,e,t);return n&&(this.strategy??(this.strategy=this.createStrategy())),n}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,r=!0){var s,i,n,o;if(this.hasValidationErrors(e)){const a=ft(this.beans,e);return this.cellEditingInvalidCommitBlocks()?((s=t==null?void 0:t.preventDefault)==null||s.call(t),r&&(!(a!=null&&a.hasBrowserFocus())&&(a==null||a.focusCell()),(o=(n=(i=a==null?void 0:a.comp)==null?void 0:i.getCellEditor())==null?void 0:n.focusIn)==null||o.call(n)),"block-stop"):(a&&this.revertSingleCellEdit(a),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){var s,i,n,o;const r=ft(this.beans,e);(s=r==null?void 0:r.comp)!=null&&s.getCellEditor()&&(to(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),go(this.beans,e,{silent:!0}),un(this.beans),r==null||r.refreshCell(Bo),t&&(r==null||r.focusCell(),(o=(n=(i=r==null?void 0:r.comp)==null?void 0:i.getCellEditor())==null?void 0:n.focusIn)==null||o.call(n)))}hasValidationErrors(e){var s;un(this.beans);const t=ft(this.beans,e);t&&(t.refreshCell(Bo),(s=t.rowCtrl.rowEditStyleFeature)==null||s.applyRowStyles());let r=!1;return e!=null&&e.rowNode?(r||(r=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(r||(r=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(r||(r=this.model.getCellValidationModel().getCellValidationMap().size>0),r||(r=this.model.getRowValidationModel().getRowValidationMap().size>0)),r}moveToNextCell(e,t,r,s="ui"){var a;let i;const n=this.isEditing(),o=n&&this.checkNavWithValidation(void 0,r)==="block-stop";return e instanceof ro&&n&&(i=(a=this.strategy)==null?void 0:a.moveToNextEditingCell(e,t,r,s,o)),i===null||(i=i||!!this.beans.focusSvc.focusedHeader,i===!1&&!o&&this.stopEditing()),i}getCellDataValue({rowNode:e,column:t},r=!0){if(!e||!t)return;let s=this.model.getEdit({rowNode:e,column:t});const i=e.pinnedSibling;if(i){const o=this.model.getEdit({rowNode:i,column:t});o&&(s=o)}const n=r?(s==null?void 0:s.editorValue)??(s==null?void 0:s.pendingValue):s==null?void 0:s.pendingValue;return n===$r||!s?(s==null?void 0:s.sourceValue)??this.valueSvc.getValue(t,e,!1,"api"):n}addStopEditingWhenGridLosesFocus(e){JL(this,this.beans,e)}createPopupEditorWrapper(e){return new H3(e)}setDataValue(e,t,r){var s;try{if((!this.isEditing()||this.committing)&&!J3.has(r))return;const{beans:i}=this;this.strategy??(this.strategy=this.createStrategy());const n=this.batch?"ui":this.committing?r??"api":"api";if(!r||q3.has(r))return ac(i,e,t,r,void 0,{persist:!0}),this.batch?(this.cleanupEditors(),oc(i),this.bulkRefresh(),!0):this.setNodeDataValue(e.rowNode,e.column,t,!0,r);const o=this.model.getEdit(e);if(o){if(o.pendingValue===t)return!1;if(o.sourceValue!==t)return ac(i,e,t,r,void 0,{persist:!0}),this.stopEditing(e,{source:n,suppressNavigateAfterEdit:!0}),!0;if(o.sourceValue===t)return(s=i.editModelSvc)==null||s.removeEdits(e),this.dispatchEditValuesChanged(e,{...o,pendingValue:t}),!0}return ac(i,e,t,r,void 0,{persist:!0}),this.stopEditing(e,{source:n,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){eO(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){const{model:r}=this;if(!this.batch||!r.hasRowEdits(e.rowNode,No))return;const{rowNode:i}=e,{compDetails:n,valueToDisplay:o}=t;if(n){const{params:a}=n;return a.data=r.getEditRowDataValue(i,No),{compDetails:n}}return{valueToDisplay:o}}cleanupEditors(){var e;(e=this.strategy)==null||e.cleanupEditors()}dispatchCellEvent(e,t,r,s){var i;(i=this.strategy)==null||i.dispatchCellEvent(e,t,r,s)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return ke(this.gos,{type:e,...e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}})}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},r){var d,h;if(!r||r.length===0)return;const{beans:s,rangeSvc:i,valueSvc:n}=this,{formula:o}=s;di(s,{persist:!0});const a=this.model.getEditMap(!0);let l=(h=(d=a.get(e))==null?void 0:d.get(t))==null?void 0:h.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"});const c=(o==null?void 0:o.isFormula(l))??!1;r.forEach(f=>{const p=f.columns.some(g=>g==null?void 0:g.isAllowFormula());if(i==null||i.forEachRowInRange(f,g=>{const m=Ys(s,g);if(m===void 0)return;const v=a.get(m)??new Map;let w=l;for(const C of f.columns){if(!C)continue;const y=!!c&&C.isAllowFormula();if(this.isCellEditable({rowNode:m,column:C},"api")){const b=n.getValue(C,m,!0,"api");let F=n.parseValue(C,m??null,w,b);Number.isNaN(F)&&(F=null),v.set(C,{editorValue:void 0,pendingValue:F,sourceValue:b,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}y&&(w=o==null?void 0:o.updateFormulaByOffset({value:w,columnDelta:1}))}v.size>0&&a.set(m,v),c&&p&&(l=o==null?void 0:o.updateFormulaByOffset({value:l,rowDelta:1}))}),this.setEditMap(a),this.batch){this.cleanupEditors(),oc(s),this.bulkRefresh();return}this.committing=!0,this.stopEditing(void 0,{source:"bulk"}),this.committing=!1,this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(a)})}),this.bulkRefresh();const u=ft(s,{rowNode:e,column:t});u&&u.focusCell(!0)}createCellStyleFeature(e){return new z3(e,this.beans)}createRowStyleFeature(e){return new U3(e,this.beans)}setEditingCells(e,t){const{beans:r}=this,{colModel:s,valueSvc:i}=r,n=new Map;for(let{colId:o,column:a,colKey:l,rowIndex:c,rowPinned:u,newValue:d,state:h}of e){const f=o?s.getCol(o):l?s.getCol(l):a;if(!f)continue;const p=Ys(r,{rowIndex:c,rowPinned:u});if(!p)continue;const g=i.getValue(f,p,!0,"api");if(!(t!=null&&t.forceRefreshOfEditCellsOnly)&&!Ss({pendingValue:d,sourceValue:g})&&h!=="editing")continue;let m=n.get(p);m||(m=new Map,n.set(p,m)),d===void 0&&(d=$r),m.set(f,{editorValue:void 0,pendingValue:d,sourceValue:g,state:h??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(n,t)}onCellFocused(e){var n;const t=ft(this.beans,e);if(!t||!this.isEditing(t,No))return;const r=this.model.getEdit(t);if(!r||!Ss(r))return;const i=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");(n=this.beans.ariaAnnounce)==null||n.announceValue(i,"pendingChange")}allowedFocusTargetOnValidation(e){return ft(this.beans,e)}};function eB(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function X0(e,t){return t??e.get("editType")??"singleCell"}var Jx=class extends ee{postConstruct(){var e,t;this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:(e=this.onCellFocusChanged)==null?void 0:e.bind(this),cellFocusCleared:(t=this.onCellFocusChanged)==null?void 0:t.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t;const r=e.previousParams,{editSvc:s,beans:i}=this,n=e.type==="cellFocused"?e.sourceEvent:null;r&&(t=ft(i,r));const{gos:o,editModelSvc:a}=i,l=e.type==="cellFocusCleared";if(s.isEditing(void 0,{withOpenEditor:!0})){const{column:c,rowIndex:u,rowPinned:d}=e,h={column:c,rowNode:Ys(i,{rowIndex:u,rowPinned:d})},f=o.get("invalidEditValueMode")==="block";if(f)return;const p=!f,g=!!(a!=null&&a.getCellValidationModel().hasCellValidation(h)),m=p&&g;(r||l?s.stopEditing(void 0,{cancel:m,source:l&&p?"api":void 0,event:n}):!0)||(s.isBatchEditing()?s.cleanupEditors():s.stopEditing(void 0,{source:"api"}))}t==null||t.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){var i,n;const r=this.model.getEditPositions(),s={all:[],pass:[],fail:[]};for(const o of r){s.all.push(o);const a=this.model.getCellValidationModel().getCellValidation(o);if((((i=a==null?void 0:a.errorMessages)==null?void 0:i.length)??0)>0){s.fail.push(o);continue}s.pass.push(o)}if(e)for(const o of r)Vc(this.beans,o,{cancel:e}),this.model.stop(o);else{const o=this.processValidationResults(s);if(o.destroy.length>0)for(const a of o.destroy)Vc(this.beans,a,{event:t,cancel:e}),this.model.stop(a);if(o.keep.length>0)for(const a of o.keep){const l=ft(this.beans,a);(n=this.editSvc)!=null&&n.cellEditingInvalidCommitBlocks()||l&&this.editSvc.revertSingleCellEdit(l)}}return!0}cleanupEditors({rowNode:e}={},t){di(this.beans,{persist:!1});const r=this.model.getEditPositions(),s=[];if(e)for(const i of r)i.rowNode!==e&&s.push(i);else for(const i of r)s.push(i);to(this.beans,s),oc(this.beans,t)}setFocusOutOnEditor(e){var t,r,s;(s=(r=(t=e.comp)==null?void 0:t.getCellEditor())==null?void 0:r.focusOut)==null||s.call(r)}setFocusInOnEditor(e){const t=e.comp,r=t==null?void 0:t.getCellEditor();if(r!=null&&r.focusIn)r.focusIn();else{const s=this.beans.gos.get("editType")==="fullRow";e.focusCell(s),e.onEditorAttachedFuncs.push(()=>{var i,n;return(n=(i=t==null?void 0:t.getCellEditor())==null?void 0:i.focusIn)==null?void 0:n.call(i)})}}setupEditors(e){const{event:t,ignoreEventKey:r=!1,startedEdit:s,position:i,cells:n=this.model.getEditPositions()}=e,o=t instanceof KeyboardEvent&&!r&&t.key||void 0;QL(this.beans,n,i,o,t,s)}dispatchCellEvent(e,t,r,s){const i=ft(this.beans,e);i&&this.eventSvc.dispatchEvent({...i.createEvent(t??null,r),...s})}dispatchRowEvent(e,t,r){if(r)return;const s=Zf(this.beans,e);s&&this.eventSvc.dispatchEvent(s.createRowEvent(t))}shouldStop(e,t,r="ui"){const s=this.editSvc.isBatchEditing();return s&&r==="api"?!0:s&&(r==="ui"||r==="edit")?!1:r==="api"?!0:t instanceof KeyboardEvent&&!s?t.key===K.ENTER:null}shouldCancel(e,t,r="ui"){const s=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!s&&t.key===K.ESCAPE||s&&r==="api"||r==="api")}setEditMap(e,t){var s;t!=null&&t.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});const r=[];if(e.forEach((i,n)=>{i.forEach((o,a)=>{o.state==="editing"&&r.push({...o,rowNode:n,column:a})})}),t!=null&&t.update&&(e=new Map([...this.model.getEditMap(),...e])),(s=this.model)==null||s.setEditMap(e),r.length>0){const i=r.at(-1),n=i.pendingValue===$r?void 0:i.pendingValue;this.start({position:i,event:new KeyboardEvent("keydown",{key:n}),source:"api"});const o=ft(this.beans,i);o&&this.setFocusInOnEditor(o)}}destroy(){this.cleanupEditors(),super.destroy()}},tB=class extends Jx{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,r="ui"){const{rowNode:s}=e||{};if(!Zf(this.beans,{rowNode:this.rowNode}))return!0;const n=super.shouldStop({rowNode:this.rowNode},t,r);return n!==null?n:this.rowNode?s!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){const{position:t,silent:r,startedEdit:s,event:i,ignoreEventKey:n}=e,{rowNode:o}=t;this.rowNode!==o&&super.cleanupEditors(t);const a=this.beans.visibleCols.allCols,l=[],c=[];for(const u of a)u.isCellEditable(o)&&c.push(u);if(c.length!=0){this.dispatchRowEvent({rowNode:o},"rowEditingStarted",r),this.startedRows.push(o);for(const u of c){const d={rowNode:o,column:u};l.push(d),this.model.hasEdits(d)||this.model.start(d)}this.rowNode=o,this.setupEditors({cells:l,position:t,startedEdit:s,event:i,ignoreEventKey:n})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){var i;const{rowNode:r}=this;if(r&&!this.model.hasRowEdits(r))return!1;const s=[];if(e||this.model.getEditMap().forEach((n,o)=>{if(!(!n||n.size===0)){for(const a of n.values())if(Ss(a)){s.push(o);break}}}),un(this.beans),!e&&((i=this.editSvc)==null?void 0:i.checkNavWithValidation({rowNode:r}))==="block-stop")return!1;super.stop(e,t);for(const n of s)this.dispatchRowEvent({rowNode:n},"rowValueChanged");return this.cleanupEditors({rowNode:r},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){const{rowIndex:t}=e,r=e.previousParams;if((r==null?void 0:r.rowIndex)===t||e.sourceEvent instanceof KeyboardEvent)return;const s=ft(this.beans,r);this.gos.get("invalidEditValueMode")==="block"&&s&&(this.model.getCellValidationModel().getCellValidation(s)||this.model.getRowValidationModel().getRowValidation(s))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(const r of this.startedRows)this.dispatchRowEvent({rowNode:r},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(e,t,r,s="ui",i=!1){var h,f,p,g;const n=e.cellPosition;let o;this.model.suspend(!0);try{o=(h=this.beans.navigation)==null?void 0:h.findNextCellToFocusOn(n,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(o===!1)return null;if(o==null)return!1;const a=o.cellPosition,l=e.isCellEditable(),c=o.isCellEditable(),u=a&&n.rowIndex===a.rowIndex&&n.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(e),this.restoreEditors();const d=this.gos.get("suppressStartEditOnTab");return c&&!i?d?o.focusCell(!0,r):((f=o.comp)!=null&&f.getCellEditor()||go(this.beans,o,{event:r,cellStartedEdit:!0}),this.setFocusInOnEditor(o),o.focusCell(!1,r)):(c&&i&&this.setFocusInOnEditor(o),o.focusCell(!0,r)),!u&&!i&&((p=this.editSvc)==null||p.stopEditing({rowNode:e.rowNode},{event:r}),this.cleanupEditors(o,!0),d?o.focusCell(!0,r):this.editSvc.startEditing(o,{startedEdit:!0,event:r,source:s,ignoreEventKey:!0})),(g=e.rowCtrl)==null||g.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:r},s)=>{var n;if(r!=="editing")return;const i=ft(this.beans,{rowNode:t,column:s});i&&!((n=i.comp)!=null&&n.getCellEditor())&&go(this.beans,i,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},rB=class extends Jx{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,r="ui"){const s=super.shouldStop(e,t,r);if(s!==null)return s;const{rowNode:i,column:n}=e||{};return(!this.rowNode||!this.column)&&i&&n?null:this.rowNode!==i||this.column!==n}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){const{position:t,startedEdit:r,event:s,ignoreEventKey:i}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:r,event:s,ignoreEventKey:i})}dispatchRowEvent(e,t,r){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){const{colModel:t,editSvc:r}=this.beans,{rowIndex:s,column:i,rowPinned:n}=e,o=Ys(this.beans,{rowIndex:s,rowPinned:n}),a=Ih(i),l=t.getCol(a),c=e.previousParams;if(c){const u=Ih(c.column);if((c==null?void 0:c.rowIndex)===s&&u===a&&(c==null?void 0:c.rowPinned)===n)return}r!=null&&r.isEditing({rowNode:o,column:l},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,r,s="ui",i=!1){var p,g,m,v,w,C;const n=this.beans.focusSvc.getFocusedCell();n&&(e=Vn(this.beans,n)??e);const o=e.cellPosition;let a;const l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),i||(e.eGui.focus(),(g=this.editSvc)==null||g.stopEditing(e,{source:(p=this.editSvc)!=null&&p.isBatchEditing()?"ui":"api",event:r}));try{a=(m=this.beans.navigation)==null?void 0:m.findNextCellToFocusOn(o,{backwards:t,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;const c=a.cellPosition,u=e.isCellEditable(),d=a.isCellEditable(),h=c&&o.rowIndex===c.rowIndex&&o.rowPinned===c.rowPinned;u&&!i&&this.setFocusOutOnEditor(e);const f=this.gos.get("suppressStartEditOnTab");if(!h&&!i&&(super.cleanupEditors(a,!0),f?a.focusCell(!0,r):this.editSvc.startEditing(a,{startedEdit:!0,event:r,source:s,ignoreEventKey:!0})),d&&!i){if(a.focusCell(!1,r),f)a.focusCell(!0,r);else if(!((v=a.comp)!=null&&v.getCellEditor())){const y=(w=this.editSvc)==null?void 0:w.isEditing(a,{withOpenEditor:!0});go(this.beans,a,{event:r,cellStartedEdit:!0,silent:y}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else d&&i&&this.setFocusInOnEditor(a),a.focusCell(!0,r);return(C=e.rowCtrl)==null||C.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},Di={moduleName:"EditCore",version:we,beans:[YL,Q3],apiFunctions:{getEditingCells:A3,getEditRowValues:D3,getCellEditorInstances:ZL,startEditingCell:_3,stopEditing:I3,isEditing:M3,validateEdit:L3},dynamicBeans:{singleCell:rB,fullRow:tB},dependsOn:[ku,zx],css:[a3]},sB={moduleName:"UndoRedoEdit",version:we,beans:[o3],apiFunctions:{undoCellEditing:k3,redoCellEditing:P3,getCurrentUndoSize:O3,getCurrentRedoSize:N3},dependsOn:[Di]},iB={moduleName:"TextEditor",version:we,userComponents:{agCellEditor:q0,agTextCellEditor:q0},dependsOn:[Di]},nB={moduleName:"NumberEditor",version:we,userComponents:{agNumberCellEditor:{classImp:x3}},dependsOn:[Di]},oB={moduleName:"DateEditor",version:we,userComponents:{agDateCellEditor:h3,agDateStringCellEditor:p3},dependsOn:[Di]},aB={moduleName:"CheckboxEditor",version:we,userComponents:{agCheckboxCellEditor:c3},dependsOn:[Di]},lB={moduleName:"SelectEditor",version:we,userComponents:{agSelectCellEditor:S3},dependsOn:[Di]},cB={moduleName:"LargeTextEditor",version:we,userComponents:{agLargeTextCellEditor:v3},dependsOn:[Di]},uB={moduleName:"CustomEditor",version:we,dependsOn:[Di]},dB=class extends ee{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,Yn(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){const t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),M2(e))}createColumns(e,t){var h,f;const r=()=>{var p;Dc(this.beans,(p=this.columns)==null?void 0:p.tree),this.columns=null},s=e.treeDepth,n=(((h=this.columns)==null?void 0:h.treeDepth)??-1)==s,o=this.generateSelectionCols();if(I2(o,((f=this.columns)==null?void 0:f.list)??[])&&n)return;r();const{colGroupSvc:l}=this.beans,c=(l==null?void 0:l.findDepth(e.tree))??0,u=(l==null?void 0:l.balanceTreeForAutoCols(o,c))??[];this.columns={list:o,tree:u,treeDepth:c,map:{}},t(p=>{if(!p)return null;const g=p.filter(m=>!Ti(m));return[...o,...g]})}updateColumns(e){var s;const t=Yn(e.source),{beans:r}=this;for(const i of((s=this.columns)==null?void 0:s.list)??[]){const n=this.createSelectionColDef(e.currentValue);i.setColDef(n,null,t),ts(r,{state:[L2(n,i.colId)]},t)}}getColumn(e){var t;return((t=this.columns)==null?void 0:t.list.find(r=>Qo(r,e)))??null}getColumns(){var e;return((e=this.columns)==null?void 0:e.list)??null}isSelectionColumnEnabled(){var o,a;const{gos:e,beans:t}=this,r=e.get("rowSelection");if(typeof r!="object"||!Ki(e))return!1;const s=(((a=(o=t.autoColSvc)==null?void 0:o.getColumns())==null?void 0:a.length)??0)>0;if(r.checkboxLocation==="autoGroupColumn"&&s)return!1;const i=!!Kn(r),n=Yl(r);return i||n}createSelectionColDef(e){const{gos:t}=this,r=e??t.get("selectionColumnDef"),s=t.get("enableRtl"),{rowSpan:i,spanRows:n,...o}=r??{};return{width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:s?"right":"left",comparator(a,l,c,u){const d=c.isSelected(),h=u.isSelected();return d===h?0:d?1:-1},editable:!1,suppressFillHandle:!0,suppressAutoSize:!0,pinned:null,...o,colId:$C,chartDataType:"excluded"}}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];const e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);const r=new xn(e,null,t,!1);return this.createBean(r),[r]}onSelectionOptionsChanged(e,t,r){const s=t&&typeof t!="string"?Kn(t):void 0,i=e&&typeof e!="string"?Kn(e):void 0,n=s!==i,o=t&&typeof t!="string"?Yl(t):void 0,a=e&&typeof e!="string"?Yl(e):void 0,l=o!==a,c=Ec(e),u=Ec(t);(n||l||c!==u)&&this.beans.colModel.refreshAll(r)}destroy(){var e;Dc(this.beans,(e=this.columns)==null?void 0:e.tree),super.destroy()}refreshVisibility(e,t,r){var l,c;if(!((l=this.columns)!=null&&l.list.length))return;const s=e.length+t.length+r.length;if(s===0)return;const i=this.columns.list[0];if(!i.isVisible())return;const n=()=>{let u;switch(i.pinned){case"left":case!0:u=e;break;case"right":u=r;break;default:u=t}u&&Es(u,i)};(((c=this.beans.rowNumbersSvc)==null?void 0:c.getColumn(KC))?2:1)===s&&n()}},hB=':where(.ag-selection-checkbox) .ag-checkbox-input-wrapper{&:before{content:"";cursor:pointer;inset:-8px;position:absolute}}';function fB(e,t){var o;if(!t.nodes.every(a=>a.rowPinned&&!Za(a)?(oe(59),!1):a.id===void 0?(oe(60),!1):!0))return;const{nodes:s,source:i,newValue:n}=t;(o=e.selectionSvc)==null||o.setNodesSelected({nodes:s,source:i??"api",newValue:n})}function gB(e,t,r="apiSelectAll"){var s;(s=e.selectionSvc)==null||s.selectAllRowNodes({source:r,selectAll:t})}function pB(e,t,r="apiSelectAll"){var s;(s=e.selectionSvc)==null||s.deselectAllRowNodes({source:r,selectAll:t})}function mB(e,t="apiSelectAllFiltered"){var r;(r=e.selectionSvc)==null||r.selectAllRowNodes({source:t,selectAll:"filtered"})}function vB(e,t="apiSelectAllFiltered"){var r;(r=e.selectionSvc)==null||r.deselectAllRowNodes({source:t,selectAll:"filtered"})}function CB(e,t="apiSelectAllCurrentPage"){var r;(r=e.selectionSvc)==null||r.selectAllRowNodes({source:t,selectAll:"currentPage"})}function wB(e,t="apiSelectAllCurrentPage"){var r;(r=e.selectionSvc)==null||r.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function xB(e){var t;return((t=e.selectionSvc)==null?void 0:t.getSelectedNodes())??[]}function yB(e){var t;return((t=e.selectionSvc)==null?void 0:t.getSelectedRows())??[]}var SB=class extends YA{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();const{gos:e}=this;this.mode=Tc(e),this.groupSelectsDescendants=Sa(e),this.groupSelectsFiltered=Pc(e)==="filteredDescendants",this.masterSelectsDetail=Bp(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{const t=Sa(e),r=Tc(e),s=Pc(e)==="filteredDescendants";this.masterSelectsDetail=Bp(e)==="detail",(t!==this.groupSelectsDescendants||s!==this.groupSelectsFiltered||r!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=s,this.mode=r)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,r){if(this.isRowSelectionBlocked(t))return 0;const s=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,r);if(s==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in s)return s.reset?this.resetNodes():this.selectRange(s.deselect,!1,r),this.selectRange(s.select,!0,r);{const i=s.checkFilteredNodes?Qx(s.node):s.newValue;return this.setNodesSelected({nodes:[s.node],newValue:i,clearSelection:s.clearSelection,keepDescendants:s.keepDescendants,event:e,source:r})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:r,nodes:s,event:i,source:n,keepDescendants:o=!1}){var c;if(s.length===0)return 0;const{gos:a}=this;if(!Ki(a)&&e)return oe(132),0;if(s.length>1&&!this.isMultiSelect())return oe(130),0;let l=0;for(let u=0;u<s.length;u++){const d=s[u],h=Dn(d);if(h.rowPinned&&!Za(h)){oe(59);continue}if(h.id===void 0){oe(60);continue}if(e&&d.destroyed)continue;this.groupSelectsFiltered&&h.group&&!a.get("treeData")||this.selectRowNode(h,e,i,n)&&(this.detailSelection.delete(h.id),l++),this.groupSelectsDescendants&&((c=h.childrenAfterGroup)!=null&&c.length)&&(l+=this.selectChildren(h,e,n))}return r||(s.length===1&&n==="api"&&this.selectionCtx.setRoot(Dn(s[0])),e&&(t||!this.isMultiSelect())&&(l+=this.clearOtherNodes(Dn(s[0]),o,n)),l>0&&(this.updateGroupsFromChildrenSelections(n),this.dispatchSelectionChanged(n))),l}selectRange(e,t,r){let s=0;return e.forEach(i=>{const n=Dn(i);if(n.group&&this.groupSelectsDescendants)return;this.selectRowNode(n,t,void 0,r)&&s++}),s>0&&(this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)),s}selectChildren(e,t,r){const s=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return s?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:r,nodes:s}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((r,s)=>{e(r)&&t.set(s,r)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;const{gos:r,rowModel:s}=this.beans;if(!wt(r))return!1;const i=s.rootNode;if(!i)return!1;t||(t=new Ea(!0,i),t.active=!1);let n=!1;return t.forEachChangedNodeDepthFirst(o=>{if(o!==i){const a=this.calculateSelectedFromChildren(o);n=this.selectRowNode(o,a===null?!1:a,void 0,e)||n}}),n}clearOtherNodes(e,t,r){const s=new Map;let i=0;return this.selectedNodes.forEach(n=>{const o=n.id==e.id;if((t?!FB(e,n):!0)&&!o){const l=this.selectedNodes.get(n.id);i+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:r}),this.groupSelectsDescendants&&n.parent&&s.set(n.parent.id,n.parent)}}),s.forEach(n=>{const o=this.calculateSelectedFromChildren(n);this.selectRowNode(n,o===null?!1:o,void 0,r)}),i}onRowSelected(e){const t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;const t=new yi(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){const{gos:e,rowModel:t}=this.beans;if(!wt(e))return;const r=t.getTopLevelNodes();if(r===null)return;const s=[];function i(n){for(let o=0,a=n.length;o<a;o++){const l=n[o];l.isSelected()?s.push(l):l.group&&l.childrenAfterGroup&&i(l.childrenAfterGroup)}}return i(r),s}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){const r=wt(this.gos);let s=!1;const i=n=>{const o=this.selectRowNode(Dn(n),!1,void 0,e);s||(s=o)};if(t==="currentPage"||t==="filtered"){if(!r){Qe(102);return}this.getNodesToSelect(t).forEach(i)}else this.selectedNodes.forEach(i),this.reset(e);if(this.selectionCtx.selectAll=!1,r&&this.groupSelectsDescendants){const n=this.updateGroupsFromChildrenSelections(e);s||(s=n)}s&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,r=0;return this.getNodesToSelect(e).forEach(s=>{this.groupSelectsDescendants&&s.group||(s.isSelected()?t++:s.selectable&&r++)}),{selectedCount:t,notSelectedCount:r}}getSelectAllState(e){const{selectedCount:t,notSelectedCount:r}=this.getSelectedCounts(e);return Zx(t,r)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];const t=[],r=i=>t.push(i);if(e==="currentPage")return this.forEachNodeOnPage(i=>{if(!i.group){r(i);return}if(!i.expanded&&!i.footer){const n=o=>{var a;r(o),(a=o.childrenAfterFilter)==null||a.forEach(n)};n(i);return}this.groupSelectsDescendants||r(i)}),t;const s=this.beans.rowModel;return e==="filtered"?(s.forEachNodeAfterFilter(r),t):(s.forEachNode(r),t)}forEachNodeOnPage(e){const{pageBounds:t,rowModel:r}=this.beans,s=t.getFirstRow(),i=t.getLastRow();for(let n=s;n<=i;n++){const o=r.getRow(n);o&&e(o)}}selectAllRowNodes(e){const{gos:t,selectionCtx:r}=this;if(!Ki(t)){oe(132);return}if(g2(t)&&!kc(t)){oe(130);return}if(!this.canSelectAll())return;const{source:s,selectAll:i}=e;let n=!1;if(this.getNodesToSelect(i).forEach(o=>{const a=this.selectRowNode(Dn(o),!0,void 0,s);n||(n=a)}),r.selectAll=!0,wt(t)&&this.groupSelectsDescendants){const o=this.updateGroupsFromChildrenSelections(s);n||(n=o)}n&&this.dispatchSelectionChanged(s)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,r){if(e||(e=[]),!Array.isArray(e)){Qe(103);return}const s=new Set(e),i=[];this.beans.rowModel.forEachNode(n=>{s.has(n.id)&&i.push(n)}),r&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:i,source:t})}canSelectAll(){return wt(this.beans.gos)}updateSelectable(e){var l;const{gos:t,rowModel:r}=this.beans;if(!Ki(t))return;const s="selectableChanged",i=e!==void 0,n=wt(t)&&this.groupSelectsDescendants,o=[],a=c=>{var d;if(i&&!c.group)return;if(n&&c.group){const h=((d=c.childrenAfterGroup)==null?void 0:d.some(f=>f.selectable))??!1;this.setRowSelectable(c,h,!0);return}!this.updateRowSelectable(c,!0)&&c.isSelected()&&o.push(c)};if(n){if(e===void 0){const c=r.rootNode;e=c?new Ea(!1,c):void 0}e==null||e.forEachChangedNodeDepthFirst(a,!i,!i)}else r.forEachNode(a);o.length&&this.setNodesSelected({nodes:o,newValue:!1,source:s}),!i&&n&&((l=this.updateGroupsFromChildrenSelections)==null||l.call(this,s))}updateSelectableAfterGrouping(e){var t;this.updateSelectable(e),this.groupSelectsDescendants&&((t=this.updateGroupsFromChildrenSelections)!=null&&t.call(this,"rowGroupChanged",e))&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){var n,o;if(!this.masterSelectsDetail)return;const r=(o=(n=e.detailNode)==null?void 0:n.detailGridInfo)==null?void 0:o.api;if(!r)return;const s=bB(r);if(e.isSelected()!==s&&this.selectRowNode(e,s,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!s){const a=this.detailSelection.get(e.id)??new Set;for(const l of r.getSelectedNodes())a.add(l.id);this.detailSelection.set(e.id,a)}}setDetailSelectionState(e,t,r){if(this.masterSelectsDetail){if(!kc(t)){oe(269);return}switch(e.isSelected()){case!0:{r.selectAll();break}case!1:{r.deselectAll();break}case void 0:{const s=this.detailSelection.get(e.id);if(s){const i=[];for(const n of s){const o=r.getRowNode(n);o&&i.push(o)}r.setNodesSelected({nodes:i,newValue:!0,source:"masterDetail"})}break}}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function Dn(e){return Za(e)?e.pinnedSibling:e.footer?e.sibling:e}function bB(e){let t=0,r=0;return e.forEachNode(s=>{s.isSelected()?t++:s.selectable&&r++}),Zx(t,r)}function Zx(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function FB(e,t){let r=t.parent;for(;r;){if(r===e)return!0;r=r.parent}return!1}function Qx(e){var s;const t=e.isSelected()===!1,r=((s=e.childrenAfterFilter)==null?void 0:s.some(Qx))??!1;return t||r}var RB={moduleName:"SharedRowSelection",version:we,beans:[dB],css:[hB],apiFunctions:{setNodesSelected:fB,selectAll:gB,deselectAll:pB,selectAllFiltered:mB,deselectAllFiltered:vB,selectAllOnCurrentPage:CB,deselectAllOnCurrentPage:wB,getSelectedNodes:xB,getSelectedRows:yB}},EB={moduleName:"RowSelection",version:we,rowModels:["clientSide","infinite","viewport"],beans:[SB],dependsOn:[RB]};function TB(e){var t;(t=e.expansionSvc)==null||t.expandAll(!0)}function kB(e){var t;(t=e.expansionSvc)==null||t.expandAll(!1)}function e1(e){var t;(t=e.rowModel)==null||t.onRowHeightChanged()}function t1(e){var t,r;if((t=e.rowAutoHeight)!=null&&t.active){oe(3);return}(r=e.rowModel)==null||r.resetRowHeights()}function PB(e,t,r){var i,n;const s=E4(e);if(s){if(((i=e.rowGroupColsSvc)==null?void 0:i.columns.length)===0){if(t<0){Qe(238);return}s.setRowCount(t,r);return}Qe(28);return}(n=Tu(e))==null||n.setRowCount(t,r)}function DB(e){var t;return bo(e.gos)?e.rowModel.getBlockStates():((t=e.rowNodeBlockLoader)==null?void 0:t.getBlockState())??{}}function AB(e){return e.rowModel.isLastRowIndexKnown()}var IB={moduleName:"CsrmSsrmSharedApi",version:we,apiFunctions:{expandAll:TB,collapseAll:kB}},MB={moduleName:"RowModelSharedApi",version:we,apiFunctions:{onRowHeightChanged:e1,resetRowHeights:t1}},_B={moduleName:"SsrmInfiniteSharedApi",version:we,apiFunctions:{setRowCount:PB,getCacheBlockState:DB,isLastRowIndexKnown:AB}},LB=class extends ee{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(s=>{var n;if(!s){Qe(18),t||Qe(20);return}if(this.isGridApi(s))return s;const i=s;return"current"in i?(n=i.current)==null?void 0:n.api:(i.api||Qe(19),i.api)}).filter(s=>!!s&&!s.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(const t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const r=[];return e.columns?e.columns.forEach(s=>{r.push(t(s))}):e.column&&r.push(t(e.column)),r}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":oe(21);break}})}processGroupOpenedEvent(e){const{colGroupSvc:t}=this.beans;if(t)for(const r of e.columnGroups){let s=null;r&&(s=t.getProvidedColGroup(r.getGroupId())),!(r&&!s)&&t.setColumnGroupOpened(s,r.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){const t=e.column;let r=null;const s=this.beans,{colResize:i,ctrlsSvc:n,colModel:o}=s;if(t&&(r=o.getColDefCol(t.getColId())),t&&!r)return;const a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{const d=e.api.getColumnState().map(h=>({colId:h.colId}));ts(s,{state:d,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const d=e.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));ts(s,{state:d},"alignedGridChanged")}break;case"columnPinned":{const d=e.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));ts(s,{state:d},"alignedGridChanged")}break;case"columnResized":{const u=e,d={};for(const h of a)d[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()};for(const h of u.flexColumns??[])d[h.getId()]&&delete d[h.getId()];i==null||i.setColumnWidths(Object.values(d),!1,u.finished,"alignedGridChanged");break}}const c=n.getGridBodyCtrl().isVerticalScrollShowing();for(const u of this.getAlignedGridApis())u.setGridOption("alwaysShowVerticalScroll",c)}},OB={moduleName:"AlignedGrids",version:we,beans:[LB],dependsOn:[lx]},NB=class extends ee{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},Y0(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){var a;this.dispatchRowDataUpdateStarted(e),this.destroyAllNodes();const t=Y0(this.rootNode),r=new Array(e.length);t._leafs=r;let s=0;const i=(a=this.beans.groupStage)==null?void 0:a.getNestedDataGetter(),n=i?new Set:null,o=(l,c)=>{const u=l.level+1;for(let d=0,h=c.length;d<h;++d){const f=c[d];if(!f)continue;const p=this.createRowNode(f,u);if(p.sourceRowIndex=s,r[s++]=p,n&&!n.has(f)){n.add(f),p.treeParent=l;const g=i(f);g&&o(p,g)}}};o(t,e),r.length=s}destroyAllNodes(){const{selectionSvc:e,pinnedRowModel:t,groupStage:r}=this.beans;e==null||e.reset("rowDataChanged"),t!=null&&t.isManual()&&t.reset(),r==null||r.clearNonLeafs();const s=this.rootNode._leafs;if(s)for(let i=0,n=s.length;i<n;++i)s[i]._destroy(!1);this.allNodesMap=Object.create(null),this.nextId=0}setImmutableRowData(e,t){var v;const{rootNode:r,gos:s}=this;this.dispatchRowDataUpdateStarted(t);const i=co(s),n=e.changedRowNodes,{adds:o,updates:a}=n,l=new Set,c=[],u=(v=this.beans.groupStage)==null?void 0:v.getNestedDataGetter();let d=s.get("suppressMaintainUnsortedOrder")?void 0:!1,h=-1,f=!1;const p=(w,C)=>{if(!d&&d!==void 0){const y=w.sourceRowIndex;d=y<=h,h=y}w.data!==C&&(w.updateData(C),o.has(w)||a.add(w),!w.selectable&&w.isSelected()&&c.push(w))},g=(w,C,y)=>{for(let b=0,F=C.length;b<F;++b){const S=C[b];if(!S)continue;let D=this.getRowNode(i({data:S,level:y}));if(D?(p(D,S),f||(f=!!u&&D.treeParent!==w)):(D=this.createRowNode(S,y),o.add(D)),!u||l.has(D)){l.add(D);continue}l.add(D),D.treeParent=w;const T=u(S);T&&g(D,T,y+1)}};g(r,t,0);const m=this.deleteUnusedNodes(l,n,c,!!e.animate)||d||o.size>0;if(m){const w=r._leafs??(r._leafs=[]);d===void 0?WB(w,l,n):GB(w,l)&&(n.reordered=!0)}(m||f||a.size)&&(e.rowDataUpdated=!0,this.deselect(c))}deleteUnusedNodes(e,{removals:t},r,s){const i=this.rootNode._leafs;for(let n=0,o=i.length;n<o;n++){const a=i[n];e.has(a)||this.destroyNode(a,s)&&(t.push(a),a.isSelected()&&r.push(a))}return t.length>0}updateRowData(e,t,r){var l;if(this.dispatchRowDataUpdateStarted(e.add),(l=this.beans.groupStage)!=null&&l.getNestedDataGetter())return oe(268),{remove:[],update:[],add:[]};const s=[],i=co(this.gos),n=this.executeRemove(i,e,t,s,r),o=this.executeUpdate(i,e,t,s),a=this.executeAdd(e,t);return this.deselect(s),{remove:n,update:o,add:a}}executeRemove(e,{remove:t},{adds:r,updates:s,removals:i},n,o){const a=this.rootNode._leafs,l=a==null?void 0:a.length,c=t==null?void 0:t.length;if(!c||!l)return[];let u=0,d=l,h=0;const f=new Array(c);for(let p=0;p<c;++p){const g=this.lookupNode(e,t[p]);if(!g)continue;const m=g.sourceRowIndex;m<d&&(d=m),m>h&&(h=m),f[u++]=g,this.destroyNode(g,o)&&(g.isSelected()&&n.push(g),r.delete(g)||(s.delete(g),i.push(g)))}return f.length=u,u&&VB(a,d,h),f}executeUpdate(e,{update:t},{adds:r,updates:s},i){const n=t==null?void 0:t.length;if(!n)return[];const o=new Array(n);let a=0;for(let l=0;l<n;l++){const c=t[l],u=this.lookupNode(e,c);u&&(u.updateData(c),!u.selectable&&u.isSelected()&&i.push(u),o[a++]=u,r.has(u)||s.add(u))}return o.length=a,o}executeAdd(e,t){var r;const s=(r=this.rootNode)._leafs??(r._leafs=[]),i=s.length,n=e.add,o=n==null?void 0:n.length;if(!o)return[];const a=i+o;let l=this.sanitizeAddIndex(s,e.addIndex);if(l<i){for(let d=i-1,h=a-1;d>=l;--d){const f=s[d];f.sourceRowIndex=h,s[h--]=f}t.reordered=!0}s.length=a;const c=new Array(o),u=t.adds;for(let d=0;d<o;d++){const h=this.createRowNode(n[d],0);u.add(h),h.sourceRowIndex=l,s[l]=h,c[d]=h,l++}return c}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e!=null&&e.length?e[0]:null})}deselect(e){var s;const t="rowDataChanged",r=this.beans.selectionSvc;e.length&&(r==null||r.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t})),(s=r==null?void 0:r.updateGroupsFromChildrenSelections)==null||s.call(r,t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:(r==null?void 0:r.getSelectedNodes())??null,serverSideState:null})}createRowNode(e,t){const r=new yi(this.beans);r.parent=this.rootNode,r.level=t,r.group=!1,r.expanded=!1,r.setDataAndId(e,String(this.nextId++));const s=r.id,i=this.allNodesMap;return i[s]&&oe(2,{nodeId:s}),i[s]=r,r}destroyNode(e,t){var n;if(!e._destroy(t))return!1;const r=e.id,s=this.allNodesMap;s[r]===e&&delete s[r];const i=e.pinnedSibling;return i&&((n=this.beans.pinnedRowModel)==null||n.pinRow(i,null)),!0}lookupNode(e,t){if(!e)return HB(this.rootNode._leafs,t);const r=e({data:t,level:0}),s=this.allNodesMap[r];return s||(Qe(4,{id:r}),null)}sanitizeAddIndex(e,t){const r=e.length;if(typeof t!="number"||t<0||t>=r||Number.isNaN(t))return r;t=Math.ceil(t);const s=this.gos;return t>0&&s.get("treeData")&&s.get("getDataPath")&&(t=BB(e,t)),t}},BB=(e,t)=>{for(let r=0,s=e.length;r<s;r++){const i=e[r];if((i==null?void 0:i.rowIndex)==t-1)return r+1}return t},Y0=e=>{var o;e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",((o=e._leafs)==null?void 0:o.length)!==0&&(e._leafs=[]);const t=[],r=[],s=[],i=[];e.childrenAfterGroup=t,e.childrenAfterSort=r,e.childrenAfterAggFilter=s,e.childrenAfterFilter=i;const n=e.sibling;return n&&(n.childrenAfterGroup=t,n.childrenAfterSort=r,n.childrenAfterAggFilter=s,n.childrenAfterFilter=i,n.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},HB=(e,t)=>{if(e)for(let r=0,s=e.length;r<s;r++){const i=e[r];if(i.data===t)return i}return Qe(5,{data:t}),null},VB=(e,t,r)=>{t=Math.max(0,t);for(let s=t,i=e.length;s<i;++s){const n=e[s];s<=r&&n.destroyed||(n.sourceRowIndex=t,e[t++]=n)}e.length=t},GB=(e,t)=>{const r=t.size;e.length=r;let s=0,i=!1,n=!1;for(const o of t){const a=o.sourceRowIndex;a===s?n||(n=i):(a>=0?n=!0:i=!0,o.sourceRowIndex=s,e[s]=o),++s}return n},WB=(e,t,{adds:r})=>{const s=e.length,i=t.size;i>s&&(e.length=i);let n=0;for(let o=0;o<s;++o){const a=e[o];a.destroyed||(n!==o&&(a.sourceRowIndex=n,e[n]=a),++n)}for(const o of r)o.sourceRowIndex<0&&(o.sourceRowIndex=n,e[n++]=o);e.length=n},r1=e=>{const t=e.childrenAfterSort,r=e.sibling;if(r&&(r.childrenAfterSort=t),!!t)for(let s=0,i=t.length-1;s<=i;s++){const n=t[s],o=s===0,a=s===i;n.firstChild!==o&&(n.firstChild=o,n.dispatchRowEvent("firstChildChanged")),n.lastChild!==a&&(n.lastChild=a,n.dispatchRowEvent("lastChildChanged")),n.childIndex!==s&&(n.childIndex=s,n.dispatchRowEvent("childIndexChanged"))}},zB=class extends ee{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e,t){const r=this.beans.sortSvc.getSortOptions(),s=r.length>0&&!!t&&this.gos.get("deltaSort"),{gos:i,colModel:n,rowGroupColsSvc:o,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:c}=this.beans,u=i.get("groupMaintainOrder"),d=n.getCols().some(w=>w.isRowGroupActive()),h=o==null?void 0:o.columns,f=n.isPivotMode(),p=i.getCallback("postSortRows");let g=!1,m;const v=w=>{var F,S;const C=f&&w.leafGroup;let y=u&&d&&!w.leafGroup;y&&(m??(m=this.shouldSortContainsGroupCols(r)),y&&(y=!m));let b=null;if(y){let D=!1;if(h){const T=w.level+1;T<h.length&&(D=h[T].wasSortExplicitlyRemoved)}D||(b=$B(w))}else!r.length||C||(s&&t?b=UB(a,w,t,e,r):b=a.doFullSort(w.childrenAfterAggFilter,r));if(b||(b=((F=w.childrenAfterAggFilter)==null?void 0:F.slice(0))??[]),g||(g=((S=w.childrenAfterSort)==null?void 0:S[0])!==b[0]),w.childrenAfterSort=b,r1(w),p){const D={nodes:w.childrenAfterSort};p(D)}};if(e==null||e.forEachChangedNodeDepthFirst(v),g&&i.get("groupHideOpenParents")){const w=c==null?void 0:c.columns;w!=null&&w.length&&l.refreshCells({columns:w,force:!0})}}shouldSortContainsGroupCols(e){const t=e.length;if(!t)return!1;if(Cs(this.gos)){for(let r=0;r<t;++r){const s=e[r].column;if(s.isPrimary()&&s.isRowGroupActive())return!0}return!1}for(let r=0;r<t;++r)if(e[r].column.getColDef().showRowGroup)return!0;return!1}},UB=(e,t,r,s,i)=>{const n=t.childrenAfterAggFilter,o=t.childrenAfterSort;if(!o)return e.doFullSort(n,i);const a=new Set,l=[],{updates:c,adds:u}=r;for(let h=0,f=n.length;h<f;++h){const p=n[h];c.has(p)||u.has(p)||s&&!s.canSkip(p)?l.push({currentPos:l.length,rowNode:p}):a.add(p)}const d=o.filter(h=>a.has(h)).map((h,f)=>({currentPos:f,rowNode:h}));return l.sort((h,f)=>e.compareRowNodes(i,h,f)),jB(e,i,l,d)},jB=(e,t,r,s)=>{let i=0,n=0;const o=r.length,a=s.length,l=new Array(o+a);let c=0;for(;i<o&&n<a;){const u=r[i],d=s[n];e.compareRowNodes(t,u,d)<0?(l[c++]=u.rowNode,++i):(l[c++]=d.rowNode,++n)}for(;i<o;)l[c++]=r[i++].rowNode;for(;n<a;)l[c++]=s[n++].rowNode;return l},$B=e=>{const t=e.childrenAfterSort,r=e.childrenAfterAggFilter,s=t==null?void 0:t.length,i=r==null?void 0:r.length;if(!s||!i)return null;const n=new Array(i),o=new Set;for(let l=0;l<i;++l)o.add(r[l]);let a=0;for(let l=0;l<s;++l){const c=t[l];o.delete(c)&&(n[a++]=c)}if(o.size===0&&a===s)return t;for(const l of o)n[a++]=l;return n.length=a,n},KB=class extends ee{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.formulaRows=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=null,this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=Wt(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){const e=this.beans,t=new yi(e);this.rootNode=t,this.nodeManager=this.createBean(new NB(t));const r=()=>{var s;(s=this.beans.groupStage)==null||s.invalidateGroupCols(),this.refreshModel({step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")})};this.addManagedEventListeners({newColumnsLoaded:r,columnRowGroupChanged:r,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:()=>this.refreshModel({step:"pivot"}),columnPivotModeChanged:()=>this.refreshModel({step:"group"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),stylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){const{beans:e,stagesRefreshProps:t}=this,r=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(s=>!!s);this.stages=r;for(let s=r.length-1;s>=0;--s){const i=r[s];for(const n of i.refreshProps)t.set(n,s)}this.addManagedPropertyListeners([...t.keys(),"rowData"],s=>{var n;const i=(n=s.changeSet)==null?void 0:n.properties;i&&this.onPropChange(i)}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,r,s){let i,n=!1;do{i=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,r),c=Math.min(a,s);for(let u=l;u<=c;u++){const d=this.getRow(u);if(d.rowHeightEstimated){const h=Ci(this.beans,d);d.setRowHeight(h.height),i=!0,n=!0}}i&&this.setRowTopAndRowIndex()}while(i);return n}onPropChange(e){const{nodeManager:t,gos:r,beans:s}=this,i=s.groupStage;if(!t)return;const n=new Set(e),o=i==null?void 0:i.onPropChange(n);let a;n.has("rowData")?a=r.get("rowData"):o&&(a=i==null?void 0:i.extractData()),a&&!Array.isArray(a)&&(a=null,oe(1));const l={step:"nothing",changedProps:n};a&&(!o&&!this.isEmpty()&&a.length>0&&r.exists("getRowId")&&!r.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!r.get("suppressAnimationFrame"),l.changedRowNodes=new ic,t.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));const c=l.rowDataUpdated?"group":this.getRefreshedStage(e);c&&(l.step=c,this.refreshModel(l))}getRefreshedStage(e){const{stages:t,stagesRefreshProps:r}=this;if(!t)return null;const s=t.length;let i=s;for(let n=0,o=e.length;n<o&&i;++n)i=Math.min(i,r.get(e[n])??i);return i<s?t[i].step:null}setRowTopAndRowIndex(e){var o;const{beans:t,rowsToDisplay:r}=this,s=t.environment.getDefaultRowHeight();let i=0;const n=qt(this.gos,"normal");for(let a=0,l=r.length;a<l;++a){const c=r[a],u=c.id;if(u!=null&&(e==null||e.add(u)),c.rowHeight==null){const d=Ci(t,c,n,s);c.setRowHeight(d.height,d.estimated)}c.setRowTop(i),c.setRowIndex(a),i+=c.rowHeight}if((o=this.beans.formula)!=null&&o.active){const a=this.formulaRows;for(let l=0,c=a.length;l<c;++l){const u=a[l];u.formulaRowIndex=l}}}clearRowTopAndRowIndex(e,t){const r=e.active,s=o=>{(o==null?void 0:o.id)!=null&&!t.has(o.id)&&o.clearRowTopAndRowIndex()},i=o=>{s(o),s(o.detailNode),s(o.sibling);const a=o.childrenAfterGroup;if(!o.hasChildren()||!a)return;const l=o.level==-1;if(!(r&&!l&&!o.expanded))for(let u=0,d=a.length;u<d;++u)i(a[u])},n=this.rootNode;n&&i(n)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){var i,n;const{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;const s=(i=e.sibling)!=null&&i.displayed?1:0;return(((n=e.childrenAfterSort)==null?void 0:n.length)??0)+s}getTopLevelRowDisplayedIndex(e){const{beans:t,rootNode:r,rowsToDisplay:s}=this;if(!r||!s.length||s[0]===r)return e;const n=r.childrenAfterSort,o=l=>{let c=n[l];if(this.gos.get("groupHideOpenParents"))for(;c.expanded&&c.childrenAfterSort&&c.childrenAfterSort.length>0;)c=c.childrenAfterSort[0];return c.rowIndex},a=t.footerSvc;return a?a==null?void 0:a.getTopDisplayIndex(s,e,n,o):o(e)}getTopLevelIndexFromDisplayedIndex(e){var a;const{rootNode:t,rowsToDisplay:r}=this;if(!t||!r.length||r[0]===t)return e;let i=this.getRow(e);i.footer&&(i=i.sibling);let n=i.parent;for(;n&&n!==t;)i=n,n=i.parent;const o=((a=t.childrenAfterSort)==null?void 0:a.indexOf(i))??-1;return o>=0?o:e}getRowBounds(e){const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:$n(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){const s=t.length===0||t.some(i=>i.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:s,keepRenderedRows:!0,animate:$n(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:$n(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){const t=new Ea(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;const{changedRowNodes:t,newData:r,rowDataUpdated:s}=e;return!(!t||r||!s||t.removals.length||t.adds.size)}refreshModel(e){var c,u;const{nodeManager:t,beans:r,eventSvc:s,started:i,refreshingModel:n}=this;if(!t)return;const o=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&o));if(i&&o&&s.dispatchEvent({type:"rowDataUpdated"}),!i||n||r.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=o);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,(c=r.masterDetailSvc)==null||c.refreshModel(e),o&&e.step!=="group"&&((u=r.colFilter)==null||u.refreshModel()),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(a,e.changedRowNodes);case"map":this.doRowsToDisplay()}const l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,s.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){var e,t,r;return!((t=(e=this.rootNode)==null?void 0:e._leafs)!=null&&t.length)||!((r=this.beans.colModel)!=null&&r.ready)}isRowsToRender(){return this.rowsToDisplay.length>0}getOverlayType(){var e;return this.isEmpty()?"noRows":(e=this.beans.filterManager)!=null&&e.isAnyFilterPresent()&&this.getRowCount()===0?"noMatchingRows":null}getNodesInRangeForSelection(e,t){let r=!1,s=!1;const i=[],n=Sa(this.gos);return this.forEachNodeAfterFilterAndSort(o=>{if(s)return;if(r&&(o===t||o===e)&&(s=!0,n&&o.group)){s1(i,o);return}if(!r){if(o!==t&&o!==e)return;r=!0,t===e&&(s=!0)}(!o.group||!n)&&i.push(o)}),i}getTopLevelNodes(){var e;return((e=this.rootNode)==null?void 0:e.childrenAfterGroup)??null}getRow(e){return this.rowsToDisplay[e]}getFormulaRow(e){return this.formulaRows[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){const t=this.rowsToDisplay,r=t.length;if(this.isEmpty()||r===0)return-1;let s=0,i=r-1;if(e<=0)return 0;if(t[i].rowTop<=e)return i;let o=-1,a=-1;for(;;){const l=Math.floor((s+i)/2),c=t[l];if(this.isRowInPixel(c,e)||(c.rowTop<e?s=l+1:c.rowTop>e&&(i=l-1),o===s&&a===i))return l;o=s,a=i}}isRowInPixel(e,t){const r=e.rowTop,s=r+e.rowHeight;return r<=t&&s>t}forEachLeafNode(e){var r;const t=(r=this.rootNode)==null?void 0:r._leafs;if(t)for(let s=0,i=t.length;s<i;++s)e(t[s],s)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){const t=this.rowsToDisplay;for(let r=0,s=t.length;r<s;++r)e(t[r],r)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,r=>r.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,r=>r.childrenAfterSort)}forEachPivotNode(e,t,r){const{colModel:s,rowGroupColsSvc:i}=this.beans;if(!s.isPivotMode())return;if(!(i!=null&&i.columns.length)){e(this.rootNode,0);return}const n=r?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,o=>o.leafGroup?null:o[n])}depthFirstSearchRowNodes(e,t=!1,r=n=>n.childrenAfterGroup,s=this.rootNode,i=0){let n=i;if(!s)return n;const o=s===this.rootNode;if(o||e(s,n++),s.hasChildren()&&!s.footer){const a=r(s);if(a){const l=this.beans.footerSvc;n=(l==null?void 0:l.addTotalRows(n,s,e,t,o,"top"))??n;for(const c of a)n=this.depthFirstSearchRowNodes(e,t,r,c,n);return(l==null?void 0:l.addTotalRows(n,s,e,t,o,"bottom"))??n}}return n}doAggregate(e){var r;this.rootNode&&((r=this.beans.aggStage)==null||r.execute(e))}doFilterAggregates(e){const t=this.rootNode,r=this.beans.filterAggStage;if(r){r.execute(e);return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){const r=this.beans.sortStage;if(r){r.execute(e,t);return}e.forEachChangedNodeDepthFirst(s=>{s.childrenAfterSort=s.childrenAfterAggFilter.slice(0),r1(s)})}doGrouping(e){var i;const t=this.rootNode;if(!t)return;const r=this.beans.groupStage,s=r==null?void 0:r.execute(e);if(s===void 0){const n=t._leafs;t.childrenAfterGroup=n,t.updateHasChildren();const o=t.sibling;o&&(o.childrenAfterGroup=n)}(s||e.rowDataUpdated)&&((i=this.beans.colFilter)==null||i.refreshModel()),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){const t=this.beans.filterStage;if(t){t.execute(e);return}e.forEachChangedNodeDepthFirst(r=>{r.childrenAfterFilter=r.childrenAfterGroup,Lh(r)},!0)}doPivot(e){var t;(t=this.beans.pivotStage)==null||t.execute(e)}getRowNode(e){var r,s;const t=(r=this.nodeManager)==null?void 0:r.getRowNode(e);return typeof t=="object"?t:(s=this.beans.groupStage)==null?void 0:s.getNonLeaf(e)}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];const r=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),r)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){const e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){var l;const{nodeManager:e,beans:t,eventSvc:r,asyncTransactions:s}=this;if(!e)return;(l=t.valueCache)==null||l.onDataChanged();const i=[],n=[],o=new ic,a=!this.gos.get("suppressAnimationFrame");for(const{rowDataTransaction:c,callback:u}of s??[]){this.rowNodesCountReady=!0;const d=e.updateRowData(c,o,a);i.push(d),u&&n.push(u.bind(null,d))}this.commitTransactions(o,a),n.length>0&&setTimeout(()=>{for(let c=0,u=n.length;c<u;c++)n[c]()},0),i.length>0&&r.dispatchEvent({type:"asyncTransactionsFlushed",results:i}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){var n;const t=this.nodeManager;if(!t)return null;(n=this.beans.valueCache)==null||n.onDataChanged(),this.rowNodesCountReady=!0;const r=new ic,s=!this.gos.get("suppressAnimationFrame"),i=t.updateRowData(e,r,s);return this.commitTransactions(r,s),i}commitTransactions(e,t){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:t,changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){var i;const{rootNode:e,beans:t}=this;if((i=t.formula)!=null&&i.active){const n=(e==null?void 0:e.childrenAfterSort)??[];this.formulaRows=n,this.rowsToDisplay=n.filter(o=>!o.softFiltered);for(const o of this.rowsToDisplay)o.setUiLevel(0);return}const r=t.flattenStage;if(r){this.rowsToDisplay=r.execute();return}const s=this.rootNode.childrenAfterSort??[];for(const n of s)n.setUiLevel(0);this.rowsToDisplay=s}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){const e=this.rootNode;if(!e)return;const t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);const r=e.sibling;r==null||r.setRowHeight(r.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const r=t.detailNode;r==null||r.setRowHeight(r.rowHeight,!0);const s=t.sibling;s==null||s.setRowHeight(s.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){var t;e.rowHeightChanged&&!((t=this.beans.rowAutoHeight)!=null&&t.active)&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,this.stages=null,this.stagesRefreshProps.clear(),clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},s1=(e,t)=>{const r=t.childrenAfterGroup;if(r)for(let s=0,i=r.length;s<i;++s){const n=r[s];n.data&&e.push(n),n.group&&s1(e,n)}};function qB(e){var t;(t=e.expansionSvc)==null||t.onGroupExpandedOrCollapsed()}function XB(e,t){const r=Pi(e);r&&((!t||t==="everything")&&(t="group"),r.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function YB(e){var t;return((t=Pi(e))==null?void 0:t.isEmpty())??!0}function JB(e,t){var r;(r=Pi(e))==null||r.forEachLeafNode(t)}function ZB(e,t){var r;(r=Pi(e))==null||r.forEachNodeAfterFilter(t)}function QB(e,t){var r;(r=Pi(e))==null||r.forEachNodeAfterFilterAndSort(t)}function eH(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var r;return(r=Pi(e))==null?void 0:r.updateRowData(t)})}function tH(e,t,r){e.frameworkOverrides.wrapIncoming(()=>{var s;return(s=Pi(e))==null?void 0:s.batchUpdateRowData(t,r)})}function rH(e){e.frameworkOverrides.wrapIncoming(()=>{var t;return(t=Pi(e))==null?void 0:t.flushAsyncTransactions()})}function sH(e){var t;return(t=e.selectionSvc)==null?void 0:t.getBestCostNodeSelection()}var iH={moduleName:"ClientSideRowModel",version:we,rowModels:["clientSide"],beans:[KB,zB],dependsOn:[Fx]},nH={moduleName:"ClientSideRowModelApi",version:we,apiFunctions:{onGroupExpandedOrCollapsed:qB,refreshClientSideRowModel:XB,isRowDataEmpty:YB,forEachLeafNode:JB,forEachNodeAfterFilter:ZB,forEachNodeAfterFilterAndSort:QB,applyTransaction:eH,applyTransactionAsync:tH,flushAsyncTransactions:rH,getBestCostNodeSelection:sH,resetRowHeights:t1,onRowHeightChanged:e1},dependsOn:[IB,MB]},oH=class extends ee{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){const{allColumns:r,columnKeys:s,skipRowGroups:i,exportRowNumbers:n}=t,o=this.getColumnsToExport({allColumns:r,skipRowGroups:i,columnKeys:s,exportRowNumbers:n});return[this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,r,s){var p;const i=t.shouldRowBeSkipped||(()=>!1),o=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!o,l=this.colModel.isPivotMode()?s.leafGroup:!s.group,c=!!s.footer,u=s.allChildrenCount===1&&((p=s.childrenAfterGroup)==null?void 0:p.length)===1&&h2(this.gos,s);if(!l&&!c&&(t.skipRowGroups||u||a)||t.onlySelected&&!s.isSelected()||t.skipPinnedTop&&s.rowPinned==="top"||t.skipPinnedBottom&&s.rowPinned==="bottom"||s.stub||s.level===-1&&!l&&!c||i(ke(this.gos,{node:s})))return;const f=e.onNewBodyRow(s);if(r.forEach((g,m)=>{f.onColumn(g,m,s)}),t.getCustomContentBelowRow){const g=t.getCustomContentBelowRow(ke(this.gos,{node:s}));g&&e.addCustomContent(g)}}appendContent(e){return t=>{const r=e.appendContent;return r&&t.addCustomContent(r),t}}prependContent(e){return t=>{const r=e.prependContent;return r&&t.addCustomContent(r),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return r=>{if(!e.skipColumnGroupHeaders){const s=new iw,{colGroupSvc:i}=this.beans,n=i?i.createColumnGroups({columns:t,idCreator:s,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(n,r,e.processGroupHeaderCallback)}return r}}exportHeaders(e,t){return r=>{if(!e.skipColumnHeaders){const s=r.onNewHeaderRow();t.forEach((i,n)=>{s.onColumn(i,n,void 0)})}return r}}processPinnedTopRows(e,t){return r=>{var i,n;const s=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(o=>o.rowPinned==="top").sort((o,a)=>o.rowIndex-a.rowIndex).map(o=>{var a;return(a=this.pinnedRowModel)==null?void 0:a.getPinnedTopRow(o.rowIndex)}).forEach(s):(i=this.pinnedRowModel)!=null&&i.isManual()||(n=this.pinnedRowModel)==null||n.forEachPinnedRow("top",s),r}}processRows(e,t){return r=>{var c;const s=this.rowModel,i=wt(this.gos),n=bo(this.gos),o=!i&&e.onlySelected,a=this.processRow.bind(this,r,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(u=>u.rowPinned==null).sort((u,d)=>u.rowIndex-d.rowIndex).map(u=>s.getRow(u.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())i?s.forEachPivotNode(a,!0,l==="filteredAndSorted"):n?s.forEachNodeAfterFilterAndSort(a,!0):s.forEachNode(a);else if(e.onlySelectedAllPages||o){const u=((c=this.beans.selectionSvc)==null?void 0:c.getSelectedNodes())??[];this.replicateSortedOrder(u),u.forEach(a)}else l==="all"?s.forEachNode(a):i||n?s.forEachNodeAfterFilterAndSort(a,!0):s.forEachNode(a);return r}}replicateSortedOrder(e){const{sortSvc:t,rowNodeSorter:r}=this.beans;if(!t||!r)return;const s=t.getSortOptions(),i=(n,o)=>{var a,l;return n.rowIndex!=null&&o.rowIndex!=null?n.rowIndex-o.rowIndex:n.level===o.level?((a=n.parent)==null?void 0:a.id)===((l=o.parent)==null?void 0:l.id)?r.compareRowNodes(s,{rowNode:n,currentPos:n.rowIndex??-1},{rowNode:o,currentPos:o.rowIndex??-1}):i(n.parent,o.parent):n.level>o.level?i(n.parent,o):i(n,o.parent)};e.sort(i)}processPinnedBottomRows(e,t){return r=>{var i,n;const s=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(o=>o.rowPinned==="bottom").sort((o,a)=>o.rowIndex-a.rowIndex).map(o=>{var a;return(a=this.pinnedRowModel)==null?void 0:a.getPinnedBottomRow(o.rowIndex)}).forEach(s):(i=this.pinnedRowModel)!=null&&i.isManual()||(n=this.pinnedRowModel)==null||n.forEachPinnedRow("bottom",s),r}}getColumnsToExport(e){const{allColumns:t=!1,skipRowGroups:r=!1,exportRowNumbers:s=!1,columnKeys:i}=e,{colModel:n,gos:o,visibleCols:a}=this,l=n.isPivotMode(),c=h=>Ti(h)?!1:!Gs(h)||s;if(i!=null&&i.length)return n.getColsForKeys(i).filter(c);const u=o.get("treeData");let d=[];return t&&!l?d=n.getCols():d=a.allCols,d=d.filter(h=>c(h)&&(r&&!u?!Pf(h):!0)),d}recursivelyAddHeaderGroups(e,t,r){const s=[];for(const i of e){const n=i;if(n.getChildren)for(const o of n.getChildren()??[])s.push(o)}e.length>0&&kt(e[0])&&this.doAddHeaderHeader(t,e,r),s&&s.length>0&&this.recursivelyAddHeaderGroups(s,t,r)}doAddHeaderHeader(e,t,r){const s=e.onNewHeaderGroupingRow();let i=0;for(const n of t){const o=n;let a;r?a=r(ke(this.gos,{columnGroup:o})):a=this.beans.colNames.getDisplayNameForColumnGroup(o,"header");const c=(o.isExpandable()?o.getLeafColumns():[]).reduce((u,d,h,f)=>{let p=nt(u);return d.getColumnGroupShow()==="open"?(!p||p[1]!=null)&&(p=[h],u.push(p)):p&&p[1]==null&&(p[1]=h-1),h===f.length-1&&p&&p[1]==null&&(p[1]=h),u},[]);s.onColumn(o,a||"",i++,o.getLeafColumns().length-1,c)}}},aH={moduleName:"SharedExport",version:we,beans:[oH]},J0=`\r
`,lH=class extends M4{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:r}=e;this.suppressQuotes=t,this.columnSeparator=r}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,J0),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((r,s)=>{s!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(r.data.value||""),r.mergeAcross&&this.appendEmptyCells(r.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,r,s){r!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(s)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,r){t!=0&&(this.result+=this.columnSeparator);const s=this.extractRowCellValue({column:e,node:r,currentColumnIndex:t,accumulatedRowIndex:t,type:"csv",useRawFormula:!1});this.result+=this.putInQuotes(s.valueFormatted??s.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(oe(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=J0),this.isFirstLine=!1}},cH=class extends I4{constructor(){super(...arguments),this.beanName="csvCreator"}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){oe(51);return}const t=()=>{const s=this.getMergedParams(e),i=this.getData(s),n=new Blob(["\uFEFF",i],{type:"text/plain"}),o=s.fileName,a=typeof o=="function"?o(ke(this.gos,{})):o;_4(this.getFileName(a),n)},{overlays:r}=this.beans;r?r.showExportOverlay(t):t()}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const r=t?Object.assign({},e):this.getMergedParams(e);return this.getData(r)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{colModel:t,colNames:r,rowGroupColsSvc:s,valueSvc:i,gos:n}=this.beans,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:d}=e;return new lH({colModel:t,colNames:r,valueSvc:i,gos:n,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:d||",",rowGroupColsSvc:s})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function uH(e,t){var r;return(r=e.csvCreator)==null?void 0:r.getDataAsCsv(t)}function dH(e,t){var r;(r=e.csvCreator)==null||r.exportDataAsCsv(t)}var hH={moduleName:"CsvExport",version:we,beans:[cH],apiFunctions:{getDataAsCsv:uH,exportDataAsCsv:dH},dependsOn:[aH]},fH=class extends ee{constructor(e,t,r){super(),this.id=e,this.parentCache=t,this.params=r,this.state="needsLoading",this.version=0,this.startRow=e*r.blockSize,this.endRow=this.startRow+r.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,r){this.successCommon(e,{rowData:t,rowCount:r})}isRequestMostRecentAndLive(e){const t=e===this.version,r=this.isAlive();return t&&r}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];const{params:{blockSize:e,rowHeight:t},startRow:r,beans:s,rowNodes:i}=this;for(let n=0;n<e;n++){const o=r+n,a=new yi(s);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(o),a.setRowTop(t*o),i.push(a)}}getBlockStateJson(){const{id:e,startRow:t,endRow:r,state:s}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:r,pageStatus:s}}}setDataAndId(e,t,r){Ce(t)?e.setDataAndId(t,r.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(ct(this.params.datasource.getRows)){oe(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){const{startRow:e,endRow:t,version:r,params:{sortModel:s,filterModel:i},gos:n}=this;return ke(n,{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,r),failCallback:this.pageLoadFailed.bind(this,r),sortModel:s,filterModel:i})}forEachNode(e,t,r){this.rowNodes.forEach((s,i)=>{this.startRow+i<r&&e(s,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);const r=e-this.startRow;return this.rowNodes[r]}processServerResult(e){const{rowNodes:t,beans:r}=this;t.forEach((i,n)=>{const o=e.rowData?e.rowData[n]:void 0;!i.id&&i.alreadyRendered&&o&&(t[n]=new yi(r),t[n].setRowIndex(i.rowIndex),t[n].setRowTop(i.rowTop),t[n].setRowHeight(i.rowHeight),i._destroy(!0)),this.setDataAndId(t[n],o,this.startRow+n)});const s=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,s)}destroy(){const e=this.rowNodes;for(let t=0,r=e.length;t<r;t++)e[t]._destroy(!1);e.length=0,super.destroy()}},gH=2,pH=class extends ee{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){const r=Math.floor(e/this.params.blockSize);let s=this.blocks[r];if(!s){if(t)return;s=this.createBlock(r)}return s.getRow(e)}createBlock(e){const t=this.params,r=this.createBean(new fH(e,this,t));return this.blocks[r.id]=r,this.blockCount++,this.purgeBlocksIfNeeded(r),t.rowNodeBlockLoader.addBlock(r),r}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(const t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(const e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(on(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(o=>o!=e),r=(o,a)=>a.lastAccessed-o.lastAccessed;t.sort(r);const s=this.params.maxBlocksInCache>0,i=s?this.params.maxBlocksInCache-1:null,n=gH-1;t.forEach((o,a)=>{const l=o.state==="needsLoading"&&a>=n,c=s?a>=i:!1;if(l||c){if(this.isBlockCurrentlyDisplayed(o)||this.isBlockFocused(o))return;this.removeBlockFromCache(o)}})}isBlockFocused(e){const t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;const{startRow:r,endRow:s}=e;return t.rowIndex>=r&&t.rowIndex<s}isBlockCurrentlyDisplayed(e){const{startRow:t,endRow:r}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,r-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const{blockSize:r,overflowSize:s}=this.params,n=(e.id+1)*r+s;this.rowCount<n&&(this.rowCount=n)}}setRowCount(e,t){this.rowCount=e,Ce(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t={value:0};for(const r of this.getBlocksInOrder())r.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){const e=(r,s)=>r.id-s.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];for(const t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(const t of e)this.destroyBlock(t)}purgeCache(){for(const e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const r=[];let s=-1,i=!1;const n={value:0};let o=!1;for(const l of this.getBlocksInOrder())if(!o){if(i&&s+1!==l.id){o=!0;continue}s=l.id,l.forEachNode(c=>{const u=c===e||c===t;(i||u)&&r.push(c),u&&(i=!i)},n,this.rowCount)}return o||i?[]:r}},mH=class extends ee{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;const e=this.beans,t=new yi(e);this.rootNode=t,t.level=-1,this.rowHeight=qi(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=qi(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){var t;let e;this.cacheParams?e=!ma(this.cacheParams.sortModel,((t=this.beans.sortSvc)==null?void 0:t.getSortModel())??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getOverlayType(){var t;const e=this.infiniteCache;return(e==null?void 0:e.getRowCount())===0?(t=this.beans.filterManager)!=null&&t.isAnyFilterPresent()?"noMatchingRows":"noRows":null}getNodesInRangeForSelection(e,t){var r;return((r=this.infiniteCache)==null?void 0:r.getRowNodesInRange(e,t))??[]}reset(){var r;if(!this.datasource)return;co(this.gos)!=null||(r=this.beans.selectionSvc)==null||r.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();const e=this.beans,{filterManager:t,sortSvc:r,rowNodeBlockLoader:s,eventSvc:i,gos:n}=e;this.cacheParams={datasource:this.datasource,filterModel:(t==null?void 0:t.getFilterModel())??{},sortModel:(r==null?void 0:r.getSortModel())??[],rowNodeBlockLoader:s,initialRowCount:n.get("infiniteInitialRowCount"),maxBlocksInCache:n.get("maxBlocksInCache"),rowHeight:qi(e),overflowSize:n.get("cacheOverflowSize"),blockSize:n.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new pH(this.cacheParams)),i.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){const t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(r=>{r.id===e&&(t=r)}),t}forEachNode(e){var t;(t=this.infiniteCache)==null||t.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),r=this.getRowCount()-1;return t>r?r:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){var e;(e=this.infiniteCache)==null||e.refreshCache()}purgeCache(){var e;(e=this.infiniteCache)==null||e.purgeCache()}isLastRowIndexKnown(){var e;return((e=this.infiniteCache)==null?void 0:e.isLastRowIndexKnown())??!1}setRowCount(e,t){var r;(r=this.infiniteCache)==null||r.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function vH(e){var t;(t=Tu(e))==null||t.refreshCache()}function CH(e){var t;(t=Tu(e))==null||t.purgeCache()}function wH(e){var t;return(t=Tu(e))==null?void 0:t.getRowCount()}var xH=class extends ee{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=f2(this.gos);const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Wt(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Es(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){on(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}const e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(r=>r.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(const r of t)r.load();this.printCacheStatus()}getBlockState(){const e={};return this.blocks.forEach(t=>{const{id:r,state:s}=t.getBlockStateJson();e[r]=s}),e}printCacheStatus(){on(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},yH={moduleName:"InfiniteRowModelCore",version:we,rowModels:["infinite"],beans:[mH,xH]},SH={moduleName:"InfiniteRowModel",version:we,apiFunctions:{refreshInfiniteCache:vH,purgeInfiniteCache:CH,getInfiniteRowCount:wH},dependsOn:[yH,_B]},bH="â†‘",FH="â†“",RH={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},EH=class extends Rt{constructor(){super(RH),this.eValue=be,this.eDelta=be,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){const r=Math.abs(t),s=e.formatValue(r),i=Ce(s)?s:r,n=t>=0,o=this.eDelta;n?o.textContent=bH+i:o.textContent=FH+i,o.classList.toggle("ag-value-change-delta-up",n),o.classList.toggle("ag-value-change-delta-down",!n)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),wr(this.eDelta)}refresh(e,t=!1){var c;const{value:r,valueFormatted:s}=e,{eValue:i,lastValue:n,beans:o}=this;if(r===n||(Ce(s)?i.textContent=s:Ce(r)?i.textContent=r:wr(i),(c=o.filterManager)!=null&&c.isSuppressFlashingCellsBecauseFiltering()))return!1;const a=r&&typeof r=="object"&&"toNumber"in r?r.toNumber():r,l=n&&typeof n=="object"&&"toNumber"in n?n.toNumber():n;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){const u=a-l;this.showDelta(e,u)}return n&&i.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=r,!0}},TH=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",kH={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},PH=class extends Rt{constructor(){super(kH),this.eCurrent=be,this.refreshCount=0,this.registerCSS(TH)}init(e){this.refresh(e,!0)}addSlideAnimation(){var i;this.refreshCount++;const e=this.refreshCount;(i=this.ePrevious)==null||i.remove();const{beans:t,eCurrent:r}=this,s=jr({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=s,s.textContent=r.textContent,this.getGui().insertBefore(s,r),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{var n;e===this.refreshCount&&((n=this.ePrevious)==null||n.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){var i;let r=e.value;if(ct(r)&&(r=""),r===this.lastValue||(i=this.beans.filterManager)!=null&&i.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=r;const s=this.eCurrent;return Ce(e.valueFormatted)?s.textContent=e.valueFormatted:Ce(e.value)?s.textContent=r:wr(s),!0}},DH=class extends ee{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,r=this.beans.gos.get("cellFlashDuration"),s=this.beans.gos.get("cellFadeDuration")){const i=this.animations[t];i.delete(e);const n=Date.now(),o=n+r,a=n+r+s,l={phase:"flash",flashEndTime:o,fadeEndTime:a};i.set(e,l);const c=`ag-cell-${t}`,u=`${c}-animation`,{comp:d,eGui:{style:h}}=e;d.toggleCss(c,!0),d.toggleCss(u,!1),h.removeProperty("transition"),h.removeProperty("transition-delay"),this.nextAnimationTime&&o+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),r)}),this.nextAnimationTime=o)}advanceAnimations(){const e=Date.now();let t=null;for(const r of Object.keys(this.animations)){const s=this.animations[r],i=`ag-cell-${r}`,n=`${i}-animation`;for(const[o,a]of s){if(!o.isAlive()||!o.comp){s.delete(o);continue}const{phase:l,flashEndTime:c,fadeEndTime:u}=a,d=l==="flash"?c:u;if(!(e+15>=d)){t=Math.min(d,t??1/0);continue}const{comp:f,eGui:{style:p}}=o;switch(l){case"flash":f.toggleCss(i,!1),f.toggleCss(n,!0),p.transition=`background-color ${u-c}ms`,p.transitionDelay=`${c-e}ms`,t=Math.min(u,t??1/0),a.phase="fade";break;case"fade":f.toggleCss(i,!1),f.toggleCss(n,!1),p.removeProperty("transition"),p.removeProperty("transition-delay"),s.delete(o);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;const r=rA(e.cellPosition);t.cells[r]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t==null?void 0:t.flashDuration,t==null?void 0:t.fadeDuration)}destroy(){for(const e of Object.keys(this.animations))this.animations[e].clear()}};function AH(e,t={}){const{cellFlashSvc:r}=e;r&&e.frameworkOverrides.wrapIncoming(()=>{for(const s of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))r.flashCell(s,t)})}var IH={moduleName:"HighlightChanges",version:we,beans:[DH],userComponents:{agAnimateShowChangeCellRenderer:EH,agAnimateSlideCellRenderer:PH},apiFunctions:{flashCells:AH}};function MH(e){var t;return((t=e.stateSvc)==null?void 0:t.getState())??{}}function _H(e,t,r){var s;return(s=e.stateSvc)==null?void 0:s.setState(t,r)}function Z0(e){return e={...e},e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=LH(e)),e.version=we,e}function LH(e){return e.cellSelection=OH(e,"rangeSelection"),e}function OH(e,t){if(e&&typeof e=="object")return e[t]}var NH=class extends ee{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=Wt(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=Wt(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=Wt(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){const{gos:e,ctrlsSvc:t,colDelayRenderSvc:r}=this.beans;this.isClientSideRowModel=wt(e);const s=Z0(e.get("initialState")??{}),i=s.partialColumnState;delete s.partialColumnState,this.cachedState=s;const n=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>n(()=>this.setupStateOnGridReady(s))),(s.columnOrder||s.columnVisibility||s.columnSizing||s.columnPinning||s.columnGroup)&&(r==null||r.hideColumns("columnState"));const[o,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:c})=>{c==="gridInitializing"&&(o(),n(()=>{this.setupStateOnColumnsInitialised(s,!!i),r==null||r.revealColumns("columnState")}))},rowCountReady:()=>{a==null||a(),n(()=>this.setupStateOnRowCountReady(s))},firstDataRendered:()=>{l==null||l(),n(()=>this.setupStateOnFirstDataRendered(s))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){const r=Z0(e);delete r.partialColumnState,this.cachedState=r,this.startSuppressEvents();const s="api",i=t?new Set(t):void 0;this.setGridReadyState(r,s,i),this.setColumnsInitialisedState(r,s,!!i,i),this.setRowCountState(r,s,i),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(r,s,i),this.stopSuppressEvents(s)})}setGridReadyState(e,t,r){var s,i;t==="api"&&!(r!=null&&r.has("sideBar"))&&((i=(s=this.beans.sideBar)==null?void 0:s.comp)==null||i.setState(e.sideBar)),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");const t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,r,s){this.setColumnState(e,t,r,s),this.setColumnGroupState(e,t,s),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);const r=s=>()=>this.updateColumnState([s]);this.addManagedEventListeners({columnValueChanged:r("aggregation"),columnMoved:r("columnOrder"),columnPinned:r("columnPinning"),columnResized:r("columnSizing"),columnVisible:r("columnVisibility"),columnPivotChanged:r("pivot"),columnPivotModeChanged:r("pivot"),columnRowGroupChanged:r("rowGroup"),sortChanged:r("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,r){const{filter:s,rowGroupExpansion:i,ssrmRowGroupExpansion:n,rowSelection:o,pagination:a,rowPinning:l}=e,c=(d,h)=>!(r!=null&&r.has(d))&&(h||t==="api");c("filter",s)&&this.setFilterState(s),c("rowGroupExpansion",i)&&this.setRowGroupExpansionState(n,i,t),c("rowSelection",o)&&this.setRowSelectionState(o,t),c("pagination",a)&&this.setPaginationState(a,t),c("rowPinning",l)&&this.setRowPinningState(l);const u=this.updateCachedState.bind(this);u("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(u("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),u("rowGroupExpansion",void 0)):(u("rowGroupExpansion",this.getRowGroupExpansionState()),u("ssrmRowGroupExpansion",void 0)),u("rowSelection",this.getRowSelectionState()),u("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");const t=this.updateCachedState.bind(this),r=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},s=()=>t("filter",this.getFilterState()),{gos:i,colFilter:n,selectableFilter:o}=this.beans;this.addManagedEventListeners({filterChanged:s,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:r,columnRowGroupChanged:r,rowDataUpdated:()=>{(i.get("groupDefaultExpanded")!==0||i.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(r)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:a=>{(a.newPage||a.newPageSize)&&t("pagination",this.getPaginationState())},pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())}),n&&this.addManagedListeners(n,{filterStateChanged:s}),o&&this.addManagedListeners(o,{selectedFilterChanged:s})}setFirstDataRenderedState(e,t,r){const{scroll:s,cellSelection:i,focusedCell:n,columnOrder:o}=e,a=(u,d)=>!(r!=null&&r.has(u))&&(d||t==="api");a("focusedCell",n)&&this.setFocusedCellState(n),a("cellSelection",i)&&this.setCellSelectionState(i),a("scroll",s)&&this.setScrollState(s),this.setColumnPivotState(!!(o!=null&&o.orderedColIds),t);const l=this.updateCachedState.bind(this);l("sideBar",this.getSideBarState()),l("focusedCell",this.getFocusedCellState());const c=this.getRangeSelectionState();l("rangeSelection",c),l("cellSelection",c),l("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");const t=this.updateCachedState.bind(this),r=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:r,cellFocusCleared:r,cellSelectionChanged:s=>{if(s.finished){const i=this.getRangeSelectionState();t("rangeSelection",i),t("cellSelection",i)}},bodyScrollEnd:()=>t("scroll",this.getScrollState())})}getColumnState(){const e=this.beans;return k4(Ic(e),e.colModel.isPivotMode())}setColumnState(e,t,r,s){const{sort:i,rowGroup:n,aggregation:o,pivot:a,columnPinning:l,columnVisibility:c,columnSizing:u,columnOrder:d}=e;let h=!1;const f=(_,I)=>{const z=!(s!=null&&s.has(_))&&!!(I||t==="api");return h||(h=z),z},p={},g=_=>{let I=p[_];return I||(I={colId:_},p[_]=I,I)},m={},v=f("sort",i);v&&(i==null||i.sortModel.forEach(({colId:_,sort:I},z)=>{const U=g(_);U.sort=I,U.sortIndex=z})),(v||!r)&&(m.sort=null,m.sortIndex=null);const w=f("rowGroup",n);w&&(n==null||n.groupColIds.forEach((_,I)=>{const z=g(_);z.rowGroup=!0,z.rowGroupIndex=I})),(w||!r)&&(m.rowGroup=null,m.rowGroupIndex=null);const C=f("aggregation",o);C&&(o==null||o.aggregationModel.forEach(({colId:_,aggFunc:I})=>{g(_).aggFunc=I})),(C||!r)&&(m.aggFunc=null);const y=f("pivot",a);y&&(a==null||a.pivotColIds.forEach((_,I)=>{const z=g(_);z.pivot=!0,z.pivotIndex=I}),this.gos.updateGridOptions({options:{pivotMode:!!(a!=null&&a.pivotMode)},source:t})),(y||!r)&&(m.pivot=null,m.pivotIndex=null);const b=f("columnPinning",l);if(b){for(const _ of(l==null?void 0:l.leftColIds)??[])g(_).pinned="left";for(const _ of(l==null?void 0:l.rightColIds)??[])g(_).pinned="right"}(b||!r)&&(m.pinned=null);const F=f("columnVisibility",c);if(F)for(const _ of(c==null?void 0:c.hiddenColIds)??[])g(_).hide=!0;(F||!r)&&(m.hide=null);const S=f("columnSizing",u);if(S)for(const{colId:_,flex:I,width:z}of(u==null?void 0:u.columnSizingModel)??[]){const U=g(_);U.flex=I??null,U.width=z}(S||!r)&&(m.flex=null);const D=d==null?void 0:d.orderedColIds,T=!!(D!=null&&D.length)&&!(s!=null&&s.has("columnOrder")),V=T?D.map(_=>g(_)):Object.values(p);(V.length||h)&&(this.columnStates=V,ts(this.beans,{state:V,applyOrder:T,defaultState:m},t))}setColumnPivotState(e,t){const r=this.columnStates;this.columnStates=void 0;const s=this.columnGroupStates;this.columnGroupStates=void 0;const i=this.beans,{pivotResultCols:n,colGroupSvc:o}=i;if(n!=null&&n.isPivotResultColsPresent()){if(r){const a=[];for(const l of r)n.getPivotResultCol(l.colId)&&a.push(l);ts(i,{state:a,applyOrder:e},t)}s&&(o==null||o.setColumnGroupState(s,t))}}getColumnGroupState(){const e=this.beans.colGroupSvc;if(!e)return;const t=e.getColumnGroupState();return P4(t)}setColumnGroupState(e,t,r){var a;const s=this.beans.colGroupSvc;if(!s||r!=null&&r.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const i=new Set((a=e.columnGroup)==null?void 0:a.openColumnGroupIds),o=s.getColumnGroupState().map(({groupId:l})=>{const c=i.has(l);return c&&i.delete(l),{groupId:l,open:c}});for(const l of i)o.push({groupId:l,open:!0});o.length&&(this.columnGroupStates=o),s.setColumnGroupState(o,t)}getFilterState(){const{filterManager:e,selectableFilter:t}=this.beans;let r=e==null?void 0:e.getFilterModel();r&&Object.keys(r).length===0&&(r=void 0);const s=e==null?void 0:e.getFilterState(),i=(e==null?void 0:e.getAdvFilterModel())??void 0,n=t==null?void 0:t.getState();return r||i||s||n?{filterModel:r,columnFilterState:s,advancedFilterModel:i,selectableFilters:n}:void 0}setFilterState(e){const{filterManager:t,selectableFilter:r}=this.beans,{filterModel:s,columnFilterState:i,advancedFilterModel:n,selectableFilters:o}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};o!==void 0&&(r==null||r.setState(o??{})),(s!==void 0||i!==void 0)&&(t==null||t.setFilterState(s??null,i??null,"columnFilter")),n!==void 0&&(t==null||t.setAdvFilterModel(n??null,"advancedFilter"))}getRangeSelectionState(){var t;const e=(t=this.beans.rangeSvc)==null?void 0:t.getCellRanges().map(r=>{const{id:s,type:i,startRow:n,endRow:o,columns:a,startColumn:l}=r;return{id:s,type:i,startRow:n,endRow:o,colIds:a.map(c=>c.getColId()),startColId:l.getColId()}});return e!=null&&e.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeSvc:r,colModel:s,visibleCols:i}=this.beans;if(!wi(t)||!r)return;const n=[];for(const o of(e==null?void 0:e.cellRanges)??[]){const a=[];for(const c of o.colIds){const u=s.getCol(c);u&&a.push(u)}if(!a.length)continue;let l=s.getCol(o.startColId);if(!l){const c=i.allCols,u=new Set(a);l=c.find(d=>u.has(d))}n.push({...o,columns:a,startColumn:l})}r.setCellRanges(n)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=(e==null?void 0:e.getHScrollPosition())??{left:0},{top:r}=(e==null?void 0:e.getVScrollPosition())??{top:0};return r||t?{top:r,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:r}=e??{top:0,left:0},{frameworkOverrides:s,rowRenderer:i,animationFrameSvc:n,ctrlsSvc:o}=this.beans;s.wrapIncoming(()=>{var a;o.get("center").setCenterViewportScrollLeft(r),(a=o.getScrollFeature())==null||a.setVerticalScrollPosition(t),i.redraw({afterScroll:!0}),n==null||n.flushAllFrames()})}getSideBarState(){var e,t;return(t=(e=this.beans.sideBar)==null?void 0:e.comp)==null?void 0:t.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.beans.focusSvc.getFocusedCell();if(e){const{column:t,rowIndex:r,rowPinned:s}=e;return{colId:t.getColId(),rowIndex:r,rowPinned:s}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{focusSvc:t,colModel:r}=this.beans;if(!e){t.clearFocusedCell();return}const{colId:s,rowIndex:i,rowPinned:n}=e;t.setFocusedCell({column:r.getCol(s),rowIndex:i,rowPinned:n,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const{pagination:e,gos:t}=this.beans;if(!e)return;const r=e.getCurrentPage(),s=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!r&&!s))return{page:r,pageSize:s}}setPaginationState(e,t){const{pagination:r,gos:s}=this.beans;if(!r)return;const{pageSize:i,page:n}=e??{page:0,pageSize:s.get("paginationPageSize")},o=t==="gridInitializing";i&&!s.get("paginationAutoPageSize")&&r.setPageSize(i,o?"initialState":"pageSizeSelector"),typeof n=="number"&&(o?r.setPage(n):r.goToPage(n))}getRowSelectionState(){var s;const e=this.beans.selectionSvc;if(!e)return;const t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!((s=t==null?void 0:t.toggledNodes)!=null&&s.length)?void 0:t}setRowSelectionState(e,t){var r;(r=this.beans.selectionSvc)==null||r.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){const{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){var e;return(e=this.beans.pinnedRowModel)==null?void 0:e.getPinnedState()}setRowPinningState(e){const t=this.beans.pinnedRowModel;e?t==null||t.setPinnedState(e):t==null||t.reset()}setRowGroupExpansionState(e,t,r){const s=this.beans.expansionSvc;if(!s)return;const i=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};s.setExpansionState(i,r)}updateColumnState(e){const t=this.getColumnState();let r=!1;const s=this.cachedState;for(const i of Object.keys(t)){const n=t[i];ma(n,s[i])||(r=!0)}this.cachedState={...s,...t},r&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const r=this.cachedState[e];this.setCachedStateValue(e,t),ma(t,r)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){const e=this.staleStateKeys;for(const t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(const t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){const e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){var e;this.suppressEvents=!0,(e=this.beans.colAnimation)==null||e.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{var t;this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&((t=this.beans.colAnimation)==null||t.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},BH={moduleName:"GridState",version:we,beans:[NH],apiFunctions:{getState:MH,setState:_H}};function HH(e){return e.rowModel.isLastRowIndexKnown()}function VH(e){var t;return((t=e.pagination)==null?void 0:t.getPageSize())??100}function GH(e){var t;return((t=e.pagination)==null?void 0:t.getCurrentPage())??0}function WH(e){var t;return((t=e.pagination)==null?void 0:t.getTotalPages())??1}function zH(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function UH(e){var t;(t=e.pagination)==null||t.goToNextPage()}function jH(e){var t;(t=e.pagination)==null||t.goToPreviousPage()}function $H(e){var t;(t=e.pagination)==null||t.goToFirstPage()}function KH(e){var t;(t=e.pagination)==null||t.goToLastPage()}function qH(e,t){var r;(r=e.pagination)==null||r.goToPage(t)}var XH=class extends ee{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){const t=this.beans,r=()=>{const s=Math.max(qi(t),1),i=Math.floor(e/s);t.pagination.setPageSize(i,"autoCalculated")};this.isBodyRendered?Wt(this,r,50)():(r(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},Ho="paginationPageSizeSelector",YH={tag:"span",cls:"ag-paging-page-size"},JH=class extends Rt{constructor(){super(YH),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(Ho,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!(e!=null&&e.newPageSize))return;const t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){wr(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(Ho)!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),r=!t||!e.includes(t);if(r){const i=this.gos.exists("paginationPageSize"),n=this.gos.get(Ho)!==!0;oe(94,{pageSizeSet:i,pageSizesSet:n,pageSizeOptions:e,paginationPageSizeOption:t}),n||oe(95,{paginationPageSizeOption:t,paginationPageSizeSelector:Ho}),e.unshift("")}const s=String(r?"":t);this.selectPageSizeComp?(Ei(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(s,!0)):this.createPageSizeSelectorComp(e,s),this.hasEmptyOption=r}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){const r=this.getLocaleTextFunc(),s=r("pageSizeSelectorLabel","Page Size:"),i=r("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new Of).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(i).setLabel(s).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(Ho);return!Array.isArray(t)||!(t!=null&&t.length)?e:[...t].sort((r,s)=>r-s)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},ZH={selector:"AG-PAGE-SIZE-SELECTOR",component:JH},QH=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",e5=class extends JA{constructor(){super(),this.btFirst=be,this.btPrevious=be,this.btNext=be,this.btLast=be,this.lbRecordCount=be,this.lbFirstRowOnPage=be,this.lbLastRowOnPage=be,this.lbCurrent=be,this.lbTotal=be,this.pageSizeComp=be,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(QH)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[ZH]);const{btFirst:t,btPrevious:r,btNext:s,btLast:i}=this;this.activateTabIndex([t,r,s,i]),t.insertAdjacentElement("afterbegin",vr(e?"last":"first",this.beans)),r.insertAdjacentElement("afterbegin",vr(e?"next":"previous",this.beans)),s.insertAdjacentElement("afterbegin",vr(e?"previous":"next",this.beans)),i.insertAdjacentElement("afterbegin",vr(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:n=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(n):uA(this.beans,n),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(const e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){const{el:t,fn:r}=e;this.addManagedListeners(t,{click:r,keydown:s=>{(s.key===K.ENTER||s.key===K.SPACE)&&(s.preventDefault(),r())}})}cA(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):A4(e,this.getLocaleTextFunc.bind(this))}getTemplate(){const e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){const e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),r=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const s=this.isZeroPagesToDisplay(),i=e===r-1;this.nextButtonDisabled=i||s,this.lastButtonDisabled=!t||s||e===r-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){mT(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),r=this.pagination.getMasterRowCount(),s=e?r:null,i=this.pagination.getCurrentPage(),n=this.pagination.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=n*i+1,a=o+n-1,e&&a>s&&(a=s));const l=o+n-1,c=!e&&r<l,u=this.formatNumber(o);this.lbFirstRowOnPage.textContent=u;let d;const h=this.getLocaleTextFunc();c?d=h("pageLastRowUnknown","?"):d=this.formatNumber(a),this.lbLastRowOnPage.textContent=d;const p=t>0?i+1:0,g=this.formatNumber(p);this.lbCurrent.textContent=g;let m,v;if(e)m=this.formatNumber(t),v=this.formatNumber(s);else{const w=h("more","more");m=w,v=w}this.lbTotal.textContent=m,this.lbRecordCount.textContent=v,this.announceAriaStatus(u,d,v,g,m)}announceAriaStatus(e,t,r,s,i){var d,h;const n=this.getLocaleTextFunc(),o=n("page","Page"),a=n("to","to"),l=n("of","of"),c=`${e} ${a} ${t} ${l} ${r}`,u=`${o} ${s} ${l} ${i}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,(d=this.ariaAnnounce)==null||d.announceValue(c,"paginationRow")),u!==this.ariaPageStatus&&(this.ariaPageStatus=u,(h=this.ariaAnnounce)==null||h.announceValue(u,"paginationPage"))}},t5={selector:"AG-PAGINATION",component:e5},r5=class extends ee{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){const e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return t5}isPaginateChildRows(){const e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){const t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;const{editSvc:r}=this.beans;r!=null&&r.isEditing()&&(r.isBatchEditing()?r.cleanupEditors():r.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){var r,s;if(!this.active)return;let t=e;this.paginateChildRows||(t=((s=(r=this.beans.rowModel).getTopLevelIndexFromDisplayedIndex)==null?void 0:s.call(r,e))??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return Ce(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:Ce(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:Ce(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:Ce(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const r=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}r!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){const e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);const t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){const e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}const r=this.pageSize,s=t-1;this.totalPages=Math.floor(s/r)+1,this.adjustCurrentPageIfInvalid();const i=this.currentPage,n=r*i;let o=r*(i+1)-1;if(o>s&&(o=s),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(n),o===s)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{const a=e.getTopLevelRowDisplayedIndex(o+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){const e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}const{pageSize:t,currentPage:r}=this,s=e-1;this.totalPages=Math.floor(s/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*r,this.bottomDisplayedRowIndex=t*(r+1)-1,this.bottomDisplayedRowIndex>s&&(this.bottomDisplayedRowIndex=s)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:r=!1,newPageSize:s=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:r,newPageSize:s,keepRenderedRows:t})}},s5={moduleName:"Pagination",version:we,beans:[r5,XH],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:HH,paginationGetPageSize:VH,paginationGetCurrentPage:GH,paginationGetTotalPages:WH,paginationGetRowCount:zH,paginationGoToNextPage:UH,paginationGoToPreviousPage:jH,paginationGoToFirstPage:$H,paginationGoToLastPage:KH,paginationGoToPage:qH},dependsOn:[ku]};function i5(e,t={}){const r=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(r))}function i1(e,t,r,s,i){t&&(s&&t.parent&&t.parent.level!==-1&&i1(e,t.parent,r,s,i),t.setExpanded(r,void 0,i))}function n5(e,t){return e.rowModel.getRowNode(t)}function o5(e,t,r,s){e.rowRenderer.addRenderedRowListener(t,r,s)}function a5(e){return e.rowRenderer.getRenderedNodes()}function l5(e,t,r){e.rowModel.forEachNode(t,r)}function c5(e){return e.rowRenderer.firstRenderedRow}function u5(e){return e.rowRenderer.lastRenderedRow}function d5(e,t){return e.rowModel.getRow(t)}function h5(e){return e.rowModel.getRowCount()}var f5={moduleName:"RowApi",version:we,apiFunctions:{redrawRows:i5,setRowNodeExpanded:i1,getRowNode:n5,addRenderedRowListener:o5,getRenderedNodes:a5,forEachNode:l5,getFirstDisplayedRowIndex:c5,getLastDisplayedRowIndex:u5,getDisplayedRowAtIndex:d5,getDisplayedRowCount:h5}},g5={moduleName:"ScrollApi",version:we,apiFunctions:{getVerticalPixelRange:R3,getHorizontalPixelRange:E3,ensureColumnVisible:Ux,ensureIndexVisible:jx,ensureNodeVisible:T3}};function p5(e,t,r){if(!t)return;const s=e.ctrlsSvc.getGridBodyCtrl().eGridBody,i=`aria-${t}`;r===null?s.removeAttribute(i):s.setAttribute(i,r)}function m5(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function v5(e){e.frameworkOverrides.wrapIncoming(()=>{for(const t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function C5(e){var t;return((t=e.animationFrameSvc)==null?void 0:t.isQueueEmpty())??!0}function w5(e){var t;(t=e.animationFrameSvc)==null||t.flushAllFrames()}function x5(e){return{rowHeight:qi(e),headerHeight:Ja(e)}}function y5(e,t={}){var n;const r=[];for(const o of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){const a=o.getCellRenderer();a!=null&&r.push(ba(a))}if((n=t.columns)!=null&&n.length)return r;const s=[],i=Mh(t.rowNodes);for(const o of e.rowRenderer.getAllRowCtrls()){if(i&&!_h(o.rowNode,i)||!o.isFullWidth())continue;const a=o.getFullWidthCellRenderers();for(let l=0;l<a.length;l++){const c=a[l];c!=null&&s.push(ba(c))}}return[...s,...r]}var S5={moduleName:"RenderApi",version:we,apiFunctions:{setGridAriaProperty:p5,refreshCells:m5,refreshHeader:v5,isAnimationFrameQueueEmpty:C5,flushAllAnimationFrames:w5,getSizesForCurrentTheme:x5,getCellRendererInstances:y5}},b5=":where(.ag-ltr) :where(.ag-animate-autosize){.ag-cell,.ag-header-cell,.ag-header-group-cell{transition:width .2s ease-in-out,left .2s ease-in-out}}:where(.ag-rtl) :where(.ag-animate-autosize){.ag-cell,.ag-header-cell,.ag-header-group-cell{transition:width .2s ease-in-out,right .2s ease-in-out}}";function F5(e,t){var r,s;typeof t=="number"?(r=e.colAutosize)==null||r.sizeColumnsToFit(t,"api"):(s=e.colAutosize)==null||s.sizeColumnsToFitGridBody(t)}function n1({colAutosize:e,visibleCols:t},r,s){Array.isArray(r)?e==null||e.autoSizeCols({colKeys:r,skipHeader:s,source:"api"}):e==null||e.autoSizeCols({...r,colKeys:r.colIds??t.allCols,source:"api"})}function R5(e,t){var r;t&&typeof t=="object"?n1(e,t):(r=e.colAutosize)==null||r.autoSizeAllColumns({source:"api",skipHeader:t})}var E5=class extends ee{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){var r;const{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let s=!1;const i=t.type;if(i==="fitGridWidth"||i==="fitProvidedWidth")s=!0;else if(i==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});const n=e.get("rowData");s=n!=null&&n.length>0&&wt(e)}s&&((r=this.beans.colDelayRenderSvc)==null||r.hideColumns(i))}}autoSizeCols(e){const{eventSvc:t,visibleCols:r,colModel:s}=this.beans;Vo(this.beans,!0),this.innerAutoSizeCols(e).then(i=>{var u;const n=d=>uo(t,Array.from(d),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return Vo(this.beans,!1),n(i);const o=Q0(this.beans),a=d=>r.leftCols.some(h=>Qo(h,d)),l=d=>r.rightCols.some(h=>Qo(h,d)),c=e.colKeys.filter(d=>{var f;return!((f=s.getCol(d))!=null&&f.getColDef().suppressAutoSize)&&!Gs(d)&&!a(d)&&!l(d)});this.sizeColumnsToFit(o,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:(u=e.columnLimits)==null?void 0:u.map(d=>({...d,key:d.colId})),colKeys:c,onlyScaleUp:!0,animate:!1}),Vo(this.beans,!1),n(i)})}innerAutoSizeCols(e){return new Promise((t,r)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,r));const{colKeys:s,skipHeader:i,skipHeaderGroups:n,stopAtGroup:o,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:c=[],source:u="api"}=e,{animationFrameSvc:d,renderStatus:h,colModel:f,autoWidthCalc:p,visibleCols:g}=this.beans;if(d==null||d.flushAllFrames(),this.timesDelayed<5&&h&&(!h.areHeaderCellsRendered()||!h.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,r)});return}this.timesDelayed=0;const m=new Set;let v=-1;const w=Object.fromEntries(c.map(({colId:b,...F})=>[b,F])),C=i??this.gos.get("skipHeaderOnAutoSize"),y=n??C;for(;v!==0;){v=0;const b=[];for(const F of s){if(!F||A2(F))continue;const S=f.getCol(F);if(!S||m.has(S)||S.getColDef().suppressAutoSize)continue;const D=p.getPreferredWidthForColumn(S,C);if(D>0){const T=w[S.colId]??{};T.minWidth??(T.minWidth=l),T.maxWidth??(T.maxWidth=a);const V=T5(S,D,T);S.setActualWidth(V,u),m.add(S),v++}b.push(S)}b.length&&g.refresh(u)}y||this.autoSizeColumnGroupsByColumns(s,u,o),t(m)})}autoSizeColumn(e,t,r){this.autoSizeCols({colKeys:[e],skipHeader:r,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,r){const{colModel:s,ctrlsSvc:i}=this.beans,n=new Set,o=s.getColsForKeys(e);for(const l of o){let c=l.getParent();for(;c&&c!=r;)c.isPadding()||n.add(c),c=c.getParent()}let a;for(const l of n){for(const c of i.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(l),a)break;a==null||a.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols({colKeys:this.beans.visibleCols.allCols,...e})}addColumnAutosizeListeners(e,t){const r=this.gos.get("skipHeaderOnAutoSize"),s=()=>{this.autoSizeColumn(t,"uiColumnResized",r)};e.addEventListener("dblclick",s);const i=new Hi(e);return i.addEventListener("doubleTap",s),()=>{e.removeEventListener("dblclick",s),i.destroy()}}addColumnGroupResize(e,t,r){const s=this.gos.get("skipHeaderOnAutoSize"),i=()=>{const n=[],o=t.getDisplayedLeafColumns();for(const a of o)a.getColDef().suppressAutoSize||n.push(a.getColId());n.length>0&&this.autoSizeCols({colKeys:n,skipHeader:s,stopAtGroup:t,source:"uiColumnResized"}),r()};return e.addEventListener("dblclick",i),()=>e.removeEventListener("dblclick",i)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;const r=Q0(this.beans);if(r>0){this.sizeColumnsToFit(r,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):oe(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",r,s){var m,v;if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,r,s));return}const{beans:i}=this,n=(s==null?void 0:s.animate)??!0;n&&Vo(i,!0);const o={};for(const{key:w,...C}of(s==null?void 0:s.columnLimits)??[])o[typeof w=="string"?w:w.getColId()]=C;const a=i.visibleCols.allCols;if(e<=0||!a.length)return;const l=Ls(a);if(s!=null&&s.onlyScaleUp&&l>e||e===l&&a.every(C=>{if(C.colDef.suppressSizeToFit)return!0;const y=o==null?void 0:o[C.getId()],b=(y==null?void 0:y.minWidth)??(s==null?void 0:s.defaultMinWidth),F=(y==null?void 0:y.maxWidth)??(s==null?void 0:s.defaultMaxWidth),S=C.getActualWidth();return(b==null||S>=b)&&(F==null||S<=F)}))return;const u=[],d=[];for(const w of a){const C=((m=s==null?void 0:s.colKeys)==null?void 0:m.some(y=>Qo(w,y)))??!0;w.getColDef().suppressSizeToFit||!C?d.push(w):u.push(w)}const h=u.slice(0);let f=!1;const p=w=>{Es(u,w),d.push(w)};for(const w of u){w.resetActualWidth(t);const C=o==null?void 0:o[w.getId()],y=(C==null?void 0:C.minWidth)??(s==null?void 0:s.defaultMinWidth),b=(C==null?void 0:C.maxWidth)??(s==null?void 0:s.defaultMaxWidth),F=w.getActualWidth();typeof y=="number"&&F<y?w.setActualWidth(y,t,!0):typeof b=="number"&&F>b&&w.setActualWidth(b,t,!0)}for(;!f;){f=!0;const w=e-Ls(d);if(w<=0)for(const C of u){const y=((v=o==null?void 0:o[C.getId()])==null?void 0:v.minWidth)??(s==null?void 0:s.defaultMinWidth)??C.minWidth;C.setActualWidth(y,t,!0)}else{const C=w/Ls(u);let y=w;for(let b=u.length-1;b>=0;b--){const F=u[b],S=o==null?void 0:o[F.getId()],D=(S==null?void 0:S.minWidth)??(s==null?void 0:s.defaultMinWidth),T=(S==null?void 0:S.maxWidth)??(s==null?void 0:s.defaultMaxWidth),V=F.getMinWidth(),_=F.getMaxWidth(),I=typeof D=="number"&&D>V?D:V,z=typeof T=="number"&&T<_?T:_;let U=Math.round(F.getActualWidth()*C);U<I?(U=I,p(F),f=!1):U>z?(U=z,p(F),f=!1):b===0&&(U=y),F.setActualWidth(U,t,!0),y-=U}}}for(const w of h)w.fireColumnWidthChangedEvent(t);const g=i.visibleCols;g.setLeftValues(t),g.updateBodyWidths(),!r&&(uo(this.eventSvc,h,!0,t),n&&Vo(i,!1))}applyAutosizeStrategy(){const{gos:e,colDelayRenderSvc:t}=this.beans,r=e.get("autoSizeStrategy");(r==null?void 0:r.type)!=="fitGridWidth"&&(r==null?void 0:r.type)!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;const s=r.type;if(s==="fitGridWidth"){const{columnLimits:i,defaultMinWidth:n,defaultMaxWidth:o}=r,a=i==null?void 0:i.map(({colId:l,minWidth:c,maxWidth:u})=>({key:l,minWidth:c,maxWidth:u}));this.sizeColumnsToFitGridBody({defaultMinWidth:n,defaultMaxWidth:o,columnLimits:a})}else s==="fitProvidedWidth"&&this.sizeColumnsToFit(r.width,"sizeColumnsToFit");t==null||t.revealColumns(s)})}onFirstDataRendered({colIds:e,...t}){setTimeout(()=>{var s;if(!this.isAlive())return;const r="autosizeColumns";e?this.autoSizeCols({...t,source:r,colKeys:e}):this.autoSizeAllColumns({...t,source:r}),(s=this.beans.colDelayRenderSvc)==null||s.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(const e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function T5(e,t,r={}){const s=r.minWidth??e.getMinWidth();t<s&&(t=s);const i=r.maxWidth??e.getMaxWidth();return t>i&&(t=i),t}function Q0({ctrlsSvc:e,scrollVisibleSvc:t}){const r=e.getGridBodyCtrl(),i=r.isVerticalScrollShowing()?t.getScrollbarWidth():0;return wa(r.eGridBody)-i}var em="ag-animate-autosize";function Vo({ctrlsSvc:e,gos:t},r){if(!t.get("animateColumnResizing")||t.get("enableRtl")||!e.isAlive())return;const s=e.getGridBodyCtrl().eGridBody.classList;r?s.add(em):s.remove(em)}var k5={moduleName:"ColumnAutoSize",version:we,beans:[E5],apiFunctions:{sizeColumnsToFit:F5,autoSizeColumns:n1,autoSizeAllColumns:R5},dependsOn:[ax],css:[b5]},P5=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function D5(e){var t;return((t=e.pinnedRowModel)==null?void 0:t.getPinnedTopRowCount())??0}function A5(e){var t;return((t=e.pinnedRowModel)==null?void 0:t.getPinnedBottomRowCount())??0}function I5(e,t){var r;return(r=e.pinnedRowModel)==null?void 0:r.getPinnedTopRow(t)}function M5(e,t){var r;return(r=e.pinnedRowModel)==null?void 0:r.getPinnedBottomRow(t)}function _5(e,t,r){var s;return(s=e.pinnedRowModel)==null?void 0:s.forEachPinnedRow(t,r)}var L5={moduleName:"PinnedRow",version:we,beans:[UA],css:[P5],apiFunctions:{getPinnedTopRowCount:D5,getPinnedBottomRowCount:A5,getPinnedTopRow:I5,getPinnedBottomRow:M5,forEachPinnedRow:_5},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},O5=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){var r;const e=(r=this.firstNode.__autoHeights)==null?void 0:r[this.col.getColId()];if(e==null)return;let t=0;for(const s of this.spannedNodes)s!==this.lastNode&&(t+=s.rowHeight);return e-t}},N5=class extends ee{constructor(e){super(),this.column=e}buildCache(e){var C;const{column:t,beans:{gos:r,pinnedRowModel:s,rowModel:i,valueSvc:n,pagination:o}}=this,{colDef:a}=t,l=this.getNodeMap(e),c=new Map,u=r.getCallback("isFullWidthRow"),d=a.equals,h=a.spanRows,f=typeof h=="function";let p=null,g=null,m;const v=(y,b)=>{p=y,g=null,m=b},w=y=>{const b=!y.isExpandable()&&!y.group&&!y.detail&&(u?!u({rowNode:y}):!0);if(y.rowIndex==null||!b){v(null,null);return}if(p==null||y.level!==p.level||y.footer||g&&y.rowIndex-1!==(g==null?void 0:g.getLastNode().rowIndex)){v(y,n.getValue(t,y));return}const F=n.getValue(t,y);if(f){const S=ke(r,{valueA:m,nodeA:p,valueB:F,nodeB:y,column:t,colDef:a});if(!h(S)){v(y,F);return}}else if(d?!d(m,F):m!==F){v(y,F);return}if(!g){const S=l==null?void 0:l.get(p);(S==null?void 0:S.firstNode)===p?(S.reset(),g=S):g=new O5(t,p),c.set(p,g)}g.addSpannedNode(y),c.set(y,g)};switch(e){case"center":(C=i.forEachDisplayedNode)==null||C.call(i,y=>{(!o||o.isRowInPage(y.rowIndex))&&w(y)}),this.centerValueNodeMap=c;break;case"top":s==null||s.forEachPinnedRow("top",w),this.topValueNodeMap=c;break;case"bottom":s==null||s.forEachPinnedRow("bottom",w),this.bottomValueNodeMap=c;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},B5=class extends ee{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=Wt(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=Wt(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){const e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){const{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;const r=this.createManagedBean(new N5(e));this.spanningColumns.set(e,r),r.buildCache("top"),r.buildCache("bottom"),r.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){const{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t==null||t.createCtrls("top"),t==null||t.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t==null||t.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){const r=this.spanningColumns.get(e);return r?r.isCellSpanning(t):!1}getCellSpanByPosition(e){const{pinnedRowModel:t,rowModel:r}=this.beans,s=e.column,i=e.rowIndex,n=this.spanningColumns.get(s);if(!n)return;let o;switch(e.rowPinned){case"top":o=t==null?void 0:t.getPinnedTopRow(i);break;case"bottom":o=t==null?void 0:t.getPinnedBottomRow(i);break;default:o=r.getRow(i)}if(o)return n.getCellSpan(o)}getCellStart(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.firstNode.rowIndex}:e}getCellEnd(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.getLastNode().rowIndex}:e}getCellSpan(e,t){const r=this.spanningColumns.get(e);if(r)return r.getCellSpan(t)}forEachSpannedColumn(e,t){for(const[r,s]of this.spanningColumns)if(s.isCellSpanning(e)){const i=s.getCellSpan(e);t(r,i)}}destroy(){super.destroy(),this.spanningColumns.clear()}},H5=class extends ro{constructor(e,t,r){super(e.col,e.firstNode,r,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,r,s,i,n,o){this.eWrapper=r,super.setComp(e,t,r,s,i,n,o),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){const{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||gC(e,t.rowIndex)}setAriaRowSpan(){xT(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){const e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){const{beans:t}=this;if(Fu(t)){this.focusedCellPosition=void 0;return}const r=this.isCellFocused();r||(this.focusedCellPosition=void 0),e&&r&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},V5=class extends Gc{onRowIndexChanged(){super.onRowIndexChanged();for(const e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){var s;const t=(s=this.beans.rowSpanSvc)==null?void 0:s.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new H5(t,this,this.beans)}isCorrectCtrlForSpan(e){var s;const t=(s=this.beans.rowSpanSvc)==null?void 0:s.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},G5=class extends ee{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){const{rowSpanSvc:t}=this.beans,r=this.getCtrlsMap(e),s=r.size,i=this.getAllRelevantRowControls(e),n=new Map;let o=!1;for(const l of i)l.isAlive()&&(t==null||t.forEachSpannedColumn(l.rowNode,(c,u)=>{if(n.has(u.firstNode))return;const d=r.get(u.firstNode);if(d){n.set(u.firstNode,d),r.delete(u.firstNode);return}o=!0;const h=new V5(u.firstNode,this.beans,!1,!1,!1);n.set(u.firstNode,h)}));this.setCtrlsMap(e,n);const a=n.size===s;if(!(!o&&a)){for(const l of r.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){const{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){const{rowSpanSvc:t}=this.beans,r=t==null?void 0:t.getCellSpanByPosition(e);if(!r)return;const s=this.getCtrlsMap(e.rowPinned).get(r.firstNode);if(s)return s.getAllCellCtrls().find(i=>i.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(const t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},W5={moduleName:"CellSpan",version:we,beans:[B5,G5]},z5=class extends ee{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const{column:e,cellComp:t}=this,r=e.colDef,s=r.cellClassRules,i=this.getCellClassParams(e,r);eg(this.beans.expressionSvc,s===this.cellClassRules?void 0:this.cellClassRules,s,i,n=>t.toggleCss(n,!0),n=>t.toggleCss(n,!1)),this.cellClassRules=s}applyUserStyles(){const e=this.column,t=e.colDef,r=t.cellStyle;if(!r)return;let s;if(typeof r=="function"){const i=this.getCellClassParams(e,t);s=r(i)}else s=r;s&&this.cellComp.setUserStyles(s)}applyClassesFromColDef(){const{column:e,cellComp:t}=this,r=e.colDef,s=this.getCellClassParams(e,r);for(const n of this.staticClasses)t.toggleCss(n,!1);const i=this.beans.cellStyles.getStaticCellClasses(r,s);this.staticClasses=i;for(const n of i)t.toggleCss(n,!0)}getCellClassParams(e,t){const{value:r,rowNode:s}=this.cellCtrl;return ke(this.beans.gos,{value:r,data:s.data,node:s,colDef:t,column:e,rowIndex:s.rowIndex})}},U5=class extends ee{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,r,s){eg(this.beans.expressionSvc,void 0,e.cellClassRules,t,r,s),this.processStaticCellClasses(e,t,r)}getStaticCellClasses(e,t){const{cellClass:r}=e;if(!r)return[];let s;return typeof r=="function"?s=r(t):s=r,typeof s=="string"&&(s=[s]),s||[]}createCellCustomStyleFeature(e){return new z5(e,this.beans)}processStaticCellClasses(e,t,r){this.getStaticCellClasses(e,t).forEach(i=>{r(i)})}},j5={moduleName:"CellStyle",version:we,beans:[U5]},$5={moduleName:"RowStyle",version:we,beans:[CO]};function K5(e,t){var r;return!!((r=e.colHover)!=null&&r.isHovered(t))}var q5=class extends ee{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=r=>{const{beans:s,gos:i,element:n,columns:o}=this,a=s.colHover;if(r??!!i.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(n,{mouseover:a.setMouseOver.bind(a,o),mouseout:a.clearMouseOver.bind(a)});else{for(const c of this.destroyManagedListeners)c();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},X5="ag-column-hover",Y5=class extends ee{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;const t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,r){const s=()=>{const i=this.isHovered(r);t.toggleCss("ag-column-hover",i)};e.addManagedEventListeners({columnHoverChanged:s}),s()}onCellColumnHover(e,t){if(!t)return;const r=this.isHovered(e);t.toggleCss(X5,r)}addHeaderFilterColumnHoverListener(e,t,r,s){this.createHoverFeature(e,[r],s);const i=()=>{const n=this.isHovered(r);t.toggleCss("ag-column-hover",n)};e.addManagedEventListeners({columnHoverChanged:i}),i()}createHoverFeature(e,t,r){e.createManagedBean(new q5(t,r))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},J5={moduleName:"ColumnHover",version:we,beans:[Y5],apiFunctions:{isColumnHovered:K5}},Z5=class extends ee{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){var e,t;this.wrapSvc=(t=(e=this.beans.frameworkOverrides).createGlobalEventListenerWrapper)==null?void 0:t.call(e)}addListener(e,t){var n;const r=((n=this.wrapSvc)==null?void 0:n.wrap(e,t))??t,s=!nc.has(e),i=s?this.asyncListeners:this.syncListeners;i.has(e)||i.set(e,new Set),i.get(e).add(r),this.eventSvc.addListener(e,r,s)}removeListener(e,t){var n,o;const r=((n=this.wrapSvc)==null?void 0:n.unwrap(e,t))??t,s=this.asyncListeners.get(e),i=!!(s!=null&&s.delete(r));i||(o=this.syncListeners.get(e))==null||o.delete(r),this.eventSvc.removeListener(e,r,i)}addGlobalListener(e){var n;const t=((n=this.wrapSvc)==null?void 0:n.wrapGlobal(e))??e,r=(o,a)=>{nc.has(o)&&t(o,a)},s=(o,a)=>{nc.has(o)||t(o,a)};this.globalListenerPairs.set(e,{syncListener:r,asyncListener:s});const i=this.eventSvc;i.addGlobalListener(r,!1),i.addGlobalListener(s,!0)}removeGlobalListener(e){const{eventSvc:t,wrapSvc:r,globalListenerPairs:s}=this,i=(r==null?void 0:r.unwrapGlobal(e))??e;if(s.has(i)){const{syncListener:o,asyncListener:a}=s.get(i);t.removeGlobalListener(o,!1),t.removeGlobalListener(a,!0),s.delete(e)}else this.syncGlobalListeners.delete(i),t.removeGlobalListener(i,!1)}destroyEventListeners(e,t){e.forEach((r,s)=>{r.forEach(i=>this.eventSvc.removeListener(s,i,t)),r.clear()}),e.clear()}destroyGlobalListeners(e,t){for(const r of e)this.eventSvc.removeGlobalListener(r,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);const{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:r,asyncListener:s})=>{t.removeGlobalListener(r,!1),t.removeGlobalListener(s,!0)}),e.clear()}};function Q5(e,t,r){var s;(s=e.apiEventSvc)==null||s.addListener(t,r)}function e6(e,t,r){var s;(s=e.apiEventSvc)==null||s.removeListener(t,r)}function t6(e,t){var r;(r=e.apiEventSvc)==null||r.addGlobalListener(t)}function r6(e,t){var r;(r=e.apiEventSvc)==null||r.removeGlobalListener(t)}var s6={moduleName:"EventApi",version:we,apiFunctions:{addEventListener:Q5,addGlobalListener:t6,removeEventListener:e6,removeGlobalListener:r6},beans:[Z5]},i6={moduleName:"Locale",version:we,beans:[T4]},n6=class extends ee{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=Wt(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){var a,l,c,u;const{visibleCols:e,rowModel:t,rowSpanSvc:r,pinnedRowModel:s}=this.beans,i=e.autoHeightCols;let n=!1;const o=d=>{var p;const h=d.__autoHeights;let f=Ci(this.beans,d).height;for(const g of i){let m=h==null?void 0:h[g.getColId()];const v=r==null?void 0:r.getCellSpan(g,d);if(v){if(v.getLastNode()!==d)continue;if(m=(p=r==null?void 0:r.getCellSpan(g,d))==null?void 0:p.getLastNodeAutoHeight(),!m)return}if(m==null){if(this.colSpanSkipCell(g,d))continue;return}f=Math.max(m,f)}f!==d.rowHeight&&(d.setRowHeight(f),n=!0)};(a=s==null?void 0:s.forEachPinnedRow)==null||a.call(s,"top",o),(l=s==null?void 0:s.forEachPinnedRow)==null||l.call(s,"bottom",o),(c=t.forEachDisplayedNode)==null||c.call(t,o),n&&((u=t.onRowHeightChanged)==null||u.call(t))}setRowAutoHeight(e,t,r){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[r.getId()];return}const s=e.__autoHeights[r.getId()];e.__autoHeights[r.getId()]=t,s!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){const{colModel:r,colViewport:s,visibleCols:i}=this.beans;if(!r.colSpanActive)return!1;let n=[];switch(e.getPinned()){case"left":n=i.getLeftColsForRow(t);break;case"right":n=i.getRightColsForRow(t);break;case null:n=s.getColsWithinViewport(t);break}return!n.includes(e)}setupCellAutoHeight(e,t,r){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;const s=t.parentElement,{rowNode:i,column:n}=e,o=this.beans,a=u=>{var w;if((w=this.beans.editSvc)!=null&&w.isEditing(e)||!e.isAlive()||!r.isAlive())return;const{paddingTop:d,paddingBottom:h,borderBottomWidth:f,borderTopWidth:p}=wn(s),g=d+h+f+p,v=t.offsetHeight+g;if(u<5){const C=Gt(o),y=!(C!=null&&C.contains(t)),b=v==0;if(y||b){window.setTimeout(()=>a(u+1),0);return}}this.setRowAutoHeight(i,v,n)},l=()=>a(0);l();const c=ei(o,t,l);return r.addDestroyFunc(()=>{c(),this.setRowAutoHeight(i,void 0,n)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;const e=this.beans.rowRenderer.getAllRowCtrls();let t=null;for(const{rowNode:r}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(r).filter(i=>i.isAutoHeight())),t.length!==0){if(!r.__autoHeights)return!1;for(const s of t){const i=r.__autoHeights[s.getColId()];if(!i||r.rowHeight<i)return!1}}return!0}},o6={moduleName:"RowAutoHeight",version:we,beans:[n6]},a6={moduleName:"AllCommunity",version:we,dependsOn:[iH,hH,SH,$4,iB,nB,oB,aB,lB,cB,uB,sB,YN,JN,ZN,XN,e3,t3,BH,OB,s5,lx,f5,g5,S5,k5,_I,L5,EB,c4,j5,J5,$5,s6,h4,IH,zx,i6,o6,MI,nH,W5]},nr=he.createContext({}),o1=he.createContext("default"),el=(e,t,r,s)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const n=e.newAgStackInstance();let o,a,l=!1;return n.then(c=>{if(l){t.destroyBean(c);return}o=c,a=o.getGui(),r.appendChild(a),tm(s,o)}),()=>{l=!0,o&&(a==null||a.remove(),t.destroyBean(o),s&&tm(s,void 0))}},tm=(e,t)=>{if(e)if(e instanceof Function)e(t);else{const r=e;r.current=t}},Vr=(...e)=>e.filter(r=>r!=null&&r!=="").join(" "),Wr=class a1{constructor(...t){this.classesMap={};for(const r of t)this.classesMap[r]=!0}setClass(t,r){if(!!this.classesMap[t]==r)return this;const i=new a1;return i.classesMap={...this.classesMap},i.classesMap[t]=r,i}toString(){return Object.keys(this.classesMap).filter(r=>this.classesMap[r]).join(" ")}},Eo=e=>{const t=()=>typeof Symbol=="function"&&Symbol.for,r=()=>t()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===r()},wv,Hh=(wv=he.version)==null?void 0:wv.split(".")[0],l1=Hh==="16"||Hh==="17";function l6(){return Hh==="19"}var cc=!1;function c6(e){return cc||setTimeout(()=>cc=!1,0),cc=!0,e()}var ka=(e,t)=>{!l1&&e&&!cc?zS.flushSync(t):t()},u6=e=>{l1?e():he.startTransition(e)};function d6(e,t,r){return he.useSyncExternalStore?he.useSyncExternalStore(e,t):r}function $c(e,t,r){if(t==null||e==null)return t;if(e===t||t.length===0&&e.length===0)return e;if(r||e.length===0&&t.length>0||e.length>0&&t.length===0)return t;const s=[],i=[],n=new Map,o=new Map;for(let a=0;a<t.length;a++){const l=t[a];o.set(l.instanceId,l)}for(let a=0;a<e.length;a++){const l=e[a];n.set(l.instanceId,l),o.has(l.instanceId)&&s.push(l)}for(let a=0;a<t.length;a++){const l=t[a],c=l.instanceId;n.has(c)||i.push(l)}return s.length===e.length&&i.length===0?e:s.length===0&&i.length===t.length?t:s.length===0?i:i.length===0?s:[...s,...i]}var c1=x.forwardRef((e,t)=>{var se;const{registry:r,context:s}=x.useContext(nr),i=x.useRef(null),n=x.useRef(null),o=x.useRef(null),a=x.useRef(null),l=x.useRef(null),c=x.useRef(),[u,d]=x.useState(),[h,f]=x.useState(),[p,g]=x.useState(),[m,v]=x.useState(()=>new Wr),[w,C]=x.useState(()=>new Wr("ag-hidden")),[y,b]=x.useState(()=>new Wr("ag-hidden")),[F,S]=x.useState(()=>new Wr("ag-invisible"));x.useImperativeHandle(t,()=>({refresh(){return!1}})),x.useLayoutEffect(()=>el(u,s,n.current),[u]);const D=x.useCallback(xe=>{if(i.current=xe,!xe||s.isDestroyed()){c.current=s.destroyBean(c.current);return}const W={setInnerRenderer:(pe,P)=>{d(pe),g(P)},setChildCount:pe=>f(pe),toggleCss:(pe,P)=>v(B=>B.setClass(pe,P)),setContractedDisplayed:pe=>b(P=>P.setClass("ag-hidden",!pe)),setExpandedDisplayed:pe=>C(P=>P.setClass("ag-hidden",!pe)),setCheckboxVisible:pe=>S(P=>P.setClass("ag-invisible",!pe)),setCheckboxSpacing:pe=>S(P=>P.setClass("ag-group-checkbox-spacing",pe))},fe=r.createDynamicBean("groupCellRendererCtrl",!0);fe&&(c.current=s.createBean(fe),c.current.init(W,xe,o.current,a.current,l.current,c1,e))},[]),T=x.useMemo(()=>`ag-cell-wrapper ${m.toString()}`,[m]),V=x.useMemo(()=>`ag-group-expanded ${w.toString()}`,[w]),_=x.useMemo(()=>`ag-group-contracted ${y.toString()}`,[y]),I=x.useMemo(()=>`ag-group-checkbox ${F.toString()}`,[F]),z=u==null?void 0:u.componentFromFramework,U=z?u.componentClass:void 0,j=u==null&&p!=null,ne=So(p);return he.createElement("span",{className:T,ref:D,...e.colDef?{}:{role:(se=c.current)==null?void 0:se.getCellAriaRole()}},he.createElement("span",{className:V,ref:a}),he.createElement("span",{className:_,ref:l}),he.createElement("span",{className:I,ref:o}),he.createElement("span",{className:"ag-group-value",ref:n},j?ne:z?he.createElement(U,{...u.params}):null),he.createElement("span",{className:"ag-group-child-count"},h))}),rm=c1,ug=x.createContext({setMethods:()=>{}}),h6=e=>{const{initialProps:t,addUpdateCallback:r,CustomComponentClass:s,setMethods:i}=e,[{key:n,...o},a]=x.useState(t);return x.useEffect(()=>{r(l=>a(l))},[]),he.createElement(ug.Provider,{value:{setMethods:i}},he.createElement(s,{key:n,...o}))},f6=x.memo(h6),g6=0;function sm(){return`agPortalKey_${++g6}`}var u1=class{constructor(e,t,r,s){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=r,this.suppressFallbackMethods=!!s,this.statelessComponent=this.isStateless(this.reactComponent),this.key=sm(),this.portalKey=sm(),this.instanceCreated=this.isStatelessComponent()?Ue.resolve(!1):new Ue(i=>{this.resolveInstanceCreated=i})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),r=document.createElement(t||"div");return r.classList.add("ag-react-container"),e.reactContainer=r,r}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&t[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,t){const r=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!r){setTimeout(()=>this.callMethod(e,t));return}const s=r[e];if(s)return s.apply(r,t);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,t&&t[0]?t[0]:{})}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new Ue(t=>this.createReactComponent(t))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=t=>{var r;this.componentInstance=t,(r=this.resolveInstanceCreated)==null||r.call(this,!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,{...e,key:this.key}),this.portal=xv.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return x.createElement(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const r=this[`${e}Component`];if(!this.suppressFallbackMethods&&r)return r.bind(this)(t)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function Au(e,t,r){for(const s of e){const i=t[s];i&&(r[s]=i)}}var qr=class extends u1{constructor(){super(...arguments),this.awaitUpdateCallback=new Ue(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=f6}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:r=>this.setMethods(r),addUpdateCallback:r=>{this.updateCallback=()=>(r(this.getProps()),new Ue(s=>{setTimeout(()=>{s()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,Au(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return{...this.sourceParams,key:this.key,ref:this.ref}}refreshProps(){return this.updateCallback?this.updateCallback():new Ue(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},p6=class extends qr{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},m6=class extends qr{refresh(e){this.sourceParams=e,this.refreshProps()}},v6=class extends qr{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},C6=class extends qr{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:r,shake:s}=this;return e.label=t,e.icon=r,e.shake=s,e}},w6=class extends qr{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterModifiedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1,this.awaitSetMethodsCallback=new Ue(e=>{this.resolveSetMethodsCallback=e})}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var r;const t=this.providedMethods;t?(r=t.afterGuiAttached)==null||r.call(t,e):this.awaitSetMethodsCallback.then(()=>{var s,i;return(i=(s=this.providedMethods)==null?void 0:s.afterGuiAttached)==null?void 0:i.call(s,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){var t,r;this.expectingNewMethods===!1&&this.hasBeenActive&&((t=this.providedMethods)==null?void 0:t.doesFilterPass)!==(e==null?void 0:e.doesFilterPass)&&setTimeout(()=>{this.sourceParams.filterChangedCallback()}),this.expectingNewMethods=!1,super.setMethods(e),this.resolveSetMethodsCallback(),(r=this.resolveFilterPassCallback)==null||r.call(this),this.resolveFilterPassCallback=void 0}updateModel(e){var r;(r=this.resolveFilterPassCallback)==null||r.call(this);const t=new Ue(s=>{this.resolveFilterPassCallback=s});this.setModel(e).then(()=>{t.then(()=>{this.sourceParams.filterChangedCallback()})})}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,e}},x6=class extends qr{constructor(){super(...arguments),this.awaitSetMethodsCallback=new Ue(e=>{this.resolveSetMethodsCallback=e})}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var r;const t=this.providedMethods;t?(r=t.afterGuiAttached)==null||r.call(t,e):this.awaitSetMethodsCallback.then(()=>{var s,i;return(i=(s=this.providedMethods)==null?void 0:s.afterGuiAttached)==null?void 0:i.call(s,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","onAnyFilterChanged"]}setMethods(e){super.setMethods(e),this.resolveSetMethodsCallback()}};function d1(e,t){e.parentFilterInstance(r=>{(r.setModel(t)||Ue.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var y6=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=r=>this.updateModel(r)}getProps(){return{...this.floatingFilterParams,model:this.model,onModelChange:this.onModelChange}}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){Au(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),d1(this.floatingFilterParams,e)}},S6=class extends qr{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),d1(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},b6=class extends qr{refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}},F6=class extends qr{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},R6=class extends qr{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},E6=class extends qr{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},T6=class extends qr{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function dg(){oe(231)}var k6=1e3,P6=class{constructor(e,t,r){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=r||k6}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter(t=>t!==e),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,r){this.portals=[...this.portals,e],this.waitForInstance(t,r),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t,r=Date.now()){if(this.destroyed){t(null);return}if(e.rendered())t(e);else{if(Date.now()-r>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){ka(!0,()=>this.refresher()),e.rendered()&&t(e);return}window.setTimeout(()=>{this.waitForInstance(e,t,r)})}}},D6=({ctrl:e})=>{const t=e.isAlive(),{context:r}=x.useContext(nr),[s,i]=x.useState(),[n,o]=x.useState(),a=x.useRef(),l=x.useRef(null),c=x.useRef(null),u=x.useRef(null),d=x.useRef(),h=x.useRef();t&&!h.current&&(h.current=new qa(()=>l.current));const f=x.useCallback(v=>{if(l.current=v,!v||!e.isAlive()||r.isDestroyed()){a.current=r.destroyBean(a.current);return}a.current=r.createBean(new Fo);const w=()=>{var b;const y=e.getSelectAllGui();y&&((b=c.current)==null||b.insertAdjacentElement("afterend",y),a.current.addDestroyFunc(()=>y.remove()))},C={setWidth:y=>{l.current&&(l.current.style.width=y)},toggleCss:(y,b)=>h.current.toggleCss(y,b),setUserStyles:y=>o(y),setAriaSort:y=>{l.current&&(y?bT(l.current,y):FT(l.current))},setUserCompDetails:y=>i(y),getUserCompInstance:()=>d.current||void 0,refreshSelectAllGui:w,removeSelectAllGui:()=>{var y;return(y=e.getSelectAllGui())==null?void 0:y.remove()}};e.setComp(C,v,c.current,u.current,a.current),w()},[]);x.useLayoutEffect(()=>el(s,r,u.current,d),[s]),x.useEffect(()=>{e.setDragSource(l.current)},[s]);const p=x.useMemo(()=>!!((s==null?void 0:s.componentFromFramework)&&Eo(s.componentClass)),[s]),g=s==null?void 0:s.componentFromFramework,m=s==null?void 0:s.componentClass;return he.createElement("div",{ref:f,style:n,className:"ag-header-cell",role:"columnheader"},he.createElement("div",{ref:c,className:"ag-header-cell-resize",role:"presentation"}),he.createElement("div",{ref:u,className:"ag-header-cell-comp-wrapper",role:"presentation"},g?p?he.createElement(m,{...s.params}):he.createElement(m,{...s.params,ref:d}):null))},A6=x.memo(D6),I6=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t}getProps(){return this.floatingFilterParams}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){Au(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}},M6=({ctrl:e})=>{const{context:t,gos:r}=x.useContext(nr),[s,i]=x.useState(),[n,o]=x.useState(()=>new Wr("ag-header-cell","ag-floating-filter")),[a,l]=x.useState(()=>new Wr),[c,u]=x.useState(()=>new Wr("ag-floating-filter-button","ag-hidden")),[d,h]=x.useState("false"),[f,p]=x.useState(),[,g]=x.useState(1),m=x.useRef(),v=x.useRef(null),w=x.useRef(null),C=x.useRef(null),y=x.useRef(null),b=x.useRef(),F=x.useRef(),S=fe=>{fe!=null&&b.current&&b.current(fe)},D=x.useCallback(fe=>{if(v.current=fe,!fe||!e.isAlive()||t.isDestroyed()){m.current=t.destroyBean(m.current);return}m.current=t.createBean(new Fo),F.current=new Ue(P=>{b.current=P});const pe={toggleCss:(P,B)=>o(H=>H.setClass(P,B)),setUserStyles:P=>i(P),addOrRemoveBodyCssClass:(P,B)=>l(H=>H.setClass(P,B)),setButtonWrapperDisplayed:P=>{u(B=>B.setClass("ag-hidden",!P)),h(P?"false":"true")},setWidth:P=>{v.current&&(v.current.style.width=P)},setCompDetails:P=>p(P),getFloatingFilterComp:()=>F.current?F.current:null,setMenuIcon:P=>{var B;return(B=y.current)==null?void 0:B.appendChild(P)}};e.setComp(pe,fe,y.current,w.current,m.current)},[]);x.useLayoutEffect(()=>el(f,t,w.current,S),[f]);const T=x.useMemo(()=>n.toString(),[n]),V=x.useMemo(()=>a.toString(),[a]),_=x.useMemo(()=>c.toString(),[c]),I=x.useMemo(()=>!!(f&&f.componentFromFramework&&Eo(f.componentClass)),[f]),z=x.useMemo(()=>r.get("reactiveCustomComponents"),[]),U=x.useMemo(()=>r.get("enableFilterHandlers"),[]),[j,ne]=x.useState();x.useEffect(()=>{if(f!=null&&f.componentFromFramework)if(z){const fe=U?I6:y6,pe=new fe(f.params,()=>g(P=>P+1));S(pe),ne(pe)}else dg()},[f]);const se=j==null?void 0:j.getProps(),xe=f==null?void 0:f.componentFromFramework,W=f==null?void 0:f.componentClass;return he.createElement("div",{ref:D,style:s,className:T,role:"gridcell"},he.createElement("div",{ref:w,className:V,role:"presentation"},xe?z?se&&he.createElement(ug.Provider,{value:{setMethods:fe=>j.setMethods(fe)}},he.createElement(W,{...se})):he.createElement(W,{...f.params,ref:I?()=>{}:S}):null),he.createElement("div",{ref:C,"aria-hidden":d,className:_,role:"presentation"},he.createElement("button",{ref:y,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},_6=x.memo(M6),L6=({ctrl:e})=>{const{context:t}=x.useContext(nr),[r,s]=x.useState(),[i,n]=x.useState(()=>new Wr),[o,a]=x.useState(()=>new Wr),[l,c]=x.useState("false"),[u,d]=x.useState(),[h,f]=x.useState(),p=x.useRef(),g=x.useRef(null),m=x.useRef(null),v=x.useRef(null),w=x.useRef(),C=x.useCallback(T=>{if(g.current=T,!T||!e.isAlive()||t.isDestroyed()){p.current=t.destroyBean(p.current);return}p.current=t.createBean(new Fo);const V={setWidth:_=>{g.current&&(g.current.style.width=_)},toggleCss:(_,I)=>n(z=>z.setClass(_,I)),setUserStyles:_=>s(_),setHeaderWrapperHidden:_=>{const I=v.current;I&&(_?I.style.setProperty("display","none"):I.style.removeProperty("display"))},setHeaderWrapperMaxHeight:_=>{const I=v.current;I&&(_!=null?I.style.setProperty("max-height",`${_}px`):I.style.removeProperty("max-height"),I.classList.toggle("ag-header-cell-comp-wrapper-limited-height",_!=null))},setUserCompDetails:_=>f(_),setResizableDisplayed:_=>{a(I=>I.setClass("ag-hidden",!_)),c(_?"false":"true")},setAriaExpanded:_=>d(_),getUserCompInstance:()=>w.current||void 0};e.setComp(V,T,m.current,v.current,p.current)},[]);x.useLayoutEffect(()=>el(h,t,v.current),[h]),x.useEffect(()=>{g.current&&e.setDragSource(g.current)},[h]);const y=x.useMemo(()=>!!((h==null?void 0:h.componentFromFramework)&&Eo(h.componentClass)),[h]),b=x.useMemo(()=>"ag-header-group-cell "+i.toString(),[i]),F=x.useMemo(()=>"ag-header-cell-resize "+o.toString(),[o]),S=h==null?void 0:h.componentFromFramework,D=h==null?void 0:h.componentClass;return he.createElement("div",{ref:C,style:r,className:b,role:"columnheader","aria-expanded":u},he.createElement("div",{ref:v,className:"ag-header-cell-comp-wrapper",role:"presentation"},S?y?he.createElement(D,{...h.params}):he.createElement(D,{...h.params,ref:w}):null),he.createElement("div",{ref:m,"aria-hidden":l,className:F}))},O6=x.memo(L6),N6=({ctrl:e})=>{const{gos:t,context:r}=x.useContext(nr),{topOffset:s,rowHeight:i}=x.useMemo(()=>e.getTopAndHeight(),[]),n=x.useMemo(()=>t.get("tabIndex"),[]),[o,a]=x.useState(()=>e.getAriaRowIndex()),l=e.headerRowClass,[c,u]=x.useState(()=>i+"px"),[d,h]=x.useState(()=>s+"px"),f=x.useRef(null),[p,g]=x.useState(()=>e.getUpdatedHeaderCtrls()),m=x.useRef(),v=x.useRef(null),w=x.useCallback(b=>{if(v.current=b,!b||!e.isAlive()||r.isDestroyed()){m.current=r.destroyBean(m.current);return}m.current=r.createBean(new Fo);const F={setHeight:S=>u(S),setTop:S=>h(S),setHeaderCtrls:(S,D,T)=>{const V=f.current,_=$c(V,S,D);_!==V&&(f.current=_,ka(T,()=>g(_)))},setWidth:S=>{v.current&&(v.current.style.width=S)},setRowIndex:S=>{a(S)}};e.setComp(F,m.current,!1)},[]),C=x.useMemo(()=>({height:c,top:d}),[c,d]),y=x.useCallback(b=>{switch(e.type){case"group":return he.createElement(O6,{ctrl:b,key:b.instanceId});case"filter":return he.createElement(_6,{ctrl:b,key:b.instanceId});default:return he.createElement(A6,{ctrl:b,key:b.instanceId})}},[]);return he.createElement("div",{ref:w,className:l,role:"row",style:C,tabIndex:n,"aria-rowindex":o},p.map(y))},B6=x.memo(N6),H6=({pinned:e})=>{const[t,r]=x.useState(!0),[s,i]=x.useState([]),{context:n}=x.useContext(nr),o=x.useRef(null),a=x.useRef(null),l=x.useRef(),c=e==="left",u=e==="right",d=!c&&!u,h=x.useCallback(g=>{if(o.current=g,!g||n.isDestroyed()){l.current=n.destroyBean(l.current);return}l.current=n.createBean(new xA(e));const m={setDisplayed:r,setCtrls:v=>i(v),setCenterWidth:v=>{a.current&&(a.current.style.width=v)},setViewportScrollLeft:v=>{o.current&&(o.current.scrollLeft=v)},setPinnedContainerWidth:v=>{o.current&&(o.current.style.width=v,o.current.style.minWidth=v,o.current.style.maxWidth=v)}};l.current.setComp(m,o.current)},[]),f=t?"":"ag-hidden",p=()=>s.map(g=>he.createElement(B6,{ctrl:g,key:g.instanceId}));return c?he.createElement("div",{ref:h,className:"ag-pinned-left-header "+f,"aria-hidden":!t,role:"rowgroup"},p()):u?he.createElement("div",{ref:h,className:"ag-pinned-right-header "+f,"aria-hidden":!t,role:"rowgroup"},p()):d?he.createElement("div",{ref:h,className:"ag-header-viewport "+f,role:"rowgroup",tabIndex:-1},he.createElement("div",{ref:a,className:"ag-header-container",role:"presentation"},p())):null},_d=x.memo(H6),V6=()=>{const[e,t]=x.useState(()=>new Wr),[r,s]=x.useState(),{context:i}=x.useContext(nr),n=x.useRef(null),o=x.useRef(),a=x.useCallback(u=>{if(n.current=u,!u||i.isDestroyed()){o.current=i.destroyBean(o.current);return}o.current=i.createBean(new mA);const d={toggleCss:(h,f)=>t(p=>p.setClass(h,f)),setHeightAndMinHeight:h=>s(h)};o.current.setComp(d,u,u)},[]),l=x.useMemo(()=>"ag-header "+e.toString(),[e]),c=x.useMemo(()=>({height:r,minHeight:r}),[r]);return he.createElement("div",{ref:a,className:l,style:c,role:"presentation"},he.createElement(_d,{pinned:"left"}),he.createElement(_d,{pinned:null}),he.createElement(_d,{pinned:"right"}))},G6=x.memo(V6),W6=(e,t)=>{x.useEffect(()=>{const r=t.current;if(r){const s=r.parentElement;if(s){const i=document.createComment(e);return s.insertBefore(i,r),()=>{i.remove()}}}},[e])},Gi=W6,z6=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new Ue(r=>{this.resolveInstanceCreated=r}),this.onValueChange=r=>this.updateValue(r),this.value=e.value}getProps(){return{...this.cellEditorParams,initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange}}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){Au(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){var t;this.componentInstance=e,(t=this.resolveInstanceCreated)==null||t.call(this),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached","getValidationErrors","getValidationElement"]}updateValue(e){this.value=e,this.refreshProps()}},U6=e=>{const t=x.useRef(e),r=x.useRef(),s=x.useRef(!1),i=x.useRef(!1),[,n]=x.useState(0);s.current&&(i.current=!0),x.useEffect(()=>(s.current||(r.current=t.current(),s.current=!0),n(o=>o+1),()=>{var o;i.current&&((o=r.current)==null||o.call(r))}),[])},j6=e=>{const[t,r]=x.useState(),s=x.useContext(nr),{context:i,popupSvc:n,gos:o,editSvc:a}=s,{editDetails:l,cellCtrl:c,eParentCell:u}=e;return U6(()=>{var g,m;const{compDetails:d}=l,h=o.get("stopEditingWhenCellsLoseFocus");let f,p;if(!i.isDestroyed()){p=i.createBean(a.createPopupEditorWrapper(d.params));const v=p.getGui();if(e.jsChildComp){const S=e.jsChildComp.getGui();S&&v.appendChild(S)}const{column:w,rowNode:C}=c,y={column:w,rowNode:C,type:"popupCellEditor",eventSource:u,ePopup:v,position:l.popupPosition,keepWithinBounds:!0},b=n==null?void 0:n.positionPopupByComponent.bind(n,y),F=n==null?void 0:n.addPopup({modal:h,eChild:v,closeOnEsc:!0,closedCallback:()=>{c.onPopupEditorClosed()},anchorToElement:u,positionCallback:b,ariaOwns:u});f=F?F.hideFunc:void 0,r(p),(m=(g=e.jsChildComp)==null?void 0:g.afterGuiAttached)==null||m.call(g)}return()=>{f==null||f(),i.destroyBean(p)}}),x.useLayoutEffect(()=>()=>{c.isCellFocused()&&(t!=null&&t.getGui().contains(pt(s)))&&u.focus({preventScroll:!0})},[t]),t&&e.wrappedContent?xv.createPortal(e.wrappedContent,t.getGui()):null},im=x.memo(j6),$6=(e,t,r)=>{const{compProxy:s}=e;r(s);const i=s.getProps(),n=Eo(t);return he.createElement(ug.Provider,{value:{setMethods:o=>s.setMethods(o)}},n?he.createElement(t,{...i}):he.createElement(t,{...i,ref:o=>s.setRef(o)}))},nm=(e,t,r)=>e.compProxy?$6(e,t,r):he.createElement(t,{...e.compDetails.params,ref:r}),K6=(e,t,r,s,i)=>{const n=e.compDetails,o=n.componentClass,a=n.componentFromFramework&&!e.popup,l=n.componentFromFramework&&e.popup,c=!n.componentFromFramework&&e.popup;return a?nm(e,o,t):l?he.createElement(im,{editDetails:e,cellCtrl:s,eParentCell:r,wrappedContent:nm(e,o,t)}):c&&i?he.createElement(im,{editDetails:e,cellCtrl:s,eParentCell:r,jsChildComp:i}):null},q6=(e,t,r,s,i,n,o=!1)=>{const{context:a}=x.useContext(nr),l=x.useCallback(()=>{const c=i.current;if(!c)return;const u=c.getGui();u&&u.parentElement&&u.remove(),a.destroyBean(c),i.current=void 0},[]);x.useEffect(()=>{const c=e!=null&&!o,u=(e==null?void 0:e.compDetails)&&!e.compDetails.componentFromFramework,d=t&&r==null;if(!(c&&u&&!d)){l();return}const f=e.compDetails;if(i.current){const g=i.current,v=g.refresh!=null&&e.force==!1?g.refresh(f.params):!1;if(v===!0||v===void 0)return;l()}f.newAgStackInstance().then(g=>{if(!g)return;const m=g.getGui();if(!m)return;(t?r:n.current).appendChild(m),i.current=g})},[e,t,s,o]),x.useEffect(()=>l,[])},h1=q6,X6=({cellCtrl:e,parent:t})=>{var i;const r=x.useRef(),s=x.useMemo(()=>{const{loadingComp:n}=e.getDeferLoadingCellRenderer();return n?{value:void 0,compDetails:n,force:!1}:void 0},[e]);if(h1(s,!1,void 0,1,r,t),(i=s==null?void 0:s.compDetails)!=null&&i.componentFromFramework){const n=s.compDetails.componentClass;return he.createElement(n,{...s.compDetails.params})}return he.createElement(he.Fragment,null)},Y6=({cellCtrl:e,printLayout:t,editingCell:r})=>{const s=x.useContext(nr),{context:i}=s,{column:{colIdSanitised:n},instanceId:o}=e,a=x.useRef(),[l,c]=x.useState(()=>e.isCellRenderer()?void 0:{compDetails:void 0,value:e.getValueToDisplay(),force:!1}),[u,d]=x.useState(),[h,f]=x.useState(1),[p,g]=x.useState(),[m,v]=x.useState(!1),[w,C]=x.useState(!1),[y,b]=x.useState(!1),[F,S]=x.useState(),D=x.useMemo(()=>e.isForceWrapper(),[e]),T=x.useMemo(()=>e.getCellAriaRole(),[e]),V=x.useRef(null),_=x.useRef(null),I=x.useRef(null),z=x.useRef(),U=x.useRef(),j=x.useRef(),ne=x.useRef([]),se=x.useRef(),xe=x.useRef(),[W,fe]=x.useState(0),pe=x.useCallback(ie=>{xe.current=ie,fe(Ee=>Ee+1)},[]),P=l!=null&&(m||y||w)&&(u==null||!!u.popup),B=D||P,H=x.useMemo(()=>e.getCellValueClass(),[e]),G=x.useCallback(ie=>{if(U.current=ie,ie){const Ee=ie.isCancelBeforeStart&&ie.isCancelBeforeStart();setTimeout(()=>{Ee?(e.stopEditing(!0),e.focusCell(!0)):(e.cellEditorAttached(),e.enableEditorTooltipFeature(ie))})}},[e]),J=x.useRef();J.current||(J.current=new qa(()=>V.current));const ae=!!u&&!u.popup;h1(l,B,xe.current,W,z,V,ae);const ue=x.useRef();x.useLayoutEffect(()=>{var Ye,st;const ie=ue.current,Ee=l;if(ue.current=l,ie==null||ie.compDetails==null||Ee==null||Ee.compDetails==null)return;(Ye=se.current)==null||Ye.refreshVisibility();const Je=ie.compDetails,$e=Ee.compDetails;if(Je.componentClass!=$e.componentClass||((st=I.current)==null?void 0:st.refresh)==null)return;I.current.refresh($e.params)!=!0&&f(Ze=>Ze+1)},[l]),x.useLayoutEffect(()=>{if(!(u&&!u.compDetails.componentFromFramework)||i.isDestroyed())return;const Ee=u.compDetails,Je=u.popup===!0,$e=Ee.newAgStackInstance();return $e.then(Re=>{var st;if(!Re)return;const Ye=Re.getGui();if(G(Re),!Je){const Ze=(D?j:V).current;Ze==null||Ze.appendChild(Ye),(st=Re.afterGuiAttached)==null||st.call(Re)}S(Re)}),()=>{$e.then(Re=>{const Ye=Re.getGui();e.disableEditorTooltipFeature(),i.destroyBean(Re),G(void 0),S(void 0),Ye==null||Ye.remove()})}},[u]);const ce=x.useCallback(ie=>{if(j.current=ie,!ie||i.isDestroyed()||!e.isAlive()){const $e=ne.current;ne.current=[];for(const Re of $e)Re();return}let Ee;const Je=$e=>{$e&&(ie.insertAdjacentElement("afterbegin",$e.getGui()),ne.current.push(()=>{vi($e.getGui()),i.destroyBean($e),se.current===Ee&&(se.current=void 0)}))};m&&Je(e.createSelectionCheckbox()),y&&Je(e.createDndSource()),w&&(Ee=e.createRowDragComp(),se.current=Ee,Ee&&(Je(Ee),Ee.refreshVisibility()))},[e,i,y,w,m]),te=x.useCallback(()=>{const ie=!e.isCellSpanning()||_.current,Ee=V.current;if(!Ee||!ie||!e||!e.isAlive()||i.isDestroyed()){a.current=i.destroyBean(a.current);return}a.current=i.createBean(new Fo);const Je={toggleCss:(Re,Ye)=>J.current.toggleCss(Re,Ye),setUserStyles:Re=>g(Re),getFocusableElement:()=>V.current,setIncludeSelection:Re=>v(Re),setIncludeRowDrag:Re=>C(Re),setIncludeDndSource:Re=>b(Re),getCellEditor:()=>U.current??null,getCellRenderer:()=>I.current??z.current,getParentOfValue:()=>xe.current??j.current??V.current,setRenderDetails:(Re,Ye,st)=>{var _t;const Ze=()=>{c(at=>(at==null?void 0:at.compDetails)!==Re||(at==null?void 0:at.value)!==Ye||(at==null?void 0:at.force)!==st?{value:Ye,compDetails:Re,force:st}:at)};if((_t=Re==null?void 0:Re.params)!=null&&_t.deferRender&&!e.rowNode.group){const{loadingComp:at,onReady:as}=e.getDeferLoadingCellRenderer();if(at){c({value:void 0,compDetails:at,force:!1}),as.then(()=>u6(Ze));return}}Ze()},setEditDetails:(Re,Ye,st,Ze)=>{if(Re){let _t;Re.componentFromFramework&&(Ze?_t=new z6(Re.params,()=>f(at=>at+1)):dg()),d({compDetails:Re,popup:Ye,popupPosition:st,compProxy:_t}),Ye||c(void 0)}else e.hasBrowserFocus()&&Je.getFocusableElement().focus({preventScroll:!0}),U.current=void 0,d(void 0)},refreshEditStyles:(Re,Ye)=>{if(!V.current)return;const{current:st}=J;st.toggleCss("ag-cell-value",!B),st.toggleCss("ag-cell-inline-editing",!!Re&&!Ye),st.toggleCss("ag-cell-popup-editing",!!Re&&!!Ye),st.toggleCss("ag-cell-not-inline-editing",!Re||!!Ye)}},$e=j.current||void 0;e.setComp(Je,Ee,_.current??void 0,$e,t,r,a.current)},[]),Ae=x.useCallback(ie=>{V.current=ie,te()},[]),O=x.useCallback(ie=>{_.current=ie,te()},[]),ze=x.useMemo(()=>{var Ee;return!!(((Ee=l==null?void 0:l.compDetails)==null?void 0:Ee.componentFromFramework)&&Eo(l.compDetails.componentClass))},[l]);x.useLayoutEffect(()=>{if(!V.current)return;const{current:ie}=J;ie.toggleCss("ag-cell-value",!B),ie.toggleCss("ag-cell-inline-editing",!!u&&!u.popup),ie.toggleCss("ag-cell-popup-editing",!!u&&!!u.popup),ie.toggleCss("ag-cell-not-inline-editing",!u||!!u.popup)});const _e=()=>{var Je;const{compDetails:ie,value:Ee}=l;if(!ie)return((Je=Ee==null?void 0:Ee.toString)==null?void 0:Je.call(Ee))??Ee;if(ie.componentFromFramework){const $e=ie.componentClass;return he.createElement(x.Suspense,{fallback:he.createElement(X6,{cellCtrl:e,parent:V})},ze?he.createElement($e,{...ie.params,key:h}):he.createElement($e,{...ie.params,key:h,ref:I}))}},je=()=>{const ie=()=>l==null?null:B?he.createElement("span",{role:"presentation",id:`cell-${o}`,className:H,ref:pe},_e()):_e(),Ee=Je=>K6(Je,G,V.current,e,F);return u!=null?u.popup?he.createElement(he.Fragment,null,ie(),Ee(u)):Ee(u):ie()},Oe=()=>he.createElement("div",{ref:Ae,style:p,role:T,"col-id":n},B?he.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:ce},je()):je());return e.isCellSpanning()?he.createElement("div",{ref:O,className:"ag-spanned-cell-wrapper",role:"presentation"},Oe()):Oe()},J6=x.memo(Y6),Z6=({rowCtrl:e,containerType:t})=>{const{context:r,gos:s,editSvc:i}=x.useContext(nr),n=x.useContext(o1)==="default",o=x.useRef(),a=x.useRef(e.getDomOrder()),l=e.isFullWidth(),c=e.rowNode.displayed,[u,d]=x.useState(()=>c?e.rowNode.getRowIndexString():null),[h,f]=x.useState(()=>e.rowId),[p,g]=x.useState(()=>e.businessKey),[m,v]=x.useState(()=>e.rowStyles),w=x.useRef(null),[C,y]=x.useState(()=>null),[b,F]=x.useState(),[S,D]=x.useState(()=>c?e.getInitialRowTop(t):void 0),[T,V]=x.useState(()=>c?e.getInitialTransform(t):void 0),_=x.useRef(null),I=x.useRef(),z=x.useRef(),U=x.useRef(!1),[j,ne]=x.useState(0);x.useEffect(()=>{var Ae;if(U.current||!b||j>10)return;const te=(Ae=_.current)==null?void 0:Ae.firstChild;te?(e.setupDetailRowAutoHeight(te),U.current=!0):ne(O=>O+1)},[b,j]);const se=x.useRef();se.current||(se.current=new qa(()=>_.current));const xe=x.useRef(()=>{}),W=x.useCallback(te=>(xe.current=te,()=>{xe.current=()=>{}}),[]),fe=d6(W,()=>w.current,[]),pe=n?fe:C,P=x.useCallback(te=>{if(_.current=te,o.current=te?r.createBean(new Fo):r.destroyBean(o.current),!te){e.unsetComp(t);return}if(!e.isAlive()||r.isDestroyed())return;const Ae={setTop:D,setTransform:V,toggleCss:(O,ze)=>se.current.toggleCss(O,ze),setDomOrder:O=>a.current=O,setRowIndex:d,setRowId:f,setRowBusinessKey:g,setUserStyles:v,setCellCtrls:(O,ze)=>{const _e=w.current,je=$c(_e,O,a.current);je!==_e&&(w.current=je,n?xe.current():ka(ze,()=>y(je)))},showFullWidth:O=>{z.current=O.params,F(O)},getFullWidthCellRenderer:()=>I.current,getFullWidthCellRendererParams:()=>z.current,refreshFullWidth:O=>{const ze=O();return z.current=ze,ae.current?(F(_e=>({..._e,params:ze})),!0):!I.current||!I.current.refresh?!1:I.current.refresh(ze)}};e.setComp(Ae,te,t,o.current)},[]);x.useLayoutEffect(()=>el(b,r,_.current,I),[b]);const B=x.useMemo(()=>{const te={top:S,transform:T};return Object.assign(te,m),te},[S,T,m]),H=l&&(b==null?void 0:b.componentFromFramework),G=!l&&pe!=null,J=x.useMemo(()=>!!((b==null?void 0:b.componentFromFramework)&&Eo(b.componentClass)),[b]),ae=x.useRef(!1);x.useEffect(()=>{ae.current=J&&!!b&&!!s.get("reactiveCustomComponents")},[J,b]);const ue=()=>pe==null?void 0:pe.map(te=>he.createElement(J6,{cellCtrl:te,editingCell:(i==null?void 0:i.isEditing(te,{withOpenEditor:!0}))??!1,printLayout:e.printLayout,key:te.instanceId})),ce=()=>{const te=b.componentClass;return J?he.createElement(te,{...b.params}):he.createElement(te,{...b.params,ref:I})};return he.createElement("div",{ref:P,role:"row",style:B,"row-index":u,"row-id":h,"row-business-key":p},G?ue():H?ce():null)},om=x.memo(Z6),Q6=({name:e})=>{const{context:t,gos:r}=x.useContext(nr),s=x.useMemo(()=>Ya(e),[e]),i=x.useRef(null),n=x.useRef(null),o=x.useRef(null),a=x.useRef([]),l=x.useRef([]),[c,u]=x.useState(()=>[]),d=!!r.get("enableCellSpan")&&!!s.getSpannedRowCtrls,h=x.useRef([]),f=x.useRef([]),[p,g]=x.useState(()=>[]),m=x.useRef(!1),v=x.useRef(),w=x.useMemo(()=>Vr("ag-viewport",Ww(e)),[e]),C=x.useMemo(()=>Vr(sc(e)),[e]),y=x.useMemo(()=>Vr("ag-spanning-container",ID(e)),[e]),b=s.type==="center"||d,F=b?i:n;Gi(" AG Row Container "+e+" ",F);const S=x.useCallback(()=>{const j=!b||i.current!=null,ne=n.current!=null,se=!d||o.current!=null;return j&&ne&&se},[]),D=x.useCallback(()=>i.current==null&&n.current==null&&o.current==null,[]),T=x.useCallback(()=>{if(D()&&(v.current=t.destroyBean(v.current)),!t.isDestroyed()&&S()){const j=xe=>{const W=$c(l.current,a.current,m.current);W!==l.current&&(l.current=W,ka(xe,()=>u(W)))},ne=xe=>{const W=$c(f.current,h.current,m.current);W!==f.current&&(f.current=W,ka(xe,()=>g(W)))},se={setHorizontalScroll:xe=>{i.current&&(i.current.scrollLeft=xe)},setViewportHeight:xe=>{i.current&&(i.current.style.height=xe)},setRowCtrls:({rowCtrls:xe,useFlushSync:W})=>{const fe=!!W&&a.current.length>0&&xe.length>0;a.current=xe,j(fe)},setSpannedRowCtrls:(xe,W)=>{const fe=!!W&&h.current.length>0&&xe.length>0;h.current=xe,ne(fe)},setDomOrder:xe=>{m.current!=xe&&(m.current=xe,j(!1))},setContainerWidth:xe=>{n.current&&(n.current.style.width=xe)},setOffsetTop:xe=>{n.current&&(n.current.style.transform=`translateY(${xe})`)}};v.current=t.createBean(new WD(e)),v.current.setComp(se,n.current,o.current??void 0,i.current)}},[S,D]),V=x.useCallback(j=>{n.current=j,T()},[T]),_=x.useCallback(j=>{o.current=j,T()},[T]),I=x.useCallback(j=>{i.current=j,T()},[T]),z=()=>he.createElement("div",{className:C,ref:V,role:b?"presentation":"rowgroup"},c.map(j=>he.createElement(om,{rowCtrl:j,containerType:s.type,key:j.instanceId})));if(!b)return z();const U=()=>he.createElement("div",{className:y,ref:_,role:"presentation"},p.map(j=>he.createElement(om,{rowCtrl:j,containerType:s.type,key:j.instanceId})));return he.createElement("div",{className:w,ref:I,role:"rowgroup"},z(),d?U():null)},e8=x.memo(Q6),t8=()=>{const e=x.useContext(nr),{context:t,overlays:r}=e,[s,i]=x.useState(""),[n,o]=x.useState(0),[a,l]=x.useState(0),[c,u]=x.useState("0px"),[d,h]=x.useState("0px"),[f,p]=x.useState("100%"),[g,m]=x.useState("0px"),[v,w]=x.useState("0px"),[C,y]=x.useState("100%"),[b,F]=x.useState(!0),[S,D]=x.useState(!0),[T,V]=x.useState(null),[_,I]=x.useState(""),[z,U]=x.useState(null),[j,ne]=x.useState("ag-layout-normal"),se=x.useRef();se.current||(se.current=new qa(()=>xe.current));const xe=x.useRef(null),W=x.useRef(null),fe=x.useRef(null),pe=x.useRef(null),P=x.useRef(null),B=x.useRef(null),H=x.useRef(null),G=x.useRef([]),J=x.useRef([]);Gi(" AG Grid Body ",xe),Gi(" AG Pinned Top ",W),Gi(" AG Sticky Top ",fe),Gi(" AG Middle ",B),Gi(" AG Pinned Bottom ",H);const ae=x.useCallback(Re=>{if(xe.current=Re,!Re||t.isDestroyed()){G.current=t.destroyBeans(G.current);for(const Ge of J.current)Ge();J.current=[];return}const Ye=(Ge,ht)=>{Ge.appendChild(ht),J.current.push(()=>ht.remove())},st=Ge=>{const ht=t.createBean(new Ge);return G.current.push(ht),ht},Ze=(Ge,ht,He)=>{Ye(Ge,document.createComment(He)),Ye(Ge,st(ht).getGui())};Ze(Re,XD," AG Fake Horizontal Scroll ");const _t=r==null?void 0:r.getOverlayWrapperCompClass();_t&&Ze(Re,_t," AG Overlay Wrapper "),P.current&&Ze(P.current,JD," AG Fake Vertical Scroll ");const at={setRowAnimationCssOnBodyViewport:i,setColumnCount:Ge=>{xe.current&&yT(xe.current,Ge)},setRowCount:Ge=>{xe.current&&wT(xe.current,Ge)},setTopHeight:o,setBottomHeight:l,setStickyTopHeight:u,setStickyTopTop:h,setStickyTopWidth:p,setTopInvisible:F,setBottomInvisible:D,setColumnMovingCss:(Ge,ht)=>se.current.toggleCss(Ge,ht),updateLayoutClasses:ne,setAlwaysVerticalScrollClass:V,setPinnedTopBottomOverflowY:I,setCellSelectableCss:(Ge,ht)=>U(ht?Ge:null),setBodyViewportWidth:Ge=>{B.current&&(B.current.style.width=Ge)},registerBodyViewportResizeListener:Ge=>{if(B.current){const ht=ei(e,B.current,Ge);J.current.push(()=>ht())}},setStickyBottomHeight:m,setStickyBottomBottom:w,setStickyBottomWidth:y,setGridRootRole:Ge=>Re.setAttribute("role",Ge)},as=t.createBean(new $D);G.current.push(as),as.setComp(at,Re,B.current,W.current,H.current,fe.current,pe.current)},[]),ue=x.useMemo(()=>Vr("ag-root","ag-unselectable",j),[j]),ce=x.useMemo(()=>Vr("ag-body-viewport",s,j,T,z),[s,j,T,z]),te=x.useMemo(()=>Vr("ag-body",j),[j]),Ae=x.useMemo(()=>Vr("ag-floating-top",b?"ag-invisible":null,z),[z,b]),O=x.useMemo(()=>Vr("ag-sticky-top",z),[z]),ze=x.useMemo(()=>Vr("ag-sticky-bottom",g==="0px"?"ag-invisible":null,z),[z,g]),_e=x.useMemo(()=>Vr("ag-floating-bottom",S?"ag-invisible":null,z),[z,S]),je=x.useMemo(()=>({height:n,minHeight:n,overflowY:_}),[n,_]),Oe=x.useMemo(()=>({height:c,top:d,width:f}),[c,d,f]),ie=x.useMemo(()=>({height:g,bottom:v,width:C}),[g,v,C]),Ee=x.useMemo(()=>({height:a,minHeight:a,overflowY:_}),[a,_]),Je=Re=>he.createElement(e8,{name:Re,key:`${Re}-container`}),$e=({section:Re,children:Ye,className:st,style:Ze})=>he.createElement("div",{ref:Re,className:st,role:"presentation",style:Ze},Ye.map(Je));return he.createElement("div",{ref:ae,className:ue},he.createElement(G6,null),$e({section:W,className:Ae,style:je,children:["topLeft","topCenter","topRight","topFullWidth"]}),he.createElement("div",{className:te,ref:P,role:"presentation"},$e({section:B,className:ce,children:["left","center","right","fullWidth"]})),$e({section:fe,className:O,style:Oe,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),$e({section:pe,className:ze,style:ie,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),$e({section:H,className:_e,style:Ee,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))},r8=x.memo(t8),s8=(e,t)=>{const{children:r,eFocusableElement:s,onTabKeyDown:i,gridCtrl:n,forceFocusOutWhenTabGuardsAreEmpty:o,isEmpty:a}=e,{context:l}=x.useContext(nr),c=x.useRef(null),u=x.useRef(null),d=x.useRef(),h=v=>{var C,y;const w=v==null?void 0:parseInt(v,10).toString();for(const b of[c,u])w===void 0?(C=b.current)==null||C.removeAttribute("tabindex"):(y=b.current)==null||y.setAttribute("tabindex",w)};x.useImperativeHandle(t,()=>({forceFocusOutOfContainer(v){var w;(w=d.current)==null||w.forceFocusOutOfContainer(v)}}));const f=x.useCallback(()=>{const v=c.current,w=u.current;if(!v&&!w||l.isDestroyed()){d.current=l.destroyBean(d.current);return}if(v&&w){const C={setTabIndex:h};d.current=l.createBean(new ZA({comp:C,eTopGuard:v,eBottomGuard:w,eFocusableElement:s,onTabKeyDown:i,forceFocusOutWhenTabGuardsAreEmpty:o,focusInnerElement:y=>n.focusInnerElement(y),isEmpty:a}))}},[]),p=x.useCallback(v=>{c.current=v,f()},[f]),g=x.useCallback(v=>{u.current=v,f()},[f]),m=v=>{const w=v==="top"?Zn.TAB_GUARD_TOP:Zn.TAB_GUARD_BOTTOM;return he.createElement("div",{className:`${Zn.TAB_GUARD} ${w}`,role:"presentation",ref:v==="top"?p:g})};return he.createElement(he.Fragment,null,m("top"),r,m("bottom"))},i8=x.forwardRef(s8),n8=x.memo(i8),o8=({context:e})=>{const[t,r]=x.useState(""),[s,i]=x.useState(""),[n,o]=x.useState(null),[a,l]=x.useState(null),[c,u]=x.useState(!1),[d,h]=x.useState(),f=x.useRef(),p=x.useRef(null),g=x.useRef(),[m,v]=x.useState(null),w=x.useRef(()=>{}),C=x.useRef(),y=x.useRef([]),b=x.useCallback(()=>{},[]);Gi(" AG Grid ",p);const F=x.useCallback(I=>{if(p.current=I,f.current=I?e.createBean(new oI):e.destroyBean(f.current),!I||e.isDestroyed())return;const z=f.current;w.current=z.focusInnerElement.bind(z);const U={destroyGridUi:()=>{},setRtlClass:r,forceFocusOutOfContainer:j=>{var ne,se;if(!j&&((ne=C.current)!=null&&ne.isDisplayed())){C.current.forceFocusOutOfContainer(j);return}(se=g.current)==null||se.forceFocusOutOfContainer(j)},updateLayoutClasses:i,getFocusableContainers:()=>{var se;const j=[],ne=(se=p.current)==null?void 0:se.querySelector(".ag-root");ne&&j.push({getGui:()=>ne});for(const xe of y.current)xe.isDisplayed()&&j.push(xe);return j},setCursor:o,setUserSelect:l};z.setComp(U,I,I),u(!0)},[]);x.useEffect(()=>{const I=f.current,z=p.current;if(!d||!I||!m||!z||e.isDestroyed())return;const U=[],{watermarkSelector:j,paginationSelector:ne,sideBarSelector:se,statusBarSelector:xe,gridHeaderDropZonesSelector:W}=I.getOptionalSelectors(),fe=[];if(W){const P=e.createBean(new W.component),B=P.getGui();z.insertAdjacentElement("afterbegin",B),fe.push(B),U.push(P)}if(se){const P=e.createBean(new se.component),B=P.getGui(),H=m.querySelector(".ag-tab-guard-bottom");H&&(H.insertAdjacentElement("beforebegin",B),fe.push(B)),U.push(P),y.current.push(P)}const pe=P=>{const B=e.createBean(new P),H=B.getGui();return z.insertAdjacentElement("beforeend",H),fe.push(H),U.push(B),B};if(xe&&pe(xe.component),ne){const P=pe(ne.component);C.current=P,y.current.push(P)}return j&&pe(j.component),()=>{e.destroyBeans(U);for(const P of fe)P.remove()}},[d,m,e]);const S=x.useMemo(()=>Vr("ag-root-wrapper",t,s),[t,s]),D=x.useMemo(()=>Vr("ag-root-wrapper-body","ag-focus-managed",s),[s]),T=x.useMemo(()=>({userSelect:a??"",WebkitUserSelect:a??"",cursor:n??""}),[a,n]),V=x.useCallback(I=>{g.current=I,h(I!==null)},[]),_=x.useCallback(()=>{var I;return!((I=f.current)!=null&&I.isFocusable())},[]);return he.createElement("div",{ref:F,className:S,style:T,role:"presentation"},he.createElement("div",{className:D,ref:v,role:"presentation"},c&&m&&!e.isDestroyed()&&he.createElement(nr.Provider,{value:e.getBeans()},he.createElement(n8,{ref:V,eFocusableElement:m,onTabKeyDown:b,gridCtrl:f.current,forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:_},he.createElement(r8,null)))))},a8=x.memo(o8),l8=class extends ee{postConstruct(){if(this.beans.colAutosize){const e=this.queueResizeOperationsForTick.bind(this);this.addManagedEventListeners({rowExpansionStateChanged:e,expandOrCollapseAll:e,cellValueChanged:e,rowNodeDataChanged:e,rowDataUpdated:e})}}queueResizeOperationsForTick(){const e=this.beans.colAutosize;e.shouldQueueResizeOperations=!0,setTimeout(()=>{e.processResizeOperations()},0)}areHeaderCellsRendered(){return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().every(e=>e.getAllCtrls().every(t=>t.areCellsRendered()))}areCellsRendered(){return this.beans.rowRenderer.getAllRowCtrls().every(e=>e.isRowRendered()&&e.getAllCellCtrls().every(t=>!!t.eGui))}},f1={setGridApi:void 0,maxComponentCreationTimeMs:void 0,children:void 0},c8={gridOptions:void 0,modules:void 0,containerStyle:void 0,className:void 0,passGridApi:void 0,componentWrappingElement:void 0,...f1},g1=new Set(Object.keys(c8)),u8=new Set(Object.keys(f1)),p1=e=>{var C;const t=x.useRef(),r=x.useRef(null),s=x.useRef(null),i=x.useRef([]),n=x.useRef([]),o=x.useRef(e),a=x.useRef(),l=x.useRef(),c=x.useRef(!1),[u,d]=x.useState(void 0),[,h]=x.useState(0),f=x.useRef(),p=y=>{var S;const b=(S=r.current)==null?void 0:S.classList,F=(D="")=>D.trim().split(/\s+/g).filter(Boolean);if(f.current!==y){for(const D of F(f.current))b!=null&&b.contains(D)&&b.remove(D);for(const D of F(y))b!=null&&b.contains(D)||b==null||b.add(D);f.current=y}};x.useLayoutEffect(()=>{p(e.className)},[e.className]);const g=x.useCallback(y=>{if(r.current=y,p(e.className),!y){for(const U of i.current)U();i.current.length=0;return}const b=e.modules||[];s.current||(s.current=new P6(()=>h(U=>U+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),i.current.push(()=>{var U;(U=s.current)==null||U.destroy(),s.current=null}));const F=S2(e.gridOptions,e,Object.keys(e).filter(U=>!g1.has(U))),S=()=>{if(c.current){const U=()=>{var ne;return(ne=a.current)!=null&&ne.shouldQueueUpdates()?void 0:n.current.shift()};let j=U();for(;j;)j(),j=U()}},D=new g8(S);a.current=D;const T=new l8,V={providedBeanInstances:{frameworkCompWrapper:new h8(s.current,F),renderStatus:T},modules:b,frameworkOverrides:D,setThemeOnGridDiv:!0},_=U=>{d(U),U.createBean(T),i.current.push(()=>{U.destroy()}),U.getBean("ctrlsSvc").whenReady({addDestroyFunc:j=>{i.current.push(j)}},()=>{var ne;if(U.isDestroyed())return;const j=t.current;j&&((ne=e.passGridApi)==null||ne.call(e,j))})},I=U=>{U.getBean("ctrlsSvc").whenReady({addDestroyFunc:j=>{i.current.push(j)}},()=>{for(const j of n.current)j();n.current.length=0,c.current=!0})},z=new R4;F.gridId??(F.gridId=l.current),t.current=z.create(y,F,_,I,V),i.current.push(()=>{t.current=void 0}),t.current&&(l.current=t.current.getGridId())},[]),m=x.useMemo(()=>({height:"100%",...e.containerStyle||{}}),[e.containerStyle]),v=x.useCallback(y=>{var b;c.current&&!((b=a.current)!=null&&b.shouldQueueUpdates())?y():n.current.push(y)},[]);x.useEffect(()=>{const y=d8(o.current,e);o.current=e,v(()=>{t.current&&b2(y,t.current)})},[e]);const w=!he.useSyncExternalStore||Jl(e,"renderingMode")==="legacy"?"legacy":"default";return he.createElement("div",{style:m,ref:g},he.createElement(o1.Provider,{value:w},u&&!u.isDestroyed()?he.createElement(a8,{key:u.instanceId,context:u}):null,((C=s.current)==null?void 0:C.getPortals())??null))};function d8(e,t){const r={};for(const s of Object.keys(t)){if(g1.has(s)){u8.has(s)&&oe(274,{prop:s});continue}const i=t[s];e[s]!==i&&(r[s]=i)}return r}var h8=class extends D4{constructor(e,t){super(),this.parent=e,this.gridOptions=t}createWrapper(e,t){const r=this.gridOptions;if(Jl(r,"reactiveCustomComponents")){const o=(a=>{switch(a){case"filter":return Jl(r,"enableFilterHandlers")?x6:w6;case"floatingFilterComponent":return Jl(r,"enableFilterHandlers")?b6:S6;case"dateComponent":return v6;case"dragAndDropImageComponent":return C6;case"loadingOverlayComponent":case"noRowsOverlayComponent":case"activeOverlay":return m6;case"statusPanel":return E6;case"toolPanel":return T6;case"menuItem":return R6;case"cellRenderer":return p6;case"innerHeaderComponent":return F6}})(t.name);if(o)return new o(e,this.parent,t)}else switch(t.name){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"activeOverlay":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":dg();break}const i=!t.cellRenderer&&t.name!=="toolPanel";return new u1(e,this.parent,t,i)}},f8=x.forwardRef((e,t)=>{const r=x.useContext(nr),{registry:s,context:i,gos:n,rowModel:o}=r,[a,l]=x.useState(()=>new Wr),[c,u]=x.useState(()=>new Wr),[d,h]=x.useState(),[f,p]=x.useState(),g=x.useRef(),m=x.useRef(null),v=x.useRef(),w=x.useMemo(()=>QT(e.api.getGridId(),(d==null?void 0:d.rowModelType)??"clientSide"),[e]),C=x.useMemo(()=>a.toString()+" ag-details-row",[a]),y=x.useMemo(()=>c.toString()+" ag-details-grid",[c]);t&&x.useImperativeHandle(t,()=>({refresh(){var S;return((S=g.current)==null?void 0:S.refresh())??!1}})),e.template&&oe(230);const b=x.useCallback(S=>{var V;if(m.current=S,!S||i.isDestroyed()){g.current=i.destroyBean(g.current),(V=v.current)==null||V.call(v);return}const D={toggleCss:(_,I)=>l(z=>z.setClass(_,I)),toggleDetailGridCss:(_,I)=>u(z=>z.setClass(_,I)),setDetailGrid:_=>h(_),setRowData:_=>p(_),getGui:()=>m.current},T=s.createDynamicBean("detailCellRendererCtrl",!0);if(T&&(i.createBean(T),T.init(D,e),g.current=T,n.get("detailRowAutoHeight"))){const _=()=>{if(m.current==null)return;const I=m.current.clientHeight;I!=null&&I>0&&setTimeout(()=>{e.node.setRowHeight(I),(wt(n)||bo(n))&&o.onRowHeightChanged()},0)};v.current=ei(r,S,_),_()}},[]),F=x.useCallback(S=>{var D;(D=g.current)==null||D.registerDetailWithMaster(S)},[]);return he.createElement("div",{className:C,ref:b},d&&he.createElement(p1,{className:y,...d,modules:w,rowData:f,passGridApi:F}))}),g8=class extends ex{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.renderingEngine="react",this.frameworkComponents={agGroupCellRenderer:rm,agGroupRowRenderer:rm,agDetailCellRenderer:f8},this.wrapIncoming=(t,r)=>r==="ensureVisible"?c6(t):t()}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return l6()}},p8=class extends x.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e;for(const t of this.apiListeners)t(e)}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return he.createElement(p1,{...this.props,passGridApi:this.setGridApi})}};t2.registerModules([a6]);function m8({data:e,columnDefs:t,height:r="600px",pagination:s=!0,paginationPageSize:i=5,rowSelection:n="multiple",onGridReady:o,onRowClicked:a,onSelectionChanged:l,emptyMessage:c="No data available",emptyIcon:u="ðŸ“Š",className:d="",suppressRowClickSelection:h=!0,animateRows:f=!0,rowHeight:p=50,headerHeight:g=45,enableRangeSelection:m=!1,enableCharts:v=!1,sideBar:w=!1,getRowStyle:C}){const y={resizable:!0,sortable:!0,filter:!0,floatingFilter:!0,minWidth:100},b=S=>{S.api.sizeColumnsToFit(),o&&o({api:S.api})},F=S=>{var D;return((D=S==null?void 0:S.node)==null?void 0:D.rowIndex)!=null&&S.node.rowIndex%2===0?{backgroundColor:"#ffffff"}:{backgroundColor:"#f9fafb"}};return e.length===0?E.jsxs("div",{className:"text-center py-12 text-gray-500",children:[E.jsx("div",{className:"mx-auto mb-4 w-12 h-12 text-gray-400 text-4xl",children:u}),E.jsx("p",{className:"text-lg",children:c})]}):E.jsx("div",{className:`ag-theme-alpine ${d}`,style:{height:r,width:"100%"},children:E.jsx(p8,{theme:"legacy",rowData:e,columnDefs:t,defaultColDef:y,onGridReady:b,onRowClicked:a,onSelectionChanged:l,pagination:s,paginationPageSize:i,rowSelection:n,suppressRowClickSelection:h,animateRows:f,rowHeight:p,headerHeight:g,enableRangeSelection:m,enableCharts:v,sideBar:w,getRowStyle:C||F,suppressMenuHide:!0,suppressMovableColumns:!1,enableCellTextSelection:!0,ensureDomOrder:!0,maintainColumnOrder:!0})})}const v8=(e,t)=>{const r=(u,d)=>{const h=typeof u=="string"?parseFloat(u):u,f=typeof d=="string"?parseFloat(d):d;return h===0?"out":h<=f?"low":"good"};return[{headerName:"Product Code",field:"product_code",width:140,pinned:"left",cellRenderer:u=>E.jsx("span",{className:"font-mono text-sm text-blue-600 font-semibold",children:u.value}),sortable:!0,filter:!0},{headerName:"Item Name",field:"name",width:200,cellRenderer:u=>{const d=r(u.data.quantity_available,u.data.minimum_stock);return E.jsxs("div",{className:"flex items-center gap-2",children:[(d==="low"||d==="out")&&E.jsx(ff,{className:"size-4 text-yellow-500 flex-shrink-0"}),E.jsx("span",{className:"text-gray-900 font-medium",children:u.value})]})},sortable:!0,filter:!0},{headerName:"Category",field:"category",width:120,cellRenderer:u=>E.jsx("span",{className:"inline-block px-2.5 py-1 text-xs rounded-full bg-blue-100 text-blue-800 font-medium",children:u.value}),sortable:!0,filter:!0},{headerName:"Available Stock",field:"quantity_available",width:140,type:"numericColumn",cellStyle:{textAlign:"center"},sortable:!0,filter:"agNumberColumnFilter"},{headerName:"Unit",field:"unit",width:80,cellStyle:{textAlign:"center"},sortable:!0,filter:!0},{headerName:"Price/Unit",field:"price",width:120,type:"numericColumn",cellRenderer:u=>{const d=typeof u.value=="string"?parseFloat(u.value):u.value;return E.jsxs("span",{className:"text-gray-900 font-medium",children:["â‚¹",(d||0).toFixed(2)]})},cellStyle:{textAlign:"right"},sortable:!0,filter:"agNumberColumnFilter"},{headerName:"Total Value",width:130,cellRenderer:u=>{const d=typeof u.data.quantity_available=="string"?parseFloat(u.data.quantity_available):u.data.quantity_available,h=typeof u.data.price=="string"?parseFloat(u.data.price):u.data.price,f=(d||0)*(h||0);return E.jsxs("span",{className:"text-green-600 font-bold",children:["â‚¹",f.toFixed(2)]})},cellStyle:{textAlign:"right"},sortable:!0,comparator:(u,d,h,f)=>{const p=typeof h.data.quantity_available=="string"?parseFloat(h.data.quantity_available):h.data.quantity_available,g=typeof h.data.price=="string"?parseFloat(h.data.price):h.data.price,m=typeof f.data.quantity_available=="string"?parseFloat(f.data.quantity_available):f.data.quantity_available,v=typeof f.data.price=="string"?parseFloat(f.data.price):f.data.price,w=(p||0)*(g||0),C=(m||0)*(v||0);return w-C}},{headerName:"Min. Stock",field:"minimum_stock",width:110,type:"numericColumn",cellStyle:{textAlign:"right"},sortable:!0,filter:"agNumberColumnFilter"},{headerName:"Status",width:130,cellRenderer:u=>{const d=r(u.data.quantity_available,u.data.minimum_stock),h={out:{label:"Out of Stock",class:"bg-red-100 text-red-800"},low:{label:"Low Stock",class:"bg-yellow-100 text-yellow-800"},good:{label:"In Stock",class:"bg-green-100 text-green-800"}};return E.jsx("span",{className:`inline-block px-2.5 py-1 text-xs rounded-full font-semibold ${h[d].class}`,children:h[d].label})},cellStyle:{textAlign:"center"},sortable:!0,comparator:(u,d,h,f)=>{const p=r(h.data.quantity_available,h.data.minimum_stock),g=r(f.data.quantity_available,f.data.minimum_stock),m={out:0,low:1,good:2};return m[p]-m[g]}},{headerName:"Actions",width:120,cellRenderer:u=>E.jsxs("div",{className:"flex gap-2 justify-center h-full items-center",children:[E.jsx("button",{onClick:()=>e(u.data),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:scale-110",title:"Edit",children:E.jsx(kE,{className:"size-4"})}),E.jsx("button",{onClick:()=>t(u.data.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 hover:scale-110",title:"Delete",children:E.jsx(BE,{className:"size-4"})})]}),cellStyle:{textAlign:"center"},sortable:!1,filter:!1,pinned:"right"}]},C8=["Vegetables","Fruits","Dairy","Meat","Grains","Beverages","Snacks","Condiments","Other"],w8=["kg","g","L","ml","pieces","packs","bottles","cans"];function x8({isOpen:e,onClose:t,onSave:r,editItem:s}){const[i,n]=x.useState({product_code:"",name:"",category:"Vegetables",quantity_available:"",unit:"kg",price:"",minimum_stock:""});x.useEffect(()=>{var a,l,c;console.log(s,"editItemKK"),n(s?{product_code:s==null?void 0:s.product_code,name:s==null?void 0:s.name,category:s==null?void 0:s.category,quantity_available:(a=s==null?void 0:s.quantity_available)==null?void 0:a.toString(),unit:s==null?void 0:s.unit,price:(l=s==null?void 0:s.price)==null?void 0:l.toString(),minimum_stock:(c=s==null?void 0:s.minimum_stock)==null?void 0:c.toString()}:{product_code:"",name:"",category:"Vegetables",quantity_available:"",unit:"kg",price:"",minimum_stock:""})},[s,e]);const o=a=>{a.preventDefault(),r({...s&&{id:s.id},product_code:i.product_code,name:i.name,category:i.category,quantity_available:parseFloat(i.quantity_available),unit:i.unit,price:parseFloat(i.price),minimum_stock:parseFloat(i.minimum_stock)}),t()};return e?E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[E.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[E.jsx("h2",{className:"text-xl font-semibold",children:s?"Edit Item":"Add New Item"}),E.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded",children:E.jsx(aC,{className:"size-5"})})]}),E.jsxs("form",{onSubmit:o,className:"p-6",children:[E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Code *"}),E.jsx("input",{type:"text",required:!0,value:i.product_code,onChange:a=>n({...i,product_code:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., MPH001"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name *"}),E.jsx("input",{type:"text",required:!0,value:i.name,onChange:a=>n({...i,name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Tomatoes"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),E.jsx("select",{required:!0,value:i.category,onChange:a=>n({...i,category:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:C8.map(a=>E.jsx("option",{value:a,children:a},a))})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),E.jsx("input",{type:"number",required:!0,min:"0",step:"0.1",value:i.quantity_available,onChange:a=>n({...i,quantity_available:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit *"}),E.jsx("select",{required:!0,value:i.unit,onChange:a=>n({...i,unit:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:w8.map(a=>E.jsx("option",{value:a,children:a},a))})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price per Unit (â‚¹)"}),E.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:i.price,onChange:a=>n({...i,price:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Stock Level *"}),E.jsx("input",{type:"number",required:!0,min:"0",step:"0.1",value:i.minimum_stock,onChange:a=>n({...i,minimum_stock:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"}),E.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Alert when stock falls below this level"})]})]}),E.jsxs("div",{className:"flex gap-3 mt-6",children:[E.jsx("button",{type:"button",onClick:t,className:"flex-1 px-5 py-2.5 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-all duration-300 font-medium",children:"Cancel"}),E.jsx("button",{type:"submit",className:"flex-1 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-lg hover:shadow-blue-500/50 font-medium",children:s?"Update":"Add Item"})]})]})]})}):null}function y8({isOpen:e,onClose:t,onConfirm:r,itemName:s}){return e?E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[E.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:E.jsx(ff,{className:"size-5 text-red-600"})}),E.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Delete Item"})]}),E.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded",children:E.jsx(aC,{className:"size-5"})})]}),E.jsxs("div",{className:"p-6",children:[E.jsx("p",{className:"text-gray-600 mb-2",children:"Are you sure you want to delete this item?"}),E.jsx("p",{className:"font-medium text-gray-900 bg-gray-50 p-3 rounded-lg",children:s}),E.jsx("p",{className:"text-sm text-red-600 mt-3",children:"This action cannot be undone."})]}),E.jsxs("div",{className:"flex gap-3 p-6 pt-0",children:[E.jsx("button",{type:"button",onClick:t,className:"flex-1 px-5 py-2.5 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-all duration-300 font-medium",children:"Cancel"}),E.jsx("button",{type:"button",onClick:r,className:"flex-1 px-5 py-2.5 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-300 shadow-lg hover:shadow-red-500/50 font-medium",children:"Delete"})]})]})}):null}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Kc={};Kc.version="0.18.5";var m1=1252,S8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],hg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fg=function(e){S8.indexOf(e)!=-1&&(m1=hg[0]=e)};function b8(){fg(1252)}var Qr=function(e){fg(e)};function gg(){Qr(1200),b8()}function am(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function F8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function v1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var jo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?F8(e.slice(2)):t==254&&r==255?v1(e.slice(2)):t==65279?e.slice(1):e},kl=function(t){return String.fromCharCode(t)},lm=function(t){return String.fromCharCode(t)},Pa,hi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Da(e){for(var t="",r=0,s=0,i=0,n=0,o=0,a=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),n=r>>2,s=e.charCodeAt(c++),o=(r&3)<<4|s>>4,i=e.charCodeAt(c++),a=(s&15)<<2|i>>6,l=i&63,isNaN(s)?a=l=64:isNaN(i)&&(l=64),t+=hi.charAt(n)+hi.charAt(o)+hi.charAt(a)+hi.charAt(l);return t}function Pr(e){var t="",r=0,s=0,i=0,n=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)n=hi.indexOf(e.charAt(c++)),o=hi.indexOf(e.charAt(c++)),r=n<<2|o>>4,t+=String.fromCharCode(r),a=hi.indexOf(e.charAt(c++)),s=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(s)),l=hi.indexOf(e.charAt(c++)),i=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Ve=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ri=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Si(e){return Ve?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function cm(e){return Ve?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Fr=function(t){return Ve?ri(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Iu(e){if(typeof ArrayBuffer>"u")return Fr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Ai(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function R8(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function pg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return pg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Vt=Ve?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ri(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function E8(e){for(var t=[],r=0,s=e.length+250,i=Si(e.length+255),n=0;n<e.length;++n){var o=e.charCodeAt(n);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++n)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>s&&(t.push(i.slice(0,r)),r=0,i=Si(65535),s=65530)}return t.push(i.slice(0,r)),Vt(t)}var ur=/\u0000/g,$o=/[\u0001-\u0006]/g;function so(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function es(e,t){var r=""+e;return r.length>=t?r:St("0",t-r.length)+r}function mg(e,t){var r=""+e;return r.length>=t?r:St(" ",t-r.length)+r}function qc(e,t){var r=""+e;return r.length>=t?r:r+St(" ",t-r.length)}function T8(e,t){var r=""+Math.round(e);return r.length>=t?r:St("0",t-r.length)+r}function k8(e,t){var r=""+e;return r.length>=t?r:St("0",t-r.length)+r}var um=Math.pow(2,32);function An(e,t){if(e>um||e<-um)return T8(e,t);var r=Math.round(e);return k8(r,t)}function Xc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var dm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ld=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function P8(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},hm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},D8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Yc(e,t,r){for(var s=e<0?-1:1,i=e*s,n=0,o=1,a=0,l=1,c=0,u=0,d=Math.floor(i);c<t&&(d=Math.floor(i),a=d*o+n,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),n=o,o=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=n):(u=c,a=o)),!r)return[0,s*a,u];var h=Math.floor(s*a/u);return[h,s*a-h*u,u]}function Ui(e,t,r){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),n=0,o=[],a={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(s+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++s,++a.D)),s===60)o=r?[1317,10,29]:[1900,2,29],n=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],n=6;else{s>60&&--s;var l=new Date(1900,0,1);l.setDate(l.getDate()+s-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),s<60&&(n=(n+6)%7),r&&(n=O8(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=n,a}var C1=new Date(1899,11,31,0,0,0),A8=C1.getTime(),I8=new Date(1900,2,1,0,0,0);function w1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=I8&&(r+=1440*60*1e3),(r-(A8+(e.getTimezoneOffset()-C1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function vg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function M8(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function _8(e){var t=e<0?12:11,r=vg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function L8(e){var t=vg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Aa(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=_8(e):t===10?r=e.toFixed(10).substr(0,12):r=L8(e),vg(M8(r.toUpperCase()))}function dn(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Aa(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Kr(14,w1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function O8(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function N8(e,t,r,s){var i="",n=0,o=0,a=r.y,l,c=0;switch(e){case 98:a=r.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Ld[r.m-1][1];case 5:return Ld[r.m-1][0];default:return Ld[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return dm[r.q][0];default:return dm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?es(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,n=Math.round(o*(r.S+r.u)),n>=60*o&&(n=0),t==="s"?n===0?"0":""+n/o:(i=es(n,2+s),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?es(l,c):"";return u}function fi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var x1=/%/g;function B8(e,t,r){var s=t.replace(x1,""),i=t.length-s.length;return Us(e,s,r*Math.pow(10,2*i))+St("%",i)}function H8(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Us(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function y1(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+y1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%i;if(n<0&&(n+=i),r=(t/Math.pow(10,n)).toPrecision(s+1+(i+n)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+n)%i)+"."+u.substr(n)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var S1=/# (\?+)( ?)\/( ?)(\d+)/;function V8(e,t,r){var s=parseInt(e[4],10),i=Math.round(t*s),n=Math.floor(i/s),o=i-n*s,a=s;return r+(n===0?"":""+n)+" "+(o===0?St(" ",e[1].length+1+e[4].length):mg(o,e[1].length)+e[2]+"/"+e[3]+es(a,e[4].length))}function G8(e,t,r){return r+(t===0?"":""+t)+St(" ",e[1].length+2+e[4].length)}var b1=/^#*0*\.([0#]+)/,F1=/\).*[0#]/,R1=/\(###\) ###\\?-####/;function ar(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function fm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function gm(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function W8(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function z8(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Mr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F1)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mr("n",s,r):"("+Mr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return H8(e,t,r);if(t.indexOf("%")!==-1)return B8(e,t,r);if(t.indexOf("E")!==-1)return y1(t,r);if(t.charCodeAt(0)===36)return"$"+Mr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,n,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+An(l,t.length);if(t.match(/^[#?]+$/))return i=An(r,0),i==="0"&&(i=""),i.length>t.length?i:ar(t.substr(0,t.length-i.length))+i;if(n=t.match(S1))return V8(n,l,c);if(t.match(/^#+0+$/))return c+An(l,t.length-t.indexOf("0"));if(n=t.match(b1))return i=fm(r,n[1].length).replace(/^([^\.]+)$/,"$1."+ar(n[1])).replace(/\.$/,"."+ar(n[1])).replace(/\.(\d*)$/,function(p,g){return"."+g+St("0",ar(n[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+fm(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+fi(An(l,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mr(e,t,-r):fi(""+(Math.floor(r)+W8(r,n[1].length)))+"."+es(gm(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return Mr(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=so(Mr(e,t.replace(/[\\-]/g,""),r)),o=0,so(so(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<i.length?i.charAt(o++):p==="0"?"0":""}));if(t.match(R1))return i=Mr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),a=Yc(l,Math.pow(10,o)-1,!1),i=""+c,u=Us("n",n[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+n[2]+"/"+n[3],u=qc(a[2],o),u.length<n[4].length&&(u=ar(n[4].substr(n[4].length-u.length))+u),i+=u,i;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),a=Yc(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?mg(a[1],o)+n[2]+"/"+n[3]+qc(a[2],o):St(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return i=An(r,0),t.length<=i.length?i:ar(t.substr(0,t.length-i.length))+i;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=t.indexOf(".")-o,h=t.length-i.length-d;return ar(t.substr(0,d)+i+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return o=gm(r,n[1].length),r<0?"-"+Mr(e,t,-r):fi(z8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?es(0,3-p.length):"")+p})+"."+es(o,n[1].length);switch(t){case"###,##0.00":return Mr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=fi(An(l,0));return f!=="0"?c+f:"";case"###,###.00":return Mr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Mr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function U8(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Us(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function j8(e,t,r){var s=t.replace(x1,""),i=t.length-s.length;return Us(e,s,r*Math.pow(10,2*i))+St("%",i)}function E1(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+E1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%i;if(n<0&&(n+=i),r=(t/Math.pow(10,n)).toPrecision(s+1+(i+n)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+n)%i)+"."+u.substr(n)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F1)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fs("n",s,r):"("+fs("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return U8(e,t,r);if(t.indexOf("%")!==-1)return j8(e,t,r);if(t.indexOf("E")!==-1)return E1(t,r);if(t.charCodeAt(0)===36)return"$"+fs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,n,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+es(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:ar(t.substr(0,t.length-i.length))+i;if(n=t.match(S1))return G8(n,l,c);if(t.match(/^#+0+$/))return c+es(l,t.length-t.indexOf("0"));if(n=t.match(b1))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ar(n[1])).replace(/\.$/,"."+ar(n[1])),i=i.replace(/\.(\d*)$/,function(p,g){return"."+g+St("0",ar(n[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+fi(""+l);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fs(e,t,-r):fi(""+r)+"."+St("0",n[1].length);if(n=t.match(/^#,#*,#0/))return fs(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=so(fs(e,t.replace(/[\\-]/g,""),r)),o=0,so(so(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<i.length?i.charAt(o++):p==="0"?"0":""}));if(t.match(R1))return i=fs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),a=Yc(l,Math.pow(10,o)-1,!1),i=""+c,u=Us("n",n[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+n[2]+"/"+n[3],u=qc(a[2],o),u.length<n[4].length&&(u=ar(n[4].substr(n[4].length-u.length))+u),i+=u,i;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),a=Yc(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?mg(a[1],o)+n[2]+"/"+n[3]+qc(a[2],o):St(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:ar(t.substr(0,t.length-i.length))+i;if(n=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=t.indexOf(".")-o,h=t.length-i.length-d;return ar(t.substr(0,d)+i+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fs(e,t,-r):fi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?es(0,3-p.length):"")+p})+"."+es(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=fi(""+l);return f!=="0"?c+f:"";default:if(t.match(/\.[0#?]*$/))return fs(e,t.slice(0,t.lastIndexOf(".")),r)+ar(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Us(e,t,r){return(r|0)===r?fs(e,t,r):Mr(e,t,r)}function $8(e){for(var t=[],r=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(i,s-i),i=s+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var T1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function To(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Xc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(T1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function K8(e,t,r,s){for(var i=[],n="",o=0,a="",l="t",c,u,d,h="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!Xc(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(n="";(d=e.charCodeAt(++o))!==34&&o<e.length;)n+=String.fromCharCode(d);i[i.length]={t:"t",v:n},++o;break;case"\\":var f=e.charAt(++o),p=f==="("||f===")"?f:"t";i[i.length]={t:p,v:f},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=Ui(t,r,e.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Ui(t,r),c==null))return"";for(n=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)n+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=h),i[i.length]={t:a,v:n},l=a;break;case"A":case"a":case"ä¸Š":var g={t:a,v:a};if(c==null&&(c=Ui(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(c!=null&&(g.v=c.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),g.t="T",o+=5,h="h"):(g.t="t",++o),c==null&&g.t==="T")return"";i[i.length]=g,l=a;break;case"[":for(n=a;e.charAt(o++)!=="]"&&o<e.length;)n+=e.charAt(o);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(T1)){if(c==null&&(c=Ui(t,r),c==null))return"";i[i.length]={t:"Z",v:n.toLowerCase()},l=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",To(e)||(i[i.length]={t:"t",v:n}));break;case".":if(c!=null){for(n=a;++o<e.length&&(a=e.charAt(o))==="0";)n+=a;i[i.length]={t:"s",v:n};break}case"0":case"#":for(n=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)n+=a;i[i.length]={t:"n",v:n};break;case"?":for(n=a;e.charAt(++o)===a;)n+=a;i[i.length]={t:a,v:n},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:s===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)n+=e.charAt(o);i[i.length]={t:"D",v:n};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var m=0,v=0,w;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,l="h",m<1&&(m=1);break;case"s":(w=i[o].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[o].v.match(/[Hh]/)&&(m=1),m<2&&i[o].v.match(/[Mm]/)&&(m=2),m<3&&i[o].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var C="",y;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=N8(i[o].t.charCodeAt(0),i[o].v,c,v),i[o].t="t";break;case"n":case"?":for(y=o+1;i[y]!=null&&((a=i[y].t)==="?"||a==="D"||(a===" "||a==="t")&&i[y+1]!=null&&(i[y+1].t==="?"||i[y+1].t==="t"&&i[y+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[y].v==="/"||i[y].v===" "&&i[y+1]!=null&&i[y+1].t=="?"));)i[o].v+=i[y].v,i[y]={v:"",t:";"},++y;C+=i[o].v,o=y-1;break;case"G":i[o].t="t",i[o].v=dn(t,r);break}var b="",F,S;if(C.length>0){C.charCodeAt(0)==40?(F=t<0&&C.charCodeAt(0)===45?-t:t,S=Us("n",C,F)):(F=t<0&&s>1?-t:t,S=Us("n",C,F),F<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),y=S.length-1;var D=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){D=o;break}var T=i.length;if(D===i.length&&S.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(y>=i[o].v.length-1?(y-=i[o].v.length,i[o].v=S.substr(y+1,i[o].v.length)):y<0?i[o].v="":(i[o].v=S.substr(0,y+1),y=-1),i[o].t="t",T=o);y>=0&&T<i.length&&(i[T].v=S.substr(0,y+1)+i[T].v)}else if(D!==i.length&&S.indexOf("E")===-1){for(y=S.indexOf(".")-1,o=D;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===D?i[o].v.indexOf(".")-1:i[o].v.length-1,b=i[o].v.substr(u+1);u>=0;--u)y>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(b=S.charAt(y--)+b);i[o].v=b,i[o].t="t",T=o}for(y>=0&&T<i.length&&(i[T].v=S.substr(0,y+1)+i[T].v),y=S.indexOf(".")+1,o=D;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==D)){for(u=i[o].v.indexOf(".")>-1&&o===D?i[o].v.indexOf(".")+1:0,b=i[o].v.substr(0,u);u<i[o].v.length;++u)y<S.length&&(b+=S.charAt(y++));i[o].v=b,i[o].t="t",T=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(F=s>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Us(i[o].t,i[o].v,F),i[o].t="t");var V="";for(o=0;o!==i.length;++o)i[o]!=null&&(V+=i[o].v);return V}var pm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function mm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function q8(e,t){var r=$8(e),s=r.length,i=r[s-1].indexOf("@");if(s<4&&i>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(pm),a=r[1].match(pm);return mm(t,o)?[s,r[0]]:mm(t,a)?[s,r[1]]:[s,r[o!=null&&a!=null?2:1]]}return[s,n]}function Kr(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:De)[e],s==null&&(s=r.table&&r.table[hm[e]]||De[hm[e]]),s==null&&(s=D8[e]||"General");break}if(Xc(s,0))return dn(t,r);t instanceof Date&&(t=w1(t,r.date1904));var i=q8(s,t);if(Xc(i[1]))return dn(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return K8(i[1],t,r,i[0])}function js(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(De[r]==null){t<0&&(t=r);continue}if(De[r]==e){t=r;break}}t<0&&(t=391)}return De[t]=e,t}function Mu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&js(e[t],t)}function ko(){De=P8()}var X8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},k1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Y8(e){var t=typeof e=="number"?De[e]:e;return t=t.replace(k1,"(\\d+)"),new RegExp("^"+t+"$")}function J8(e,t,r){var s=-1,i=-1,n=-1,o=-1,a=-1,l=-1;(t.match(k1)||[]).forEach(function(d,h){var f=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":s=f;break;case"d":n=f;break;case"h":o=f;break;case"s":l=f;break;case"m":o>=0?a=f:i=f;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:s==-1&&i==-1&&n==-1?u:c+"T"+u}var Z8=(function(){var e={};e.version="1.2.0";function t(){for(var S=0,D=new Array(256),T=0;T!=256;++T)S=T,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,D[T]=S;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function s(S){var D=0,T=0,V=0,_=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)_[V]=S[V];for(V=0;V!=256;++V)for(T=S[V],D=256+V;D<4096;D+=256)T=_[D]=T>>>8^S[T&255];var I=[];for(V=1;V!=16;++V)I[V-1]=typeof Int32Array<"u"?_.subarray(V*256,V*256+256):_.slice(V*256,V*256+256);return I}var i=s(r),n=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],f=i[8],p=i[9],g=i[10],m=i[11],v=i[12],w=i[13],C=i[14];function y(S,D){for(var T=D^-1,V=0,_=S.length;V<_;)T=T>>>8^r[(T^S.charCodeAt(V++))&255];return~T}function b(S,D){for(var T=D^-1,V=S.length-15,_=0;_<V;)T=C[S[_++]^T&255]^w[S[_++]^T>>8&255]^v[S[_++]^T>>16&255]^m[S[_++]^T>>>24]^g[S[_++]]^p[S[_++]]^f[S[_++]]^h[S[_++]]^d[S[_++]]^u[S[_++]]^c[S[_++]]^l[S[_++]]^a[S[_++]]^o[S[_++]]^n[S[_++]]^r[S[_++]];for(V+=15;_<V;)T=T>>>8^r[(T^S[_++])&255];return~T}function F(S,D){for(var T=D^-1,V=0,_=S.length,I=0,z=0;V<_;)I=S.charCodeAt(V++),I<128?T=T>>>8^r[(T^I)&255]:I<2048?(T=T>>>8^r[(T^(192|I>>6&31))&255],T=T>>>8^r[(T^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,z=S.charCodeAt(V++)&1023,T=T>>>8^r[(T^(240|I>>8&7))&255],T=T>>>8^r[(T^(128|I>>2&63))&255],T=T>>>8^r[(T^(128|z>>6&15|(I&3)<<4))&255],T=T>>>8^r[(T^(128|z&63))&255]):(T=T>>>8^r[(T^(224|I>>12&15))&255],T=T>>>8^r[(T^(128|I>>6&63))&255],T=T>>>8^r[(T^(128|I&63))&255]);return~T}return e.table=r,e.bstr=y,e.buf=b,e.str=F,e})(),Te=(function(){var t={};t.version="1.2.1";function r(R,M){for(var k=R.split("/"),A=M.split("/"),L=0,N=0,X=Math.min(k.length,A.length);L<X;++L){if(N=k[L].length-A[L].length)return N;if(k[L]!=A[L])return k[L]<A[L]?-1:1}return k.length-A.length}function s(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:s(R.slice(0,-1));var M=R.lastIndexOf("/");return M===-1?R:R.slice(0,M+1)}function i(R){if(R.charAt(R.length-1)=="/")return i(R.slice(0,-1));var M=R.lastIndexOf("/");return M===-1?R:R.slice(M+1)}function n(R,M){typeof M=="string"&&(M=new Date(M));var k=M.getHours();k=k<<6|M.getMinutes(),k=k<<5|M.getSeconds()>>>1,R.write_shift(2,k);var A=M.getFullYear()-1980;A=A<<4|M.getMonth()+1,A=A<<5|M.getDate(),R.write_shift(2,A)}function o(R){var M=R.read_shift(2)&65535,k=R.read_shift(2)&65535,A=new Date,L=k&31;k>>>=5;var N=k&15;k>>>=4,A.setMilliseconds(0),A.setFullYear(k+1980),A.setMonth(N-1),A.setDate(L);var X=M&31;M>>>=5;var re=M&63;return M>>>=6,A.setHours(M),A.setMinutes(re),A.setSeconds(X<<1),A}function a(R){$t(R,0);for(var M={},k=0;R.l<=R.length-4;){var A=R.read_shift(2),L=R.read_shift(2),N=R.l+L,X={};switch(A){case 21589:k=R.read_shift(1),k&1&&(X.mtime=R.read_shift(4)),L>5&&(k&2&&(X.atime=R.read_shift(4)),k&4&&(X.ctime=R.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}R.l=N,M[A]=X}return M}var l;function c(){return l||(l={})}function u(R,M){if(R[0]==80&&R[1]==75)return rp(R,M);if((R[0]|32)==109&&(R[1]|32)==105)return _S(R,M);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var k=3,A=512,L=0,N=0,X=0,re=0,q=0,Y=[],Z=R.slice(0,512);$t(Z,0);var de=d(Z);switch(k=de[0],k){case 3:A=512;break;case 4:A=4096;break;case 0:if(de[1]==0)return rp(R,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+k)}A!==512&&(Z=R.slice(0,A),$t(Z,28));var ye=R.slice(0,A);h(Z,k);var Fe=Z.read_shift(4,"i");if(k===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);Z.l+=4,X=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),re=Z.read_shift(4,"i"),L=Z.read_shift(4,"i"),q=Z.read_shift(4,"i"),N=Z.read_shift(4,"i");for(var ge=-1,Se=0;Se<109&&(ge=Z.read_shift(4,"i"),!(ge<0));++Se)Y[Se]=ge;var Le=f(R,A);m(q,N,Le,A,Y);var vt=w(Le,X,Y,A);vt[X].name="!Directory",L>0&&re!==z&&(vt[re].name="!MiniFAT"),vt[Y[0]].name="!FAT",vt.fat_addrs=Y,vt.ssz=A;var Ct={},Xt=[],Ao=[],Io=[];C(X,vt,Le,Xt,L,Ct,Ao,re),p(Ao,Io,Xt),Xt.shift();var Mo={FileIndex:Ao,FullPaths:Io};return M&&M.raw&&(Mo.raw={header:ye,sectors:Le}),Mo}function d(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(U,"Header Signature: "),R.l+=16;var M=R.read_shift(2,"u");return[R.read_shift(2,"u"),M]}function h(R,M){var k=9;switch(R.l+=2,k=R.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+k);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+k);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+k)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function f(R,M){for(var k=Math.ceil(R.length/M)-1,A=[],L=1;L<k;++L)A[L-1]=R.slice(L*M,(L+1)*M);return A[k-1]=R.slice(k*M),A}function p(R,M,k){for(var A=0,L=0,N=0,X=0,re=0,q=k.length,Y=[],Z=[];A<q;++A)Y[A]=Z[A]=A,M[A]=k[A];for(;re<Z.length;++re)A=Z[re],L=R[A].L,N=R[A].R,X=R[A].C,Y[A]===A&&(L!==-1&&Y[L]!==L&&(Y[A]=Y[L]),N!==-1&&Y[N]!==N&&(Y[A]=Y[N])),X!==-1&&(Y[X]=A),L!==-1&&A!=Y[A]&&(Y[L]=Y[A],Z.lastIndexOf(L)<re&&Z.push(L)),N!==-1&&A!=Y[A]&&(Y[N]=Y[A],Z.lastIndexOf(N)<re&&Z.push(N));for(A=1;A<q;++A)Y[A]===A&&(N!==-1&&Y[N]!==N?Y[A]=Y[N]:L!==-1&&Y[L]!==L&&(Y[A]=Y[L]));for(A=1;A<q;++A)if(R[A].type!==0){if(re=A,re!=Y[re])do re=Y[re],M[A]=M[re]+"/"+M[A];while(re!==0&&Y[re]!==-1&&re!=Y[re]);Y[A]=-1}for(M[0]+="/",A=1;A<q;++A)R[A].type!==2&&(M[A]+="/")}function g(R,M,k){for(var A=R.start,L=R.size,N=[],X=A;k&&L>0&&X>=0;)N.push(M.slice(X*I,X*I+I)),L-=I,X=Wi(k,X*4);return N.length===0?Q(0):Vt(N).slice(0,R.size)}function m(R,M,k,A,L){var N=z;if(R===z){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var X=k[R],re=(A>>>2)-1;if(!X)return;for(var q=0;q<re&&(N=Wi(X,q*4))!==z;++q)L.push(N);m(Wi(X,A-4),M-1,k,A,L)}}function v(R,M,k,A,L){var N=[],X=[];L||(L=[]);var re=A-1,q=0,Y=0;for(q=M;q>=0;){L[q]=!0,N[N.length]=q,X.push(R[q]);var Z=k[Math.floor(q*4/A)];if(Y=q*4&re,A<4+Y)throw new Error("FAT boundary crossed: "+q+" 4 "+A);if(!R[Z])break;q=Wi(R[Z],Y)}return{nodes:N,data:km([X])}}function w(R,M,k,A){var L=R.length,N=[],X=[],re=[],q=[],Y=A-1,Z=0,de=0,ye=0,Fe=0;for(Z=0;Z<L;++Z)if(re=[],ye=Z+M,ye>=L&&(ye-=L),!X[ye]){q=[];var ge=[];for(de=ye;de>=0;){ge[de]=!0,X[de]=!0,re[re.length]=de,q.push(R[de]);var Se=k[Math.floor(de*4/A)];if(Fe=de*4&Y,A<4+Fe)throw new Error("FAT boundary crossed: "+de+" 4 "+A);if(!R[Se]||(de=Wi(R[Se],Fe),ge[de]))break}N[ye]={nodes:re,data:km([q])}}return N}function C(R,M,k,A,L,N,X,re){for(var q=0,Y=A.length?2:0,Z=M[R].data,de=0,ye=0,Fe;de<Z.length;de+=128){var ge=Z.slice(de,de+128);$t(ge,64),ye=ge.read_shift(2),Fe=Fg(ge,0,ye-Y),A.push(Fe);var Se={name:Fe,type:ge.read_shift(1),color:ge.read_shift(1),L:ge.read_shift(4,"i"),R:ge.read_shift(4,"i"),C:ge.read_shift(4,"i"),clsid:ge.read_shift(16),state:ge.read_shift(4,"i"),start:0,size:0},Le=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);Le!==0&&(Se.ct=y(ge,ge.l-8));var vt=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);vt!==0&&(Se.mt=y(ge,ge.l-8)),Se.start=ge.read_shift(4,"i"),Se.size=ge.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=z,Se.name=""),Se.type===5?(q=Se.start,L>0&&q!==z&&(M[q].name="!StreamData")):Se.size>=4096?(Se.storage="fat",M[Se.start]===void 0&&(M[Se.start]=v(k,Se.start,M.fat_addrs,M.ssz)),M[Se.start].name=Se.name,Se.content=M[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:q!==z&&Se.start!==z&&M[q]&&(Se.content=g(Se,M[q].data,(M[re]||{}).data))),Se.content&&$t(Se.content,0),N[Fe]=Se,X.push(Se)}}function y(R,M){return new Date((br(R,M+4)/1e7*Math.pow(2,32)+br(R,M)/1e7-11644473600)*1e3)}function b(R,M){return c(),u(l.readFileSync(R),M)}function F(R,M){var k=M&&M.type;switch(k||Ve&&Buffer.isBuffer(R)&&(k="buffer"),k||"base64"){case"file":return b(R,M);case"base64":return u(Fr(Pr(R)),M);case"binary":return u(Fr(R),M)}return u(R,M)}function S(R,M){var k=M||{},A=k.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=A+"/",R.FileIndex[0]={name:A,type:5}),k.CLSID&&(R.FileIndex[0].clsid=k.CLSID),D(R)}function D(R){var M="Sh33tJ5";if(!Te.find(R,"/"+M)){var k=Q(4);k[0]=55,k[1]=k[3]=50,k[2]=54,R.FileIndex.push({name:M,type:2,content:k,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+M),T(R)}}function T(R,M){S(R);for(var k=!1,A=!1,L=R.FullPaths.length-1;L>=0;--L){var N=R.FileIndex[L];switch(N.type){case 0:A?k=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(N.R*N.L*N.C)&&(k=!0),N.R>-1&&N.L>-1&&N.R==N.L&&(k=!0);break;default:k=!0;break}}if(!(!k&&!M)){var X=new Date(1987,1,19),re=0,q=Object.create?Object.create(null):{},Y=[];for(L=0;L<R.FullPaths.length;++L)q[R.FullPaths[L]]=!0,R.FileIndex[L].type!==0&&Y.push([R.FullPaths[L],R.FileIndex[L]]);for(L=0;L<Y.length;++L){var Z=s(Y[L][0]);A=q[Z],A||(Y.push([Z,{name:i(Z).replace("/",""),type:1,clsid:ne,ct:X,mt:X,content:null}]),q[Z]=!0)}for(Y.sort(function(Fe,ge){return r(Fe[0],ge[0])}),R.FullPaths=[],R.FileIndex=[],L=0;L<Y.length;++L)R.FullPaths[L]=Y[L][0],R.FileIndex[L]=Y[L][1];for(L=0;L<Y.length;++L){var de=R.FileIndex[L],ye=R.FullPaths[L];if(de.name=i(ye).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||ne,L===0)de.C=Y.length>1?1:-1,de.size=0,de.type=5;else if(ye.slice(-1)=="/"){for(re=L+1;re<Y.length&&s(R.FullPaths[re])!=ye;++re);for(de.C=re>=Y.length?-1:re,re=L+1;re<Y.length&&s(R.FullPaths[re])!=s(ye);++re);de.R=re>=Y.length?-1:re,de.type=1}else s(R.FullPaths[L+1]||"")==s(ye)&&(de.R=L+1),de.type=2}}}function V(R,M){var k=M||{};if(k.fileType=="mad")return LS(R,k);switch(T(R),k.fileType){case"zip":return kS(R,k)}var A=(function(Fe){for(var ge=0,Se=0,Le=0;Le<Fe.FileIndex.length;++Le){var vt=Fe.FileIndex[Le];if(vt.content){var Ct=vt.content.length;Ct>0&&(Ct<4096?ge+=Ct+63>>6:Se+=Ct+511>>9)}}for(var Xt=Fe.FullPaths.length+3>>2,Ao=ge+7>>3,Io=ge+127>>7,Mo=Ao+Se+Xt+Io,Li=Mo+127>>7,Wu=Li<=109?0:Math.ceil((Li-109)/127);Mo+Li+Wu+127>>7>Li;)Wu=++Li<=109?0:Math.ceil((Li-109)/127);var Is=[1,Wu,Li,Io,Xt,Se,ge,0];return Fe.FileIndex[0].size=ge<<6,Is[7]=(Fe.FileIndex[0].start=Is[0]+Is[1]+Is[2]+Is[3]+Is[4]+Is[5])+(Is[6]+7>>3),Is})(R),L=Q(A[7]<<9),N=0,X=0;{for(N=0;N<8;++N)L.write_shift(1,j[N]);for(N=0;N<8;++N)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),N=0;N<3;++N)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,A[2]),L.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:z),L.write_shift(4,A[3]),L.write_shift(-4,A[1]?A[0]-1:z),L.write_shift(4,A[1]),N=0;N<109;++N)L.write_shift(-4,N<A[2]?A[1]+N:-1)}if(A[1])for(X=0;X<A[1];++X){for(;N<236+X*127;++N)L.write_shift(-4,N<A[2]?A[1]+N:-1);L.write_shift(-4,X===A[1]-1?z:X+1)}var re=function(Fe){for(X+=Fe;N<X-1;++N)L.write_shift(-4,N+1);Fe&&(++N,L.write_shift(-4,z))};for(X=N=0,X+=A[1];N<X;++N)L.write_shift(-4,se.DIFSECT);for(X+=A[2];N<X;++N)L.write_shift(-4,se.FATSECT);re(A[3]),re(A[4]);for(var q=0,Y=0,Z=R.FileIndex[0];q<R.FileIndex.length;++q)Z=R.FileIndex[q],Z.content&&(Y=Z.content.length,!(Y<4096)&&(Z.start=X,re(Y+511>>9)));for(re(A[6]+7>>3);L.l&511;)L.write_shift(-4,se.ENDOFCHAIN);for(X=N=0,q=0;q<R.FileIndex.length;++q)Z=R.FileIndex[q],Z.content&&(Y=Z.content.length,!(!Y||Y>=4096)&&(Z.start=X,re(Y+63>>6)));for(;L.l&511;)L.write_shift(-4,se.ENDOFCHAIN);for(N=0;N<A[4]<<2;++N){var de=R.FullPaths[N];if(!de||de.length===0){for(q=0;q<17;++q)L.write_shift(4,0);for(q=0;q<3;++q)L.write_shift(4,-1);for(q=0;q<12;++q)L.write_shift(4,0);continue}Z=R.FileIndex[N],N===0&&(Z.start=Z.size?Z.start-1:z);var ye=N===0&&k.root||Z.name;if(Y=2*(ye.length+1),L.write_shift(64,ye,"utf16le"),L.write_shift(2,Y),L.write_shift(1,Z.type),L.write_shift(1,Z.color),L.write_shift(-4,Z.L),L.write_shift(-4,Z.R),L.write_shift(-4,Z.C),Z.clsid)L.write_shift(16,Z.clsid,"hex");else for(q=0;q<4;++q)L.write_shift(4,0);L.write_shift(4,Z.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Z.start),L.write_shift(4,Z.size),L.write_shift(4,0)}for(N=1;N<R.FileIndex.length;++N)if(Z=R.FileIndex[N],Z.size>=4096)if(L.l=Z.start+1<<9,Ve&&Buffer.isBuffer(Z.content))Z.content.copy(L,L.l,0,Z.size),L.l+=Z.size+511&-512;else{for(q=0;q<Z.size;++q)L.write_shift(1,Z.content[q]);for(;q&511;++q)L.write_shift(1,0)}for(N=1;N<R.FileIndex.length;++N)if(Z=R.FileIndex[N],Z.size>0&&Z.size<4096)if(Ve&&Buffer.isBuffer(Z.content))Z.content.copy(L,L.l,0,Z.size),L.l+=Z.size+63&-64;else{for(q=0;q<Z.size;++q)L.write_shift(1,Z.content[q]);for(;q&63;++q)L.write_shift(1,0)}if(Ve)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function _(R,M){var k=R.FullPaths.map(function(q){return q.toUpperCase()}),A=k.map(function(q){var Y=q.split("/");return Y[Y.length-(q.slice(-1)=="/"?2:1)]}),L=!1;M.charCodeAt(0)===47?(L=!0,M=k[0].slice(0,-1)+M):L=M.indexOf("/")!==-1;var N=M.toUpperCase(),X=L===!0?k.indexOf(N):A.indexOf(N);if(X!==-1)return R.FileIndex[X];var re=!N.match($o);for(N=N.replace(ur,""),re&&(N=N.replace($o,"!")),X=0;X<k.length;++X)if((re?k[X].replace($o,"!"):k[X]).replace(ur,"")==N||(re?A[X].replace($o,"!"):A[X]).replace(ur,"")==N)return R.FileIndex[X];return null}var I=64,z=-2,U="d0cf11e0a1b11ae1",j=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(R,M,k){c();var A=V(R,k);l.writeFileSync(M,A)}function W(R){for(var M=new Array(R.length),k=0;k<R.length;++k)M[k]=String.fromCharCode(R[k]);return M.join("")}function fe(R,M){var k=V(R,M);switch(M&&M.type||"buffer"){case"file":return c(),l.writeFileSync(M.filename,k),k;case"binary":return typeof k=="string"?k:W(k);case"base64":return Da(typeof k=="string"?k:W(k));case"buffer":if(Ve)return Buffer.isBuffer(k)?k:ri(k);case"array":return typeof k=="string"?Fr(k):k}return k}var pe;function P(R){try{var M=R.InflateRaw,k=new M;if(k._processChunk(new Uint8Array([3,0]),k._finishFlushFlag),k.bytesRead)pe=R;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function B(R,M){if(!pe)return ep(R,M);var k=pe.InflateRaw,A=new k,L=A._processChunk(R.slice(R.l),A._finishFlushFlag);return R.l+=A.bytesRead,L}function H(R){return pe?pe.deflateRawSync(R):He(R)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(R){var M=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(M>>16|M>>8|M)&255}for(var ce=typeof Uint8Array<"u",te=ce?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)te[Ae]=ue(Ae);function O(R,M){var k=te[R&255];return M<=8?k>>>8-M:(k=k<<8|te[R>>8&255],M<=16?k>>>16-M:(k=k<<8|te[R>>16&255],k>>>24-M))}function ze(R,M){var k=M&7,A=M>>>3;return(R[A]|(k<=6?0:R[A+1]<<8))>>>k&3}function _e(R,M){var k=M&7,A=M>>>3;return(R[A]|(k<=5?0:R[A+1]<<8))>>>k&7}function je(R,M){var k=M&7,A=M>>>3;return(R[A]|(k<=4?0:R[A+1]<<8))>>>k&15}function Oe(R,M){var k=M&7,A=M>>>3;return(R[A]|(k<=3?0:R[A+1]<<8))>>>k&31}function ie(R,M){var k=M&7,A=M>>>3;return(R[A]|(k<=1?0:R[A+1]<<8))>>>k&127}function Ee(R,M,k){var A=M&7,L=M>>>3,N=(1<<k)-1,X=R[L]>>>A;return k<8-A||(X|=R[L+1]<<8-A,k<16-A)||(X|=R[L+2]<<16-A,k<24-A)||(X|=R[L+3]<<24-A),X&N}function Je(R,M,k){var A=M&7,L=M>>>3;return A<=5?R[L]|=(k&7)<<A:(R[L]|=k<<A&255,R[L+1]=(k&7)>>8-A),M+3}function $e(R,M,k){var A=M&7,L=M>>>3;return k=(k&1)<<A,R[L]|=k,M+1}function Re(R,M,k){var A=M&7,L=M>>>3;return k<<=A,R[L]|=k&255,k>>>=8,R[L+1]=k,M+8}function Ye(R,M,k){var A=M&7,L=M>>>3;return k<<=A,R[L]|=k&255,k>>>=8,R[L+1]=k&255,R[L+2]=k>>>8,M+16}function st(R,M){var k=R.length,A=2*k>M?2*k:M+5,L=0;if(k>=M)return R;if(Ve){var N=cm(A);if(R.copy)R.copy(N);else for(;L<R.length;++L)N[L]=R[L];return N}else if(ce){var X=new Uint8Array(A);if(X.set)X.set(R);else for(;L<k;++L)X[L]=R[L];return X}return R.length=A,R}function Ze(R){for(var M=new Array(R),k=0;k<R;++k)M[k]=0;return M}function _t(R,M,k){var A=1,L=0,N=0,X=0,re=0,q=R.length,Y=ce?new Uint16Array(32):Ze(32);for(N=0;N<32;++N)Y[N]=0;for(N=q;N<k;++N)R[N]=0;q=R.length;var Z=ce?new Uint16Array(q):Ze(q);for(N=0;N<q;++N)Y[L=R[N]]++,A<L&&(A=L),Z[N]=0;for(Y[0]=0,N=1;N<=A;++N)Y[N+16]=re=re+Y[N-1]<<1;for(N=0;N<q;++N)re=R[N],re!=0&&(Z[N]=Y[re+16]++);var de=0;for(N=0;N<q;++N)if(de=R[N],de!=0)for(re=O(Z[N],A)>>A-de,X=(1<<A+4-de)-1;X>=0;--X)M[re|X<<de]=de&15|N<<4;return A}var at=ce?new Uint16Array(512):Ze(512),as=ce?new Uint16Array(32):Ze(32);if(!ce){for(var Ge=0;Ge<512;++Ge)at[Ge]=0;for(Ge=0;Ge<32;++Ge)as[Ge]=0}(function(){for(var R=[],M=0;M<32;M++)R.push(5);_t(R,as,32);var k=[];for(M=0;M<=143;M++)k.push(8);for(;M<=255;M++)k.push(9);for(;M<=279;M++)k.push(7);for(;M<=287;M++)k.push(8);_t(k,at,288)})();var ht=(function(){for(var M=ce?new Uint8Array(32768):[],k=0,A=0;k<ae.length-1;++k)for(;A<ae[k+1];++A)M[A]=k;for(;A<32768;++A)M[A]=29;var L=ce?new Uint8Array(259):[];for(k=0,A=0;k<J.length-1;++k)for(;A<J[k+1];++A)L[A]=k;function N(re,q){for(var Y=0;Y<re.length;){var Z=Math.min(65535,re.length-Y),de=Y+Z==re.length;for(q.write_shift(1,+de),q.write_shift(2,Z),q.write_shift(2,~Z&65535);Z-- >0;)q[q.l++]=re[Y++]}return q.l}function X(re,q){for(var Y=0,Z=0,de=ce?new Uint16Array(32768):[];Z<re.length;){var ye=Math.min(65535,re.length-Z);if(ye<10){for(Y=Je(q,Y,+(Z+ye==re.length)),Y&7&&(Y+=8-(Y&7)),q.l=Y/8|0,q.write_shift(2,ye),q.write_shift(2,~ye&65535);ye-- >0;)q[q.l++]=re[Z++];Y=q.l*8;continue}Y=Je(q,Y,+(Z+ye==re.length)+2);for(var Fe=0;ye-- >0;){var ge=re[Z];Fe=(Fe<<5^ge)&32767;var Se=-1,Le=0;if((Se=de[Fe])&&(Se|=Z&-32768,Se>Z&&(Se-=32768),Se<Z))for(;re[Se+Le]==re[Z+Le]&&Le<250;)++Le;if(Le>2){ge=L[Le],ge<=22?Y=Re(q,Y,te[ge+1]>>1)-1:(Re(q,Y,3),Y+=5,Re(q,Y,te[ge-23]>>5),Y+=3);var vt=ge<8?0:ge-4>>2;vt>0&&(Ye(q,Y,Le-J[ge]),Y+=vt),ge=M[Z-Se],Y=Re(q,Y,te[ge]>>3),Y-=3;var Ct=ge<4?0:ge-2>>1;Ct>0&&(Ye(q,Y,Z-Se-ae[ge]),Y+=Ct);for(var Xt=0;Xt<Le;++Xt)de[Fe]=Z&32767,Fe=(Fe<<5^re[Z])&32767,++Z;ye-=Le-1}else ge<=143?ge=ge+48:Y=$e(q,Y,1),Y=Re(q,Y,te[ge]),de[Fe]=Z&32767,++Z}Y=Re(q,Y,0)-1}return q.l=(Y+7)/8|0,q.l}return function(q,Y){return q.length<8?N(q,Y):X(q,Y)}})();function He(R){var M=Q(50+Math.floor(R.length*1.1)),k=ht(R,M);return M.slice(0,k)}var Et=ce?new Uint16Array(32768):Ze(32768),Ar=ce?new Uint16Array(32768):Ze(32768),Lt=ce?new Uint16Array(128):Ze(128),_i=1,Qg=1;function RS(R,M){var k=Oe(R,M)+257;M+=5;var A=Oe(R,M)+1;M+=5;var L=je(R,M)+4;M+=4;for(var N=0,X=ce?new Uint8Array(19):Ze(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,Y=ce?new Uint8Array(8):Ze(8),Z=ce?new Uint8Array(8):Ze(8),de=X.length,ye=0;ye<L;++ye)X[G[ye]]=N=_e(R,M),q<N&&(q=N),Y[N]++,M+=3;var Fe=0;for(Y[0]=0,ye=1;ye<=q;++ye)Z[ye]=Fe=Fe+Y[ye-1]<<1;for(ye=0;ye<de;++ye)(Fe=X[ye])!=0&&(re[ye]=Z[Fe]++);var ge=0;for(ye=0;ye<de;++ye)if(ge=X[ye],ge!=0){Fe=te[re[ye]]>>8-ge;for(var Se=(1<<7-ge)-1;Se>=0;--Se)Lt[Fe|Se<<ge]=ge&7|ye<<3}var Le=[];for(q=1;Le.length<k+A;)switch(Fe=Lt[ie(R,M)],M+=Fe&7,Fe>>>=3){case 16:for(N=3+ze(R,M),M+=2,Fe=Le[Le.length-1];N-- >0;)Le.push(Fe);break;case 17:for(N=3+_e(R,M),M+=3;N-- >0;)Le.push(0);break;case 18:for(N=11+ie(R,M),M+=7;N-- >0;)Le.push(0);break;default:Le.push(Fe),q<Fe&&(q=Fe);break}var vt=Le.slice(0,k),Ct=Le.slice(k);for(ye=k;ye<286;++ye)vt[ye]=0;for(ye=A;ye<30;++ye)Ct[ye]=0;return _i=_t(vt,Et,286),Qg=_t(Ct,Ar,30),M}function ES(R,M){if(R[0]==3&&!(R[1]&3))return[Si(M),2];for(var k=0,A=0,L=cm(M||1<<18),N=0,X=L.length>>>0,re=0,q=0;(A&1)==0;){if(A=_e(R,k),k+=3,A>>>1)A>>1==1?(re=9,q=5):(k=RS(R,k),re=_i,q=Qg);else{k&7&&(k+=8-(k&7));var Y=R[k>>>3]|R[(k>>>3)+1]<<8;if(k+=32,Y>0)for(!M&&X<N+Y&&(L=st(L,N+Y),X=L.length);Y-- >0;)L[N++]=R[k>>>3],k+=8;continue}for(;;){!M&&X<N+32767&&(L=st(L,N+32767),X=L.length);var Z=Ee(R,k,re),de=A>>>1==1?at[Z]:Et[Z];if(k+=de&15,de>>>=4,(de>>>8&255)===0)L[N++]=de;else{if(de==256)break;de-=257;var ye=de<8?0:de-4>>2;ye>5&&(ye=0);var Fe=N+J[de];ye>0&&(Fe+=Ee(R,k,ye),k+=ye),Z=Ee(R,k,q),de=A>>>1==1?as[Z]:Ar[Z],k+=de&15,de>>>=4;var ge=de<4?0:de-2>>1,Se=ae[de];for(ge>0&&(Se+=Ee(R,k,ge),k+=ge),!M&&X<Fe&&(L=st(L,Fe+100),X=L.length);N<Fe;)L[N]=L[N-Se],++N}}}return M?[L,k+7>>>3]:[L.slice(0,N),k+7>>>3]}function ep(R,M){var k=R.slice(R.l||0),A=ES(k,M);return R.l+=A[1],A[0]}function tp(R,M){if(R)typeof console<"u"&&console.error(M);else throw new Error(M)}function rp(R,M){var k=R;$t(k,0);var A=[],L=[],N={FileIndex:A,FullPaths:L};S(N,{root:M.root});for(var X=k.length-4;(k[X]!=80||k[X+1]!=75||k[X+2]!=5||k[X+3]!=6)&&X>=0;)--X;k.l=X+4,k.l+=4;var re=k.read_shift(2);k.l+=6;var q=k.read_shift(4);for(k.l=q,X=0;X<re;++X){k.l+=20;var Y=k.read_shift(4),Z=k.read_shift(4),de=k.read_shift(2),ye=k.read_shift(2),Fe=k.read_shift(2);k.l+=8;var ge=k.read_shift(4),Se=a(k.slice(k.l+de,k.l+de+ye));k.l+=de+ye+Fe;var Le=k.l;k.l=ge+4,TS(k,Y,Z,N,Se),k.l=Le}return N}function TS(R,M,k,A,L){R.l+=2;var N=R.read_shift(2),X=R.read_shift(2),re=o(R);if(N&8257)throw new Error("Unsupported ZIP encryption");for(var q=R.read_shift(4),Y=R.read_shift(4),Z=R.read_shift(4),de=R.read_shift(2),ye=R.read_shift(2),Fe="",ge=0;ge<de;++ge)Fe+=String.fromCharCode(R[R.l++]);if(ye){var Se=a(R.slice(R.l,R.l+ye));(Se[21589]||{}).mt&&(re=Se[21589].mt),((L||{})[21589]||{}).mt&&(re=L[21589].mt)}R.l+=ye;var Le=R.slice(R.l,R.l+Y);switch(X){case 8:Le=B(R,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var vt=!1;N&8&&(q=R.read_shift(4),q==134695760&&(q=R.read_shift(4),vt=!0),Y=R.read_shift(4),Z=R.read_shift(4)),Y!=M&&tp(vt,"Bad compressed size: "+M+" != "+Y),Z!=k&&tp(vt,"Bad uncompressed size: "+k+" != "+Z),Gu(A,Fe,Le,{unsafe:!0,mt:re})}function kS(R,M){var k=M||{},A=[],L=[],N=Q(1),X=k.compression?8:0,re=0,q=0,Y=0,Z=0,de=0,ye=R.FullPaths[0],Fe=ye,ge=R.FileIndex[0],Se=[],Le=0;for(q=1;q<R.FullPaths.length;++q)if(Fe=R.FullPaths[q].slice(ye.length),ge=R.FileIndex[q],!(!ge.size||!ge.content||Fe=="Sh33tJ5")){var vt=Z,Ct=Q(Fe.length);for(Y=0;Y<Fe.length;++Y)Ct.write_shift(1,Fe.charCodeAt(Y)&127);Ct=Ct.slice(0,Ct.l),Se[de]=Z8.buf(ge.content,0);var Xt=ge.content;X==8&&(Xt=H(Xt)),N=Q(30),N.write_shift(4,67324752),N.write_shift(2,20),N.write_shift(2,re),N.write_shift(2,X),ge.mt?n(N,ge.mt):N.write_shift(4,0),N.write_shift(-4,Se[de]),N.write_shift(4,Xt.length),N.write_shift(4,ge.content.length),N.write_shift(2,Ct.length),N.write_shift(2,0),Z+=N.length,A.push(N),Z+=Ct.length,A.push(Ct),Z+=Xt.length,A.push(Xt),N=Q(46),N.write_shift(4,33639248),N.write_shift(2,0),N.write_shift(2,20),N.write_shift(2,re),N.write_shift(2,X),N.write_shift(4,0),N.write_shift(-4,Se[de]),N.write_shift(4,Xt.length),N.write_shift(4,ge.content.length),N.write_shift(2,Ct.length),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(4,0),N.write_shift(4,vt),Le+=N.l,L.push(N),Le+=Ct.length,L.push(Ct),++de}return N=Q(22),N.write_shift(4,101010256),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,de),N.write_shift(2,de),N.write_shift(4,Le),N.write_shift(4,Z),N.write_shift(2,0),Vt([Vt(A),Vt(L),N])}var cl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function PS(R,M){if(R.ctype)return R.ctype;var k=R.name||"",A=k.match(/\.([^\.]+)$/);return A&&cl[A[1]]||M&&(A=(k=M).match(/[\.\\]([^\.\\])+$/),A&&cl[A[1]])?cl[A[1]]:"application/octet-stream"}function DS(R){for(var M=Da(R),k=[],A=0;A<M.length;A+=76)k.push(M.slice(A,A+76));return k.join(`\r
`)+`\r
`}function AS(R){var M=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var Z=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var k=[],A=M.split(`\r
`),L=0;L<A.length;++L){var N=A[L];if(N.length==0){k.push("");continue}for(var X=0;X<N.length;){var re=76,q=N.slice(X,X+re);q.charAt(re-1)=="="?re--:q.charAt(re-2)=="="?re-=2:q.charAt(re-3)=="="&&(re-=3),q=N.slice(X,X+re),X+=re,X<N.length&&(q+="="),k.push(q)}}return k.join(`\r
`)}function IS(R){for(var M=[],k=0;k<R.length;++k){for(var A=R[k];k<=R.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+R[++k];M.push(A)}for(var L=0;L<M.length;++L)M[L]=M[L].replace(/[=][0-9A-Fa-f]{2}/g,function(N){return String.fromCharCode(parseInt(N.slice(1),16))});return Fr(M.join(`\r
`))}function MS(R,M,k){for(var A="",L="",N="",X,re=0;re<10;++re){var q=M[re];if(!q||q.match(/^\s*$/))break;var Y=q.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":A=Y[2].trim();break;case"content-type":N=Y[2].trim();break;case"content-transfer-encoding":L=Y[2].trim();break}}switch(++re,L.toLowerCase()){case"base64":X=Fr(Pr(M.slice(re).join("")));break;case"quoted-printable":X=IS(M.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Z=Gu(R,A.slice(k.length),X,{unsafe:!0});N&&(Z.ctype=N)}function _S(R,M){if(W(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var k=M&&M.root||"",A=(Ve&&Buffer.isBuffer(R)?R.toString("binary"):W(R)).split(`\r
`),L=0,N="";for(L=0;L<A.length;++L)if(N=A[L],!!/^Content-Location:/i.test(N)&&(N=N.slice(N.indexOf("file")),k||(k=N.slice(0,N.lastIndexOf("/")+1)),N.slice(0,k.length)!=k))for(;k.length>0&&(k=k.slice(0,k.length-1),k=k.slice(0,k.lastIndexOf("/")+1),N.slice(0,k.length)!=k););var X=(A[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var re="--"+(X[1]||""),q=[],Y=[],Z={FileIndex:q,FullPaths:Y};S(Z);var de,ye=0;for(L=0;L<A.length;++L){var Fe=A[L];Fe!==re&&Fe!==re+"--"||(ye++&&MS(Z,A.slice(de,L),k),de=L)}return Z}function LS(R,M){var k=M||{},A=k.boundary||"SheetJS";A="------="+A;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],N=R.FullPaths[0],X=N,re=R.FileIndex[0],q=1;q<R.FullPaths.length;++q)if(X=R.FullPaths[q].slice(N.length),re=R.FileIndex[q],!(!re.size||!re.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var Y=re.content,Z=Ve&&Buffer.isBuffer(Y)?Y.toString("binary"):W(Y),de=0,ye=Math.min(1024,Z.length),Fe=0,ge=0;ge<=ye;++ge)(Fe=Z.charCodeAt(ge))>=32&&Fe<128&&++de;var Se=de>=ye*4/5;L.push(A),L.push("Content-Location: "+(k.root||"file:///C:/SheetJS/")+X),L.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),L.push("Content-Type: "+PS(re,X)),L.push(""),L.push(Se?AS(Z):DS(Z))}return L.push(A+`--\r
`),L.join(`\r
`)}function OS(R){var M={};return S(M,R),M}function Gu(R,M,k,A){var L=A&&A.unsafe;L||S(R);var N=!L&&Te.find(R,M);if(!N){var X=R.FullPaths[0];M.slice(0,X.length)==X?X=M:(X.slice(-1)!="/"&&(X+="/"),X=(X+M).replace("//","/")),N={name:i(M),type:2},R.FileIndex.push(N),R.FullPaths.push(X),L||Te.utils.cfb_gc(R)}return N.content=k,N.size=k?k.length:0,A&&(A.CLSID&&(N.clsid=A.CLSID),A.mt&&(N.mt=A.mt),A.ct&&(N.ct=A.ct)),N}function NS(R,M){S(R);var k=Te.find(R,M);if(k){for(var A=0;A<R.FileIndex.length;++A)if(R.FileIndex[A]==k)return R.FileIndex.splice(A,1),R.FullPaths.splice(A,1),!0}return!1}function BS(R,M,k){S(R);var A=Te.find(R,M);if(A){for(var L=0;L<R.FileIndex.length;++L)if(R.FileIndex[L]==A)return R.FileIndex[L].name=i(k),R.FullPaths[L]=k,!0}return!1}function HS(R){T(R,!0)}return t.find=_,t.read=F,t.parse=u,t.write=fe,t.writeFile=xe,t.utils={cfb_new:OS,cfb_add:Gu,cfb_del:NS,cfb_mov:BS,cfb_gc:HS,ReadShift:ia,CheckField:Y1,prep_blob:$t,bconcat:Vt,use_zlib:P,_deflateRaw:He,_inflateRaw:ep,consts:se},t})();function Q8(e){return typeof e=="string"?Iu(e):Array.isArray(e)?R8(e):e}function tl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Iu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?bs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var i=new Blob([Q8(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=Ai(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function eV(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Ft(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function vm(e,t){for(var r=[],s=Ft(e),i=0;i!==s.length;++i)r[e[s[i]][t]]==null&&(r[e[s[i]][t]]=s[i]);return r}function _u(e){for(var t=[],r=Ft(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Lu(e){for(var t=[],r=Ft(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function tV(e){for(var t=[],r=Ft(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var Jc=new Date(1899,11,30,0,0,0);function Nt(e,t){var r=e.getTime(),s=Jc.getTime()+(e.getTimezoneOffset()-Jc.getTimezoneOffset())*6e4;return(r-s)/(1440*60*1e3)}var P1=new Date,rV=Jc.getTime()+(P1.getTimezoneOffset()-Jc.getTimezoneOffset())*6e4,Cm=P1.getTimezoneOffset();function Ou(e){var t=new Date;return t.setTime(e*24*60*60*1e3+rV),t.getTimezoneOffset()!==Cm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Cm)*6e4),t}function sV(e){var t=0,r=0,s=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=i.length;++n)if(i[n]){switch(r=1,n>3&&(s=!0),i[n].slice(i[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[n].slice(i[n].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[n],10)}return t}var wm=new Date("2017-02-19T19:06:09.000Z"),D1=isNaN(wm.getFullYear())?new Date("2/19/17"):wm,iV=D1.getFullYear()==2017;function ut(e,t){var r=new Date(e);if(iV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(D1.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function hn(e,t){if(Ve&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return bs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return bs(v1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return bs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return bs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(n){return r[n]||n})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function dt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=dt(e[r]));return t}function St(e,t){for(var r="";r.length<t;)r+=e;return r}function rs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,n){return r=-r,n}),!isNaN(t=Number(s)))?t/r:t}var nV=["january","february","march","april","may","june","july","august","september","october","november","december"];function mo(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),i=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&nV.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(i>0||n>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var oV=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,i){if(e||typeof s=="string")return r.split(s);for(var n=r.split(s),o=[n[0]],a=1;a<n.length;++a)o.push(i),o.push(n[a]);return o}})();function A1(e){return e?e.content&&e.type?hn(e.content,!0):e.data?jo(e.data):e.asNodeBuffer&&Ve?jo(e.asNodeBuffer().toString("binary")):e.asBinary?jo(e.asBinary()):e._data&&e._data.getContent?jo(hn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function I1(e){if(!e)return null;if(e.data)return am(e.data);if(e.asNodeBuffer&&Ve)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?am(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function aV(e){return e&&e.name.slice(-4)===".bin"?I1(e):A1(e)}function Br(e,t){for(var r=e.FullPaths||Ft(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),i=s.replace(/\\/g,"/"),n=0;n<r.length;++n){var o=r[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==o||i==o)return e.files?e.files[r[n]]:e.FileIndex[n]}return null}function Cg(e,t){var r=Br(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function It(e,t,r){if(!r)return aV(Cg(e,t));if(!t)return null;try{return It(e,t)}catch{return null}}function Rr(e,t,r){if(!r)return A1(Cg(e,t));if(!t)return null;try{return Rr(e,t)}catch{return null}}function lV(e,t,r){return I1(Cg(e,t))}function xm(e){for(var t=e.FullPaths||Ft(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function Be(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Ve?s=ri(r):s=E8(r),Te.utils.cfb_add(e,t,s)}Te.utils.cfb_add(e,t,r)}else e.file(t,r)}function wg(){return Te.utils.cfb_new()}function M1(e,t){switch(t.type){case"base64":return Te.read(e,{type:"base64"});case"binary":return Te.read(e,{type:"binary"});case"buffer":case"array":return Te.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ko(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var i=s.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Dt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cV=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ym=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,uV=/<[^>]*>/g,or=Dt.match(ym)?ym:uV,dV=/<\w*:/,hV=/<(\/?)\w+:/;function Me(e,t,r){for(var s={},i=0,n=0;i!==e.length&&!((n=e.charCodeAt(i))===32||n===10||n===13);++i);if(t||(s[0]=e.slice(0,i)),i===e.length)return s;var o=e.match(cV),a=0,l="",c=0,u="",d="",h=1;if(o)for(c=0;c!=o.length;++c){for(d=o[c],n=0;n!=d.length&&d.charCodeAt(n)!==61;++n);for(u=d.slice(0,n).trim();d.charCodeAt(n+1)==32;)++n;for(h=(i=d.charCodeAt(n+1))==34||i==39?1:0,l=d.slice(n+1+h,d.length-h),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),s[u]=l,s[u.toLowerCase()]=l;else{var f=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(s[f]&&u.slice(a-3,a)=="ext")continue;s[f]=l,s[f.toLowerCase()]=l}}return s}function Ds(e){return e.replace(hV,"<$1")}var _1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xg=_u(_1),Ke=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var i=s+"",n=i.indexOf("<![CDATA[");if(n==-1)return i.replace(e,function(a,l){return _1[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(t,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,n))+i.slice(n+9,o)+r(i.slice(o+3))}})(),yg=/[&<>'"]/g,fV=/[\u0000-\u0008\u000b-\u001f]/g;function rt(e){var t=e+"";return t.replace(yg,function(r){return xg[r]}).replace(fV,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Sm(e){return rt(e).replace(/ /g,"_x0020_")}var L1=/[\u0000-\u001f]/g;function Sg(e){var t=e+"";return t.replace(yg,function(r){return xg[r]}).replace(/\n/g,"<br/>").replace(L1,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function gV(e){var t=e+"";return t.replace(yg,function(r){return xg[r]}).replace(L1,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var bm=(function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}})();function pV(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function lt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Od(e){for(var t="",r=0,s=0,i=0,n=0,o=0,a=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(n=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(i&63)<<6|n&63);continue}o=e.charCodeAt(r++),a=((s&7)<<18|(i&63)<<12|(n&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function Fm(e){var t=Si(2*e.length),r,s,i=1,n=0,o=0,a;for(s=0;s<e.length;s+=i)i=1,(a=e.charCodeAt(s))<128?r=a:a<224?(r=(a&31)*64+(e.charCodeAt(s+1)&63),i=2):a<240?(r=(a&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,r=(a&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[n++]=o&255,t[n++]=o>>>8,o=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function Rm(e){return ri(e,"binary").toString("utf8")}var Pl="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",ot=Ve&&(Rm(Pl)==Od(Pl)&&Rm||Fm(Pl)==Od(Pl)&&Fm)||Od,bs=Ve?function(e){return ri(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,i=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},Ia=(function(){var e={};return function(r,s){var i=r+"|"+(s||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}})(),O1=(function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}})(),mV=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),vV=/<\/?(?:vt:)?variant>/g,CV=/<(?:vt:)([^>]*)>([\s\S]*)</;function Em(e,t){var r=Me(e),s=e.match(mV(r.baseType))||[],i=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return i}return s.forEach(function(n){var o=n.replace(vV,"").match(CV);o&&i.push({v:ot(o[2]),t:o[1]})}),i}var N1=/(^\s|\s$|\n)/;function Kt(e,t){return"<"+e+(t.match(N1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ma(e){return Ft(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function me(e,t,r){return"<"+e+(r!=null?Ma(r):"")+(t!=null?(t.match(N1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Vh(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function wV(e,t){switch(typeof e){case"string":var r=me("vt:lpwstr",rt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return me((e|0)==e?"vt:i4":"vt:r8",rt(String(e)));case"boolean":return me("vt:bool",e?"true":"false")}if(e instanceof Date)return me("vt:filetime",Vh(e));throw new Error("Unable to serialize "+e)}function bg(e){if(Ve&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ot(Ai(pg(e)));throw new Error("Bad input format: expected Buffer or string")}var _a=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ot={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},bn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Sr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function xV(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,n=5;n>=0;--n)i=i*256+e[t+n];return s==2047?i==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),r*Math.pow(2,s-52)*i)}function yV(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,i=0,n=0,o=s?-t:t;isFinite(o)?o==0?i=n=0:(i=Math.floor(Math.log(o)/Math.LN2),n=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?i=-1022:(n-=Math.pow(2,52),i+=1023)):(i=2047,n=isNaN(t)?26985:0);for(var a=0;a<=5;++a,n/=256)e[r+a]=n&255;e[r+6]=(i&15)<<4|n&15,e[r+7]=i>>4|s}var Tm=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,n=e[0][s].length;i<n;i+=r)t.push.apply(t,e[0][s].slice(i,i+r));return t},km=Ve?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ri(t)})):Tm(e)}:Tm,Pm=function(e,t,r){for(var s=[],i=t;i<r;i+=2)s.push(String.fromCharCode(Ns(e,i)));return s.join("").replace(ur,"")},Fg=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ur,""):Pm(e,t,r)}:Pm,Dm=function(e,t,r){for(var s=[],i=t;i<t+r;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},B1=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Dm(e,t,r)}:Dm,Am=function(e,t,r){for(var s=[],i=t;i<r;i++)s.push(String.fromCharCode(On(e,i)));return s.join("")},rl=Ve?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):Am(t,r,s)}:Am,H1=function(e,t){var r=br(e,t);return r>0?rl(e,t+4,t+4+r-1):""},V1=H1,G1=function(e,t){var r=br(e,t);return r>0?rl(e,t+4,t+4+r-1):""},W1=G1,z1=function(e,t){var r=2*br(e,t);return r>0?rl(e,t+4,t+4+r-1):""},U1=z1,j1=function(t,r){var s=br(t,r);return s>0?Fg(t,r+4,r+4+s):""},$1=j1,K1=function(e,t){var r=br(e,t);return r>0?rl(e,t+4,t+4+r):""},q1=K1,X1=function(e,t){return xV(e,t)},Zc=X1,Rg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ve&&(V1=function(t,r){if(!Buffer.isBuffer(t))return H1(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},W1=function(t,r){if(!Buffer.isBuffer(t))return G1(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},U1=function(t,r){if(!Buffer.isBuffer(t))return z1(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},$1=function(t,r){if(!Buffer.isBuffer(t))return j1(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},q1=function(t,r){if(!Buffer.isBuffer(t))return K1(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Zc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):X1(t,r)},Rg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var On=function(e,t){return e[t]},Ns=function(e,t){return e[t+1]*256+e[t]},SV=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},br=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Wi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},bV=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ia(e,t){var r="",s,i,n=[],o,a,l,c;switch(t){case"dbcs":if(c=this.l,Ve&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ns(this,c)),c+=2;e*=2;break;case"utf8":r=rl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Fg(this,this.l,this.l+e);break;case"wstr":return ia.call(this,e,"dbcs");case"lpstr-ansi":r=V1(this,this.l),e=4+br(this,this.l);break;case"lpstr-cp":r=W1(this,this.l),e=4+br(this,this.l);break;case"lpwstr":r=U1(this,this.l),e=4+2*br(this,this.l);break;case"lpp4":e=4+br(this,this.l),r=$1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+br(this,this.l),r=q1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=On(this,this.l+e++))!==0;)n.push(kl(o));r=n.join("");break;case"_wstr":for(e=0,r="";(o=Ns(this,this.l+e))!==0;)n.push(kl(o)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=On(this,c),this.l=c+1,a=ia.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),n.join("")+a;n.push(kl(Ns(this,c))),c+=2}r=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=On(this,c),this.l=c+1,a=ia.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),n.join("")+a;n.push(kl(On(this,c))),c+=1}r=n.join("");break;default:switch(e){case 1:return s=On(this,this.l),this.l++,s;case 2:return s=(t==="i"?SV:Ns)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(s=(e>0?Wi:bV)(this,this.l),this.l+=4,s):(i=br(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Zc(this,this.l):i=Zc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=B1(this,this.l,e);break}}return this.l+=e,r}var FV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},RV=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},EV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function TV(e,t,r){var s=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)EV(this,t.charCodeAt(i),this.l+2*i);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;s=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,FV(this,t,this.l);break;case 8:if(s=8,r==="f"){yV(this,t,this.l);break}case 16:break;case-4:s=4,RV(this,t,this.l);break}return this.l+=s,this}function Y1(e,t){var r=B1(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function $t(e,t){e.l=t,e.read_shift=ia,e.chk=Y1,e.write_shift=TV}function ir(e,t){e.l+=t}function Q(e){var t=Si(e);return $t(t,0),t}function si(e,t,r){if(e){var s,i,n;$t(e,e.l||0);for(var o=e.length,a=0,l=0;e.l<o;){a=e.read_shift(1),a&128&&(a=(a&127)+((e.read_shift(1)&127)<<7));var c=Va[a]||Va[65535];for(s=e.read_shift(1),n=s&127,i=1;i<4&&s&128;++i)n+=((s=e.read_shift(1))&127)<<7*i;l=e.l+n;var u=c.f&&c.f(e,n,r);if(e.l=l,t(u,c,a))return}}}function Cr(){var e=[],t=Ve?256:2048,r=function(c){var u=Q(c);return $t(u,0),u},s=r(t),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},n=function(c){return s&&c<s.length-s.l?s:(i(),s=r(Math.max(c+1,t)))},o=function(){return i(),Vt(e)},a=function(c){i(),s=c,s.l==null&&(s.l=s.length),n(t)};return{next:n,push:a,end:o,_bufs:e}}function le(e,t,r,s){var i=+t,n;if(!isNaN(i)){s||(s=Va[i].p||(r||[]).length||0),n=1+(i>=128?1:0)+1,s>=128&&++n,s>=16384&&++n,s>=2097152&&++n;var o=e.next(n);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Rg(r)&&e.push(r)}}function na(e,t,r){var s=dt(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Im(e,t,r){var s=dt(e);return s.s=na(s.s,t.s,r),s.e=na(s.e,t.s,r),s}function oa(e,t){if(e.cRel&&e.c<0)for(e=dt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=dt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ie(e);return!e.cRel&&e.cRel!=null&&(r=DV(r)),!e.rRel&&e.rRel!=null&&(r=kV(r)),r}function Nd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+xt(e.s.c)+":"+(e.e.cRel?"":"$")+xt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Pt(e.s.r)+":"+(e.e.rRel?"":"$")+Pt(e.e.r):oa(e.s,t.biff)+":"+oa(e.e,t.biff)}function Eg(e){return parseInt(PV(e),10)-1}function Pt(e){return""+(e+1)}function kV(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function PV(e){return e.replace(/\$(\d+)$/,"$1")}function Tg(e){for(var t=AV(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function xt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function DV(e){return e.replace(/^([A-Z])/,"$$$1")}function AV(e){return e.replace(/^\$([A-Z])/,"$1")}function IV(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yt(e){for(var t=0,r=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ie(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yr(e){var t=e.indexOf(":");return t==-1?{s:yt(e),e:yt(e)}:{s:yt(e.slice(0,t)),e:yt(e.slice(t+1))}}function Ne(e,t){return typeof t>"u"||typeof t=="number"?Ne(e.s,e.e):(typeof e!="string"&&(e=Ie(e)),typeof t!="string"&&(t=Ie(t)),e==t?e:e+":"+t)}function qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,i=0,n=e.length;for(r=0;s<n&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.s.c=--r,r=0;s<n&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;if(t.s.r=--r,s===n||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=n&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.e.c=--r,r=0;s!=n&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;return t.e.r=--r,t}function Mm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Kr(e.z,r?Nt(t):t)}catch{}try{return e.w=Kr((e.XF||{}).numFmtId||(r?14:0),r?Nt(t):t)}catch{return""+t}}function Js(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ii[e.v]||e.v:t==null?Mm(e,e.v):Mm(e,t))}function Ii(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function J1(e,t,r){var s=r||{},i=e?Array.isArray(e):s.dense,n=e||(i?[]:{}),o=0,a=0;if(n&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var l=typeof s.origin=="string"?yt(s.origin):s.origin;o=l.r,a=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var u=qe(n["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var f={v:t[d][h]},p=o+d,g=a+h;if(c.s.r>p&&(c.s.r=p),c.s.c>g&&(c.s.c=g),c.e.r<p&&(c.e.r=p),c.e.c<g&&(c.e.c=g),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))f=t[d][h];else if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(s.nullError)f.t="e",f.v=0;else if(s.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=s.dateNF||De[14],s.cellDates?(f.t="d",f.w=Kr(f.z,Nt(f.v))):(f.t="n",f.v=Nt(f.v),f.w=Kr(f.z,f.v))):f.t="s";if(i)n[p]||(n[p]=[]),n[p][g]&&n[p][g].z&&(f.z=n[p][g].z),n[p][g]=f;else{var m=Ie({c:g,r:p});n[m]&&n[m].z&&(f.z=n[m].z),n[m]=f}}}return c.s.c<1e7&&(n["!ref"]=Ne(c)),n}function Po(e,t){return J1(null,e,t)}function MV(e){return e.read_shift(4,"i")}function ss(e,t){return t||(t=Q(4)),t.write_shift(4,e),t}function sr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function zt(e,t){var r=!1;return t==null&&(r=!0,t=Q(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function _V(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function LV(e,t){return t||(t=Q(4)),t.write_shift(2,0),t.write_shift(2,0),t}function kg(e,t){var r=e.l,s=e.read_shift(1),i=sr(e),n=[],o={t:i,h:i};if((s&1)!==0){for(var a=e.read_shift(4),l=0;l!=a;++l)n.push(_V(e));o.r=n}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function OV(e,t){var r=!1;return t==null&&(r=!0,t=Q(15+4*e.t.length)),t.write_shift(1,0),zt(e.t,t),r?t.slice(0,t.l):t}var NV=kg;function BV(e,t){var r=!1;return t==null&&(r=!0,t=Q(23+4*e.t.length)),t.write_shift(1,1),zt(e.t,t),t.write_shift(4,1),LV({},t),r?t.slice(0,t.l):t}function Xr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Fn(e,t){return t==null&&(t=Q(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Rn(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function En(e,t){return t==null&&(t=Q(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var HV=sr,Z1=zt;function Pg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Qc(e,t){var r=!1;return t==null&&(r=!0,t=Q(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var VV=sr,Gh=Pg,Dg=Qc;function Ag(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var i=s===0?Zc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Wi(t,0)>>2;return r?i/100:i}function Q1(e,t){t==null&&(t=Q(4));var r=0,s=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function ey(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function GV(e,t){return t||(t=Q(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Tn=ey,Do=GV;function rr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fn(e,t){return(t||Q(8)).write_shift(8,e,"f")}function WV(e){var t={},r=e.read_shift(1),s=r>>>1,i=e.read_shift(1),n=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=i;var c=Zi[i];c&&(t.rgb=Oa(c));break;case 2:t.rgb=Oa([o,a,l]);break;case 3:t.theme=i;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function eu(e,t){if(t||(t=Q(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function zV(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function UV(e,t){t||(t=Q(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ty(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function jV(e){return ty(e,1)}function $V(e){return ty(e,2)}var Ig=2,gr=3,Dl=11,_m=12,tu=19,Al=64,KV=65,qV=71,XV=4108,YV=4126,Ht=80,ry=81,JV=[Ht,ry],Wh={1:{n:"CodePage",t:Ig},2:{n:"Category",t:Ht},3:{n:"PresentationFormat",t:Ht},4:{n:"ByteCount",t:gr},5:{n:"LineCount",t:gr},6:{n:"ParagraphCount",t:gr},7:{n:"SlideCount",t:gr},8:{n:"NoteCount",t:gr},9:{n:"HiddenCount",t:gr},10:{n:"MultimediaClipCount",t:gr},11:{n:"ScaleCrop",t:Dl},12:{n:"HeadingPairs",t:XV},13:{n:"TitlesOfParts",t:YV},14:{n:"Manager",t:Ht},15:{n:"Company",t:Ht},16:{n:"LinksUpToDate",t:Dl},17:{n:"CharacterCount",t:gr},19:{n:"SharedDoc",t:Dl},22:{n:"HyperlinksChanged",t:Dl},23:{n:"AppVersion",t:gr,p:"version"},24:{n:"DigSig",t:KV},26:{n:"ContentType",t:Ht},27:{n:"ContentStatus",t:Ht},28:{n:"Language",t:Ht},29:{n:"Version",t:Ht},255:{},2147483648:{n:"Locale",t:tu},2147483651:{n:"Behavior",t:tu},1919054434:{}},zh={1:{n:"CodePage",t:Ig},2:{n:"Title",t:Ht},3:{n:"Subject",t:Ht},4:{n:"Author",t:Ht},5:{n:"Keywords",t:Ht},6:{n:"Comments",t:Ht},7:{n:"Template",t:Ht},8:{n:"LastAuthor",t:Ht},9:{n:"RevNumber",t:Ht},10:{n:"EditTime",t:Al},11:{n:"LastPrinted",t:Al},12:{n:"CreatedDate",t:Al},13:{n:"ModifiedDate",t:Al},14:{n:"PageCount",t:gr},15:{n:"WordCount",t:gr},16:{n:"CharCount",t:gr},17:{n:"Thumbnail",t:qV},18:{n:"Application",t:Ht},19:{n:"DocSecurity",t:gr},255:{},2147483648:{n:"Locale",t:tu},2147483651:{n:"Behavior",t:tu},1919054434:{}},Lm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ZV=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function QV(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var eG=QV([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zi=dt(eG),ii={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sy={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Uh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Il={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Mg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function tG(e){var t=Mg();if(!e||!e.match)return t;var r={};if((e.match(or)||[]).forEach(function(s){var i=Me(s);switch(i[0].replace(dV,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Uh[i.ContentType]]!==void 0&&t[Uh[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Ot.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function iy(e,t){var r=tV(Uh),s=[],i;s[s.length]=Dt,s[s.length]=me("Types",null,{xmlns:Ot.CT,"xmlns:xsd":Ot.xsd,"xmlns:xsi":Ot.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return me("Default",null,{Extension:l[0],ContentType:l[1]})}));var n=function(l){e[l]&&e[l].length>0&&(i=e[l][0],s[s.length]=me("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Il[l][t.bookType]||Il[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(c){s[s.length]=me("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Il[l][t.bookType]||Il[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(c){s[s.length]=me("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return n("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var We={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function La(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function aa(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(or)||[]).forEach(function(i){var n=Me(i);if(n[0]==="<Relationship"){var o={};o.Type=n.Type,o.Target=n.Target,o.Id=n.Id,n.TargetMode&&(o.TargetMode=n.TargetMode);var a=n.TargetMode==="External"?n.Target:Ko(n.Target,t);r[a]=o,s[n.Id]=o}}),r["!id"]=s,r}function io(e){var t=[Dt,me("Relationships",null,{xmlns:Ot.RELS})];return Ft(e["!id"]).forEach(function(r){t[t.length]=me("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function tt(e,t,r,s,i,n){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=s,i.Target=r,[We.HLINK,We.XPATH,We.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var rG="application/vnd.oasis.opendocument.spreadsheet";function sG(e,t){for(var r=bg(e),s,i;s=_a.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(i=Me(s[0],!1),i.path=="/"&&i.type!==rG)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function iG(e){var t=[Dt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Om(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function nG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function oG(e){var t=[Dt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Om(e[r][0],e[r][1])),t.push(nG("",e[r][0]));return t.push(Om("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ny(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Kc.version+"</meta:generator></office:meta></office:document-meta>"}var zr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],aG=(function(){for(var e=new Array(zr.length),t=0;t<zr.length;++t){var r=zr[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e})();function oy(e){var t={};e=ot(e);for(var r=0;r<zr.length;++r){var s=zr[r],i=e.match(aG[r]);i!=null&&i.length>0&&(t[s[1]]=Ke(i[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=ut(t[s[1]]))}return t}function Bd(e,t,r,s,i){i[e]!=null||t==null||t===""||(i[e]=t,t=rt(t),s[s.length]=r?me(e,t,r):Kt(e,t))}function ay(e,t){var r=t||{},s=[Dt,me("cp:coreProperties",null,{"xmlns:cp":Ot.CORE_PROPS,"xmlns:dc":Ot.dc,"xmlns:dcterms":Ot.dcterms,"xmlns:dcmitype":Ot.dcmitype,"xmlns:xsi":Ot.xsi})],i={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&Bd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Vh(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i),e.ModifiedDate!=null&&Bd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Vh(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i));for(var n=0;n!=zr.length;++n){var o=zr[n],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&Bd(o[0],a,null,s,i)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Qi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ly=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function cy(e,t,r,s){var i=[];if(typeof e=="string")i=Em(e,s);else for(var n=0;n<e.length;++n)i=i.concat(e[n].map(function(u){return{v:u}}));var o=typeof t=="string"?Em(t,s).map(function(u){return u.v}):t,a=0,l=0;if(o.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ð›Ð¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function lG(e,t,r){var s={};return t||(t={}),e=ot(e),Qi.forEach(function(i){var n=(e.match(Ia(i[0]))||[])[1];switch(i[2]){case"string":n&&(t[i[1]]=Ke(n));break;case"bool":t[i[1]]=n==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(s[i[1]]=o[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&cy(s.HeadingPairs,s.TitlesOfParts,t,r),t}function uy(e){var t=[],r=me;return e||(e={}),e.Application="SheetJS",t[t.length]=Dt,t[t.length]=me("Properties",null,{xmlns:Ot.EXT_PROPS,"xmlns:vt":Ot.vt}),Qi.forEach(function(s){if(e[s[1]]!==void 0){var i;switch(s[2]){case"string":i=rt(String(e[s[1]]));break;case"bool":i=e[s[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(s[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+rt(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var cG=/<[^>]+>[^<]*/g;function uG(e,t){var r={},s="",i=e.match(cG);if(i)for(var n=0;n!=i.length;++n){var o=i[n],a=Me(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Ke(a.name);break;case"</property>":s=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[s]=Ke(u);break;case"bool":r[s]=lt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(u);break;case"filetime":case"date":r[s]=ut(u);break;case"cy":case"error":r[s]=Ke(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function dy(e){var t=[Dt,me("Properties",null,{xmlns:Ot.CUST_PROPS,"xmlns:vt":Ot.vt})];if(!e)return t.join("");var r=1;return Ft(e).forEach(function(i){++r,t[t.length]=me("property",wV(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var jh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hd;function dG(e,t,r){Hd||(Hd=_u(jh)),t=Hd[t]||t,e[t]=r}function hG(e,t){var r=[];return Ft(jh).map(function(s){for(var i=0;i<zr.length;++i)if(zr[i][1]==s)return zr[i];for(i=0;i<Qi.length;++i)if(Qi[i][1]==s)return Qi[i];throw s}).forEach(function(s){if(e[s[1]]!=null){var i=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Kt(jh[s[1]]||s[1],i))}}),me("DocumentProperties",r.join(""),{xmlns:Sr.o})}function fG(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",i=[];return e&&Ft(e).forEach(function(n){if(Object.prototype.hasOwnProperty.call(e,n)){for(var o=0;o<zr.length;++o)if(n==zr[o][1])return;for(o=0;o<Qi.length;++o)if(n==Qi[o][1])return;for(o=0;o<r.length;++o)if(n==r[o])return;var a=e[n],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(me(Sm(n),a,{"dt:dt":l}))}}),t&&Ft(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&!(e&&Object.prototype.hasOwnProperty.call(e,n))){var o=t[n],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(me(Sm(n),o,{"dt:dt":a}))}}),"<"+s+' xmlns="'+Sr.o+'">'+i.join("")+"</"+s+">"}function _g(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function gG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),i=(r-s)/Math.pow(2,32);s*=1e7,i*=1e7;var n=s/Math.pow(2,32)|0;n>0&&(s=s%Math.pow(2,32),i+=n);var o=Q(8);return o.write_shift(4,s),o.write_shift(4,i),o}function hy(e,t,r){var s=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return i}function fy(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function gy(e,t,r){return t===31?fy(e):hy(e,t,r)}function $h(e,t,r){return gy(e,t,r===!1?0:4)}function pG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return gy(e,t,0)}function mG(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var i=e.l;r[s]=e.read_shift(0,"lpwstr").replace(ur,""),e.l-i&2&&(e.l+=2)}return r}function vG(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(ur,"");return r}function CG(e){var t=e.l,r=ru(e,ry);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=ru(e,gr);return[r,s]}function wG(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(CG(e));return r}function Nm(e,t){for(var r=e.read_shift(4),s={},i=0;i!=r;++i){var n=e.read_shift(4),o=e.read_shift(4);s[n]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(ur,"").replace($o,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function py(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function xG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ru(e,t,r){var s=e.read_shift(2),i,n=r||{};if(e.l+=2,t!==_m&&s!==t&&JV.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===_m?s:t){case 2:return i=e.read_shift(2,"i"),n.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return hy(e,s,4).replace(ur,"");case 31:return fy(e);case 64:return _g(e);case 65:return py(e);case 71:return xG(e);case 80:return $h(e,s,!n.raw).replace(ur,"");case 81:return pG(e,s).replace(ur,"");case 4108:return wG(e);case 4126:case 4127:return s==4127?mG(e):vG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function Bm(e,t){var r=Q(4),s=Q(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=Q(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=gG(t);break;case 31:case 80:for(s=Q(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vt([r,s])}function Hm(e,t){var r=e.l,s=e.read_shift(4),i=e.read_shift(4),n=[],o=0,a=0,l=-1,c={};for(o=0;o!=i;++o){var u=e.read_shift(4),d=e.read_shift(4);n[o]=[u,d+r]}n.sort(function(w,C){return w[1]-C[1]});var h={};for(o=0;o!=i;++o){if(e.l!==n[o][1]){var f=!0;if(o>0&&t)switch(t[n[o-1][0]].t){case 2:e.l+2===n[o][1]&&(e.l+=2,f=!1);break;case 80:e.l<=n[o][1]&&(e.l=n[o][1],f=!1);break;case 4108:e.l<=n[o][1]&&(e.l=n[o][1],f=!1);break}if((!t||o==0)&&e.l<=n[o][1]&&(f=!1,e.l=n[o][1]),f)throw new Error("Read Error: Expected address "+n[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[n[o][0]];if(h[p.n]=ru(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qr(a=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(n[o][0]===1){if(a=h.CodePage=ru(e,Ig),Qr(a),l!==-1){var g=e.l;e.l=n[l][1],c=Nm(e,a),e.l=g}}else if(n[o][0]===0){if(a===0){l=o,e.l=n[o+1][1];continue}c=Nm(e,a)}else{var m=c[n[o][0]],v;switch(e[e.l]){case 65:e.l+=4,v=py(e);break;case 30:e.l+=4,v=$h(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=$h(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Tt(e,4);break;case 64:e.l+=4,v=ut(_g(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[m]=v}}return e.l=r+s,h}var my=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function yG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Vm(e,t,r){var s=Q(8),i=[],n=[],o=8,a=0,l=Q(8),c=Q(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),n.push(l),i.push(c),o+=8+l.length,!t){c=Q(8),c.write_shift(4,0),i.unshift(c);var u=[Q(4)];for(u[0].write_shift(4,e.length),a=0;a<e.length;++a){var d=e[a][0];for(l=Q(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Vt(u),n.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(my.indexOf(e[a][0])>-1||ly.indexOf(e[a][0])>-1)&&e[a][1]!=null){var h=e[a][1],f=0;if(t){f=+t[e[a][0]];var p=r[f];if(p.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}l=Bm(p.t,h)}else{var m=yG(h);m==-1&&(m=31,h=String(h)),l=Bm(m,h)}n.push(l),c=Q(8),c.write_shift(4,t?f:2+a),i.push(c),o+=8+l.length}var v=8*(n.length+1);for(a=0;a<n.length;++a)i[a].write_shift(4,v),v+=n[a].length;return s.write_shift(4,o),s.write_shift(4,n.length),Vt([s].concat(i).concat(n))}function Gm(e,t,r){var s=e.content;if(!s)return{};$t(s,0);var i,n,o,a,l=0;s.chk("feff","Byte Order: "),s.read_shift(2);var c=s.read_shift(4),u=s.read_shift(16);if(u!==Te.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=s.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(n=s.read_shift(16),a=s.read_shift(4),i===1&&a!==s.l)throw new Error("Length mismatch: "+a+" !== "+s.l);i===2&&(o=s.read_shift(16),l=s.read_shift(4));var d=Hm(s,t),h={SystemIdentifier:c};for(var f in d)h[f]=d[f];if(h.FMTID=n,i===1)return h;if(l-s.l==2&&(s.l+=2),s.l!==l)throw new Error("Length mismatch 2: "+s.l+" !== "+l);var p;try{p=Hm(s,null)}catch{}for(f in p)h[f]=p[f];return h.FMTID=[n,o],h}function Wm(e,t,r,s,i,n){var o=Q(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Te.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var l=Vm(e,r,s);if(a.push(l),i){var c=Vm(i,null,null);o.write_shift(16,n,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Vt(a)}function ci(e,t){return e.read_shift(t),null}function SG(e,t){t||(t=Q(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function bG(e,t,r){for(var s=[],i=e.l+t;e.l<i;)s.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return s}function Tt(e,t){return e.read_shift(t)===1}function lr(e,t){return t||(t=Q(2)),t.write_shift(2,+!!e),t}function Mt(e){return e.read_shift(2,"u")}function Hr(e,t){return t||(t=Q(2)),t.write_shift(2,e),t}function vy(e,t){return bG(e,t,Mt)}function FG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Cy(e,t,r){return r||(r=Q(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function sl(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=e.read_shift(1);n&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=s?e.read_shift(s,i):"";return o}function RG(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,i=r&8,n=1+(r&1),o=0,a,l={};i&&(o=e.read_shift(2)),s&&(a=e.read_shift(4));var c=n==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*o),s&&(e.l+=a),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function EG(e){var t=e.t||"",r=Q(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=Q(2*t.length);s.write_shift(2*t.length,t,"utf16le");var i=[r,s];return Vt(i)}function gn(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function il(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):gn(e,s,r)}function kn(e,t,r){if(r.biff>5)return il(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function wy(e,t,r){return r||(r=Q(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function TG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function kG(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var i=e.read_shift((s?t-24:t)>>1,"utf16le").replace(ur,"");return s&&(e.l+=24),i}function PG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+s.replace(/\\/g,"/");var n=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(n>>1,"utf16le").replace(ur,"");return r+o}function DG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kG(e);case"0303000000000000c000000000000046":return PG(e);default:throw new Error("Unsupported Moniker "+r)}}function Ml(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ur,""):"";return r}function zm(e,t){t||(t=Q(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function AG(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var i=e.read_shift(2);e.l+=2;var n,o,a,l,c="",u,d;i&16&&(n=Ml(e,r-e.l)),i&128&&(o=Ml(e,r-e.l)),(i&257)===257&&(a=Ml(e,r-e.l)),(i&257)===1&&(l=DG(e,r-e.l)),i&8&&(c=Ml(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(d=_g(e)),e.l=r;var h=o||a||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var f={Target:h};return u&&(f.guid=u),d&&(f.time=d),n&&(f.Tooltip=n),f}function IG(e){var t=Q(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var i=s.indexOf("#"),n=i>-1?31:23;switch(s.charAt(0)){case"#":n=28;break;case".":n&=-3;break}t.write_shift(4,2),t.write_shift(4,n);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(n==28)s=s.slice(1),zm(s,t);else if(n&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var a=i>-1?s.slice(0,i):s;for(t.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)t.write_shift(2,a.charCodeAt(r));t.write_shift(2,0),n&8&&zm(i>-1?s.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var l=0;s.slice(l*3,l*3+3)=="../"||s.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,s.length-3*l+1),r=0;r<s.length-3*l;++r)t.write_shift(1,s.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function xy(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),i=e.read_shift(1);return[t,r,s,i]}function yy(e,t){var r=xy(e);return r[3]=0,r}function As(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function pn(e,t,r,s){return s||(s=Q(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function MG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function _G(e,t,r){return t===0?"":kn(e,t,r)}function LG(e,t,r){var s=r.biff>8?4:2,i=e.read_shift(s),n=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[i,n,o]}function Sy(e){var t=e.read_shift(2),r=Ag(e);return[t,r]}function OG(e,t,r){e.l+=4,t-=4;var s=e.l+t,i=sl(e,t,r),n=e.read_shift(2);if(s-=e.l,n!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+n);return e.l+=n,i}function Nu(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:t},e:{c:i,r}}}function by(e,t){return t||(t=Q(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Fy(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1);return{s:{c:s,r:t},e:{c:i,r}}}var NG=Fy;function Ry(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function BG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function HG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Jt(e){e.l+=2,e.l+=e.read_shift(2)}var VG={0:Jt,4:Jt,5:Jt,6:Jt,7:HG,8:Jt,9:Jt,10:Jt,11:Jt,12:Jt,13:BG,14:Jt,15:Jt,16:Jt,17:Jt,18:Jt,19:Jt,20:Jt,21:Ry};function GG(e,t){for(var r=e.l+t,s=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{s.push(VG[i](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function _l(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Lg(e,t,r){var s=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,i=8;break;case"biff4":s=4,i=6;break;case"biff3":s=3,i=6;break;case"biff2":s=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=Q(i);return n.write_shift(2,s),n.write_shift(2,t),i>4&&n.write_shift(2,29282),i>6&&n.write_shift(2,1997),i>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function WG(e,t){return t===0||e.read_shift(2),1200}function zG(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,i=kn(e,0,r);return e.read_shift(t+s-e.l),i}function UG(e,t){var r=!t||t.biff==8,s=Q(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function jG(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function $G(e,t,r){var s=e.read_shift(4),i=e.read_shift(1)&3,n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var o=sl(e,0,r);return o.length===0&&(o="Sheet1"),{pos:s,hs:i,dt:n,name:o}}function KG(e,t){var r=!t||t.biff>=8?2:1,s=Q(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=s.slice(0,s.l);return i.l=s.l,i}function qG(e,t){for(var r=e.l+t,s=e.read_shift(4),i=e.read_shift(4),n=[],o=0;o!=i&&e.l<r;++o)n.push(RG(e));return n.Count=s,n.Unique=i,n}function XG(e,t){var r=Q(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],i=0;i<e.length;++i)s[i]=EG(e[i]);var n=Vt([r].concat(s));return n.parts=[r.length].concat(s.map(function(o){return o.length})),n}function YG(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function JG(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function ZG(e){var t=MG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function QG(e){return e.read_shift(2),e.read_shift(4)}function Um(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(s=1-(i>>15),i&=32767);var n={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[n,i]}function eW(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[s,i],Flags:n,CurTab:o,FirstTab:a,Selected:l,TabRatio:c}}function tW(){var e=Q(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function rW(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function sW(e){var t=Q(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function iW(){}function nW(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=sl(e,0,r),s}function oW(e,t){var r=e.name||"Arial",s=t&&t.biff==5,i=s?15+r.length:16+2*r.length,n=Q(i);return n.write_shift(2,e.sz*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),n}function aW(e){var t=As(e);return t.isst=e.read_shift(4),t}function lW(e,t,r,s){var i=Q(10);return pn(e,t,s,i),i.write_shift(4,r),i}function cW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,i=As(e);r.biff==2&&e.l++;var n=il(e,s-e.l,r);return i.val=n,i}function uW(e,t,r,s,i){var n=!i||i.biff==8,o=Q(8+ +n+(1+n)*r.length);return pn(e,t,s,o),o.write_shift(2,r.length),n&&o.write_shift(1,1),o.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),o}function dW(e,t,r){var s=e.read_shift(2),i=kn(e,0,r);return[s,i]}function hW(e,t,r,s){var i=r&&r.biff==5;s||(s=Q(i?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(i?1:2,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var n=s.length>s.l?s.slice(0,s.l):s;return n.l==null&&(n.l=n.length),n}var fW=kn;function jm(e,t,r){var s=e.l+t,i=r.biff==8||!r.biff?4:2,n=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(2),l=e.read_shift(2);return e.l=s,{s:{r:n,c:a},e:{r:o,c:l}}}function gW(e,t){var r=t.biff==8||!t.biff?4:2,s=Q(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function pW(e){var t=e.read_shift(2),r=e.read_shift(2),s=Sy(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function mW(e,t){for(var r=e.l+t-2,s=e.read_shift(2),i=e.read_shift(2),n=[];e.l<r;)n.push(Sy(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(n.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:s,c:i,C:o,rkrec:n}}function vW(e,t){for(var r=e.l+t-2,s=e.read_shift(2),i=e.read_shift(2),n=[];e.l<r;)n.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(n.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:s,c:i,C:o,ixfe:n}}function CW(e,t,r,s){var i={},n=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(2);return i.patternType=ZV[a>>26],s.cellStyles&&(i.alc=n&7,i.fWrap=n>>3&1,i.alcV=n>>4&7,i.fJustLast=n>>7&1,i.trot=n>>8&255,i.cIndent=n>>16&15,i.fShrinkToFit=n>>20&1,i.iReadOrder=n>>22&2,i.fAtrNum=n>>26&1,i.fAtrFnt=n>>27&1,i.fAtrAlc=n>>28&1,i.fAtrBdr=n>>29&1,i.fAtrPat=n>>30&1,i.fAtrProt=n>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function wW(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=CW(e,t,s.fStyle,r),s}function $m(e,t,r,s){var i=r&&r.biff==5;s||(s=Q(i?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&i&&(n|=1024),s.write_shift(4,n),s.write_shift(4,0),i||s.write_shift(4,0),s.write_shift(2,0),s}function xW(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function yW(e){var t=Q(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Km(e,t,r){var s=As(e);(r.biff==2||t==9)&&++e.l;var i=FG(e);return s.val=i,s.t=i===!0||i===!1?"b":"e",s}function SW(e,t,r,s,i,n){var o=Q(8);return pn(e,t,s,o),Cy(r,n,o),o}function bW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=As(e),i=rr(e);return s.val=i,s}function FW(e,t,r,s){var i=Q(14);return pn(e,t,s,i),fn(r,i),i}var qm=_G;function RW(e,t,r){var s=e.l+t,i=e.read_shift(2),n=e.read_shift(2);if(r.sbcch=n,n==1025||n==14849)return[n,i];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var o=gn(e,n),a=[];s>e.l;)a.push(il(e));return[n,i,o,a]}function Xm(e,t,r){var s=e.read_shift(2),i,n={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(i=OG(e,t-2,r)),n.body=i||e.read_shift(t-2),typeof i=="string"&&(n.Name=i),n}var EW=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ym(e,t,r){var s=e.l+t,i=e.read_shift(2),n=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=gn(e,o,r);i&32&&(c=EW[c.charCodeAt(0)]);var u=s-e.l;r&&r.biff==2&&--u;var d=s==e.l||a===0||!(u>0)?[]:GU(e,u,r,a);return{chKey:n,Name:c,itab:l,rgce:d}}function Ey(e,t,r){if(r.biff<8)return TW(e,t,r);for(var s=[],i=e.l+t,n=e.read_shift(r.biff>8?4:2);n--!==0;)s.push(LG(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function TW(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=sl(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function kW(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),i=e.read_shift(2),n=gn(e,s,r),o=gn(e,i,r);return[n,o]}function PW(e,t,r){var s=Fy(e);e.l++;var i=e.read_shift(1);return t-=8,[WU(e,t,r),i,s]}function Jm(e,t,r){var s=NG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,HU(e,t,r)]}function DW(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function AW(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),i=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),a=kn(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:i},a,o,n]}}function IW(e,t,r){return AW(e,t,r)}function MW(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(Nu(e));return r}function _W(e){var t=Q(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)by(e[r],t);return t}function LW(e,t,r){if(r&&r.biff<8)return NW(e,t,r);var s=Ry(e),i=GG(e,t-22,s[1]);return{cmo:s,ft:i}}var OW={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:s}}};function NW(e,t,r){e.l+=4;var s=e.read_shift(2),i=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((OW[s]||ir)(e,t,r)),{cmo:[i,s,n],ft:o}}function BW(e,t,r){var s=e.l,i="";try{e.l+=4;var n=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(n)==-1?e.l+=6:o=TG(e,6,r);var a=e.read_shift(2);e.read_shift(2),Mt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-s!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=gn(e,e.lens[c+1]-e.lens[c]-1);if(i+=d,i.length>=(u?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return e.l=s+t,{t:i}}catch{return e.l=s+t,{t:i}}}function HW(e,t){var r=Nu(e);e.l+=16;var s=AG(e,t-24);return[r,s]}function VW(e){var t=Q(24),r=yt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(s[i],16));return Vt([t,IG(e[1])])}function GW(e,t){e.read_shift(2);var r=Nu(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(ur,""),[r,s]}function WW(e){var t=e[1].Tooltip,r=Q(10+2*(t.length+1));r.write_shift(2,2048);var s=yt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function zW(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Lm[r]||r,r=e.read_shift(2),t[1]=Lm[r]||r,t}function UW(e){return e||(e=Q(4)),e.write_shift(2,1),e.write_shift(2,1),e}function jW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(yy(e));return r}function $W(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(yy(e));return r}function KW(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Ty(e,t,r){if(!r.cellStyles)return ir(e,t);var s=r&&r.biff>=12?4:2,i=e.read_shift(s),n=e.read_shift(s),o=e.read_shift(s),a=e.read_shift(s),l=e.read_shift(2);s==2&&(e.l+=2);var c={s:i,e:n,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function qW(e,t){var r=Q(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function XW(e,t){var r={};return t<32||(e.l+=16,r.header=rr(e),r.footer=rr(e),e.l+=2),r}function YW(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var i=e.read_shift(1);return e.l+=3,i&16&&(s.area=!0),s}function JW(e){for(var t=Q(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var ZW=As,QW=vy,e7=il;function t7(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),i={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,i}function r7(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=As(e);++e.l;var i=kn(e,t-7,r);return s.t="str",s.val=i,s}function s7(e){var t=As(e);++e.l;var r=rr(e);return t.t="n",t.val=r,t}function i7(e,t,r){var s=Q(15);return ll(s,e,t),s.write_shift(8,r,"f"),s}function n7(e){var t=As(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function o7(e,t,r){var s=Q(9);return ll(s,e,t),s.write_shift(2,r),s}function a7(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function l7(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function c7(e,t,r){var s=e.l+t,i=As(e),n=e.read_shift(2),o=gn(e,n,r);return e.l=s,i.t="str",i.val=o,i}var u7=[2,3,48,49,131,139,140,245],Kh=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_u({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var c=[],u=Si(1);switch(l.type){case"base64":u=Fr(Pr(a));break;case"binary":u=Fr(a);break;case"buffer":case"array":u=a;break}$t(u,0);var d=u.read_shift(1),h=!!(d&136),f=!1,p=!1;switch(d){case 2:break;case 3:break;case 48:f=!0,h=!0;break;case 49:f=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,m=521;d==2&&(g=u.read_shift(2)),u.l+=3,d!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(m=u.read_shift(2));var v=u.read_shift(2),w=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var C=[],y={},b=Math.min(u.length,d==2?521:m-10-(f?264:0)),F=p?32:11;u.l<b&&u[u.l]!=13;)switch(y={},y.name=Pa.utils.decode(w,u.slice(u.l,u.l+F)).replace(/[\u0000\r\n].*$/g,""),u.l+=F,y.type=String.fromCharCode(u.read_shift(1)),d!=2&&!p&&(y.offset=u.read_shift(4)),y.len=u.read_shift(1),d==2&&(y.offset=u.read_shift(2)),y.dec=u.read_shift(1),y.name.length&&C.push(y),d!=2&&(u.l+=p?13:14),y.type){case"B":(!f||y.len!=8)&&l.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(u[u.l]!==13&&(u.l=m-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=m;var S=0,D=0;for(c[0]=[],D=0;D!=C.length;++D)c[0][D]=C[D].name;for(;g-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++S]=[],D=0,D=0;D!=C.length;++D){var T=u.slice(u.l,u.l+C[D].len);u.l+=C[D].len,$t(T,0);var V=Pa.utils.decode(w,T);switch(C[D].type){case"C":V.trim().length&&(c[S][D]=V.replace(/\s+$/,""));break;case"D":V.length===8?c[S][D]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):c[S][D]=V;break;case"F":c[S][D]=parseFloat(V.trim());break;case"+":case"I":c[S][D]=p?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":c[S][D]=!0;break;case"N":case"F":c[S][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[S][D]="##MEMO##"+(p?parseInt(V.trim(),10):T.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(c[S][D]=+V||0);break;case"@":c[S][D]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[S][D]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[S][D]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][D]=-T.read_shift(-8,"f");break;case"B":if(f&&C[D].len==8){c[S][D]=T.read_shift(8,"f");break}case"G":case"P":T.l+=C[D].len;break;case"0":if(C[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[D].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=C,c}function s(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Po(r(a,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function i(a,l){try{return Ii(s(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&Qr(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Cr(),d=nu(a,{header:1,raw:!0,cellDates:!0}),h=d[0],f=d.slice(1),p=a["!cols"]||[],g=0,m=0,v=0,w=1;for(g=0;g<h.length;++g){if(((p[g]||{}).DBF||{}).name){h[g]=p[g].DBF.name,++v;continue}if(h[g]!=null){if(++v,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(m=0;m<1024;++m)if(h.indexOf(h[g]+"_"+m)==-1){h[g]+="_"+m;break}}}}var C=qe(a["!ref"]),y=[],b=[],F=[];for(g=0;g<=C.e.c-C.s.c;++g){var S="",D="",T=0,V=[];for(m=0;m<f.length;++m)f[m][g]!=null&&V.push(f[m][g]);if(V.length==0||h[g]==null){y[g]="?";continue}for(m=0;m<V.length;++m){switch(typeof V[m]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=V[m]instanceof Date?"D":"C";break;default:D="C"}T=Math.max(T,String(V[m]).length),S=S&&S!=D?"C":D}T>250&&(T=250),D=((p[g]||{}).DBF||{}).type,D=="C"&&p[g].DBF.len>T&&(T=p[g].DBF.len),S=="B"&&D=="N"&&(S="N",F[g]=p[g].DBF.dec,T=p[g].DBF.len),b[g]=S=="C"||D=="N"?T:n[S]||0,w+=b[g],y[g]=S}var _=u.next(32);for(_.write_shift(4,318902576),_.write_shift(4,f.length),_.write_shift(2,296+32*v),_.write_shift(2,w),g=0;g<4;++g)_.write_shift(4,0);for(_.write_shift(4,0|(+t[m1]||3)<<8),g=0,m=0;g<h.length;++g)if(h[g]!=null){var I=u.next(32),z=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,z,"sbcs"),I.write_shift(1,y[g]=="?"?"C":y[g],"sbcs"),I.write_shift(4,m),I.write_shift(1,b[g]||n[y[g]]||0),I.write_shift(1,F[g]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),m+=b[g]||n[y[g]]||0}var U=u.next(264);for(U.write_shift(4,13),g=0;g<65;++g)U.write_shift(4,0);for(g=0;g<f.length;++g){var j=u.next(w);for(j.write_shift(1,0),m=0;m<h.length;++m)if(h[m]!=null)switch(y[m]){case"L":j.write_shift(1,f[g][m]==null?63:f[g][m]?84:70);break;case"B":j.write_shift(8,f[g][m]||0,"f");break;case"N":var ne="0";for(typeof f[g][m]=="number"&&(ne=f[g][m].toFixed(F[m]||0)),v=0;v<b[m]-ne.length;++v)j.write_shift(1,32);j.write_shift(1,ne,"sbcs");break;case"D":f[g][m]?(j.write_shift(4,("0000"+f[g][m].getFullYear()).slice(-4),"sbcs"),j.write_shift(2,("00"+(f[g][m].getMonth()+1)).slice(-2),"sbcs"),j.write_shift(2,("00"+f[g][m].getDate()).slice(-2),"sbcs")):j.write_shift(8,"00000000","sbcs");break;case"C":var se=String(f[g][m]!=null?f[g][m]:"").slice(0,b[m]);for(j.write_shift(1,se,"sbcs"),v=0;v<b[m]-se.length;++v)j.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:s,from_sheet:o}})(),ky=(function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ft(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,f){var p=e[f];return typeof p=="number"?lm(p):p},s=function(h,f,p){var g=f.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return g==59?h:lm(g)};e["|"]=254;function i(h,f){switch(f.type){case"base64":return n(Pr(h),f);case"binary":return n(h,f);case"buffer":return n(Ve&&Buffer.isBuffer(h)?h.toString("binary"):Ai(h),f);case"array":return n(hn(h),f)}throw new Error("Unrecognized type "+f.type)}function n(h,f){var p=h.split(/[\n\r]+/),g=-1,m=-1,v=0,w=0,C=[],y=[],b=null,F={},S=[],D=[],T=[],V=0,_;for(+f.codepage>=0&&Qr(+f.codepage);v!==p.length;++v){V=0;var I=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),z=I.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),U=z[0],j;if(I.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&y.push(I.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,se=!1,xe=!1,W=!1,fe=-1,pe=-1;for(w=1;w<z.length;++w)switch(z[w].charAt(0)){case"A":break;case"X":m=parseInt(z[w].slice(1))-1,se=!0;break;case"Y":for(g=parseInt(z[w].slice(1))-1,se||(m=0),_=C.length;_<=g;++_)C[_]=[];break;case"K":j=z[w].slice(1),j.charAt(0)==='"'?j=j.slice(1,j.length-1):j==="TRUE"?j=!0:j==="FALSE"?j=!1:isNaN(rs(j))?isNaN(mo(j).getDate())||(j=ut(j)):(j=rs(j),b!==null&&To(b)&&(j=Ou(j))),ne=!0;break;case"E":W=!0;var P=no(z[w].slice(1),{r:g,c:m});C[g][m]=[C[g][m],P];break;case"S":xe=!0,C[g][m]=[C[g][m],"S5S"];break;case"G":break;case"R":fe=parseInt(z[w].slice(1))-1;break;case"C":pe=parseInt(z[w].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}if(ne&&(C[g][m]&&C[g][m].length==2?C[g][m][0]=j:C[g][m]=j,b=null),xe){if(W)throw new Error("SYLK shared formula cannot have own formula");var B=fe>-1&&C[fe][pe];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");C[g][m][1]=$y(B[1],{r:g-fe,c:m-pe})}break;case"F":var H=0;for(w=1;w<z.length;++w)switch(z[w].charAt(0)){case"X":m=parseInt(z[w].slice(1))-1,++H;break;case"Y":for(g=parseInt(z[w].slice(1))-1,_=C.length;_<=g;++_)C[_]=[];break;case"M":V=parseInt(z[w].slice(1))/20;break;case"F":break;case"G":break;case"P":b=y[parseInt(z[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=z[w].slice(1).split(" "),_=parseInt(T[0],10);_<=parseInt(T[1],10);++_)V=parseInt(T[2],10),D[_-1]=V===0?{hidden:!0}:{wch:V},bi(D[_-1]);break;case"C":m=parseInt(z[w].slice(1))-1,D[m]||(D[m]={});break;case"R":g=parseInt(z[w].slice(1))-1,S[g]||(S[g]={}),V>0?(S[g].hpt=V,S[g].hpx=Co(V)):V===0&&(S[g].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}H<1&&(b=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}}return S.length>0&&(F["!rows"]=S),D.length>0&&(F["!cols"]=D),f&&f.sheetRows&&(C=C.slice(0,f.sheetRows)),[C,F]}function o(h,f){var p=i(h,f),g=p[0],m=p[1],v=Po(g,f);return Ft(m).forEach(function(w){v[w]=m[w]}),v}function a(h,f){return Ii(o(h,f),f)}function l(h,f,p,g){var m="C;Y"+(p+1)+";X"+(g+1)+";K";switch(h.t){case"n":m+=h.v||0,h.f&&!h.F&&(m+=";E"+Gg(h.f,{r:p,c:g}));break;case"b":m+=h.v?"TRUE":"FALSE";break;case"e":m+=h.w||h.v;break;case"d":m+='"'+(h.w||h.v)+'"';break;case"s":m+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(h,f){f.forEach(function(p,g){var m="F;W"+(g+1)+" "+(g+1)+" ";p.hidden?m+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Na(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ba(p.wpx)),typeof p.wch=="number"&&(m+=Math.round(p.wch))),m.charAt(m.length-1)!=" "&&h.push(m)})}function u(h,f){f.forEach(function(p,g){var m="F;";p.hidden?m+="M0;":p.hpt?m+="M"+20*p.hpt+";":p.hpx&&(m+="M"+20*Ha(p.hpx)+";"),m.length>2&&h.push(m+"R"+(g+1))})}function d(h,f){var p=["ID;PWXL;N;E"],g=[],m=qe(h["!ref"]),v,w=Array.isArray(h),C=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&u(p,h["!rows"]),p.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var y=m.s.r;y<=m.e.r;++y)for(var b=m.s.c;b<=m.e.c;++b){var F=Ie({r:y,c:b});v=w?(h[y]||[])[b]:h[F],!(!v||v.v==null&&(!v.f||v.F))&&g.push(l(v,h,y,b))}return p.join(C)+C+g.join(C)+C+"E"+C}return{to_workbook:a,to_sheet:o,from_sheet:d}})(),Py=(function(){function e(n,o){switch(o.type){case"base64":return t(Pr(n),o);case"binary":return t(n,o);case"buffer":return t(Ve&&Buffer.isBuffer(n)?n.toString("binary"):Ai(n),o);case"array":return t(hn(n),o)}throw new Error("Unrecognized type "+o.type)}function t(n,o){for(var a=n.split(`
`),l=-1,c=-1,u=0,d=[];u!==a.length;++u){if(a[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=a[u].trim().split(","),f=h[0],p=h[1];++u;for(var g=a[u]||"";(g.match(/["]/g)||[]).length&1&&u<a.length-1;)g+=`
`+a[++u];switch(g=g.trim(),+f){case-1:if(g==="BOT"){d[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[l][c]=!0:g==="FALSE"?d[l][c]=!1:isNaN(rs(p))?isNaN(mo(p).getDate())?d[l][c]=p:d[l][c]=ut(p):d[l][c]=rs(p),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function r(n,o){return Po(e(n,o),o)}function s(n,o){return Ii(r(n,o),o)}var i=(function(){var n=function(l,c,u,d,h){l.push(c),l.push(u+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=qe(l["!ref"]),d,h=Array.isArray(l);n(c,"TABLE",0,1,"sheetjs"),n(c,"VECTORS",0,u.e.r-u.s.r+1,""),n(c,"TUPLES",0,u.e.c-u.s.c+1,""),n(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){o(c,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var g=Ie({r:f,c:p});if(d=h?(l[f]||[])[p]:l[g],!d){o(c,1,0,"");continue}switch(d.t){case"n":var m=d.w;!m&&d.v!=null&&(m=d.v),m==null?d.f&&!d.F?o(c,1,0,"="+d.f):o(c,1,0,""):o(c,0,m,"V");break;case"b":o(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Kr(d.z||De[14],Nt(ut(d.v)))),o(c,0,d.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var v=`\r
`,w=c.join(v);return w}})();return{to_workbook:s,to_sheet:r,from_sheet:i}})(),Dy=(function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var f=d.split(`
`),p=-1,g=-1,m=0,v=[];m!==f.length;++m){var w=f[m].trim().split(":");if(w[0]==="cell"){var C=yt(w[1]);if(v.length<=C.r)for(p=v.length;p<=C.r;++p)v[p]||(v[p]=[]);switch(p=C.r,g=C.c,w[2]){case"t":v[p][g]=e(w[3]);break;case"v":v[p][g]=+w[3];break;case"vtf":var y=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[p][g]=!!+w[4];break;default:v[p][g]=+w[4];break}w[2]=="vtf"&&(v[p][g]=[v[p][g],y])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function s(d,h){return Po(r(d,h),h)}function i(d,h){return Ii(s(d,h),h)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],f=[],p,g="",m=yr(d["!ref"]),v=Array.isArray(d),w=m.s.r;w<=m.e.r;++w)for(var C=m.s.c;C<=m.e.c;++C)if(g=Ie({r:w,c:C}),p=v?(d[w]||[])[C]:d[g],!(!p||p.v==null||p.t==="z")){switch(f=["cell",g,"t"],p.t){case"s":case"str":f.push(t(p.v));break;case"n":p.f?(f[2]="vtf",f[3]="n",f[4]=p.v,f[5]=t(p.f)):(f[2]="v",f[3]=p.v);break;case"b":f[2]="vt"+(p.f?"f":"c"),f[3]="nl",f[4]=p.v?"1":"0",f[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var y=Nt(ut(p.v));f[2]="vtc",f[3]="nd",f[4]=""+y,f[5]=p.w||Kr(p.z||De[14],y);break;case"e":continue}h.push(f.join(":"))}return h.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[n,o,a,o,c(d),l].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:u}})(),vo=(function(){function e(u,d,h,f,p){p.raw?d[h][f]=u:u===""||(u==="TRUE"?d[h][f]=!0:u==="FALSE"?d[h][f]=!1:isNaN(rs(u))?isNaN(mo(u).getDate())?d[h][f]=u:d[h][f]=ut(u):d[h][f]=rs(u))}function t(u,d){var h=d||{},f=[];if(!u||u.length===0)return f;for(var p=u.split(/[\r\n]/),g=p.length-1;g>=0&&p[g].length===0;)--g;for(var m=10,v=0,w=0;w<=g;++w)v=p[w].indexOf(" "),v==-1?v=p[w].length:v++,m=Math.max(m,v);for(w=0;w<=g;++w){f[w]=[];var C=0;for(e(p[w].slice(0,m).trim(),f,w,C,h),C=1;C<=(p[w].length-m)/10+1;++C)e(p[w].slice(m+(C-1)*10,m+C*10).trim(),f,w,C,h)}return h.sheetRows&&(f=f.slice(0,h.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(u){for(var d={},h=!1,f=0,p=0;f<u.length;++f)(p=u.charCodeAt(f))==34?h=!h:!h&&p in r&&(d[p]=(d[p]||0)+1);p=[];for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&p.push([d[f],f]);if(!p.length){d=s;for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&p.push([d[f],f])}return p.sort(function(g,m){return g[0]-m[0]||s[g[1]]-s[m[1]]}),r[p.pop()[1]]||44}function n(u,d){var h=d||{},f="",p=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=i(u.slice(0,1024)):h&&h.FS?f=h.FS:f=i(u.slice(0,1024));var m=0,v=0,w=0,C=0,y=0,b=f.charCodeAt(0),F=!1,S=0,D=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=h.dateNF!=null?Y8(h.dateNF):null;function V(){var _=u.slice(C,y),I={};if(_.charAt(0)=='"'&&_.charAt(_.length-1)=='"'&&(_=_.slice(1,-1).replace(/""/g,'"')),_.length===0)I.t="z";else if(h.raw)I.t="s",I.v=_;else if(_.trim().length===0)I.t="s",I.v=_;else if(_.charCodeAt(0)==61)_.charCodeAt(1)==34&&_.charCodeAt(_.length-1)==34?(I.t="s",I.v=_.slice(2,-1).replace(/""/g,'"')):Rz(_)?(I.t="n",I.f=_.slice(1)):(I.t="s",I.v=_);else if(_=="TRUE")I.t="b",I.v=!0;else if(_=="FALSE")I.t="b",I.v=!1;else if(!isNaN(w=rs(_)))I.t="n",h.cellText!==!1&&(I.w=_),I.v=w;else if(!isNaN(mo(_).getDate())||T&&_.match(T)){I.z=h.dateNF||De[14];var z=0;T&&_.match(T)&&(_=J8(_,h.dateNF,_.match(T)||[]),z=1),h.cellDates?(I.t="d",I.v=ut(_,z)):(I.t="n",I.v=Nt(ut(_,z))),h.cellText!==!1&&(I.w=Kr(I.z,I.v instanceof Date?Nt(I.v):I.v)),h.cellNF||delete I.z}else I.t="s",I.v=_;if(I.t=="z"||(h.dense?(p[m]||(p[m]=[]),p[m][v]=I):p[Ie({c:v,r:m})]=I),C=y+1,D=u.charCodeAt(C),g.e.c<v&&(g.e.c=v),g.e.r<m&&(g.e.r=m),S==b)++v;else if(v=0,++m,h.sheetRows&&h.sheetRows<=m)return!0}e:for(;y<u.length;++y)switch(S=u.charCodeAt(y)){case 34:D===34&&(F=!F);break;case b:case 10:case 13:if(!F&&V())break e;break}return y-C>0&&V(),p["!ref"]=Ne(g),p}function o(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?n(u,d):Po(t(u,d),d)}function a(u,d){var h="",f=d.type=="string"?[0,0,0,0]:Xg(u,d);switch(d.type){case"base64":h=Pr(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):d.codepage&&typeof Pa<"u"||(h=Ve&&Buffer.isBuffer(u)?u.toString("binary"):Ai(u));break;case"array":h=hn(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return f[0]==239&&f[1]==187&&f[2]==191?h=ot(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=ot(h):d.type=="binary"&&typeof Pa<"u",h.slice(0,19)=="socialcalc:version:"?Dy.to_sheet(d.type=="string"?h:ot(h),d):o(h,d)}function l(u,d){return Ii(a(u,d),d)}function c(u){for(var d=[],h=qe(u["!ref"]),f,p=Array.isArray(u),g=h.s.r;g<=h.e.r;++g){for(var m=[],v=h.s.c;v<=h.e.c;++v){var w=Ie({r:g,c:v});if(f=p?(u[g]||[])[v]:u[w],!f||f.v==null){m.push("          ");continue}for(var C=(f.w||(Js(f),f.w)||"").slice(0,10);C.length<10;)C+=" ";m.push(C+(v===0?" ":""))}d.push(m.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}})();function d7(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var i=ky.to_workbook(e,r);return r.WTF=s,i}catch(n){if(r.WTF=s,!n.message.match(/SYLK bad record ID/)&&s)throw n;return vo.to_workbook(e,t)}}var en=(function(){function e(P,B,H){if(P){$t(P,P.l||0);for(var G=H.Enum||fe;P.l<P.length;){var J=P.read_shift(2),ae=G[J]||G[65535],ue=P.read_shift(2),ce=P.l+ue,te=ae.f&&ae.f(P,ue,H);if(P.l=ce,B(te,ae,J))return}}}function t(P,B){switch(B.type){case"base64":return r(Fr(Pr(P)),B);case"binary":return r(Fr(P),B);case"buffer":case"array":return r(P,B)}throw"Unsupported type "+B.type}function r(P,B){if(!P)return P;var H=B||{},G=H.dense?[]:{},J="Sheet1",ae="",ue=0,ce={},te=[],Ae=[],O={s:{r:0,c:0},e:{r:0,c:0}},ze=H.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)H.Enum=fe,e(P,function(ie,Ee,Je){switch(Je){case 0:H.vers=ie,ie>=4096&&(H.qpro=!0);break;case 6:O=ie;break;case 204:ie&&(ae=ie);break;case 222:ae=ie;break;case 15:case 51:H.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:Je==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=H.dateNF||De[14],H.cellDates&&(ie[1].t="d",ie[1].v=Ou(ie[1].v))),H.qpro&&ie[3]>ue&&(G["!ref"]=Ne(O),ce[J]=G,te.push(J),G=H.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},ue=ie[3],J=ae||"Sheet"+(ue+1),ae="");var $e=H.dense?(G[ie[0].r]||[])[ie[0].c]:G[Ie(ie[0])];if($e){$e.t=ie[1].t,$e.v=ie[1].v,ie[1].z!=null&&($e.z=ie[1].z),ie[1].f!=null&&($e.f=ie[1].f);break}H.dense?(G[ie[0].r]||(G[ie[0].r]=[]),G[ie[0].r][ie[0].c]=ie[1]):G[Ie(ie[0])]=ie[1];break}},H);else if(P[2]==26||P[2]==14)H.Enum=pe,P[2]==14&&(H.qpro=!0,P.l=0),e(P,function(ie,Ee,Je){switch(Je){case 204:J=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>ue&&(G["!ref"]=Ne(O),ce[J]=G,te.push(J),G=H.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},ue=ie[3],J="Sheet"+(ue+1)),ze>0&&ie[0].r>=ze)break;H.dense?(G[ie[0].r]||(G[ie[0].r]=[]),G[ie[0].r][ie[0].c]=ie[1]):G[Ie(ie[0])]=ie[1],O.e.c<ie[0].c&&(O.e.c=ie[0].c),O.e.r<ie[0].r&&(O.e.r=ie[0].r);break;case 27:ie[14e3]&&(Ae[ie[14e3][0]]=ie[14e3][1]);break;case 1537:Ae[ie[0]]=ie[1],ie[0]==ue&&(J=ie[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(G["!ref"]=Ne(O),ce[ae||J]=G,te.push(ae||J),!Ae.length)return{SheetNames:te,Sheets:ce};for(var _e={},je=[],Oe=0;Oe<Ae.length;++Oe)ce[te[Oe]]?(je.push(Ae[Oe]||te[Oe]),_e[Ae[Oe]]=ce[Ae[Oe]]||ce[te[Oe]]):(je.push(Ae[Oe]),_e[Ae[Oe]]={"!ref":"A1"});return{SheetNames:je,Sheets:_e}}function s(P,B){var H=B||{};if(+H.codepage>=0&&Qr(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Cr(),J=qe(P["!ref"]),ae=Array.isArray(P),ue=[];ve(G,0,n(1030)),ve(G,6,l(J));for(var ce=Math.min(J.e.r,8191),te=J.s.r;te<=ce;++te)for(var Ae=Pt(te),O=J.s.c;O<=J.e.c;++O){te===J.s.r&&(ue[O]=xt(O));var ze=ue[O]+Ae,_e=ae?(P[te]||[])[O]:P[ze];if(!(!_e||_e.t=="z"))if(_e.t=="n")(_e.v|0)==_e.v&&_e.v>=-32768&&_e.v<=32767?ve(G,13,f(te,O,_e.v)):ve(G,14,g(te,O,_e.v));else{var je=Js(_e);ve(G,15,d(te,O,je.slice(0,239)))}}return ve(G,1),G.end()}function i(P,B){var H=B||{};if(+H.codepage>=0&&Qr(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Cr();ve(G,0,o(P));for(var J=0,ae=0;J<P.SheetNames.length;++J)(P.Sheets[P.SheetNames[J]]||{})["!ref"]&&ve(G,27,W(P.SheetNames[J],ae++));var ue=0;for(J=0;J<P.SheetNames.length;++J){var ce=P.Sheets[P.SheetNames[J]];if(!(!ce||!ce["!ref"])){for(var te=qe(ce["!ref"]),Ae=Array.isArray(ce),O=[],ze=Math.min(te.e.r,8191),_e=te.s.r;_e<=ze;++_e)for(var je=Pt(_e),Oe=te.s.c;Oe<=te.e.c;++Oe){_e===te.s.r&&(O[Oe]=xt(Oe));var ie=O[Oe]+je,Ee=Ae?(ce[_e]||[])[Oe]:ce[ie];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")ve(G,23,V(_e,Oe,ue,Ee.v));else{var Je=Js(Ee);ve(G,22,S(_e,Oe,ue,Je.slice(0,239)))}}++ue}}return ve(G,1),G.end()}function n(P){var B=Q(2);return B.write_shift(2,P),B}function o(P){var B=Q(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var H=0,G=0,J=0,ae=0;ae<P.SheetNames.length;++ae){var ue=P.SheetNames[ae],ce=P.Sheets[ue];if(!(!ce||!ce["!ref"])){++J;var te=yr(ce["!ref"]);H<te.e.r&&(H=te.e.r),G<te.e.c&&(G=te.e.c)}}return H>8191&&(H=8191),B.write_shift(2,H),B.write_shift(1,J),B.write_shift(1,G),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function a(P,B,H){var G={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&H.qpro?(G.s.c=P.read_shift(1),P.l++,G.s.r=P.read_shift(2),G.e.c=P.read_shift(1),P.l++,G.e.r=P.read_shift(2),G):(G.s.c=P.read_shift(2),G.s.r=P.read_shift(2),B==12&&H.qpro&&(P.l+=2),G.e.c=P.read_shift(2),G.e.r=P.read_shift(2),B==12&&H.qpro&&(P.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(P){var B=Q(8);return B.write_shift(2,P.s.c),B.write_shift(2,P.s.r),B.write_shift(2,P.e.c),B.write_shift(2,P.e.r),B}function c(P,B,H){var G=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(G[0].c=P.read_shift(1),G[3]=P.read_shift(1),G[0].r=P.read_shift(2),P.l+=2):(G[2]=P.read_shift(1),G[0].c=P.read_shift(2),G[0].r=P.read_shift(2)),G}function u(P,B,H){var G=P.l+B,J=c(P,B,H);if(J[1].t="s",H.vers==20768){P.l++;var ae=P.read_shift(1);return J[1].v=P.read_shift(ae,"utf8"),J}return H.qpro&&P.l++,J[1].v=P.read_shift(G-P.l,"cstr"),J}function d(P,B,H){var G=Q(7+H.length);G.write_shift(1,255),G.write_shift(2,B),G.write_shift(2,P),G.write_shift(1,39);for(var J=0;J<G.length;++J){var ae=H.charCodeAt(J);G.write_shift(1,ae>=128?95:ae)}return G.write_shift(1,0),G}function h(P,B,H){var G=c(P,B,H);return G[1].v=P.read_shift(2,"i"),G}function f(P,B,H){var G=Q(7);return G.write_shift(1,255),G.write_shift(2,B),G.write_shift(2,P),G.write_shift(2,H,"i"),G}function p(P,B,H){var G=c(P,B,H);return G[1].v=P.read_shift(8,"f"),G}function g(P,B,H){var G=Q(13);return G.write_shift(1,255),G.write_shift(2,B),G.write_shift(2,P),G.write_shift(8,H,"f"),G}function m(P,B,H){var G=P.l+B,J=c(P,B,H);if(J[1].v=P.read_shift(8,"f"),H.qpro)P.l=G;else{var ae=P.read_shift(2);y(P.slice(P.l,P.l+ae),J),P.l+=ae}return J}function v(P,B,H){var G=B&32768;return B&=-32769,B=(G?P:0)+(B>=8192?B-16384:B),(G?"":"$")+(H?xt(B):Pt(B))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(P,B){$t(P,0);for(var H=[],G=0,J="",ae="",ue="",ce="";P.l<P.length;){var te=P[P.l++];switch(te){case 0:H.push(P.read_shift(8,"f"));break;case 1:ae=v(B[0].c,P.read_shift(2),!0),J=v(B[0].r,P.read_shift(2),!1),H.push(ae+J);break;case 2:{var Ae=v(B[0].c,P.read_shift(2),!0),O=v(B[0].r,P.read_shift(2),!1);ae=v(B[0].c,P.read_shift(2),!0),J=v(B[0].r,P.read_shift(2),!1),H.push(Ae+O+":"+ae+J)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(P.read_shift(2));break;case 6:{for(var ze="";te=P[P.l++];)ze+=String.fromCharCode(te);H.push('"'+ze.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ce=H.pop(),ue=H.pop(),H.push(["AND","OR"][te-20]+"("+ue+","+ce+")");break;default:if(te<32&&C[te])ce=H.pop(),ue=H.pop(),H.push(ue+C[te]+ce);else if(w[te]){if(G=w[te][1],G==69&&(G=P[P.l++]),G>H.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+H.join("|")+"|");return}var _e=H.slice(-G);H.length-=G,H.push(w[te][0]+"("+_e.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}H.length==1?B[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function b(P){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=P.read_shift(2),B[3]=P[P.l++],B[0].c=P[P.l++],B}function F(P,B){var H=b(P);return H[1].t="s",H[1].v=P.read_shift(B-4,"cstr"),H}function S(P,B,H,G){var J=Q(6+G.length);J.write_shift(2,P),J.write_shift(1,H),J.write_shift(1,B),J.write_shift(1,39);for(var ae=0;ae<G.length;++ae){var ue=G.charCodeAt(ae);J.write_shift(1,ue>=128?95:ue)}return J.write_shift(1,0),J}function D(P,B){var H=b(P);H[1].v=P.read_shift(2);var G=H[1].v>>1;if(H[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return H[1].v=G,H}function T(P,B){var H=b(P),G=P.read_shift(4),J=P.read_shift(4),ae=P.read_shift(2);if(ae==65535)return G===0&&J===3221225472?(H[1].t="e",H[1].v=15):G===0&&J===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var ue=ae&32768;return ae=(ae&32767)-16446,H[1].v=(1-ue*2)*(J*Math.pow(2,ae+32)+G*Math.pow(2,ae)),H}function V(P,B,H,G){var J=Q(14);if(J.write_shift(2,P),J.write_shift(1,H),J.write_shift(1,B),G==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ae=0,ue=0,ce=0,te=0;return G<0&&(ae=1,G=-G),ue=Math.log2(G)|0,G/=Math.pow(2,ue-31),te=G>>>0,(te&2147483648)==0&&(G/=2,++ue,te=G>>>0),G-=te,te|=2147483648,te>>>=0,G*=Math.pow(2,32),ce=G>>>0,J.write_shift(4,ce),J.write_shift(4,te),ue+=16383+(ae?32768:0),J.write_shift(2,ue),J}function _(P,B){var H=T(P);return P.l+=B-14,H}function I(P,B){var H=b(P),G=P.read_shift(4);return H[1].v=G>>6,H}function z(P,B){var H=b(P),G=P.read_shift(8,"f");return H[1].v=G,H}function U(P,B){var H=z(P);return P.l+=B-10,H}function j(P,B){return P[P.l+B-1]==0?P.read_shift(B,"cstr"):""}function ne(P,B){var H=P[P.l++];H>B-1&&(H=B-1);for(var G="";G.length<H;)G+=String.fromCharCode(P[P.l++]);return G}function se(P,B,H){if(!(!H.qpro||B<21)){var G=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var J=P.read_shift(B-21,"cstr");return[G,J]}}function xe(P,B){for(var H={},G=P.l+B;P.l<G;){var J=P.read_shift(2);if(J==14e3){for(H[J]=[0,""],H[J][0]=P.read_shift(2);P[P.l];)H[J][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return H}function W(P,B){var H=Q(5+P.length);H.write_shift(2,14e3),H.write_shift(2,B);for(var G=0;G<P.length;++G){var J=P.charCodeAt(G);H[H.l++]=J>127?95:J}return H[H.l++]=0,H}var fe={0:{n:"BOF",f:Mt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:j},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:_},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:j},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:t}})();function h7(e){var t={},r=e.match(or),s=0,i=!1;if(r)for(;s!=r.length;++s){var n=Me(r[s]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=hg[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+n[0])}}return t}var f7=(function(){var e=Ia("t"),t=Ia("rPr");function r(n){var o=n.match(e);if(!o)return{t:"s",v:""};var a={t:"s",v:Ke(o[1])},l=n.match(t);return l&&(a.s=h7(l[1])),a}var s=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(s,"").split(i).map(r).filter(function(a){return a.v})}})(),g7=(function(){var t=/(\r\n|\n)/g;function r(i,n,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),n.push('<span style="'+a.join("")+'">'),i.b&&(n.push("<b>"),o.push("</b>")),i.i&&(n.push("<i>"),o.push("</i>")),i.strike&&(n.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(n.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function s(i){var n=[[],i.v,[]];return i.v?(i.s&&r(i.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(s).join("")}})(),p7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,m7=/<(?:\w+:)?r>/,v7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Og(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Ke(ot(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=ot(e),r&&(s.h=Sg(s.t))):e.match(m7)&&(s.r=ot(e),s.t=Ke(ot((e.replace(v7,"").match(p7)||[]).join("").replace(or,""))),r&&(s.h=g7(f7(s.r)))),s):{t:""}}var C7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,w7=/<(?:\w+:)?(?:si|sstItem)>/g,x7=/<\/(?:\w+:)?(?:si|sstItem)>/;function y7(e,t){var r=[],s="";if(!e)return r;var i=e.match(C7);if(i){s=i[2].replace(w7,"").split(x7);for(var n=0;n!=s.length;++n){var o=Og(s[n].trim(),t);o!=null&&(r[r.length]=o)}i=Me(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var S7=/^\s|\s$|[\t\n\r]/;function Ay(e,t){if(!t.bookSST)return"";var r=[Dt];r[r.length]=me("sst",null,{xmlns:bn[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var i=e[s],n="<si>";i.r?n+=i.r:(n+="<t",i.t||(i.t=""),i.t.match(S7)&&(n+=' xml:space="preserve"'),n+=">"+rt(i.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function b7(e){return[e.read_shift(4),e.read_shift(4)]}function F7(e,t){var r=[],s=!1;return si(e,function(n,o,a){switch(a){case 159:r.Count=n[0],r.Unique=n[1];break;case 19:r.push(n);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(o.T,!s||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function R7(e,t){return t||(t=Q(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var E7=OV;function T7(e){var t=Cr();le(t,159,R7(e));for(var r=0;r<e.length;++r)le(t,19,E7(e[r]));return le(t,160),t.end()}function Iy(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function $s(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function k7(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=$s(e,4),t.U=$s(e,4),t.W=$s(e,4),t}function P7(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},i=e.read_shift(4),n=[];i-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=n,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function D7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(P7(e));return t}function A7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function I7(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=$s(e,4),t.U=$s(e,4),t.W=$s(e,4),t}function M7(e){var t=I7(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function My(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var i=!1;switch(s.AlgID){case 26126:case 26127:case 26128:i=s.Flags==36;break;case 26625:i=s.Flags==4;break;case 0:i=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function _y(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function _7(e){var t=$s(e);switch(t.Minor){case 2:return[t.Minor,L7(e)];case 3:return[t.Minor,O7()];case 4:return[t.Minor,N7(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function L7(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=My(e,r),i=_y(e,e.length-e.l);return{t:"Std",h:s,v:i}}function O7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function N7(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(or,function(n){var o=Me(n);switch(Ds(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(a){s[a]=o[a]});break;case"<dataIntegrity":s.encryptedHmacKey=o.encryptedHmacKey,s.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(o);break;default:throw o[0]}}),s}function B7(e,t){var r={},s=r.EncryptionVersionInfo=$s(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=My(e,i),t-=i,r.EncryptionVerifier=_y(e,t),r}function H7(e){var t={},r=t.EncryptionVersionInfo=$s(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ng(e){var t=0,r,s=Iy(e),i=s.length+1,n,o,a,l,c;for(r=Si(i),r[0]=s.length,n=1;n!=i;++n)r[n]=s[n-1];for(n=i-1;n>=0;--n)o=r[n],a=(t&16384)===0?0:1,l=t<<1&32767,c=a|l,t=c^o;return t^52811}var Ly=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(o){return(o/2|o*128)&255},i=function(o,a){return s(o^a)},n=function(o){for(var a=t[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],d=0;d!=7;++d)u&64&&(a^=r[l]),u*=2,--l;return a};return function(o){for(var a=Iy(o),l=n(a),c=a.length,u=Si(16),d=0;d!=16;++d)u[d]=0;var h,f,p;for((c&1)===1&&(h=l>>8,u[c]=i(e[0],h),--c,h=l&255,f=a[a.length-1],u[c]=i(f,h));c>0;)--c,h=l>>8,u[c]=i(a[c],h),--c,h=l&255,u[c]=i(a[c],h);for(c=15,p=15-a.length;p>0;)h=l>>8,u[c]=i(e[p],h),--c,--p,h=l&255,u[c]=i(a[c],h),--c,--p;return u}})(),V7=function(e,t,r,s,i){i||(i=t),s||(s=Ly(e));var n,o;for(n=0;n!=t.length;++n)o=t[n],o^=s[r],o=(o>>5|o<<3)&255,i[n]=o,++r;return[i,r,s]},G7=function(e){var t=0,r=Ly(e);return function(s){var i=V7("",s,t,r);return t=i[1],i[0]}};function W7(e,t,r,s){var i={key:Mt(e),verificationBytes:Mt(e)};return r.password&&(i.verifier=Ng(r.password)),s.valid=i.verificationBytes===i.verifier,s.valid&&(s.insitu=G7(r.password)),i}function z7(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=H7(e):s.Data=B7(e,t),s}function U7(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?z7(e,t-2,s):W7(e,r.biff>=8?t:t-2,r,s),s}var Oy=(function(){function e(i,n){switch(n.type){case"base64":return t(Pr(i),n);case"binary":return t(i,n);case"buffer":return t(Ve&&Buffer.isBuffer(i)?i.toString("binary"):Ai(i),n);case"array":return t(hn(i),n)}throw new Error("Unrecognized type "+n.type)}function t(i,n){var o=n||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(a)&&(a[d]=[]);for(var h=/\\\w+\b/g,f=0,p,g=-1;p=h.exec(u);){switch(p[0]){case"\\cell":var m=u.slice(f,h.lastIndex-p[0].length);if(m[0]==" "&&(m=m.slice(1)),++g,m.length){var v={v:m,t:"s"};Array.isArray(a)?a[d][g]=v:a[Ie({r:d,c:g})]=v}break}f=h.lastIndex}g>c.e.c&&(c.e.c=g)}),a["!ref"]=Ne(c),a}function r(i,n){return Ii(e(i,n),n)}function s(i){for(var n=["{\\rtf1\\ansi"],o=qe(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){n.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)n.push("\\cellx"+(u+1));for(n.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var d=Ie({r:c,c:u});a=l?(i[c]||[])[u]:i[d],!(!a||a.v==null&&(!a.f||a.F))&&(n.push(" "+(a.w||(Js(a),a.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}})();function j7(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Oa(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function $7(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,i=Math.max(t,r,s),n=Math.min(t,r,s),o=i-n;if(o===0)return[0,0,t];var a=0,l=0,c=i+n;switch(l=o/(c>1?2-c:c),i){case t:a=((r-s)/o+6)%6;break;case r:a=(s-t)/o+2;break;case s:a=(t-r)/o+4;break}return[a/6,l,c/2]}function K7(e){var t=e[0],r=e[1],s=e[2],i=r*2*(s<.5?s:1-s),n=s-i/2,o=[n,n,n],a=6*t,l;if(r!==0)switch(a|0){case 0:case 6:l=i*a,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-a),o[0]+=l,o[1]+=i;break;case 2:l=i*(a-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-a),o[1]+=l,o[2]+=i;break;case 4:l=i*(a-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-a),o[2]+=l,o[0]+=i;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function su(e,t){if(t===0)return e;var r=$7(j7(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Oa(K7(r))}var Ny=6,q7=15,X7=1,tr=Ny;function Na(e){return Math.floor((e+Math.round(128/tr)/256)*tr)}function Ba(e){return Math.floor((e-5)/tr*100+.5)/100}function iu(e){return Math.round((e*tr+5)/tr*256)/256}function Vd(e){return iu(Ba(Na(e)))}function Bg(e){var t=Math.abs(e-Vd(e)),r=tr;if(t>.005)for(tr=X7;tr<q7;++tr)Math.abs(e-Vd(e))<=t&&(t=Math.abs(e-Vd(e)),r=tr);tr=r}function bi(e){e.width?(e.wpx=Na(e.width),e.wch=Ba(e.wpx),e.MDW=tr):e.wpx?(e.wch=Ba(e.wpx),e.width=iu(e.wch),e.MDW=tr):typeof e.wch=="number"&&(e.width=iu(e.wch),e.wpx=Na(e.width),e.MDW=tr),e.customWidth&&delete e.customWidth}var Y7=96,By=Y7;function Ha(e){return e*96/By}function Co(e){return e*By/96}var J7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Z7(e,t,r,s){t.Borders=[];var i={},n=!1;(e[0].match(or)||[]).forEach(function(o){var a=Me(o);switch(Ds(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=lt(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=lt(a.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s&&s.WTF&&!n)throw new Error("unrecognized "+a[0]+" in borders")}})}function Q7(e,t,r,s){t.Fills=[];var i={},n=!1;(e[0].match(or)||[]).forEach(function(o){var a=Me(o);switch(Ds(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s&&s.WTF&&!n)throw new Error("unrecognized "+a[0]+" in fills")}})}function e9(e,t,r,s){t.Fonts=[];var i={},n=!1;(e[0].match(or)||[]).forEach(function(o){var a=Me(o);switch(Ds(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=ot(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?lt(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?lt(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?lt(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?lt(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?lt(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?lt(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?lt(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=hg[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=lt(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=Zi[i.color.index];i.color.index==81&&(l=Zi[1]),l||(l=Zi[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=su(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s&&s.WTF&&!n)throw new Error("unrecognized "+a[0]+" in fonts")}})}function t9(e,t,r){t.NumberFmt=[];for(var s=Ft(De),i=0;i<s.length;++i)t.NumberFmt[s[i]]=De[s[i]];var n=e[0].match(or);if(n)for(i=0;i<n.length;++i){var o=Me(n[i]);switch(Ds(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Ke(ot(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=a}js(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function r9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=me("numFmt",null,{numFmtId:s,formatCode:rt(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=me("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Ll=["numFmtId","fillId","fontId","borderId","xfId"],Ol=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function s9(e,t,r){t.CellXf=[];var s,i=!1;(e[0].match(or)||[]).forEach(function(n){var o=Me(n),a=0;switch(Ds(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=o,delete s[0],a=0;a<Ll.length;++a)s[Ll[a]]&&(s[Ll[a]]=parseInt(s[Ll[a]],10));for(a=0;a<Ol.length;++a)s[Ol[a]]&&(s[Ol[a]]=lt(s[Ol[a]]));if(t.NumberFmt&&s.numFmtId>392){for(a=392;a>60;--a)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[a]){s.numFmtId=a;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=lt(o.wrapText)),s.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function i9(e){var t=[];return t[t.length]=me("cellXfs",null),e.forEach(function(r){t[t.length]=me("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=me("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var n9=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=a.match(t))&&t9(d,u,c),(d=a.match(i))&&e9(d,u,l,c),(d=a.match(s))&&Q7(d,u,l,c),(d=a.match(n))&&Z7(d,u,l,c),(d=a.match(r))&&s9(d,u,c),u}})();function Hy(e,t){var r=[Dt,me("styleSheet",null,{xmlns:bn[0],"xmlns:vt":Ot.vt})],s;return e.SSF&&(s=r9(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=i9(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function o9(e,t){var r=e.read_shift(2),s=sr(e);return[r,s]}function a9(e,t,r){r||(r=Q(6+4*t.length)),r.write_shift(2,e),zt(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function l9(e,t,r){var s={};s.sz=e.read_shift(2)/20;var i=zV(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var n=e.read_shift(2);switch(n===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var a=e.read_shift(1);a>0&&(s.family=a);var l=e.read_shift(1);switch(l>0&&(s.charset=l),e.l++,s.color=WV(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=sr(e),s}function c9(e,t){t||(t=Q(153)),t.write_shift(2,e.sz*20),UV(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),eu(e.color,t);var s=0;return s=2,t.write_shift(1,s),zt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var u9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gd,d9=ir;function Zm(e,t){t||(t=Q(84)),Gd||(Gd=_u(u9));var r=Gd[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(eu({auto:1},t),eu({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function h9(e,t){var r=e.l+t,s=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:i}}function Vy(e,t,r){r||(r=Q(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Go(e,t){return t||(t=Q(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var f9=ir;function g9(e,t){return t||(t=Q(51)),t.write_shift(1,0),Go(null,t),Go(null,t),Go(null,t),Go(null,t),Go(null,t),t.length>t.l?t.slice(0,t.l):t}function p9(e,t){return t||(t=Q(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Qc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function m9(e,t,r){var s=Q(2052);return s.write_shift(4,e),Qc(t,s),Qc(r,s),s.length>s.l?s.slice(0,s.l):s}function v9(e,t,r){var s={};s.NumberFmt=[];for(var i in De)s.NumberFmt[i]=De[i];s.CellXf=[],s.Fonts=[];var n=[],o=!1;return si(e,function(l,c,u){switch(u){case 44:s.NumberFmt[l[0]]=l[1],js(l[1],l[0]);break;case 43:s.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=su(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&s.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:n.push(u),o=!0;break;case 38:n.pop(),o=!1;break;default:if(c.T>0)n.push(u);else if(c.T<0)n.pop();else if(!o||r.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),s}function C9(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&++r}),r!=0&&(le(e,615,ss(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&le(e,44,a9(i,t[i]))}),le(e,616))}}function w9(e){var t=1;le(e,611,ss(t)),le(e,43,c9({sz:12,color:{theme:1},name:"Calibri",family:2})),le(e,612)}function x9(e){var t=2;le(e,603,ss(t)),le(e,45,Zm({patternType:"none"})),le(e,45,Zm({patternType:"gray125"})),le(e,604)}function y9(e){var t=1;le(e,613,ss(t)),le(e,46,g9()),le(e,614)}function S9(e){var t=1;le(e,626,ss(t)),le(e,47,Vy({numFmtId:0},65535)),le(e,627)}function b9(e,t){le(e,617,ss(t.length)),t.forEach(function(r){le(e,47,Vy(r,0))}),le(e,618)}function F9(e){var t=1;le(e,619,ss(t)),le(e,48,p9({xfId:0,name:"Normal"})),le(e,620)}function R9(e){var t=0;le(e,505,ss(t)),le(e,506)}function E9(e){var t=0;le(e,508,m9(t,"TableStyleMedium9","PivotStyleMedium4")),le(e,509)}function T9(e,t){var r=Cr();return le(r,278),C9(r,e.SSF),w9(r),x9(r),y9(r),S9(r),b9(r,t.cellXfs),F9(r),R9(r),E9(r),le(r,279),r.end()}var k9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function P9(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(or)||[]).forEach(function(i){var n=Me(i);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=n.val;break;case"<a:sysClr":s.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[k9.indexOf(n[0])]=s,s={}):s.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function D9(){}function A9(){}var I9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,M9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,_9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function L9(e,t,r){t.themeElements={};var s;[["clrScheme",I9,P9],["fontScheme",M9,D9],["fmtScheme",_9,A9]].forEach(function(i){if(!(s=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](s,t,r)})}var O9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Gy(e,t){(!e||e.length===0)&&(e=Hg());var r,s={};if(!(r=e.match(O9)))throw new Error("themeElements not found in theme");return L9(r[0],s,t),s.raw=e,s}function Hg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Dt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function N9(e,t,r){var s=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=s;return}var n=e.slice(e.l);e.l=s;var o;try{o=M1(n,{type:"array"})}catch{return}var a=Rr(o,"theme/theme/theme1.xml",!0);if(a)return Gy(a,r)}}function B9(e){return e.read_shift(4)}function H9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=V9(e,4);break;case 2:t.xclrValue=xy(e);break;case 3:t.xclrValue=B9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function V9(e,t){return ir(e,t)}function G9(e,t){return ir(e,t)}function W9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=H9(e);break;case 6:s[1]=G9(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function z9(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),n=[];i-- >0;)n.push(W9(e,r-e.l));return{ixfe:s,ext:n}}function U9(e,t){t.forEach(function(r){r[0]})}function j9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:sr(e)}}function $9(e){var t=Q(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),zt(e.name,t),t.slice(0,t.l)}function K9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function q9(e){var t=Q(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function X9(e,t){var r=Q(8+2*t.length);return r.write_shift(4,e),zt(t,r),r.slice(0,r.l)}function Y9(e){return e.l+=4,e.read_shift(4)!=0}function J9(e,t){var r=Q(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Z9(e,t,r){var s={Types:[],Cell:[],Value:[]},i=r||{},n=[],o=!1,a=2;return si(e,function(l,c,u){switch(u){case 335:s.Types.push({name:l.name});break;case 51:l.forEach(function(d){a==1?s.Cell.push({type:s.Types[d[0]-1].name,index:d[1]}):a==0&&s.Value.push({type:s.Types[d[0]-1].name,index:d[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:n.push(u),o=!0;break;case 36:n.pop(),o=!1;break;default:if(!c.T){if(!o||i.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),s}function Q9(){var e=Cr();return le(e,332),le(e,334,ss(1)),le(e,335,$9({name:"XLDAPR",version:12e4,flags:3496657072})),le(e,336),le(e,339,X9(1,"XLDAPR")),le(e,52),le(e,35,ss(514)),le(e,4096,ss(0)),le(e,4097,Hr(1)),le(e,36),le(e,53),le(e,340),le(e,337,J9(1)),le(e,51,q9([[1,0]])),le(e,338),le(e,333),e.end()}function ez(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var i=!1,n=2,o;return e.replace(or,function(a){var l=Me(a);switch(Ds(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<s.Types.length;++c)s.Types[c].name==l.name&&(o=s.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?s.Cell.push({type:s.Types[l.t-1].name,index:+l.v}):n==0&&s.Value.push({type:s.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),s}function Wy(){var e=[Dt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function tz(e){var t=[];if(!e)return t;var r=1;return(e.match(or)||[]).forEach(function(s){var i=Me(s);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function rz(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ie(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function sz(e,t,r){var s=[];return si(e,function(n,o,a){switch(a){case 63:s.push(n);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),s}function iz(e,t,r,s){if(!e)return e;var i=s||{},n=!1;si(e,function(a,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!l.T){if(!n||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function nz(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Wn=1024;function zy(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[me("xml",null,{"xmlns:v":Sr.v,"xmlns:o":Sr.o,"xmlns:x":Sr.x,"xmlns:mv":Sr.mv}).replace(/\/>/,">"),me("o:shapelayout",me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),me("v:shapetype",[me("v:stroke",null,{joinstyle:"miter"}),me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Wn<e*1e3;)Wn+=1e3;return t.forEach(function(n){var o=yt(n[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=me("v:fill",l,a),u={on:"t",obscured:"t"};++Wn,i=i.concat(["<v:shape"+Ma({id:"_x0000_s"+Wn,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,me("v:shadow",null,u),me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Kt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Kt("x:AutoFill","False"),Kt("x:Row",String(o.r)),Kt("x:Column",String(o.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Qm(e,t,r,s){var i=Array.isArray(e),n;t.forEach(function(o){var a=yt(o.ref);if(i?(e[a.r]||(e[a.r]=[]),n=e[a.r][a.c]):n=e[o.ref],!n){n={t:"z"},i?e[a.r][a.c]=n:e[o.ref]=n;var l=qe(e["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=Ne(l);c!==e["!ref"]&&(e["!ref"]=c)}n.c||(n.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var d=n.c.length-1;d>=0;--d){if(!r&&n.c[d].T)return;r&&!n.c[d].T&&n.c.splice(d,1)}if(r&&s){for(d=0;d<s.length;++d)if(u.a==s[d].id){u.a=s[d].name||u.a;break}}n.c.push(u)})}function oz(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=Me(a[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=yt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var d=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Og(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),s.push(c)}}}}),s}function Uy(e){var t=[Dt,me("comments",null,{xmlns:bn[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(i){var n=rt(i.a);r.indexOf(n)==-1&&(r.push(n),t.push("<author>"+n+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var i=0,n=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?i=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(l){l.a&&(i=r.indexOf(rt(l.a))),n.push(l.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+i+'"><text>'),n.length<=1)t.push(Kt("t",rt(n[0]||"")));else{for(var o=`Comment:
    `+n[0]+`
`,a=1;a<n.length;++a)o+=`Reply:
    `+n[a]+`
`;t.push(Kt("t",rt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function az(e,t){var r=[],s=!1,i={},n=0;return e.replace(or,function(a,l){var c=Me(a);switch(Ds(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":n=l+a.length;break;case"</text>":i.t=e.slice(n,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),r}function lz(e,t,r){var s=[Dt,me("ThreadedComments",null,{xmlns:Ot.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var n="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?n=l.id:l.parentId=n,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push(me("threadedComment",Kt("text",o.t||""),l))})}),s.push("</ThreadedComments>"),s.join("")}function cz(e,t){var r=[],s=!1;return e.replace(or,function(n){var o=Me(n);switch(Ds(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return n}),r}function uz(e){var t=[Dt,me("personList",null,{xmlns:Ot.TCMNT,"xmlns:x":bn[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(me("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function dz(e){var t={};t.iauthor=e.read_shift(4);var r=Tn(e);return t.rfx=r.s,t.ref=Ie(r.s),e.l+=16,t}function hz(e,t){return t==null&&(t=Q(36)),t.write_shift(4,e[1].iauthor),Do(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var fz=sr;function gz(e){return zt(e.slice(0,54))}function pz(e,t){var r=[],s=[],i={},n=!1;return si(e,function(a,l,c){switch(c){case 632:s.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=s[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function mz(e){var t=Cr(),r=[];return le(t,628),le(t,630),e.forEach(function(s){s[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),le(t,632,gz(i.a)))})}),le(t,631),le(t,633),e.forEach(function(s){s[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var n={s:yt(s[0]),e:yt(s[0])};le(t,635,hz([n,i])),i.t&&i.t.length>0&&le(t,637,BV(i)),le(t,636),delete i.iauthor})}),le(t,634),le(t,629),t.end()}var vz="application/vnd.ms-office.vbaProject";function Cz(e){var t=Te.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Te.utils.cfb_add(t,i,e.FileIndex[s].content)}}),Te.write(t)}function wz(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Te.utils.cfb_add(e,i,t.FileIndex[s].content)}})}var jy=["xlsb","xlsm","xlam","biff8","xla"];function xz(){return{"!type":"dialog"}}function yz(){return{"!type":"dialog"}}function Sz(){return{"!type":"macro"}}function bz(){return{"!type":"macro"}}var no=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,i,n,o){var a=!1,l=!1;n.length==0?l=!0:n.charAt(0)=="["&&(l=!0,n=n.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=n.length>0?parseInt(n,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=t.c:--u,l?c+=t.r:--c,i+(a?"":"$")+xt(u)+(l?"":"$")+Pt(c)}return function(i,n){return t=n,i.replace(e,r)}})(),Vg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Gg=(function(){return function(t,r){return t.replace(Vg,function(s,i,n,o,a,l){var c=Tg(o)-(n?0:r.c),u=Eg(l)-(a?0:r.r),d=u==0?"":a?u+1:"["+u+"]",h=c==0?"":n?c+1:"["+c+"]";return i+"R"+d+"C"+h})}})();function $y(e,t){return e.replace(Vg,function(r,s,i,n,o,a){return s+(i=="$"?i+n:xt(Tg(n)+t.c))+(o=="$"?o+a:Pt(Eg(a)+t.r))})}function Fz(e,t,r){var s=yr(t),i=s.s,n=yt(r),o={r:n.r-i.r,c:n.c-i.c};return $y(e,o)}function Rz(e){return e.length!=1}function ev(e){return e.replace(/_xlfn\./g,"")}function At(e){e.l+=1}function Fi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Ky(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return qy(e);r.biff==12&&(s=4)}var i=e.read_shift(s),n=e.read_shift(s),o=Fi(e),a=Fi(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function qy(e){var t=Fi(e),r=Fi(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Ez(e,t,r){if(r.biff<8)return qy(e);var s=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),n=Fi(e),o=Fi(e);return{s:{r:s,c:n[0],cRel:n[1],rRel:n[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Xy(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Tz(e);var s=e.read_shift(r&&r.biff==12?4:2),i=Fi(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function Tz(e){var t=Fi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Pz(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return Dz(e);var i=e.read_shift(s>=12?4:2),n=e.read_shift(2),o=(n&16384)>>14,a=(n&32768)>>15;if(n&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;n>8191;)n=n-16384;return{r:i,c:n,cRel:o,rRel:a}}function Dz(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:s}}function Az(e,t,r){var s=(e[e.l++]&96)>>5,i=Ky(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,i]}function Iz(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var o=Ky(e,n,r);return[s,i,o]}function Mz(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function _z(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[s,i]}function Lz(e,t,r){var s=(e[e.l++]&96)>>5,i=Ez(e,t-1,r);return[s,i]}function Oz(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function tv(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Nz(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),i=[],n=0;n<=s;++n)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Bz(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function Hz(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function Vz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Gz(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function Yy(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Wz(e){return e.read_shift(2),Yy(e)}function zz(e){return e.read_shift(2),Yy(e)}function Uz(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=Xy(e,0,r);return[s,i]}function jz(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=Pz(e,0,r);return[s,i]}function $z(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var n=Xy(e,0,r);return[s,i,n]}function Kz(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[YU[i],Qy[i],s]}function qz(e,t,r){var s=e[e.l++],i=e.read_shift(1),n=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:Xz(e);return[i,(n[0]===0?Qy:XU)[n[1]]]}function Xz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Yz(e,t,r){e.l+=r&&r.biff==2?3:4}function Jz(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function Zz(e){return e.l++,ii[e.read_shift(1)]}function Qz(e){return e.l++,e.read_shift(2)}function eU(e){return e.l++,e.read_shift(1)!==0}function tU(e){return e.l++,rr(e)}function rU(e,t,r){return e.l++,sl(e,t-1,r)}function sU(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Tt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ii[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=rr(e);break;case 2:r[1]=kn(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function iU(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),i=[],n=0;n!=s;++n)i.push((r.biff==12?Tn:Nu)(e));return i}function nU(e,t,r){var s=0,i=0;r.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--i==0&&(i=256));for(var n=0,o=[];n!=s&&(o[n]=[]);++n)for(var a=0;a!=i;++a)o[n][a]=sU(e,r.biff);return o}function oU(e,t,r){var s=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,n=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,n]}function aU(e,t,r){if(r.biff==5)return lU(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),n=e.read_shift(4);return[s,i,n]}function lU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function cU(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function uU(e,t,r){var s=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function dU(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function hU(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[s,i]}var fU=ir,gU=ir,pU=ir;function nl(e,t,r){return e.l+=2,[kz(e)]}function Wg(e){return e.l+=6,[]}var mU=nl,vU=Wg,CU=Wg,wU=nl;function Jy(e){return e.l+=2,[Mt(e),e.read_shift(2)&1]}var xU=nl,yU=Jy,SU=Wg,bU=nl,FU=nl,RU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function EU(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),n=e.read_shift(2),o=RU[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:i,C:n}}function TU(e){return e.l+=2,[e.read_shift(4)]}function kU(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function PU(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function DU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IU(e){return e.l+=4,[0,0]}var rv={1:{n:"PtgExp",f:Jz},2:{n:"PtgTbl",f:pU},3:{n:"PtgAdd",f:At},4:{n:"PtgSub",f:At},5:{n:"PtgMul",f:At},6:{n:"PtgDiv",f:At},7:{n:"PtgPower",f:At},8:{n:"PtgConcat",f:At},9:{n:"PtgLt",f:At},10:{n:"PtgLe",f:At},11:{n:"PtgEq",f:At},12:{n:"PtgGe",f:At},13:{n:"PtgGt",f:At},14:{n:"PtgNe",f:At},15:{n:"PtgIsect",f:At},16:{n:"PtgUnion",f:At},17:{n:"PtgRange",f:At},18:{n:"PtgUplus",f:At},19:{n:"PtgUminus",f:At},20:{n:"PtgPercent",f:At},21:{n:"PtgParen",f:At},22:{n:"PtgMissArg",f:At},23:{n:"PtgStr",f:rU},26:{n:"PtgSheet",f:kU},27:{n:"PtgEndSheet",f:PU},28:{n:"PtgErr",f:Zz},29:{n:"PtgBool",f:eU},30:{n:"PtgInt",f:Qz},31:{n:"PtgNum",f:tU},32:{n:"PtgArray",f:Oz},33:{n:"PtgFunc",f:Kz},34:{n:"PtgFuncVar",f:qz},35:{n:"PtgName",f:oU},36:{n:"PtgRef",f:Uz},37:{n:"PtgArea",f:Az},38:{n:"PtgMemArea",f:cU},39:{n:"PtgMemErr",f:fU},40:{n:"PtgMemNoMem",f:gU},41:{n:"PtgMemFunc",f:uU},42:{n:"PtgRefErr",f:dU},43:{n:"PtgAreaErr",f:Mz},44:{n:"PtgRefN",f:jz},45:{n:"PtgAreaN",f:Lz},46:{n:"PtgMemAreaN",f:DU},47:{n:"PtgMemNoMemN",f:AU},57:{n:"PtgNameX",f:aU},58:{n:"PtgRef3d",f:$z},59:{n:"PtgArea3d",f:Iz},60:{n:"PtgRefErr3d",f:hU},61:{n:"PtgAreaErr3d",f:_z},255:{}},MU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_U={1:{n:"PtgElfLel",f:Jy},2:{n:"PtgElfRw",f:bU},3:{n:"PtgElfCol",f:mU},6:{n:"PtgElfRwV",f:FU},7:{n:"PtgElfColV",f:wU},10:{n:"PtgElfRadical",f:xU},11:{n:"PtgElfRadicalS",f:SU},13:{n:"PtgElfColS",f:vU},15:{n:"PtgElfColSV",f:CU},16:{n:"PtgElfRadicalLel",f:yU},25:{n:"PtgList",f:EU},29:{n:"PtgSxName",f:TU},255:{}},LU={0:{n:"PtgAttrNoop",f:IU},1:{n:"PtgAttrSemi",f:Gz},2:{n:"PtgAttrIf",f:Hz},4:{n:"PtgAttrChoose",f:Nz},8:{n:"PtgAttrGoto",f:Bz},16:{n:"PtgAttrSum",f:Yz},32:{n:"PtgAttrBaxcel",f:tv},33:{n:"PtgAttrBaxcel",f:tv},64:{n:"PtgAttrSpace",f:Wz},65:{n:"PtgAttrSpaceSemi",f:zz},128:{n:"PtgAttrIfError",f:Vz},255:{}};function ol(e,t,r,s){if(s.biff<8)return ir(e,t);for(var i=e.l+t,n=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=nU(e,0,s),n.push(r[o][1]);break;case"PtgMemArea":r[o][2]=iU(e,r[o][1],s),n.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),n.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&n.push(ir(e,t)),n}function al(e,t,r){for(var s=e.l+t,i,n,o=[];s!=e.l;)t=s-e.l,n=e[e.l],i=rv[n]||rv[MU[n]],(n===24||n===25)&&(i=(n===24?_U:LU)[e[e.l+1]]),!i||!i.f?ir(e,t):o.push([i.n,i.f(e,t,r)]);return o}function OU(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],i=[],n=0;n<s.length;++n){var o=s[n];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var NU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function BU(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Zy(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function sv(e,t,r){var s=Zy(e,t,r);return s=="#REF"?s:BU(s,r)}function er(e,t,r,s,i){var n=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,d=0,h=0,f,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",v=0,w=e[0].length;v<w;++v){var C=e[0][v];switch(C[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=St(" ",e[0][g][1][1]);break;case 1:m=St("\r",e[0][g][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+m,g=-1}a.push(c+NU[C[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=na(C[1][1],o,i),a.push(oa(u,n));break;case"PtgRefN":u=r?na(C[1][1],r,i):C[1][1],a.push(oa(u,n));break;case"PtgRef3d":d=C[1][1],u=na(C[1][2],o,i),p=sv(s,d,i),a.push(p+"!"+oa(u,n));break;case"PtgFunc":case"PtgFuncVar":var y=C[1][0],b=C[1][1];y||(y=0),y&=127;var F=y==0?[]:a.slice(-y);a.length-=y,b==="User"&&(b=F.shift()),a.push(b+"("+F.join(",")+")");break;case"PtgBool":a.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(C[1]);break;case"PtgNum":a.push(String(C[1]));break;case"PtgStr":a.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(C[1]);break;case"PtgAreaN":f=Im(C[1][1],r?{s:r}:o,i),a.push(Nd(f,i));break;case"PtgArea":f=Im(C[1][1],o,i),a.push(Nd(f,i));break;case"PtgArea3d":d=C[1][1],f=C[1][2],p=sv(s,d,i),a.push(p+"!"+Nd(f,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=C[1][2];var S=(s.names||[])[h-1]||(s[0]||[])[h],D=S?S.Name:"SH33TJSNAME"+String(h);D&&D.slice(0,6)=="_xlfn."&&!i.xlfn&&(D=D.slice(6)),a.push(D);break;case"PtgNameX":var T=C[1][1];h=C[1][2];var V;if(i.biff<=5)T<0&&(T=-T),s[T]&&(V=s[T][h]);else{var _="";if(((s[T]||[])[0]||[])[0]==14849||(((s[T]||[])[0]||[])[0]==1025?s[T][h]&&s[T][h].itab>0&&(_=s.SheetNames[s[T][h].itab-1]+"!"):_=s.SheetNames[h-1]+"!"),s[T]&&s[T][h])_+=s[T][h].Name;else if(s[0]&&s[0][h])_+=s[0][h].Name;else{var I=(Zy(s,T,i)||"").split(";;");I[h-1]?_=I[h-1]:_+="SH33TJSERRX"}a.push(_);break}V||(V={Name:"SH33TJSERRY"}),a.push(V.Name);break;case"PtgParen":var z="(",U=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:z=St(" ",e[0][g][1][1])+z;break;case 3:z=St("\r",e[0][g][1][1])+z;break;case 4:U=St(" ",e[0][g][1][1])+U;break;case 5:U=St("\r",e[0][g][1][1])+U;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}a.push(z+a.pop()+U);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:C[1][1],r:C[1][0]};var j={c:r.c,r:r.r};if(s.sharedf[Ie(u)]){var ne=s.sharedf[Ie(u)];a.push(er(ne,o,j,s,i))}else{var se=!1;for(l=0;l!=s.arrayf.length;++l)if(c=s.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(er(c[1],o,j,s,i)),se=!0;break}se||a.push(C[1])}break;case"PtgArray":a.push("{"+OU(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&xe.indexOf(e[0][v][0])==-1){C=e[0][g];var W=!0;switch(C[1][0]){case 4:W=!1;case 0:m=St(" ",C[1][1]);break;case 5:W=!1;case 1:m=St("\r",C[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}a.push((W?m:"")+a.pop()+(W?"":m)),g=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function HU(e,t,r){var s=e.l+t,i=r.biff==2?1:2,n,o=e.read_shift(i);if(o==65535)return[[],ir(e,t-2)];var a=al(e,o,r);return t!==o+i&&(n=ol(e,t-o-i,a,r)),e.l=s,[a,n]}function VU(e,t,r){var s=e.l+t,i=r.biff==2?1:2,n,o=e.read_shift(i);if(o==65535)return[[],ir(e,t-2)];var a=al(e,o,r);return t!==o+i&&(n=ol(e,t-o-i,a,r)),e.l=s,[a,n]}function GU(e,t,r,s){var i=e.l+t,n=al(e,s,r),o;return i!==e.l&&(o=ol(e,i-e.l,n,r)),[n,o]}function WU(e,t,r){var s=e.l+t,i,n=e.read_shift(2),o=al(e,n,r);return n==65535?[[],ir(e,t-2)]:(t!==n+2&&(i=ol(e,s-n-2,o,r)),[o,i])}function zU(e){var t;if(Ns(e,e.l+6)!==65535)return[rr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function UU(e){if(e==null){var t=Q(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return fn(e);return fn(0)}function Wd(e,t,r){var s=e.l+t,i=As(e);r.biff==2&&++e.l;var n=zU(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var a=VU(e,s-e.l,r);return{cell:i,val:n[0],formula:a,shared:o>>3&1,tt:n[1]}}function jU(e,t,r,s,i){var n=pn(t,r,i),o=UU(e.v),a=Q(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=Q(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var d=Vt([n,o,a,c]);return d}function Bu(e,t,r){var s=e.read_shift(4),i=al(e,s,r),n=e.read_shift(4),o=n>0?ol(e,n,i,r):null;return[i,o]}var $U=Bu,Hu=Bu,KU=Bu,qU=Bu,XU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Qy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},YU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function iv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function JU(e){var t="of:="+e.replace(Vg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function zd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function ZU(e){return e.replace(/\./,"!")}var la={},oo={},ca=typeof Map<"u";function zg(e,t,r){var s=0,i=e.length;if(r){if(ca?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var n=ca?r.get(t):r[t];s<n.length;++s)if(e[n[s]].t===t)return e.Count++,n[s]}}else for(;s<i;++s)if(e[s].t===t)return e.Count++,s;return e[i]={t},e.Count++,e.Unique++,r&&(ca?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Vu(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(tr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Ba(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=iu(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function tn(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Mi(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],i=60,n=e.length;if(s==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){js(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=s=i;break}}for(i=0;i!=n;++i)if(e[i].numFmtId===s)return i;return e[n]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function eS(e,t,r,s,i,n){try{s.cellNF&&(e.z=De[t])}catch(a){if(s.WTF)throw a}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ut(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(De[t]==null&&js(X8[t]||"General",t),e.t==="e")e.w=e.w||ii[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Aa(e.v);else if(e.t==="d"){var o=Nt(e.v);(o|0)===o?e.w=o.toString(10):e.w=Aa(o)}else{if(e.v===void 0)return"";e.w=dn(e.v,oo)}else e.t==="d"?e.w=Kr(t,Nt(e.v),oo):e.w=Kr(t,e.v,oo)}catch(a){if(s.WTF)throw a}if(s.cellStyles&&r!=null)try{e.s=n.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=su(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=su(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(s.WTF&&n.Fills)throw a}}}function QU(e,t,r){if(e&&e["!ref"]){var s=qe(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function ej(e,t){var r=qe(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ne(r))}var tj=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,rj=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,sj=/<(?:\w:)?hyperlink [^>]*>/mg,ij=/"(\w*:\w*)"/,nj=/<(?:\w:)?col\b[^>]*[\/]?>/g,oj=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,aj=/<(?:\w:)?pageMargins[^>]*\/>/g,tS=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lj=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,cj=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function uj(e,t,r,s,i,n,o){if(!e)return e;s||(s={"!id":{}});var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(rj);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(tS);h?Ug(h[0],a,i,r):(h=c.match(lj))&&hj(h[0],h[1]||"",a,i,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=c.slice(f,f+50).match(ij);p&&ej(a,p[1])}var g=c.match(cj);g&&g[1]&&Rj(g[1],i);var m=[];if(t.cellStyles){var v=c.match(nj);v&&xj(m,v)}d&&kj(d[1],a,t,l,n,o);var w=u.match(oj);w&&(a["!autofilter"]=Sj(w[0]));var C=[],y=u.match(tj);if(y)for(f=0;f!=y.length;++f)C[f]=qe(y[f].slice(y[f].indexOf('"')+1));var b=u.match(sj);b&&vj(a,b,s);var F=u.match(aj);if(F&&(a["!margins"]=Cj(Me(F[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=Ne(l)),t.sheetRows>0&&a["!ref"]){var S=qe(a["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),a["!fullref"]=a["!ref"],a["!ref"]=Ne(S))}return m.length>0&&(a["!cols"]=m),C.length>0&&(a["!merges"]=C),a}function dj(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ne(e[r])+'"/>';return t+"</mergeCells>"}function Ug(e,t,r,s){var i=Me(e);r.Sheets[s]||(r.Sheets[s]={}),i.codeName&&(r.Sheets[s].CodeName=Ke(ot(i.codeName)))}function hj(e,t,r,s,i){Ug(e.slice(0,e.indexOf(">")),r,s,i)}function fj(e,t,r,s,i){var n=!1,o={},a=null;if(s.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}n=!0,o.codeName=bs(rt(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+me("outlinePr",null,c)}!n&&!a||(i[i.length]=me("sheetPr",a,o))}var gj=["objects","scenarios","selectLockedCells","selectUnlockedCells"],pj=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function mj(e){var t={sheet:1};return gj.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),pj.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Ng(e.password).toString(16).toUpperCase()),me("sheetProtection",null,t)}function vj(e,t,r){for(var s=Array.isArray(e),i=0;i!=t.length;++i){var n=Me(ot(t[i]),!0);if(!n.ref)return;var o=((r||{})["!id"]||[])[n.id];o?(n.Target=o.Target,n.location&&(n.Target+="#"+Ke(n.location))):(n.Target="#"+Ke(n.location),o={Target:n.Target,TargetMode:"Internal"}),n.Rel=o,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var a=qe(n.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=Ie({c,r:l});s?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=n):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=n)}}}function Cj(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function wj(e){return tn(e),me("pageMargins",null,e)}function xj(e,t){for(var r=!1,s=0;s!=t.length;++s){var i=Me(t[s],!0);i.hidden&&(i.hidden=lt(i.hidden));var n=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Bg(i.width)),bi(i);n<=o;)e[n++]=dt(i)}}function yj(e,t){for(var r=["<cols>"],s,i=0;i!=t.length;++i)(s=t[i])&&(r[r.length]=me("col",null,Vu(i,s)));return r[r.length]="</cols>",r.join("")}function Sj(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function bj(e,t,r,s){var i=typeof e.ref=="string"?e.ref:Ne(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,o=yr(i);o.s.r==o.e.r&&(o.e.r=yr(t["!ref"]).e.r,i=Ne(o));for(var a=0;a<n.length;++a){var l=n[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==s){l.Ref="'"+r.SheetNames[s]+"'!"+i;break}}return a==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),me("autoFilter",null,{ref:i})}var Fj=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Rj(e,t){t.Views||(t.Views=[{}]),(e.match(Fj)||[]).forEach(function(r,s){var i=Me(r);t.Views[s]||(t.Views[s]={}),+i.zoomScale&&(t.Views[s].zoom=+i.zoomScale),lt(i.rightToLeft)&&(t.Views[s].RTL=!0)})}function Ej(e,t,r,s){var i={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),me("sheetViews",me("sheetView",null,i),{})}function Tj(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",n=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ii[e.v];break;case"d":s&&s.cellDates?i=ut(e.v,-1).toISOString():(e=dt(e),e.t="n",i=""+(e.v=Nt(ut(e.v)))),typeof e.z>"u"&&(e.z=De[14]);break;default:i=e.v;break}var a=Kt("v",rt(i)),l={r:t},c=Mi(s.cellXfs,e,s);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){a=Kt("v",""+zg(s.Strings,e.v,s.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=n&&(e.t=n,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=me("f",rt(e.f),u)+(e.v!=null?a:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),me("c",a,l)}var kj=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,n=Ia("v"),o=Ia("f");return function(l,c,u,d,h,f){for(var p=0,g="",m=[],v=[],w=0,C=0,y=0,b="",F,S,D=0,T=0,V,_,I=0,z=0,U=Array.isArray(f.CellXf),j,ne=[],se=[],xe=Array.isArray(c),W=[],fe={},pe=!1,P=!!u.sheetStubs,B=l.split(t),H=0,G=B.length;H!=G;++H){g=B[H].trim();var J=g.length;if(J!==0){var ae=0;e:for(p=0;p<J;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(S=Me(g.slice(ae,p),!0),D=S.r!=null?parseInt(S.r,10):D+1,T=-1,u.sheetRows&&u.sheetRows<D)continue;fe={},pe=!1,S.ht&&(pe=!0,fe.hpt=parseFloat(S.ht),fe.hpx=Co(fe.hpt)),S.hidden=="1"&&(pe=!0,fe.hidden=!0),S.outlineLevel!=null&&(pe=!0,fe.level=+S.outlineLevel),pe&&(W[D-1]=fe)}break;case"<":ae=p;break}if(ae>=p)break;if(S=Me(g.slice(ae,p),!0),D=S.r!=null?parseInt(S.r,10):D+1,T=-1,!(u.sheetRows&&u.sheetRows<D)){d.s.r>D-1&&(d.s.r=D-1),d.e.r<D-1&&(d.e.r=D-1),u&&u.cellStyles&&(fe={},pe=!1,S.ht&&(pe=!0,fe.hpt=parseFloat(S.ht),fe.hpx=Co(fe.hpt)),S.hidden=="1"&&(pe=!0,fe.hidden=!0),S.outlineLevel!=null&&(pe=!0,fe.level=+S.outlineLevel),pe&&(W[D-1]=fe)),m=g.slice(p).split(e);for(var ue=0;ue!=m.length&&m[ue].trim().charAt(0)=="<";++ue);for(m=m.slice(ue),p=0;p!=m.length;++p)if(g=m[p].trim(),g.length!==0){if(v=g.match(r),w=p,C=0,y=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(w=0,b=v[1],C=0;C!=b.length&&!((y=b.charCodeAt(C)-64)<1||y>26);++C)w=26*w+y;--w,T=w}else++T;for(C=0;C!=g.length&&g.charCodeAt(C)!==62;++C);if(++C,S=Me(g.slice(0,C),!0),S.r||(S.r=Ie({r:D-1,c:T})),b=g.slice(C),F={t:""},(v=b.match(n))!=null&&v[1]!==""&&(F.v=Ke(v[1])),u.cellFormula){if((v=b.match(o))!=null&&v[1]!==""){if(F.f=Ke(ot(v[1])).replace(/\r\n/g,`
`),u.xlfn||(F.f=ev(F.f)),v[0].indexOf('t="array"')>-1)F.F=(b.match(i)||[])[1],F.F.indexOf(":")>-1&&ne.push([qe(F.F),F.F]);else if(v[0].indexOf('t="shared"')>-1){_=Me(v[0]);var ce=Ke(ot(v[1]));u.xlfn||(ce=ev(ce)),se[parseInt(_.si,10)]=[_,ce,S.r]}}else(v=b.match(/<f[^>]*\/>/))&&(_=Me(v[0]),se[_.si]&&(F.f=Fz(se[_.si][1],se[_.si][2],S.r)));var te=yt(S.r);for(C=0;C<ne.length;++C)te.r>=ne[C][0].s.r&&te.r<=ne[C][0].e.r&&te.c>=ne[C][0].s.c&&te.c<=ne[C][0].e.c&&(F.F=ne[C][1])}if(S.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(P)F.t="z";else continue;else F.t=S.t||"n";switch(d.s.c>T&&(d.s.c=T),d.e.c<T&&(d.e.c=T),F.t){case"n":if(F.v==""||F.v==null){if(!P)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!P)continue;F.t="z"}else V=la[parseInt(F.v,10)],F.v=V.t,F.r=V.r,u.cellHTML&&(F.h=V.h);break;case"str":F.t="s",F.v=F.v!=null?ot(F.v):"",u.cellHTML&&(F.h=Sg(F.v));break;case"inlineStr":v=b.match(s),F.t="s",v!=null&&(V=Og(v[1]))?(F.v=V.t,u.cellHTML&&(F.h=V.h)):F.v="";break;case"b":F.v=lt(F.v);break;case"d":u.cellDates?F.v=ut(F.v,1):(F.v=Nt(ut(F.v,1)),F.t="n");break;case"e":(!u||u.cellText!==!1)&&(F.w=F.v),F.v=sy[F.v];break}if(I=z=0,j=null,U&&S.s!==void 0&&(j=f.CellXf[S.s],j!=null&&(j.numFmtId!=null&&(I=j.numFmtId),u.cellStyles&&j.fillId!=null&&(z=j.fillId))),eS(F,I,z,u,h,f),u.cellDates&&U&&F.t=="n"&&To(De[I])&&(F.t="d",F.v=Ou(F.v)),S.cm&&u.xlmeta){var Ae=(u.xlmeta.Cell||[])[+S.cm-1];Ae&&Ae.type=="XLDAPR"&&(F.D=!0)}if(xe){var O=yt(S.r);c[O.r]||(c[O.r]=[]),c[O.r][O.c]=F}else c[S.r]=F}}}}W.length>0&&(c["!rows"]=W)}})();function Pj(e,t,r,s){var i=[],n=[],o=qe(e["!ref"]),a="",l,c="",u=[],d=0,h=0,f=e["!rows"],p=Array.isArray(e),g={r:c},m,v=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=xt(h);for(d=o.s.r;d<=o.e.r;++d){for(n=[],c=Pt(d),h=o.s.c;h<=o.e.c;++h){l=u[h]+c;var w=p?(e[d]||[])[h]:e[l];w!==void 0&&(a=Tj(w,l,e,t))!=null&&n.push(a)}(n.length>0||f&&f[d])&&(g={r:c},f&&f[d]&&(m=f[d],m.hidden&&(g.hidden=1),v=-1,m.hpx?v=Ha(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(g.ht=v,g.customHeight=1),m.level&&(g.outlineLevel=m.level)),i[i.length]=me("row",n.join(""),g))}if(f)for(;d<f.length;++d)f&&f[d]&&(g={r:d+1},m=f[d],m.hidden&&(g.hidden=1),v=-1,m.hpx?v=Ha(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(g.ht=v,g.customHeight=1),m.level&&(g.outlineLevel=m.level),i[i.length]=me("row","",g));return i.join("")}function rS(e,t,r,s){var i=[Dt,me("worksheet",null,{xmlns:bn[0],"xmlns:r":Ot.r})],n=r.SheetNames[e],o=0,a="",l=r.Sheets[n];l==null&&(l={});var c=l["!ref"]||"A1",u=qe(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ne(u)}s||(s={}),l["!comments"]=[];var d=[];fj(l,r,e,t,i),i[i.length]=me("dimension",null,{ref:c}),i[i.length]=Ej(l,t,e,r),t.sheetFormat&&(i[i.length]=me("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=yj(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=Pj(l,t),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=mj(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=bj(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=dj(l["!merges"]));var h=-1,f,p=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(f={ref:g[0]},g[1].Target.charAt(0)!="#"&&(p=tt(s,-1,rt(g[1].Target).replace(/#.*$/,""),We.HLINK),f["r:id"]="rId"+p),(h=g[1].Target.indexOf("#"))>-1&&(f.location=rt(g[1].Target.slice(h+1))),g[1].Tooltip&&(f.tooltip=rt(g[1].Tooltip)),i[i.length]=me("hyperlink",null,f))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=wj(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Kt("ignoredErrors",me("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(p=tt(s,-1,"../drawings/drawing"+(e+1)+".xml",We.DRAW),i[i.length]=me("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=d),l["!comments"].length>0&&(p=tt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",We.VML),i[i.length]=me("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Dj(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=s,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=i/20),r}function Aj(e,t,r){var s=Q(145),i=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var n=320;i.hpx?n=Ha(i.hpx)*20:i.hpt&&(n=i.hpt*20),s.write_shift(2,n),s.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var a=0,l=s.l;s.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,f=u<<10;f<u+1<<10;++f){c.c=f;var p=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ie(c)];p&&(d<0&&(d=f),h=f)}d<0||(++a,s.write_shift(4,d),s.write_shift(4,h))}var g=s.l;return s.l=l,s.write_shift(4,a),s.l=g,s.length>s.l?s.slice(0,s.l):s}function Ij(e,t,r,s){var i=Aj(s,r,t);(i.length>17||(t["!rows"]||[])[s])&&le(e,0,i)}var Mj=Tn,_j=Do;function Lj(){}function Oj(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=HV(e),r}function Nj(e,t,r){r==null&&(r=Q(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var i=1;i<3;++i)r.write_shift(1,0);return eu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Z1(e,r),r.slice(0,r.l)}function Bj(e){var t=Xr(e);return[t]}function Hj(e,t,r){return r==null&&(r=Q(8)),Fn(t,r)}function Vj(e){var t=Rn(e);return[t]}function Gj(e,t,r){return r==null&&(r=Q(4)),En(t,r)}function Wj(e){var t=Xr(e),r=e.read_shift(1);return[t,r,"b"]}function zj(e,t,r){return r==null&&(r=Q(9)),Fn(t,r),r.write_shift(1,e.v?1:0),r}function Uj(e){var t=Rn(e),r=e.read_shift(1);return[t,r,"b"]}function jj(e,t,r){return r==null&&(r=Q(5)),En(t,r),r.write_shift(1,e.v?1:0),r}function $j(e){var t=Xr(e),r=e.read_shift(1);return[t,r,"e"]}function Kj(e,t,r){return r==null&&(r=Q(9)),Fn(t,r),r.write_shift(1,e.v),r}function qj(e){var t=Rn(e),r=e.read_shift(1);return[t,r,"e"]}function Xj(e,t,r){return r==null&&(r=Q(8)),En(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Yj(e){var t=Xr(e),r=e.read_shift(4);return[t,r,"s"]}function Jj(e,t,r){return r==null&&(r=Q(12)),Fn(t,r),r.write_shift(4,t.v),r}function Zj(e){var t=Rn(e),r=e.read_shift(4);return[t,r,"s"]}function Qj(e,t,r){return r==null&&(r=Q(8)),En(t,r),r.write_shift(4,t.v),r}function e$(e){var t=Xr(e),r=rr(e);return[t,r,"n"]}function t$(e,t,r){return r==null&&(r=Q(16)),Fn(t,r),fn(e.v,r),r}function sS(e){var t=Rn(e),r=rr(e);return[t,r,"n"]}function r$(e,t,r){return r==null&&(r=Q(12)),En(t,r),fn(e.v,r),r}function s$(e){var t=Xr(e),r=Ag(e);return[t,r,"n"]}function i$(e,t,r){return r==null&&(r=Q(12)),Fn(t,r),Q1(e.v,r),r}function n$(e){var t=Rn(e),r=Ag(e);return[t,r,"n"]}function o$(e,t,r){return r==null&&(r=Q(8)),En(t,r),Q1(e.v,r),r}function a$(e){var t=Xr(e),r=kg(e);return[t,r,"is"]}function l$(e){var t=Xr(e),r=sr(e);return[t,r,"str"]}function c$(e,t,r){return r==null&&(r=Q(12+4*e.v.length)),Fn(t,r),zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function u$(e){var t=Rn(e),r=sr(e);return[t,r,"str"]}function d$(e,t,r){return r==null&&(r=Q(8+4*e.v.length)),En(t,r),zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function h$(e,t,r){var s=e.l+t,i=Xr(e);i.r=r["!row"];var n=e.read_shift(1),o=[i,n,"b"];if(r.cellFormula){e.l+=2;var a=Hu(e,s-e.l,r);o[3]=er(a,null,i,r.supbooks,r)}else e.l=s;return o}function f$(e,t,r){var s=e.l+t,i=Xr(e);i.r=r["!row"];var n=e.read_shift(1),o=[i,n,"e"];if(r.cellFormula){e.l+=2;var a=Hu(e,s-e.l,r);o[3]=er(a,null,i,r.supbooks,r)}else e.l=s;return o}function g$(e,t,r){var s=e.l+t,i=Xr(e);i.r=r["!row"];var n=rr(e),o=[i,n,"n"];if(r.cellFormula){e.l+=2;var a=Hu(e,s-e.l,r);o[3]=er(a,null,i,r.supbooks,r)}else e.l=s;return o}function p$(e,t,r){var s=e.l+t,i=Xr(e);i.r=r["!row"];var n=sr(e),o=[i,n,"str"];if(r.cellFormula){e.l+=2;var a=Hu(e,s-e.l,r);o[3]=er(a,null,i,r.supbooks,r)}else e.l=s;return o}var m$=Tn,v$=Do;function C$(e,t){return t==null&&(t=Q(4)),t.write_shift(4,e),t}function w$(e,t){var r=e.l+t,s=Tn(e),i=Pg(e),n=sr(e),o=sr(e),a=sr(e);e.l=r;var l={rfx:s,relId:i,loc:n,display:a};return o&&(l.Tooltip=o),l}function x$(e,t){var r=Q(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Do({s:yt(e[0]),e:yt(e[0])},r),Dg("rId"+t,r);var s=e[1].Target.indexOf("#"),i=s==-1?"":e[1].Target.slice(s+1);return zt(i||"",r),zt(e[1].Tooltip||"",r),zt("",r),r.slice(0,r.l)}function y$(){}function S$(e,t,r){var s=e.l+t,i=ey(e),n=e.read_shift(1),o=[i];if(o[2]=n,r.cellFormula){var a=$U(e,s-e.l,r);o[1]=a}else e.l=s;return o}function b$(e,t,r){var s=e.l+t,i=Tn(e),n=[i];if(r.cellFormula){var o=qU(e,s-e.l,r);n[1]=o,e.l=s}else e.l=s;return n}function F$(e,t,r){r==null&&(r=Q(18));var s=Vu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof s.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var iS=["left","right","top","bottom","header","footer"];function R$(e){var t={};return iS.forEach(function(r){t[r]=rr(e)}),t}function E$(e,t){return t==null&&(t=Q(48)),tn(e),iS.forEach(function(r){fn(e[r],t)}),t}function T$(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function k$(e,t,r){r==null&&(r=Q(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function P$(e){var t=Q(24);return t.write_shift(4,4),t.write_shift(4,1),Do(e,t),t}function D$(e,t){return t==null&&(t=Q(66)),t.write_shift(2,e.password?Ng(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function A$(){}function I$(){}function M$(e,t,r,s,i,n,o){if(!e)return e;var a=t||{};s||(s={"!id":{}});var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,f,p,g,m,v,w,C,y,b,F=[];a.biff=12,a["!row"]=0;var S=0,D=!1,T=[],V={},_=a.supbooks||i.supbooks||[[]];if(_.sharedf=V,_.arrayf=T,_.SheetNames=i.SheetNames||i.Sheets.map(function(xe){return xe.name}),!a.supbooks&&(a.supbooks=_,i.Names))for(var I=0;I<i.Names.length;++I)_[0][I+1]=i.Names[I];var z=[],U=[],j=!1;Va[16]={n:"BrtShortReal",f:sS};var ne;if(si(e,function(W,fe,pe){if(!h)switch(pe){case 148:c=W;break;case 0:f=W,a.sheetRows&&a.sheetRows<=f.r&&(h=!0),y=Pt(m=f.r),a["!row"]=f.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Co(W.hpt)),U[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:W[2]},W[2]){case"n":p.v=W[1];break;case"s":C=la[W[1]],p.v=C.t,p.r=C.r;break;case"b":p.v=!!W[1];break;case"e":p.v=W[1],a.cellText!==!1&&(p.w=ii[p.v]);break;case"str":p.t="s",p.v=W[1];break;case"is":p.t="s",p.v=W[1].t;break}if((g=o.CellXf[W[0].iStyleRef])&&eS(p,g.numFmtId,null,a,n,o),v=W[0].c==-1?v+1:W[0].c,a.dense?(l[m]||(l[m]=[]),l[m][v]=p):l[xt(v)+y]=p,a.cellFormula){for(D=!1,S=0;S<T.length;++S){var P=T[S];f.r>=P[0].s.r&&f.r<=P[0].e.r&&v>=P[0].s.c&&v<=P[0].e.c&&(p.F=Ne(P[0]),D=!0)}!D&&W.length>3&&(p.f=W[3])}if(u.s.r>f.r&&(u.s.r=f.r),u.s.c>v&&(u.s.c=v),u.e.r<f.r&&(u.e.r=f.r),u.e.c<v&&(u.e.c=v),a.cellDates&&g&&p.t=="n"&&To(De[g.numFmtId])){var B=Ui(p.v);B&&(p.t="d",p.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}ne&&(ne.type=="XLDAPR"&&(p.D=!0),ne=void 0);break;case 1:case 12:if(!a.sheetStubs||d)break;p={t:"z",v:void 0},v=W[0].c==-1?v+1:W[0].c,a.dense?(l[m]||(l[m]=[]),l[m][v]=p):l[xt(v)+y]=p,u.s.r>f.r&&(u.s.r=f.r),u.s.c>v&&(u.s.c=v),u.e.r<f.r&&(u.e.r=f.r),u.e.c<v&&(u.e.c=v),ne&&(ne.type=="XLDAPR"&&(p.D=!0),ne=void 0);break;case 176:F.push(W);break;case 49:ne=((a.xlmeta||{}).Cell||[])[W-1];break;case 494:var H=s["!id"][W.relId];for(H?(W.Target=H.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=H):W.relId==""&&(W.Target="#"+W.loc),m=W.rfx.s.r;m<=W.rfx.e.r;++m)for(v=W.rfx.s.c;v<=W.rfx.e.c;++v)a.dense?(l[m]||(l[m]=[]),l[m][v]||(l[m][v]={t:"z",v:void 0}),l[m][v].l=W):(w=Ie({c:v,r:m}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=W);break;case 426:if(!a.cellFormula)break;T.push(W),b=a.dense?l[m][v]:l[xt(v)+y],b.f=er(W[1],u,{r:f.r,c:v},_,a),b.F=Ne(W[0]);break;case 427:if(!a.cellFormula)break;V[Ie(W[0].s)]=W[1],b=a.dense?l[m][v]:l[xt(v)+y],b.f=er(W[1],u,{r:f.r,c:v},_,a);break;case 60:if(!a.cellStyles)break;for(;W.e>=W.s;)z[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},j||(j=!0,Bg(W.w/256)),bi(z[W.e+1]);break;case 161:l["!autofilter"]={ref:Ne(W)};break;case 476:l["!margins"]=W;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),W.name&&(i.Sheets[r].CodeName=W.name),(W.above||W.left)&&(l["!outline"]={above:W.above,left:W.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),W.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!fe.T){if(!d||a.WTF)throw new Error("Unexpected record 0x"+pe.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ne(c||u)),a.sheetRows&&l["!ref"]){var se=qe(l["!ref"]);a.sheetRows<=+se.e.r&&(se.e.r=a.sheetRows-1,se.e.r>u.e.r&&(se.e.r=u.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>u.e.c&&(se.e.c=u.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ne(se))}return F.length>0&&(l["!merges"]=F),z.length>0&&(l["!cols"]=z),U.length>0&&(l["!rows"]=U),l}function _$(e,t,r,s,i,n,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=dt(t),t.z=t.z||De[14],t.v=Nt(ut(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var l={r,c:s};switch(l.s=Mi(i.cellXfs,t,i),t.l&&n["!links"].push([Ie(l),t.l]),t.c&&n["!comments"].push([Ie(l),t.c]),t.t){case"s":case"str":return i.bookSST?(a=zg(i.Strings,t.v,i.revStrings),l.t="s",l.v=a,o?le(e,18,Qj(t,l)):le(e,7,Jj(t,l))):(l.t="str",o?le(e,17,d$(t,l)):le(e,6,c$(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?le(e,13,o$(t,l)):le(e,2,i$(t,l)):o?le(e,16,r$(t,l)):le(e,5,t$(t,l)),!0;case"b":return l.t="b",o?le(e,15,jj(t,l)):le(e,4,zj(t,l)),!0;case"e":return l.t="e",o?le(e,14,Xj(t,l)):le(e,3,Kj(t,l)),!0}return o?le(e,12,Gj(t,l)):le(e,1,Hj(t,l)),!0}function L$(e,t,r,s){var i=qe(t["!ref"]||"A1"),n,o="",a=[];le(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=Pt(u),Ij(e,t,i,u);var d=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(a[h]=xt(h)),n=a[h]+o;var f=l?(t[u]||[])[h]:t[n];if(!f){d=!1;continue}d=_$(e,f,u,h,s,t,d)}}le(e,146)}function O$(e,t){!t||!t["!merges"]||(le(e,177,C$(t["!merges"].length)),t["!merges"].forEach(function(r){le(e,176,v$(r))}),le(e,178))}function N$(e,t){!t||!t["!cols"]||(le(e,390),t["!cols"].forEach(function(r,s){r&&le(e,60,F$(s,r))}),le(e,391))}function B$(e,t){!t||!t["!ref"]||(le(e,648),le(e,649,P$(qe(t["!ref"]))),le(e,650))}function H$(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var i=tt(r,-1,s[1].Target.replace(/#.*$/,""),We.HLINK);le(e,494,x$(s,i))}}),delete t["!links"]}function V$(e,t,r,s){if(t["!comments"].length>0){var i=tt(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",We.VML);le(e,551,Dg("rId"+i)),t["!legacy"]=i}}function G$(e,t,r,s){if(t["!autofilter"]){var i=t["!autofilter"],n=typeof i.ref=="string"?i.ref:Ne(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=yr(n);a.s.r==a.e.r&&(a.e.r=yr(t["!ref"]).e.r,n=Ne(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),le(e,161,Do(qe(n))),le(e,162)}}function W$(e,t,r){le(e,133),le(e,137,k$(t,r)),le(e,138),le(e,134)}function z$(e,t){t["!protect"]&&le(e,535,D$(t["!protect"]))}function U$(e,t,r,s){var i=Cr(),n=r.SheetNames[e],o=r.Sheets[n]||{},a=n;try{r&&r.Workbook&&(a=r.Workbook.Sheets[e].CodeName||a)}catch{}var l=qe(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],le(i,129),(r.vbaraw||o["!outline"])&&le(i,147,Nj(a,o["!outline"])),le(i,148,_j(l)),W$(i,o,r.Workbook),N$(i,o),L$(i,o,e,t),z$(i,o),G$(i,o,r,e),O$(i,o),H$(i,o,s),o["!margins"]&&le(i,476,E$(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&B$(i,o),V$(i,o,e,s),le(i,130),i.end()}function j$(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var o=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Ke((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){s=n.replace(/<.*?>/g,"")}),[t,i,s]}function $$(e,t,r,s,i,n){var o=n||{"!type":"chart"};if(!e)return n;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=j$(d);u.s.r=u.s.c=0,u.e.c=a,c=xt(a),h[0].forEach(function(f,p){o[c+Pt(p)]={t:"n",v:f,z:h[1]},l=p}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(o["!ref"]=Ne(u)),o}function K$(e,t,r,s,i){if(!e)return e;s||(s={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},o,a=e.match(tS);return a&&Ug(a[0],n,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=o[1]),s["!id"][n["!rel"]]&&(n["!drawel"]=s["!id"][n["!rel"]]),n}function q$(e,t){e.l+=10;var r=sr(e);return{name:r}}function X$(e,t,r,s,i){if(!e)return e;s||(s={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},o=!1;return si(e,function(l,c,u){switch(u){case 550:n["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),s["!id"][n["!rel"]]&&(n["!drawel"]=s["!id"][n["!rel"]]),n}var jg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Y$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],J$=[],Z$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function nv(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],i=0;i!=t.length;++i){var n=t[i];if(s[n[0]]==null)s[n[0]]=n[1];else switch(n[2]){case"bool":typeof s[n[0]]=="string"&&(s[n[0]]=lt(s[n[0]]));break;case"int":typeof s[n[0]]=="string"&&(s[n[0]]=parseInt(s[n[0]],10));break}}}function ov(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=lt(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function nS(e){ov(e.WBProps,jg),ov(e.CalcPr,Z$),nv(e.WBView,Y$),nv(e.Sheets,J$),oo.date1904=lt(e.WBProps.date1904)}function Q$(e){return!e.Workbook||!e.Workbook.WBProps?"false":lt(e.Workbook.WBProps.date1904)?"true":"false"}var eK="][*?/\\".split("");function oS(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return eK.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function tK(e,t,r){e.forEach(function(s,i){oS(s);for(var n=0;n<i;++n)if(s==e[n])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[i]&&t[i].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function rK(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];tK(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)QU(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var sK=/<\w+:workbook/;function iK(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,i="xmlns",n={},o=0;if(e.replace(or,function(l,c){var u=Me(l);switch(Ds(u[0])){case"<?xml":break;case"<workbook":l.match(sK)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jg.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=lt(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=ot(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ke(ot(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":n={},n.Name=ot(u.name),u.comment&&(n.Comment=u.comment),u.localSheetId&&(n.Sheet=+u.localSheetId),lt(u.hidden||"0")&&(n.Hidden=!0),o=c+l.length;break;case"</definedName>":n.Ref=Ke(ot(e.slice(o,c))),r.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),bn.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return nS(r),r}function aS(e){var t=[Dt];t[t.length]=me("workbook",null,{xmlns:bn[0],"xmlns:r":Ot.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jg.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(s[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=me("workbookPr",null,s);var i=e.Workbook&&e.Workbook.Sheets||[],n=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=e.SheetNames.length&&!(!i[n]||!i[n].Hidden);++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=e.SheetNames.length;++n){var o={name:rt(e.SheetNames[n].slice(0,31))};if(o.sheetId=""+(n+1),o["r:id"]="rId"+(n+1),i[n])switch(i[n].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=me("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=me("definedName",rt(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function nK(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Gh(e),r.name=sr(e),r}function oK(e,t){return t||(t=Q(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Dg(e.strRelID,t),zt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function aK(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?sr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function lK(e,t){t||(t=Q(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Z1(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function cK(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function uK(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),n=VV(e),o=KU(e,0,r),a=Pg(e);e.l=s;var l={Name:n,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function dK(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],i=!1;t||(t={}),t.biff=12;var n=[],o=[[]];return o.SheetNames=[],o.XTI=[],Va[16]={n:"BrtFRTArchID$",f:cK},si(e,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=er(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,n.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),nS(r),r.Names=n,r.supbooks=o,r}function hK(e,t){le(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};le(e,156,oK(i))}le(e,144)}function fK(e,t){t||(t=Q(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return zt("SheetJS",t),zt(Kc.version,t),zt(Kc.version,t),zt("7262",t),t.length>t.l?t.slice(0,t.l):t}function gK(e,t){t||(t=Q(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function pK(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,i=-1,n=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&i==-1?i=s:r[s].Hidden==1&&n==-1&&(n=s);n>i||(le(e,135),le(e,158,gK(i)),le(e,136))}}function mK(e,t){var r=Cr();return le(r,131),le(r,128,fK()),le(r,153,lK(e.Workbook&&e.Workbook.WBProps||null)),pK(r,e),hK(r,e),le(r,132),r.end()}function vK(e,t,r){return t.slice(-4)===".bin"?dK(e,r):iK(e,r)}function CK(e,t,r,s,i,n,o,a){return t.slice(-4)===".bin"?M$(e,s,r,i,n,o,a):uj(e,s,r,i,n,o,a)}function wK(e,t,r,s,i,n,o,a){return t.slice(-4)===".bin"?X$(e,s,r,i,n):K$(e,s,r,i,n)}function xK(e,t,r,s,i,n,o,a){return t.slice(-4)===".bin"?Sz():bz()}function yK(e,t,r,s,i,n,o,a){return t.slice(-4)===".bin"?xz():yz()}function SK(e,t,r,s){return t.slice(-4)===".bin"?v9(e,r,s):n9(e,r,s)}function bK(e,t,r){return Gy(e,r)}function FK(e,t,r){return t.slice(-4)===".bin"?F7(e,r):y7(e,r)}function RK(e,t,r){return t.slice(-4)===".bin"?pz(e,r):oz(e,r)}function EK(e,t,r){return t.slice(-4)===".bin"?sz(e):tz(e)}function TK(e,t,r,s){return r.slice(-4)===".bin"?iz(e,t,r,s):void 0}function kK(e,t,r){return t.slice(-4)===".bin"?Z9(e,t,r):ez(e,t,r)}function PK(e,t,r){return(t.slice(-4)===".bin"?mK:aS)(e)}function DK(e,t,r,s,i){return(t.slice(-4)===".bin"?U$:rS)(e,r,s,i)}function AK(e,t,r){return(t.slice(-4)===".bin"?T9:Hy)(e,r)}function IK(e,t,r){return(t.slice(-4)===".bin"?T7:Ay)(e,r)}function MK(e,t,r){return(t.slice(-4)===".bin"?mz:Uy)(e)}function _K(e){return(e.slice(-4)===".bin"?Q9:Wy)()}var lS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yr(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var i=e.match(lS),n,o,a,l;if(i)for(l=0;l!=i.length;++l)n=i[l].match(cS),(o=n[1].indexOf(":"))===-1?s[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?a="xmlns"+n[1].slice(6):a=n[1].slice(o+1),s[a]=n[2].slice(1,n[2].length-1));return s}function LK(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(lS),i,n,o,a;if(s)for(a=0;a!=s.length;++a)i=s[a].match(cS),(n=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(n+1),r[o]=i[2].slice(1,i[2].length-1));return r}var ua;function OK(e,t){var r=ua[e]||Ke(e);return r==="General"?dn(t):Kr(r,t)}function NK(e,t,r,s){var i=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=lt(s);break;case"i2":case"int":i=parseInt(s,10);break;case"r4":case"float":i=parseFloat(s);break;case"date":case"dateTime.tz":i=ut(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ke(t)]=i}function BK(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ii[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Aa(e.v):e.w=dn(e.v):e.w=OK(t||"General",e.v)}catch(n){if(r.WTF)throw n}try{var s=ua[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&To(s)){var i=Ui(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(n){if(r.WTF)throw n}}}function HK(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=J7[s.Pattern]||s.Pattern)}e[t.ID]=t}function VK(e,t,r,s,i,n,o,a,l,c){var u="General",d=s.StyleID,h={};c=c||{};var f=[],p=0;for(d===void 0&&a&&(d=a.StyleID),d===void 0&&o&&(d=o.StyleID);n[d]!==void 0&&(n[d].nf&&(u=n[d].nf),n[d].Interior&&f.push(n[d].Interior),!!n[d].Parent);)d=n[d].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=lt(e);break;case"String":s.t="s",s.r=bm(Ke(e)),s.v=e.indexOf("<")>-1?Ke(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(ut(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=Ke(e):s.v<60&&(s.v=s.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=sy[e],c.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=bm(t||e));break}if(BK(s,u,c),c.cellFormula!==!1)if(s.Formula){var g=Ke(s.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),s.f=no(g,i),delete s.Formula,s.ArrayRange=="RC"?s.F=no("RC:RC",i):s.ArrayRange&&(s.F=no(s.ArrayRange,i),l.push([qe(s.F),s.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(s.F=l[p][1]);c.cellStyles&&(f.forEach(function(m){!h.patternType&&m.patternType&&(h.patternType=m.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function GK(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ud(e,t){var r=t||{};ko();var s=jo(bg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=ot(s));var i=s.slice(0,1024).toLowerCase(),n=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=dt(r);return o.type="string",vo.to_workbook(s,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ee){i.indexOf("<"+Ee)>=0&&(n=!0)}),n)return Eq(s,r);ua={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c,u={},d=[],h=r.dense?[]:{},f="",p={},g={},m=Yr('<Data ss:Type="String">'),v=0,w=0,C=0,y={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},F={},S="",D=0,T=[],V={},_={},I=0,z=[],U=[],j={},ne=[],se,xe=!1,W=[],fe=[],pe={},P=0,B=0,H={Sheets:[],WBProps:{date1904:!1}},G={};_a.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";a=_a.exec(s);)switch(a[3]=(J=a[3]).toLowerCase()){case"data":if(J=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?VK(s.slice(v,a.index),S,m,l[l.length-1][0]=="comment"?j:p,{c:w,r:C},b,ne[w],g,W,r):(S="",m=Yr(a[0]),v=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(U.length>0&&(p.c=U),(!r.sheetRows||r.sheetRows>C)&&p.v!==void 0&&(r.dense?(h[C]||(h[C]=[]),h[C][w]=p):h[xt(w)+Pt(C)]=p),p.HRef&&(p.l={Target:Ke(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(P=w+(parseInt(p.MergeAcross,10)|0),B=C+(parseInt(p.MergeDown,10)|0),T.push({s:{c:w,r:C},e:{c:P,r:B}})),!r.sheetStubs)p.MergeAcross?w=P+1:++w;else if(p.MergeAcross||p.MergeDown){for(var ae=w;ae<=P;++ae)for(var ue=C;ue<=B;++ue)(ae>w||ue>C)&&(r.dense?(h[ue]||(h[ue]=[]),h[ue][ae]={t:"z"}):h[xt(ae)+Pt(ue)]={t:"z"});w=P+1}else++w;else p=LK(a[0]),p.Index&&(w=+p.Index-1),w<y.s.c&&(y.s.c=w),w>y.e.c&&(y.e.c=w),a[0].slice(-2)==="/>"&&++w,U=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(C<y.s.r&&(y.s.r=C),C>y.e.r&&(y.e.r=C),a[0].slice(-2)==="/>"&&(g=Yr(a[0]),g.Index&&(C=+g.Index-1)),w=0,++C):(g=Yr(a[0]),g.Index&&(C=+g.Index-1),pe={},(g.AutoFitHeight=="0"||g.Height)&&(pe.hpx=parseInt(g.Height,10),pe.hpt=Ha(pe.hpx),fe[C]=pe),g.Hidden=="1"&&(pe.hidden=!0,fe[C]=pe));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));d.push(f),y.s.r<=y.e.r&&y.s.c<=y.e.c&&(h["!ref"]=Ne(y),r.sheetRows&&r.sheetRows<=y.e.r&&(h["!fullref"]=h["!ref"],y.e.r=r.sheetRows-1,h["!ref"]=Ne(y))),T.length&&(h["!merges"]=T),ne.length>0&&(h["!cols"]=ne),fe.length>0&&(h["!rows"]=fe),u[f]=h}else y={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=w=0,l.push([a[3],!1]),c=Yr(a[0]),f=Ke(c.Name),h=r.dense?[]:{},T=[],W=[],fe=[],G={name:f,Hidden:0},H.Sheets.push(G);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),ne=[],xe=!1}break;case"style":a[1]==="/"?HK(b,F,r):F=Yr(a[0]);break;case"numberformat":F.nf=Ke(Yr(a[0]).Format||"General"),ua[F.nf]&&(F.nf=ua[F.nf]);for(var ce=0;ce!=392&&De[ce]!=F.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(De[ce]==null){js(F.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(se=Yr(a[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!xe&&se.wpx>10){xe=!0,tr=Ny;for(var te=0;te<ne.length;++te)ne[te]&&bi(ne[te])}xe&&bi(se),ne[se.Index-1||ne.length]=se;for(var Ae=0;Ae<+se.Span;++Ae)ne[ne.length]=dt(se);break;case"namedrange":if(a[1]==="/")break;H.Names||(H.Names=[]);var O=Me(a[0]),ze={Name:O.Name,Ref:no(O.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(ze.Sheet=H.Sheets.length-1),H.Names.push(ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?S+=s.slice(D,a.index):D=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=Yr(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?dG(V,J,s.slice(I,a.index)):I=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));GK(j),U.push(j)}else l.push([a[3],!1]),c=Yr(a[0]),j={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var _e=Yr(a[0]);h["!autofilter"]={ref:no(_e.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return dv(s,r);var je=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:je=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:je=!1}break;case"excelworkbook":switch(a[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:je=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:je=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(s.slice(I,a.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else I=a.index+a[0].length;break;case"header":h["!margins"]||tn(h["!margins"]={},"xlml"),isNaN(+Me(a[0]).Margin)||(h["!margins"].header=+Me(a[0]).Margin);break;case"footer":h["!margins"]||tn(h["!margins"]={},"xlml"),isNaN(+Me(a[0]).Margin)||(h["!margins"].footer=+Me(a[0]).Margin);break;case"pagemargins":var Oe=Me(a[0]);h["!margins"]||tn(h["!margins"]={},"xlml"),isNaN(+Oe.Top)||(h["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(h["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(h["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(h["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:je=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:je=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:je=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:je=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:je=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:je=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:je=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:je=!1}break;case"smarttags":break;default:je=!1;break}if(je||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?NK(_,J,z,s.slice(I,a.index)):(z=a,I=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var ie={};return!r.bookSheets&&!r.bookProps&&(ie.Sheets=u),ie.SheetNames=d,ie.Workbook=H,ie.SSF=dt(De),ie.Props=V,ie.Custprops=_,ie}function qh(e,t){switch(Kg(t=t||{}),t.type||"base64"){case"base64":return Ud(Pr(e),t);case"binary":case"buffer":case"file":return Ud(e,t);case"array":return Ud(Ai(e),t)}}function WK(e,t){var r=[];return e.Props&&r.push(hG(e.Props,t)),e.Custprops&&r.push(fG(e.Props,e.Custprops)),r.join("")}function zK(){return""}function UK(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,i){var n=[];n.push(me("NumberFormat",null,{"ss:Format":rt(De[s.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(me("Style",n.join(""),o))}),me("Styles",r.join(""))}function uS(e){return me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Gg(e.Ref,{r:0,c:0})})}function jK(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var i=t[s];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(uS(i)))}return me("Names",r.join(""))}function $K(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var i=s.Workbook.Names,n=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||n.push(uS(a)))}return n.join("")}function KK(e,t,r,s){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(me("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)i.push(me("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&!(s.Workbook.Sheets[n]&&!s.Workbook.Sheets[n].Hidden);++n);n==r&&i.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Kt("ProtectContents","True")),e["!protect"].objects&&i.push(Kt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Kt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Kt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Kt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":me("WorksheetOptions",i.join(""),{xmlns:Sr.x})}function qK(e){return e.map(function(t){var r=pV(t.t||""),s=me("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return me("Comment",s,{"ss:Author":t.a})}).join("")}function XK(e,t,r,s,i,n,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+rt(Gg(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=yt(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=rt(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=rt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=ii[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||De[14]);break;case"s":d="String",h=gV(e.v||"");break}var f=Mi(s.cellXfs,e,s);a["ss:StyleID"]="s"+(21+f),a["ss:Index"]=o.c+1;var p=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+d+'">'+p+"</Data>";return(e.c||[]).length>0&&(g+=qK(e.c)),me("Cell",g,a)}function YK(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Co(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function JK(e,t,r,s){if(!e["!ref"])return"";var i=qe(e["!ref"]),n=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(m,v){bi(m);var w=!!m.width,C=Vu(v,m),y={"ss:Index":v+1};w&&(y["ss:Width"]=Na(C.width)),m.hidden&&(y["ss:Hidden"]="1"),a.push(me("Column",null,y))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[YK(c,(e["!rows"]||[])[c])],d=i.s.c;d<=i.e.c;++d){var h=!1;for(o=0;o!=n.length;++o)if(!(n[o].s.c>d)&&!(n[o].s.r>c)&&!(n[o].e.c<d)&&!(n[o].e.r<c)){(n[o].s.c!=d||n[o].s.r!=c)&&(h=!0);break}if(!h){var f={r:c,c:d},p=Ie(f),g=l?(e[c]||[])[d]:e[p];u.push(XK(g,p,e,t,r,s,f))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function ZK(e,t,r){var s=[],i=r.SheetNames[e],n=r.Sheets[i],o=n?$K(n,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=n?JK(n,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(KK(n,t,e,r)),s.join("")}function QK(e,t){t||(t={}),e.SSF||(e.SSF=dt(De)),e.SSF&&(ko(),Mu(e.SSF),t.revssf=Lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Mi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(WK(e,t)),r.push(zK()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(me("Worksheet",ZK(s,t,e),{"ss:Name":rt(e.SheetNames[s])}));return r[2]=UK(e,t),r[3]=jK(e),Dt+me("Workbook",r.join(""),{xmlns:Sr.ss,"xmlns:o":Sr.o,"xmlns:x":Sr.x,"xmlns:ss":Sr.ss,"xmlns:dt":Sr.dt,"xmlns:html":Sr.html})}function eq(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=jV(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=$V(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var tq=[60,1084,2066,2165,2175];function rq(e,t,r,s,i){var n=s,o=[],a=r.slice(r.l,r.l+n);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=n;for(var l=Ns(r,r.l),c=Xh[l],u=0;c!=null&&tq.indexOf(l)>-1;)n=Ns(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=r.slice(u,r.l+4+n),o.push(a),r.l+=4+n,c=Xh[l=Ns(r,r.l)];var d=Vt(o);$t(d,0);var h=0;d.lens=[];for(var f=0;f<o.length;++f)d.lens.push(h),h+=o[f].length;if(d.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+s;return t.f(d,d.length,i)}function ds(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=De[s])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ii[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Aa(e.v):e.w=dn(e.v):e.w=Kr(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&s&&e.t=="n"&&To(De[s]||String(s))){var i=Ui(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Nl(e,t,r){return{v:e,ixfe:t,t:r}}function sq(e,t){var r={opts:{}},s={},i=t.dense?[]:{},n={},o={},a=null,l=[],c="",u={},d,h="",f,p,g,m,v={},w=[],C,y,b=[],F=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},T=function(He){return He<8?Zi[He]:He<64&&F[He-8]||Zi[He]},V=function(He,Et,Ar){var Lt=Et.XF.data;if(!(!Lt||!Lt.patternType||!Ar||!Ar.cellStyles)){Et.s={},Et.s.patternType=Lt.patternType;var _i;(_i=Oa(T(Lt.icvFore)))&&(Et.s.fgColor={rgb:_i}),(_i=Oa(T(Lt.icvBack)))&&(Et.s.bgColor={rgb:_i})}},_=function(He,Et,Ar){if(!(pe>1)&&!(Ar.sheetRows&&He.r>=Ar.sheetRows)){if(Ar.cellStyles&&Et.XF&&Et.XF.data&&V(He,Et,Ar),delete Et.ixfe,delete Et.XF,d=He,h=Ie(He),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),He.r<o.s.r&&(o.s.r=He.r),He.c<o.s.c&&(o.s.c=He.c),He.r+1>o.e.r&&(o.e.r=He.r+1),He.c+1>o.e.c&&(o.e.c=He.c+1),Ar.cellFormula&&Et.f){for(var Lt=0;Lt<w.length;++Lt)if(!(w[Lt][0].s.c>He.c||w[Lt][0].s.r>He.r)&&!(w[Lt][0].e.c<He.c||w[Lt][0].e.r<He.r)){Et.F=Ne(w[Lt][0]),(w[Lt][0].s.c!=He.c||w[Lt][0].s.r!=He.r)&&delete Et.f,Et.f&&(Et.f=""+er(w[Lt][1],o,He,W,I));break}}Ar.dense?(i[He.r]||(i[He.r]=[]),i[He.r][He.c]=Et):i[h]=Et}},I={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var z,U=[],j=[],ne=[],se=[],xe=!1,W=[];W.SheetNames=I.snames,W.sharedf=I.sharedf,W.arrayf=I.arrayf,W.names=[],W.XTI=[];var fe=0,pe=0,P=0,B=[],H=[],G;I.codepage=1200,Qr(1200);for(var J=!1;e.l<e.length-1;){var ae=e.l,ue=e.read_shift(2);if(ue===0&&fe===10)break;var ce=e.l===e.length?0:e.read_shift(2),te=Xh[ue];if(te&&te.f){if(t.bookSheets&&fe===133&&ue!==133)break;if(fe=ue,te.r===2||te.r==12){var Ae=e.read_shift(2);if(ce-=2,!I.enc&&Ae!==ue&&((Ae&255)<<8|Ae>>8)!==ue)throw new Error("rt mismatch: "+Ae+"!="+ue);te.r==12&&(e.l+=10,ce-=10)}var O={};if(ue===10?O=te.f(e,ce,I):O=rq(ue,te,e,ce,I),pe==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(ue){case 34:r.opts.Date1904=S.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=O;break;case 66:var ze=Number(O);switch(ze){case 21010:ze=1200;break;case 32768:ze=1e4;break;case 32769:ze=1252;break}Qr(I.codepage=ze),J=!0;break;case 317:I.rrtabid=O;break;case 25:I.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:I.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(i["!type"]="dialog"),O.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),O.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:b.push(O);break;case 430:W.push([O]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(O);break;case 24:case 536:G={Name:O.Name,Ref:er(O.rgce,o,null,W,I)},O.itab>0&&(G.Sheet=O.itab-1),W.names.push(G),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(H[O.itab-1]={ref:Ne(O.rgce[0][0][1][2])});break;case 22:I.ExternCount=O;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(O),W.XTI=W.XTI.concat(O);break;case 2196:if(I.biff<8)break;G!=null&&(G.Comment=O[1]);break;case 18:i["!protect"]=O;break;case 19:O!==0&&I.WTF&&console.error("Password verifier: "+O);break;case 133:n[O.pos]=O,I.snames.push(O.name);break;case 10:{if(--pe)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=Ne(o),t.sheetRows&&t.sheetRows<=o.e.r){var _e=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ne(o),o.e.r=_e}o.e.r++,o.e.c++}U.length>0&&(i["!merges"]=U),j.length>0&&(i["!objects"]=j),ne.length>0&&(i["!cols"]=ne),se.length>0&&(i["!rows"]=se),S.Sheets.push(D)}c===""?u=i:s[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),I.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(I.biff=5,J=!0,Qr(I.codepage=28591)),I.biff==8&&O.BIFFVer==0&&O.dt==16&&(I.biff=2),pe++)break;if(i=t.dense?[]:{},I.biff<8&&!J&&(J=!0,Qr(I.codepage=t.codepage||1252)),I.biff<5||O.BIFFVer==0&&O.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var je={pos:e.l-ce,name:c};n[je.pos]=je,I.snames.push(c)}else c=(n[ae]||{name:""}).name;O.dt==32&&(i["!type"]="chart"),O.dt==64&&(i["!type"]="macro"),U=[],j=[],I.arrayf=w=[],ne=[],se=[],xe=!1,D={Hidden:(n[ae]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[O.r]||[])[O.c]:i[Ie({c:O.c,r:O.r})])&&++O.c,C={ixfe:O.ixfe,XF:b[O.ixfe]||{},v:O.val,t:"n"},P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:O.c,r:O.r},C,t);break;case 5:case 517:C={ixfe:O.ixfe,XF:b[O.ixfe],v:O.val,t:O.t},P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:O.c,r:O.r},C,t);break;case 638:C={ixfe:O.ixfe,XF:b[O.ixfe],v:O.rknum,t:"n"},P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:O.c,r:O.r},C,t);break;case 189:for(var Oe=O.c;Oe<=O.C;++Oe){var ie=O.rkrec[Oe-O.c][0];C={ixfe:ie,XF:b[ie],v:O.rkrec[Oe-O.c][1],t:"n"},P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:Oe,r:O.r},C,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){a=O;break}if(C=Nl(O.val,O.cell.ixfe,O.tt),C.XF=b[C.ixfe],t.cellFormula){var Ee=O.formula;if(Ee&&Ee[0]&&Ee[0][0]&&Ee[0][0][0]=="PtgExp"){var Je=Ee[0][0][1][0],$e=Ee[0][0][1][1],Re=Ie({r:Je,c:$e});v[Re]?C.f=""+er(O.formula,o,O.cell,W,I):C.F=((t.dense?(i[Je]||[])[$e]:i[Re])||{}).F}else C.f=""+er(O.formula,o,O.cell,W,I)}P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_(O.cell,C,t),a=O}break;case 7:case 519:if(a)a.val=O,C=Nl(O,a.cell.ixfe,"s"),C.XF=b[C.ixfe],t.cellFormula&&(C.f=""+er(a.formula,o,a.cell,W,I)),P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_(a.cell,C,t),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(O);var Ye=Ie(O[0].s);if(f=t.dense?(i[O[0].s.r]||[])[O[0].s.c]:i[Ye],t.cellFormula&&f){if(!a||!Ye||!f)break;f.f=""+er(O[1],o,O[0],W,I),f.F=Ne(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!a)break;v[Ie(a.cell)]=O[0],f=t.dense?(i[a.cell.r]||[])[a.cell.c]:i[Ie(a.cell)],(f||{}).f=""+er(O[0],o,d,W,I)}}break;case 253:C=Nl(l[O.isst].t,O.ixfe,"s"),l[O.isst].h&&(C.h=l[O.isst].h),C.XF=b[C.ixfe],P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:O.c,r:O.r},C,t);break;case 513:t.sheetStubs&&(C={ixfe:O.ixfe,XF:b[O.ixfe],t:"z"},P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:O.c,r:O.r},C,t));break;case 190:if(t.sheetStubs)for(var st=O.c;st<=O.C;++st){var Ze=O.ixfe[st-O.c];C={ixfe:Ze,XF:b[Ze],t:"z"},P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:st,r:O.r},C,t)}break;case 214:case 516:case 4:C=Nl(O.val,O.ixfe,"s"),C.XF=b[C.ixfe],P>0&&(C.z=B[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),_({c:O.c,r:O.r},C,t);break;case 0:case 512:pe===1&&(o=O);break;case 252:l=O;break;case 1054:if(I.biff==4){B[P++]=O[1];for(var _t=0;_t<P+163&&De[_t]!=O[1];++_t);_t>=163&&js(O[1],P+163)}else js(O[1],O[0]);break;case 30:{B[P++]=O;for(var at=0;at<P+163&&De[at]!=O;++at);at>=163&&js(O,P+163)}break;case 229:U=U.concat(O);break;case 93:j[O.cmo[0]]=I.lastobj=O;break;case 438:I.lastobj.TxO=O;break;case 127:I.lastobj.ImData=O;break;case 440:for(m=O[0].s.r;m<=O[0].e.r;++m)for(g=O[0].s.c;g<=O[0].e.c;++g)f=t.dense?(i[m]||[])[g]:i[Ie({c:g,r:m})],f&&(f.l=O[1]);break;case 2048:for(m=O[0].s.r;m<=O[0].e.r;++m)for(g=O[0].s.c;g<=O[0].e.c;++g)f=t.dense?(i[m]||[])[g]:i[Ie({c:g,r:m})],f&&f.l&&(f.l.Tooltip=O[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;f=t.dense?(i[O[0].r]||[])[O[0].c]:i[Ie(O[0])];var as=j[O[2]];f||(t.dense?(i[O[0].r]||(i[O[0].r]=[]),f=i[O[0].r][O[0].c]={t:"z"}):f=i[Ie(O[0])]={t:"z"},o.e.r=Math.max(o.e.r,O[0].r),o.s.r=Math.min(o.s.r,O[0].r),o.e.c=Math.max(o.e.c,O[0].c),o.s.c=Math.min(o.s.c,O[0].c)),f.c||(f.c=[]),p={a:O[1],t:as.TxO.t},f.c.push(p)}break;case 2173:U9(b[O.ixfe],O.ext);break;case 125:{if(!I.cellStyles)break;for(;O.e>=O.s;)ne[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},xe||(xe=!0,Bg(O.w/256)),bi(ne[O.e+1])}break;case 520:{var Ge={};O.level!=null&&(se[O.r]=Ge,Ge.level=O.level),O.hidden&&(se[O.r]=Ge,Ge.hidden=!0),O.hpt&&(se[O.r]=Ge,Ge.hpt=O.hpt,Ge.hpx=Co(O.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||tn(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=O;break;case 161:i["!margins"]||tn(i["!margins"]={}),i["!margins"].header=O.header,i["!margins"].footer=O.footer;break;case 574:O.RTL&&(S.Views[0].RTL=!0);break;case 146:F=O;break;case 2198:z=O;break;case 140:y=O;break;case 442:c?D.CodeName=O||D.name:S.WBProps.CodeName=O||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=ce}return r.SheetNames=Ft(n).sort(function(ht,He){return Number(ht)-Number(He)}).map(function(ht){return n[ht].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&H.forEach(function(ht,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=ht}),r.Strings=l,r.SSF=dt(De),I.enc&&(r.Encryption=I.enc),z&&(r.Themes=z),r.Metadata={},y!==void 0&&(r.Metadata.Country=y),W.names.length>0&&(S.Names=W.names),r.Workbook=S,r}var da={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function iq(e,t,r){var s=Te.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var i=Gm(s,Wh,da.DSI);for(var n in i)t[n]=i[n]}catch(c){if(r.WTF)throw c}var o=Te.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var a=Gm(o,zh,da.SI);for(var l in a)t[l]==null&&(t[l]=a[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(cy(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function nq(e,t){var r=[],s=[],i=[],n=0,o,a=vm(Wh,"n"),l=vm(zh,"n");if(e.Props)for(o=Ft(e.Props),n=0;n<o.length;++n)(Object.prototype.hasOwnProperty.call(a,o[n])?r:Object.prototype.hasOwnProperty.call(l,o[n])?s:i).push([o[n],e.Props[o[n]]]);if(e.Custprops)for(o=Ft(e.Custprops),n=0;n<o.length;++n)Object.prototype.hasOwnProperty.call(e.Props||{},o[n])||(Object.prototype.hasOwnProperty.call(a,o[n])?r:Object.prototype.hasOwnProperty.call(l,o[n])?s:i).push([o[n],e.Custprops[o[n]]]);var c=[];for(n=0;n<i.length;++n)my.indexOf(i[n][0])>-1||ly.indexOf(i[n][0])>-1||i[n][1]!=null&&c.push(i[n]);s.length&&Te.utils.cfb_add(t,"/SummaryInformation",Wm(s,da.SI,l,zh)),(r.length||c.length)&&Te.utils.cfb_add(t,"/DocumentSummaryInformation",Wm(r,da.DSI,a,Wh,c.length?c:null,da.UDI))}function dS(e,t){t||(t={}),Kg(t),gg(),t.codepage&&fg(t.codepage);var r,s;if(e.FullPaths){if(Te.find(e,"/encryption"))throw new Error("File is password-protected");r=Te.find(e,"!CompObj"),s=Te.find(e,"/Workbook")||Te.find(e,"/Book")}else{switch(t.type){case"base64":e=Fr(Pr(e));break;case"binary":e=Fr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}$t(e,0),s={content:e}}var i,n;if(r&&eq(r),t.bookProps&&!t.bookSheets)i={};else{var o=Ve?"buffer":"array";if(s&&s.content)i=sq(s.content,t);else if((n=Te.find(e,"PerfectOffice_MAIN"))&&n.content)i=en.to_workbook(n.content,(t.type=o,t));else if((n=Te.find(e,"NativeContent_MAIN"))&&n.content)i=en.to_workbook(n.content,(t.type=o,t));else throw(n=Te.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Te.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=Cz(e))}var a={};return e.FullPaths&&iq(e,a,t),i.Props=i.Custprops=a,t.bookFiles&&(i.cfb=e),i}function oq(e,t){var r=t||{},s=Te.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Te.utils.cfb_add(s,i,hS(e,r)),r.biff==8&&(e.Props||e.Custprops)&&nq(e,s),r.biff==8&&e.vbaraw&&wz(s,Te.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var Va={0:{f:Dj},1:{f:Bj},2:{f:s$},3:{f:$j},4:{f:Wj},5:{f:e$},6:{f:l$},7:{f:Yj},8:{f:p$},9:{f:g$},10:{f:h$},11:{f:f$},12:{f:Vj},13:{f:n$},14:{f:qj},15:{f:Uj},16:{f:sS},17:{f:u$},18:{f:Zj},19:{f:kg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uK},40:{},42:{},43:{f:l9},44:{f:o9},45:{f:d9},46:{f:f9},47:{f:h9},48:{},49:{f:MV},50:{},51:{f:K9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ty},62:{f:a$},63:{f:rz},64:{f:A$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ir,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:T$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Oj},148:{f:Mj,p:16},151:{f:y$},152:{},153:{f:aK},154:{},155:{},156:{f:nK},157:{},158:{},159:{T:1,f:b7},160:{T:-1},161:{T:1,f:Tn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:m$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:j9},336:{T:-1},337:{f:Y9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Gh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ey},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:S$},427:{f:b$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:R$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Lj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:w$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Gh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fz},633:{T:1},634:{T:-1},635:{T:1,f:dz},636:{T:-1},637:{f:NV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:q$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:I$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Xh={6:{f:Wd},10:{f:ci},12:{f:Mt},13:{f:Mt},14:{f:Tt},15:{f:Tt},16:{f:rr},17:{f:Tt},18:{f:Tt},19:{f:Mt},20:{f:qm},21:{f:qm},23:{f:Ey},24:{f:Ym},25:{f:Tt},26:{},27:{},28:{f:IW},29:{},34:{f:Tt},35:{f:Xm},38:{f:rr},39:{f:rr},40:{f:rr},41:{f:rr},42:{f:Tt},43:{f:Tt},47:{f:U7},49:{f:nW},51:{f:Mt},60:{},61:{f:eW},64:{f:Tt},65:{f:iW},66:{f:Mt},77:{},80:{},81:{},82:{},85:{f:Mt},89:{},90:{},91:{},92:{f:zG},93:{f:LW},94:{},95:{f:Tt},96:{},97:{},99:{f:Tt},125:{f:Ty},128:{f:xW},129:{f:jG},130:{f:Mt},131:{f:Tt},132:{f:Tt},133:{f:$G},134:{},140:{f:zW},141:{f:Mt},144:{},146:{f:$W},151:{},152:{},153:{},154:{},155:{},156:{f:Mt},157:{},158:{},160:{f:QW},161:{f:XW},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:mW},190:{f:vW},193:{f:ci},197:{},198:{},199:{},200:{},201:{},202:{f:Tt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mt},220:{},221:{f:Tt},222:{},224:{f:wW},225:{f:WG},226:{f:ci},227:{},229:{f:MW},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:qG},253:{f:aW},255:{f:YG},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:vy},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tt},353:{f:ci},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:RW},431:{f:Tt},432:{},433:{},434:{},437:{},438:{f:BW},439:{f:Tt},440:{f:HW},441:{},442:{f:il},443:{},444:{f:Mt},445:{},446:{},448:{f:ci},449:{f:QG,r:2},450:{f:ci},512:{f:jm},513:{f:ZW},515:{f:bW},516:{f:cW},517:{f:Km},519:{f:e7},520:{f:JG},523:{},545:{f:Jm},549:{f:Um},566:{},574:{f:rW},638:{f:pW},659:{},1048:{},1054:{f:dW},1084:{},1212:{f:PW},2048:{f:GW},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_l},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ci},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:KW,r:12},2173:{f:z9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:kW,r:12},2197:{},2198:{f:N9,r:12},2199:{},2200:{},2201:{},2202:{f:DW,r:12},2203:{f:ci},2204:{},2205:{},2206:{},2207:{},2211:{f:ZG},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:YW},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:jW},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:jm},1:{},2:{f:n7},3:{f:s7},4:{f:r7},5:{f:Km},7:{f:a7},8:{},9:{f:_l},11:{},22:{f:Mt},30:{f:fW},31:{},32:{},33:{f:Jm},36:{},37:{f:Um},50:{f:l7},62:{},52:{},67:{},68:{f:Mt},69:{},86:{},126:{},127:{f:t7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:c7},223:{},234:{},354:{},421:{},518:{f:Wd},521:{f:_l},536:{f:Ym},547:{f:Xm},561:{},579:{},1030:{f:Wd},1033:{f:_l},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ve(e,t,r,s){var i=t;if(!isNaN(i)){var n=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,n),n>0&&Rg(r)&&e.push(r)}}function aq(e,t,r,s){var i=(r||[]).length||0;if(i<=8224)return ve(e,t,r,i);var n=t;if(!isNaN(n)){for(var o=r.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=e.next(4);for(u.write_shift(2,n),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function ll(e,t,r){return e||(e=Q(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function lq(e,t,r,s){var i=Q(9);return ll(i,e,t),Cy(r,s||"b",i),i}function cq(e,t,r){var s=Q(8+2*r.length);return ll(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function uq(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Nt(ut(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ve(e,2,o7(r,s,i)):ve(e,3,i7(r,s,i));return;case"b":case"e":ve(e,5,lq(r,s,t.v,t.t));return;case"s":case"str":ve(e,4,cq(r,s,(t.v||"").slice(0,255)));return}ve(e,1,ll(null,r,s))}function dq(e,t,r,s){var i=Array.isArray(t),n=qe(t["!ref"]||"A1"),o,a="",l=[];if(n.e.c>255||n.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),o=Ne(n)}for(var c=n.s.r;c<=n.e.r;++c){a=Pt(c);for(var u=n.s.c;u<=n.e.c;++u){c===n.s.r&&(l[u]=xt(u)),o=l[u]+a;var d=i?(t[c]||[])[u]:t[o];d&&uq(e,d,c,u)}}}function hq(e,t){for(var r=t||{},s=Cr(),i=0,n=0;n<e.SheetNames.length;++n)e.SheetNames[n]==r.sheet&&(i=n);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ve(s,r.biff==4?1033:r.biff==3?521:9,Lg(e,16,r)),dq(s,e.Sheets[e.SheetNames[i]],i,r),ve(s,10),s.end()}function fq(e,t,r){ve(e,49,oW({sz:12,name:"Arial"},r))}function gq(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&ve(e,1054,hW(i,t[i],r))})}function pq(e,t){var r=Q(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ve(e,2151,r),r=Q(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),by(qe(t["!ref"]||"A1"),r),r.write_shift(4,4),ve(e,2152,r)}function mq(e,t){for(var r=0;r<16;++r)ve(e,224,$m({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){ve(e,224,$m(s,0,t))})}function vq(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];ve(e,440,VW(s)),s[1].Tooltip&&ve(e,2048,WW(s))}delete t["!links"]}function Cq(e,t){if(t){var r=0;t.forEach(function(s,i){++r<=256&&s&&ve(e,125,qW(Vu(i,s),i))})}}function wq(e,t,r,s,i){var n=16+Mi(i.cellXfs,t,i);if(t.v==null&&!t.bf){ve(e,513,pn(r,s,n));return}if(t.bf)ve(e,6,jU(t,r,s,i,n));else switch(t.t){case"d":case"n":var o=t.t=="d"?Nt(ut(t.v)):t.v;ve(e,515,FW(r,s,o,n));break;case"b":case"e":ve(e,517,SW(r,s,t.v,n,i,t.t));break;case"s":case"str":if(i.bookSST){var a=zg(i.Strings,t.v,i.revStrings);ve(e,253,lW(r,s,a,n))}else ve(e,516,uW(r,s,(t.v||"").slice(0,255),n,i));break;default:ve(e,513,pn(r,s,n))}}function xq(e,t,r){var s=Cr(),i=r.SheetNames[e],n=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(n),c=t.biff==8,u,d="",h=[],f=qe(n["!ref"]||"A1"),p=c?65536:16384;if(f.e.c>255||f.e.r>=p){if(t.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}ve(s,2057,Lg(r,16,t)),ve(s,13,Hr(1)),ve(s,12,Hr(100)),ve(s,15,lr(!0)),ve(s,17,lr(!1)),ve(s,16,fn(.001)),ve(s,95,lr(!0)),ve(s,42,lr(!1)),ve(s,43,lr(!1)),ve(s,130,Hr(1)),ve(s,128,yW()),ve(s,131,lr(!1)),ve(s,132,lr(!1)),c&&Cq(s,n["!cols"]),ve(s,512,gW(f,t)),c&&(n["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){d=Pt(g);for(var m=f.s.c;m<=f.e.c;++m){g===f.s.r&&(h[m]=xt(m)),u=h[m]+d;var v=l?(n[g]||[])[m]:n[u];v&&(wq(s,v,g,m,t),c&&v.l&&n["!links"].push([u,v.l]))}}var w=a.CodeName||a.name||i;return c&&ve(s,574,sW((o.Views||[])[0])),c&&(n["!merges"]||[]).length&&ve(s,229,_W(n["!merges"])),c&&vq(s,n),ve(s,442,wy(w)),c&&pq(s,n),ve(s,10),s.end()}function yq(e,t,r){var s=Cr(),i=(e||{}).Workbook||{},n=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,l=r.biff==5;if(ve(s,2057,Lg(e,5,r)),r.bookType=="xla"&&ve(s,135),ve(s,225,a?Hr(1200):null),ve(s,193,SG(2)),l&&ve(s,191),l&&ve(s,192),ve(s,226),ve(s,92,UG("SheetJS",r)),ve(s,66,Hr(a?1200:1252)),a&&ve(s,353,Hr(0)),a&&ve(s,448),ve(s,317,JW(e.SheetNames.length)),a&&e.vbaraw&&ve(s,211),a&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";ve(s,442,wy(c))}ve(s,156,Hr(17)),ve(s,25,lr(!1)),ve(s,18,lr(!1)),ve(s,19,Hr(0)),a&&ve(s,431,lr(!1)),a&&ve(s,444,Hr(0)),ve(s,61,tW()),ve(s,64,lr(!1)),ve(s,141,Hr(0)),ve(s,34,lr(Q$(e)=="true")),ve(s,14,lr(!0)),a&&ve(s,439,lr(!1)),ve(s,218,Hr(0)),fq(s,e,r),gq(s,e.SSF,r),mq(s,r),a&&ve(s,352,lr(!1));var u=s.end(),d=Cr();a&&ve(d,140,UW()),a&&r.Strings&&aq(d,252,XG(r.Strings)),ve(d,10);var h=d.end(),f=Cr(),p=0,g=0;for(g=0;g<e.SheetNames.length;++g)p+=(a?12:11)+(a?2:1)*e.SheetNames[g].length;var m=u.length+p+h.length;for(g=0;g<e.SheetNames.length;++g){var v=n[g]||{};ve(f,133,KG({pos:m,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),m+=t[g].length}var w=f.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var C=[];return u.length&&C.push(u),w.length&&C.push(w),h.length&&C.push(h),Vt(C)}function Sq(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=dt(De)),e&&e.SSF&&(ko(),Mu(e.SSF),r.revssf=Lu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,qg(r),r.cellXfs=[],Mi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)s[s.length]=xq(i,r,e);return s.unshift(yq(e,s,r)),Vt(s)}function hS(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var i=yr(s["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var n=t||{};switch(n.biff||2){case 8:case 5:return Sq(e,t);case 4:case 3:case 2:return hq(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function av(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),o=i.index,a=n&&n.index||e.length,l=oV(e.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<l.length;++o){var g=l[o].trim(),m=g.slice(0,3).toLowerCase();if(m=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(m!="<td"&&m!="<th")){var v=g.split(/<\/t[dh]>/i);for(a=0;a<v.length;++a){var w=v[a].trim();if(w.match(/<t[dh]/i)){for(var C=w,y=0;C.charAt(0)=="<"&&(y=C.indexOf(">"))>-1;)C=C.slice(y+1);for(var b=0;b<p.length;++b){var F=p[b];F.s.c==u&&F.s.r<c&&c<=F.e.r&&(u=F.e.c+1,b=-1)}var S=Me(w.slice(0,w.indexOf(">")));h=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||h>1)&&p.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var D=S.t||S["data-t"]||"";if(!C.length){u+=h;continue}if(C=O1(C),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!C.length){u+=h;continue}var T={t:"s",v:C};r.raw||!C.trim().length||D=="s"||(C==="TRUE"?T={t:"b",v:!0}:C==="FALSE"?T={t:"b",v:!1}:isNaN(rs(C))?isNaN(mo(C).getDate())||(T={t:"d",v:ut(C)},r.cellDates||(T={t:"n",v:Nt(T.v)}),T.z=r.dateNF||De[14]):T={t:"n",v:rs(C)}),r.dense?(s[c]||(s[c]=[]),s[c][u]=T):s[Ie({r:c,c:u})]=T,u+=h}}}}return s["!ref"]=Ne(f),p.length&&(s["!merges"]=p),s}function bq(e,t,r,s){for(var i=e["!merges"]||[],n=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=Ie({r,c:o}),d=s.dense?(e[r]||[])[o]:e[u],h=d&&d.v!=null&&(d.h||Sg(d.w||(Js(d),d.w)||""))||"",f={};a>1&&(f.rowspan=a),l>1&&(f.colspan=l),s.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",d.v!=null&&(f["data-v"]=d.v),d.z!=null&&(f["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(s.id||"sjs")+"-"+u,n.push(me("td",h,f))}}var p="<tr>";return p+n.join("")+"</tr>"}var Fq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Rq="</body></html>";function Eq(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ii(av(r[0],t),t);var s=Jg();return r.forEach(function(i,n){Zg(s,av(i,t),"Sheet"+(n+1))}),s}function Tq(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function fS(e,t){var r=t||{},s=r.header!=null?r.header:Fq,i=r.footer!=null?r.footer:Rq,n=[s],o=yr(e["!ref"]);r.dense=Array.isArray(e),n.push(Tq(e,o,r));for(var a=o.s.r;a<=o.e.r;++a)n.push(bq(e,o,a,r));return n.push("</table>"+i),n.join("")}function gS(e,t,r){var s=r||{},i=0,n=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var o=typeof s.origin=="string"?yt(s.origin):s.origin;i=o.r,n=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(s.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:n}};if(e["!ref"]){var u=yr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,v=0,w=0,C=0;for(e["!cols"]||(e["!cols"]=[]);p<a.length&&g<l;++p){var y=a[p];if(lv(y)){if(s.display)continue;f[g]={hidden:!0}}var b=y.children;for(m=v=0;m<b.length;++m){var F=b[m];if(!(s.display&&lv(F))){var S=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):O1(F.innerHTML),D=F.getAttribute("data-z")||F.getAttribute("z");for(h=0;h<d.length;++h){var T=d[h];T.s.c==v+n&&T.s.r<g+i&&g+i<=T.e.r&&(v=T.e.c+1-n,h=-1)}C=+F.getAttribute("colspan")||1,((w=+F.getAttribute("rowspan")||1)>1||C>1)&&d.push({s:{r:g+i,c:v+n},e:{r:g+i+(w||1)-1,c:v+n+(C||1)-1}});var V={t:"s",v:S},_=F.getAttribute("data-t")||F.getAttribute("t")||"";S!=null&&(S.length==0?V.t=_||"z":s.raw||S.trim().length==0||_=="s"||(S==="TRUE"?V={t:"b",v:!0}:S==="FALSE"?V={t:"b",v:!1}:isNaN(rs(S))?isNaN(mo(S).getDate())||(V={t:"d",v:ut(S)},s.cellDates||(V={t:"n",v:Nt(V.v)}),V.z=s.dateNF||De[14]):V={t:"n",v:rs(S)})),V.z===void 0&&D!=null&&(V.z=D);var I="",z=F.getElementsByTagName("A");if(z&&z.length)for(var U=0;U<z.length&&!(z[U].hasAttribute("href")&&(I=z[U].getAttribute("href"),I.charAt(0)!="#"));++U);I&&I.charAt(0)!="#"&&(V.l={Target:I}),s.dense?(e[g+i]||(e[g+i]=[]),e[g+i][v+n]=V):e[Ie({c:v+n,r:g+i})]=V,c.e.c<v+n&&(c.e.c=v+n),v+=C}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,g-1+i),e["!ref"]=Ne(c),g>=l&&(e["!fullref"]=Ne((c.e.r=a.length-p+g-1+i,c))),e}function pS(e,t){var r=t||{},s=r.dense?[]:{};return gS(s,e,t)}function kq(e,t){return Ii(pS(e,t),t)}function lv(e){var t="",r=Pq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Pq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Dq(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ke(t.replace(/<[^>]*>/g,""));return[r]}var cv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mS(e,t){var r=t||{},s=bg(e),i=[],n,o,a={name:""},l="",c=0,u,d,h={},f=[],p=r.dense?[]:{},g,m,v={value:""},w="",C=0,y=[],b=-1,F=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,T={},V=[],_={},I=0,z=0,U=[],j=1,ne=1,se=[],xe={Names:[]},W={},fe=["",""],pe=[],P={},B="",H=0,G=!1,J=!1,ae=0;for(_a.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=_a.exec(s);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"å·¥ä½œè¡¨":g[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?p["!ref"]=Ne(S):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=Ne(S)),V.length&&(p["!merges"]=V),U.length&&(p["!rows"]=U),u.name=u.åç§°||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),h[u.name]=p,J=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Me(g[0],!1),b=F=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,p=r.dense?[]:{},V=[],U=[],J=!0);break;case"table-row-group":g[1]==="/"?--D:++D;break;case"table-row":case"è¡Œ":if(g[1]==="/"){b+=j,j=1;break}if(d=Me(g[0],!1),d.è¡Œå·?b=d.è¡Œå·-1:b==-1&&(b=0),j=+d["number-rows-repeated"]||1,j<10)for(ae=0;ae<j;++ae)D>0&&(U[b+ae]={level:D});F=-1;break;case"covered-table-cell":g[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(p[b]||(p[b]=[]),p[b][F]={t:"z"}):p[Ie({r:b,c:F})]={t:"z"}),w="",y=[];break;case"table-cell":case"æ•°æ®":if(g[0].charAt(g[0].length-2)==="/")++F,v=Me(g[0],!1),ne=parseInt(v["number-columns-repeated"]||"1",10),m={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(m.f=iv(Ke(v.formula))),(v.æ•°æ®ç±»åž‹||v["value-type"])=="string"&&(m.t="s",m.v=Ke(v["string-value"]||""),r.dense?(p[b]||(p[b]=[]),p[b][F]=m):p[Ie({r:b,c:F})]=m),F+=ne-1;else if(g[1]!=="/"){++F,w="",C=0,y=[],ne=1;var ue=j?b+j-1:b;if(F>S.e.c&&(S.e.c=F),F<S.s.c&&(S.s.c=F),b<S.s.r&&(S.s.r=b),ue>S.e.r&&(S.e.r=ue),v=Me(g[0],!1),pe=[],P={},m={t:v.æ•°æ®ç±»åž‹||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ke(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(I=parseInt(v["number-matrix-rows-spanned"],10)||0,z=parseInt(v["number-matrix-columns-spanned"],10)||0,_={s:{r:b,c:F},e:{r:b+I-1,c:F+z-1}},m.F=Ne(_),se.push([_,m.F])),v.formula)m.f=iv(v.formula);else for(ae=0;ae<se.length;++ae)b>=se[ae][0].s.r&&b<=se[ae][0].e.r&&F>=se[ae][0].s.c&&F<=se[ae][0].e.c&&(m.F=se[ae][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(I=parseInt(v["number-rows-spanned"],10)||0,z=parseInt(v["number-columns-spanned"],10)||0,_={s:{r:b,c:F},e:{r:b+I-1,c:F+z-1}},V.push(_)),v["number-columns-repeated"]&&(ne=parseInt(v["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=lt(v["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(v.value);break;case"percentage":m.t="n",m.v=parseFloat(v.value);break;case"currency":m.t="n",m.v=parseFloat(v.value);break;case"date":m.t="d",m.v=ut(v["date-value"]),r.cellDates||(m.t="n",m.v=Nt(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=sV(v["time-value"])/86400,r.cellDates&&(m.t="d",m.v=Ou(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(v.æ•°æ®æ•°å€¼);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",v["string-value"]!=null&&(w=Ke(v["string-value"]),y=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(G=!1,m.t==="s"&&(m.v=w||"",y.length&&(m.R=y),G=C==0),W.Target&&(m.l=W),pe.length>0&&(m.c=pe,pe=[]),w&&r.cellText!==!1&&(m.w=w),G&&(m.t="z",delete m.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var ce=0;ce<j;++ce){if(ne=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[b+ce]||(p[b+ce]=[]),p[b+ce][F]=ce==0?m:dt(m);--ne>0;)p[b+ce][F+ne]=dt(m);else for(p[Ie({r:b+ce,c:F})]=m;--ne>0;)p[Ie({r:b+ce,c:F+ne})]=dt(m);S.e.c<=F&&(S.e.c=F)}ne=parseInt(v["number-columns-repeated"]||"1",10),F+=ne-1,ne=0,m={},w="",y=[]}W={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((n=i.pop())[0]!==g[3])throw"Bad state: "+n}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((n=i.pop())[0]!==g[3])throw"Bad state: "+n;P.t=w,y.length&&(P.R=y),P.a=B,pe.push(P)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);B="",H=0,w="",C=0,y=[];break;case"creator":g[1]==="/"?B=s.slice(H,g.index):H=g.index+g[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((n=i.pop())[0]!==g[3])throw"Bad state: "+n}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);w="",C=0,y=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(T[a.name]=l,(n=i.pop())[0]!==g[3])throw"Bad state: "+n}else g[0].charAt(g[0].length-2)!=="/"&&(l="",a=Me(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Me(g[0],!1),l+=cv[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Me(g[0],!1),l+=cv[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=s.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":o=Me(g[0],!1),fe=zd(o["cell-range-address"]);var te={Name:o.name,Ref:fe[0]+"!"+fe[1]};J&&(te.Sheet=f.length),xe.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"ç”µå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"æ–‡æœ¬ä¸²":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var Ae=Dq(s.slice(C,g.index));w=(w.length>0?w+`
`:"")+Ae[0]}else Me(g[0],!1),C=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{fe=zd(Me(g[0])["target-range-address"]),h[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ ‡é¢˜":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(W=Me(g[0],!1),!W.href)break;W.Target=Ke(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(fe=zd(W.Target.slice(1)),W.Target="#"+fe[0]+"!"+fe[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(r.WTF)throw new Error(g)}}var O={Sheets:h,SheetNames:f,Workbook:xe};return r.bookSheets&&delete O.Sheets,O}function uv(e,t){t=t||{},Br(e,"META-INF/manifest.xml")&&sG(It(e,"META-INF/manifest.xml"),t);var r=Rr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=mS(ot(r),t);return Br(e,"meta.xml")&&(s.Props=oy(It(e,"meta.xml"))),s}function dv(e,t){return mS(e,t)}var Aq=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ma({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Dt+t}})(),hv=(function(){var e=function(n){return rt(n).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(n,o,a){var l=[];l.push('      <table:table table:name="'+rt(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,d=yr(n["!ref"]||"A1"),h=n["!merges"]||[],f=0,p=Array.isArray(n);if(n["!cols"])for(u=0;u<=d.e.c;++u)l.push("        <table:table-column"+(n["!cols"][u]?' table:style-name="co'+n["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",m=n["!rows"]||[];for(c=0;c<d.s.r;++c)g=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=d.e.r;++c){for(g=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),u=0;u<d.s.c;++u)l.push(t);for(;u<=d.e.c;++u){var v=!1,w={},C="";for(f=0;f!=h.length;++f)if(!(h[f].s.c>u)&&!(h[f].s.r>c)&&!(h[f].e.c<u)&&!(h[f].e.r<c)){(h[f].s.c!=u||h[f].s.r!=c)&&(v=!0),w["table:number-columns-spanned"]=h[f].e.c-h[f].s.c+1,w["table:number-rows-spanned"]=h[f].e.r-h[f].s.r+1;break}if(v){l.push(r);continue}var y=Ie({r:c,c:u}),b=p?(n[c]||[])[u]:n[y];if(b&&b.f&&(w["table:formula"]=rt(JU(b.f)),b.F&&b.F.slice(0,y.length)==y)){var F=yr(b.F);w["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,w["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!b){l.push(t);continue}switch(b.t){case"b":C=b.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=b.v?"true":"false";break;case"n":C=b.w||String(b.v||0),w["office:value-type"]="float",w["office:value"]=b.v||0;break;case"s":case"str":C=b.v==null?"":b.v,w["office:value-type"]="string";break;case"d":C=b.w||ut(b.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=ut(b.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var S=e(C);if(b.l&&b.l.Target){var D=b.l.Target;D=D.charAt(0)=="#"?"#"+ZU(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),S=me("text:a",S,{"xlink:href":D.replace(/&/g,"&amp;")})}l.push("          "+me("table:table-cell",me("text:p",S,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(n,o){n.push(` <office:automatic-styles>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var d=c["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;bi(d),d.ods=a;var h=c["!cols"][u].wpx+"px";n.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),n.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var d=c["!rows"][u].hpx+"px";n.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),n.push(`  </style:style>
`),++l}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),n.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Dt],c=Ma({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ma({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(ny().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=o.SheetNames.length;++d)l.push(s(o.Sheets[o.SheetNames[d]],o,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function vS(e,t){if(t.bookType=="fods")return hv(e,t);var r=wg(),s="",i=[],n=[];return s="mimetype",Be(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Be(r,s,hv(e,t)),i.push([s,"text/xml"]),n.push([s,"ContentFile"]),s="styles.xml",Be(r,s,Aq(e,t)),i.push([s,"text/xml"]),n.push([s,"StylesFile"]),s="meta.xml",Be(r,s,Dt+ny()),i.push([s,"text/xml"]),n.push([s,"MetadataFile"]),s="manifest.rdf",Be(r,s,oG(n)),i.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Be(r,s,iG(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function mn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Yh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ot(Ai(e))}function Iq(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Fr(bs(e))}function Mq(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function Ri(e){var t=e.reduce(function(i,n){return i+n.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(i){r.set(i,s),s+=i.length}),r}function fv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function _q(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,i=t+13;i>=t;--i)s=s*256+e[i];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function Lq(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var n=0;i>=1;++n,i/=256)e[t+n]=i&255;e[t+15]|=r>=0?0:128}function Ga(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function et(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function bt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Xe(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],i=Ga(e,r),n=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(n){case 0:{for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0])}break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ga(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(i," at offset ").concat(s))}var c={data:a,type:n};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Ut(e){var t=[];return e.forEach(function(r,s){r.forEach(function(i){i.data&&(t.push(et(s*8+i.type)),i.type==2&&t.push(et(i.data.length)),t.push(i.data))})}),Ri(t)}function $g(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function _r(e){for(var t,r=[],s=[0];s[0]<e.length;){var i=Ga(e,s),n=Xe(e.slice(s[0],s[0]+i));s[0]+=i;var o={id:bt(n[1][0].data),messages:[]};n[2].forEach(function(a){var l=Xe(a.data),c=bt(l[3][0].data);o.messages.push({meta:l,data:e.slice(s[0],s[0]+c)}),s[0]+=c}),(t=n[3])!=null&&t[0]&&(o.merge=bt(n[3][0].data)>>>0>0),r.push(o)}return r}function In(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:et(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:et(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:et(o.data.length)}],s[2].push({data:Ut(o.meta),type:2})});var n=Ut(s);t.push(et(n.length)),t.push(n),i.forEach(function(o){return t.push(o)})}),Ri(t)}function Oq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Ga(t,r),i=[];r[0]<t.length;){var n=t[r[0]]&3;if(n==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[r[0]],a>1&&(o|=t[r[0]+1]<<8),a>2&&(o|=t[r[0]+2]<<16),a>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,c=0;if(n==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,n==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ri(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Ri(i);if(u.length!=s)throw new Error("Unexpected length: ".concat(u.length," != ").concat(s));return u}function Lr(e){for(var t=[],r=0;r<e.length;){var s=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Oq(s,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ri(t)}function Mn(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var n=et(s),o=n.length;t.push(n),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=s}return Ri(t)}function Nq(e,t,r,s){var i=mn(e),n=i.getUint32(4,!0),o=(s>1?12:8)+fv(n&(s>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);n&512&&(a=i.getUint32(o,!0),o+=4),o+=fv(n&(s>1?12288:4096))*4,n&16&&(l=i.getUint32(o,!0),o+=4),n&32&&(c=i.getFloat64(o,!0),o+=8),n&64&&(u.setTime(u.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:r[a]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function Bq(e,t,r){var s=mn(e),i=s.getUint32(8,!0),n=12,o=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=_q(e,n),n+=16),i&2&&(c=s.getFloat64(n,!0),n+=8),i&4&&(u.setTime(u.getTime()+s.getFloat64(n,!0)*1e3),n+=8),i&8&&(a=s.getUint32(n,!0),n+=4),i&16&&(o=s.getUint32(n,!0),n+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[a]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return d}function jd(e,t){var r=new Uint8Array(32),s=mn(r),i=12,n=0;switch(r[0]=5,e.t){case"n":r[1]=2,Lq(r,i,e.v),n|=1,i+=16;break;case"b":r[1]=6,s.setFloat64(i,e.v?1:0,!0),n|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(i,t.indexOf(e.v),!0),n|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,n,!0),r.slice(0,i)}function $d(e,t){var r=new Uint8Array(32),s=mn(r),i=12,n=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(i,e.v,!0),n|=32,i+=8;break;case"b":r[2]=6,s.setFloat64(i,e.v?1:0,!0),n|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(i,t.indexOf(e.v),!0),n|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,n,!0),r.slice(0,i)}function Hq(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Nq(e,t,r,e[0]);case 5:return Bq(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Qt(e){var t=Xe(e);return Ga(t[1][0].data)}function gv(e,t){var r=Xe(t.data),s=bt(r[1][0].data),i=r[3],n=[];return(i||[]).forEach(function(o){var a=Xe(o.data),l=bt(a[1][0].data)>>>0;switch(s){case 1:n[l]=Yh(a[3][0].data);break;case 8:{var c=e[Qt(a[9][0].data)][0],u=Xe(c.data),d=e[Qt(u[1][0].data)][0],h=bt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var f=Xe(d.data);n[l]=f[3].map(function(p){return Yh(p.data)}).join("")}break}}),n}function Vq(e,t){var r,s,i,n,o,a,l,c,u,d,h,f,p,g,m=Xe(e),v=bt(m[1][0].data)>>>0,w=bt(m[2][0].data)>>>0,C=((s=(r=m[8])==null?void 0:r[0])==null?void 0:s.data)&&bt(m[8][0].data)>0||!1,y,b;if((n=(i=m[7])==null?void 0:i[0])!=null&&n.data&&t!=0)y=(a=(o=m[7])==null?void 0:o[0])==null?void 0:a.data,b=(c=(l=m[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=m[4])==null?void 0:u[0])!=null&&d.data&&t!=1)y=(f=(h=m[4])==null?void 0:h[0])==null?void 0:f.data,b=(g=(p=m[3])==null?void 0:p[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=C?4:1,S=mn(y),D=[],T=0;T<y.length/2;++T){var V=S.getUint16(T*2,!0);V<65535&&D.push([T,V])}if(D.length!=w)throw"Expected ".concat(w," cells, found ").concat(D.length);var _=[];for(T=0;T<D.length-1;++T)_[D[T][0]]=b.subarray(D[T][1]*F,D[T+1][1]*F);return D.length>=1&&(_[D[D.length-1][0]]=b.subarray(D[D.length-1][1]*F)),{R:v,cells:_}}function Gq(e,t){var r,s=Xe(t.data),i=(r=s==null?void 0:s[7])!=null&&r[0]?bt(s[7][0].data)>>>0>0?1:0:-1,n=$g(s[5],function(o){return Vq(o,i)});return{nrows:bt(s[4][0].data)>>>0,data:n.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,c){if(o[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));o[a.R][c]=l}),o},[])}}function Wq(e,t,r){var s,i=Xe(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(bt(i[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(n.e.c=(bt(i[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ne(n);var o=Xe(i[4][0].data),a=gv(e,e[Qt(o[4][0].data)][0]),l=(s=o[17])!=null&&s[0]?gv(e,e[Qt(o[17][0].data)][0]):[],c=Xe(o[3][0].data),u=0;c[1].forEach(function(d){var h=Xe(d.data),f=e[Qt(h[2][0].data)][0],p=bt(f.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var g=Gq(e,f);g.data.forEach(function(m,v){m.forEach(function(w,C){var y=Ie({r:u+v,c:C}),b=Hq(w,a,l);b&&(r[y]=b)})}),u+=g.nrows})}function zq(e,t){var r=Xe(t.data),s={"!ref":"A1"},i=e[Qt(r[2][0].data)],n=bt(i[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return Wq(e,i[0],s),s}function Uq(e,t){var r,s=Xe(t.data),i={name:(r=s[1])!=null&&r[0]?Yh(s[1][0].data):"",sheets:[]},n=$g(s[2],Qt);return n.forEach(function(o){e[o].forEach(function(a){var l=bt(a.meta[1][0].data);l==6e3&&i.sheets.push(zq(e,a))})}),i}function jq(e,t){var r=Jg(),s=Xe(t.data),i=$g(s[1],Qt);if(i.forEach(function(n){e[n].forEach(function(o){var a=bt(o.meta[1][0].data);if(a==2){var l=Uq(e,o);l.sheets.forEach(function(c,u){Zg(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Kd(e){var t,r,s,i,n={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Lr(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=_r(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){n[d.id]=d.messages,o.push(d.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(s=(r=(t=n==null?void 0:n[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:i[0].data)&&bt(n[1][0].meta[1][0].data)==1&&n[1][0];if(a||o.forEach(function(l){n[l].forEach(function(c){var u=bt(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return jq(n,a)}function $q(e,t,r){var s,i,n,o;if(!((s=e[6])!=null&&s[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(n=e[8])==null?void 0:n[0])==null?void 0:o.data)&&bt(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=mn(e[7][0].data),u=0,d=[],h=mn(e[4][0].data),f=0,p=[],g=0;g<t.length;++g){if(t[g]==null){c.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}c.setUint16(g*2,u,!0),h.setUint16(g*2,f,!0);var m,v;switch(typeof t[g]){case"string":m=jd({t:"s",v:t[g]},r),v=$d({t:"s",v:t[g]},r);break;case"number":m=jd({t:"n",v:t[g]},r),v=$d({t:"n",v:t[g]},r);break;case"boolean":m=jd({t:"b",v:t[g]},r),v=$d({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}d.push(m),u+=m.length,p.push(v),f+=v.length,++l}for(e[2][0].data=et(l);g<e[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=Ri(d),e[3][0].data=Ri(p),l}function Kq(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=yr(r["!ref"]);s.s.r=s.s.c=0;var i=!1;s.e.c>9&&(i=!0,s.e.c=9),s.e.r>49&&(i=!0,s.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ne(s)));var n=nu(r,{range:s,header:1}),o=["~Sh33tJ5~"];n.forEach(function(B){return B.forEach(function(H){typeof H=="string"&&o.push(H)})});var a={},l=[],c=Te.read(t.numbers,{type:"base64"});c.FileIndex.map(function(B,H){return[B,c.FullPaths[H]]}).forEach(function(B){var H=B[0],G=B[1];if(H.type==2&&H.name.match(/\.iwa/)){var J=H.content,ae=Lr(J),ue=_r(ae);ue.forEach(function(ce){l.push(ce.id),a[ce.id]={deps:[],location:G,type:bt(ce.messages[0].meta[1][0].data)}})}}),l.sort(function(B,H){return B-H});var u=l.filter(function(B){return B>1}).map(function(B){return[B,et(B)]});c.FileIndex.map(function(B,H){return[B,c.FullPaths[H]]}).forEach(function(B){var H=B[0];if(B[1],!!H.name.match(/\.iwa/)){var G=_r(Lr(H.content));G.forEach(function(J){J.messages.forEach(function(ae){u.forEach(function(ue){J.messages.some(function(ce){return bt(ce.meta[1][0].data)!=11006&&Mq(ce.data,ue[1])})&&a[ue[0]].deps.push(J.id)})})})}});for(var d=Te.find(c,a[1].location),h=_r(Lr(d.content)),f,p=0;p<h.length;++p){var g=h[p];g.id==1&&(f=g)}var m=Qt(Xe(f.messages[0].data)[1][0].data);for(d=Te.find(c,a[m].location),h=_r(Lr(d.content)),p=0;p<h.length;++p)g=h[p],g.id==m&&(f=g);for(m=Qt(Xe(f.messages[0].data)[2][0].data),d=Te.find(c,a[m].location),h=_r(Lr(d.content)),p=0;p<h.length;++p)g=h[p],g.id==m&&(f=g);for(m=Qt(Xe(f.messages[0].data)[2][0].data),d=Te.find(c,a[m].location),h=_r(Lr(d.content)),p=0;p<h.length;++p)g=h[p],g.id==m&&(f=g);var v=Xe(f.messages[0].data);{v[6][0].data=et(s.e.r+1),v[7][0].data=et(s.e.c+1);var w=Qt(v[46][0].data),C=Te.find(c,a[w].location),y=_r(Lr(C.content));{for(var b=0;b<y.length&&y[b].id!=w;++b);if(y[b].id!=w)throw"Bad ColumnRowUIDMapArchive";var F=Xe(y[b].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var S=0;S<=s.e.c;++S){var D=[];D[1]=D[2]=[{type:0,data:et(S+420690)}],F[1].push({type:2,data:Ut(D)}),F[2].push({type:0,data:et(S)}),F[3].push({type:0,data:et(S)})}F[4]=[],F[5]=[],F[6]=[];for(var T=0;T<=s.e.r;++T)D=[],D[1]=D[2]=[{type:0,data:et(T+726270)}],F[4].push({type:2,data:Ut(D)}),F[5].push({type:0,data:et(T)}),F[6].push({type:0,data:et(T)});y[b].messages[0].data=Ut(F)}C.content=Mn(In(y)),C.size=C.content.length,delete v[46];var V=Xe(v[4][0].data);{V[7][0].data=et(s.e.r+1);var _=Xe(V[1][0].data),I=Qt(_[2][0].data);C=Te.find(c,a[I].location),y=_r(Lr(C.content));{if(y[0].id!=I)throw"Bad HeaderStorageBucket";var z=Xe(y[0].messages[0].data);for(T=0;T<n.length;++T){var U=Xe(z[2][0].data);U[1][0].data=et(T),U[4][0].data=et(n[T].length),z[2][T]={type:z[2][0].type,data:Ut(U)}}y[0].messages[0].data=Ut(z)}C.content=Mn(In(y)),C.size=C.content.length;var j=Qt(V[2][0].data);C=Te.find(c,a[j].location),y=_r(Lr(C.content));{if(y[0].id!=j)throw"Bad HeaderStorageBucket";for(z=Xe(y[0].messages[0].data),S=0;S<=s.e.c;++S)U=Xe(z[2][0].data),U[1][0].data=et(S),U[4][0].data=et(s.e.r+1),z[2][S]={type:z[2][0].type,data:Ut(U)};y[0].messages[0].data=Ut(z)}C.content=Mn(In(y)),C.size=C.content.length;var ne=Qt(V[4][0].data);(function(){for(var B=Te.find(c,a[ne].location),H=_r(Lr(B.content)),G,J=0;J<H.length;++J){var ae=H[J];ae.id==ne&&(G=ae)}var ue=Xe(G.messages[0].data);{ue[3]=[];var ce=[];o.forEach(function(O,ze){ce[1]=[{type:0,data:et(ze)}],ce[2]=[{type:0,data:et(1)}],ce[3]=[{type:2,data:Iq(O)}],ue[3].push({type:2,data:Ut(ce)})})}G.messages[0].data=Ut(ue);var te=In(H),Ae=Mn(te);B.content=Ae,B.size=B.content.length})();var se=Xe(V[3][0].data);{var xe=se[1][0];delete se[2];var W=Xe(xe.data);{var fe=Qt(W[2][0].data);(function(){for(var B=Te.find(c,a[fe].location),H=_r(Lr(B.content)),G,J=0;J<H.length;++J){var ae=H[J];ae.id==fe&&(G=ae)}var ue=Xe(G.messages[0].data);{delete ue[6],delete se[7];var ce=new Uint8Array(ue[5][0].data);ue[5]=[];for(var te=0,Ae=0;Ae<=s.e.r;++Ae){var O=Xe(ce);te+=$q(O,n[Ae],o),O[1][0].data=et(Ae),ue[5].push({data:Ut(O),type:2})}ue[1]=[{type:0,data:et(s.e.c+1)}],ue[2]=[{type:0,data:et(s.e.r+1)}],ue[3]=[{type:0,data:et(te)}],ue[4]=[{type:0,data:et(s.e.r+1)}]}G.messages[0].data=Ut(ue);var ze=In(H),_e=Mn(ze);B.content=_e,B.size=B.content.length})()}xe.data=Ut(W)}V[3][0].data=Ut(se)}v[4][0].data=Ut(V)}f.messages[0].data=Ut(v);var pe=In(h),P=Mn(pe);return d.content=P,d.size=d.content.length,c}function CS(e){return function(r){for(var s=0;s!=e.length;++s){var i=e[s];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Kg(e){CS([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function qg(e){CS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function qq(e){return We.WS.indexOf(e)>-1?"sheet":e==We.CS?"chart":e==We.DS?"dialog":e==We.MS?"macro":e&&e.length?e:"sheet"}function Xq(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,qq(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Yq(e,t,r,s,i,n,o,a,l,c,u,d){try{n[s]=aa(Rr(e,r,!0),t);var h=It(e,t),f;switch(a){case"sheet":f=CK(h,t,i,l,n[s],c,u,d);break;case"chart":if(f=wK(h,t,i,l,n[s],c,u,d),!f||!f["!drawel"])break;var p=Ko(f["!drawel"].Target,t),g=La(p),m=nz(Rr(e,p,!0),aa(Rr(e,g,!0),p)),v=Ko(m,p),w=La(v);f=$$(Rr(e,v,!0),v,l,aa(Rr(e,w,!0),v),c,f);break;case"macro":f=xK(h,t,i,l,n[s],c,u,d);break;case"dialog":f=yK(h,t,i,l,n[s],c,u,d);break;default:throw new Error("Unrecognized sheet type "+a)}o[s]=f;var C=[];n&&n[s]&&Ft(n[s]).forEach(function(y){var b="";if(n[s][y].Type==We.CMNT){b=Ko(n[s][y].Target,t);var F=RK(It(e,b,!0),b,l);if(!F||!F.length)return;Qm(f,F,!1)}n[s][y].Type==We.TCMNT&&(b=Ko(n[s][y].Target,t),C=C.concat(az(It(e,b,!0),l)))}),C&&C.length&&Qm(f,C,!0,l.people||[])}catch(y){if(l.WTF)throw y}}function Ir(e){return e.charAt(0)=="/"?e.slice(1):e}function Jq(e,t){if(ko(),t=t||{},Kg(t),Br(e,"META-INF/manifest.xml")||Br(e,"objectdata.xml"))return uv(e,t);if(Br(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Kd<"u"){if(e.FileIndex)return Kd(e);var r=Te.utils.cfb_new();return xm(e).forEach(function(U){Be(r,U,lV(e,U))}),Kd(r)}throw new Error("Unsupported NUMBERS file")}if(!Br(e,"[Content_Types].xml"))throw Br(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Br(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=xm(e),i=tG(Rr(e,"[Content_Types].xml")),n=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",It(e,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!It(e,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),n=!0}i.workbooks[0].slice(-3)=="bin"&&(n=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(la=[],i.sst)try{la=FK(It(e,Ir(i.sst)),i.sst,t)}catch(U){if(t.WTF)throw U}t.cellStyles&&i.themes.length&&(l=bK(Rr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=SK(It(e,Ir(i.style)),i.style,l,t))}i.links.map(function(U){try{var j=aa(Rr(e,La(Ir(U))),U);return TK(It(e,Ir(U)),j,U,t)}catch{}});var u=vK(It(e,Ir(i.workbooks[0])),i.workbooks[0],t),d={},h="";i.coreprops.length&&(h=It(e,Ir(i.coreprops[0]),!0),h&&(d=oy(h)),i.extprops.length!==0&&(h=It(e,Ir(i.extprops[0]),!0),h&&lG(h,d,t)));var f={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Rr(e,Ir(i.custprops[0]),!0),h&&(f=uG(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(j){return j.name}):d.Worksheets&&d.SheetNames.length>0&&(o=d.SheetNames),t.bookProps&&(p.Props=d,p.Custprops=f),t.bookSheets&&typeof o<"u"&&(p.SheetNames=o),t.bookSheets?p.SheetNames:t.bookProps))return p;o={};var g={};t.bookDeps&&i.calcchain&&(g=EK(It(e,Ir(i.calcchain)),i.calcchain));var m=0,v={},w,C;{var y=u.Sheets;d.Worksheets=y.length,d.SheetNames=[];for(var b=0;b!=y.length;++b)d.SheetNames[b]=y[b].name}var F=n?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),D=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Br(e,D)||(D="xl/_rels/workbook."+F+".rels");var T=aa(Rr(e,D,!0),D.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=kK(It(e,Ir(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=cz(It(e,Ir(i.people[0])),t)),T&&(T=Xq(T,u.Sheets));var V=It(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=d.Worksheets;++m){var _="sheet";if(T&&T[m]?(w="xl/"+T[m][1].replace(/[\/]?xl\//,""),Br(e,w)||(w=T[m][1]),Br(e,w)||(w=D.replace(/_rels\/.*$/,"")+T[m][1]),_=T[m][2]):(w="xl/worksheets/sheet"+(m+1-V)+"."+F,w=w.replace(/sheet0\./,"sheet.")),C=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(m!=t.sheets)continue e;break;case"string":if(d.SheetNames[m].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,z=0;z!=t.sheets.length;++z)typeof t.sheets[z]=="number"&&t.sheets[z]==m&&(I=1),typeof t.sheets[z]=="string"&&t.sheets[z].toLowerCase()==d.SheetNames[m].toLowerCase()&&(I=1);if(!I)continue e}}Yq(e,w,C,d.SheetNames[m],m,v,o,_,t,u,l,c)}return p={Directory:i,Workbook:u,Props:d,Custprops:f,Deps:g,Sheets:o,SheetNames:d.SheetNames,Strings:la,Styles:c,Themes:l,SSF:dt(De)},t&&t.bookFiles&&(e.files?(p.keys=s,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(U,j){U=U.replace(/^Root Entry[\/]/,""),p.keys.push(U),p.files[U]=e.FileIndex[j]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=It(e,Ir(i.vba[0]),!0):i.defaults&&i.defaults.bin===vz&&(p.vbaraw=It(e,"xl/vbaProject.bin",!0))),p}function Zq(e,t){var r=t||{},s="Workbook",i=Te.find(e,s);try{if(s="/!DataSpaces/Version",i=Te.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(k7(i.content),s="/!DataSpaces/DataSpaceMap",i=Te.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var n=D7(i.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Te.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=A7(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Te.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);M7(i.content)}catch{}if(s="/EncryptionInfo",i=Te.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var a=_7(i.content);if(s="/EncryptedPackage",i=Te.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Qq(e,t){return t.bookType=="ods"?vS(e,t):t.bookType=="numbers"?Kq(e,t):t.bookType=="xlsb"?eX(e,t):tX(e,t)}function eX(e,t){Wn=1024,e&&!e.SSF&&(e.SSF=dt(De)),e&&e.SSF&&(ko(),Mu(e.SSF),t.revssf=Lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ca?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=jy.indexOf(t.bookType)>-1,i=Mg();qg(t=t||{});var n=wg(),o="",a=0;if(t.cellXfs=[],Mi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Be(n,o,ay(e.Props,t)),i.coreprops.push(o),tt(t.rels,2,o,We.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Be(n,o,uy(e.Props)),i.extprops.push(o),tt(t.rels,3,o,We.EXT_PROPS),e.Custprops!==e.Props&&Ft(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Be(n,o,dy(e.Custprops)),i.custprops.push(o),tt(t.rels,4,o,We.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},d=e.Sheets[e.SheetNames[a-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,Be(n,o,DK(a-1,o,t,e,u)),i.sheets.push(o),tt(t.wbrels,-1,"worksheets/sheet"+a+"."+r,We.WS[0])}if(d){var f=d["!comments"],p=!1,g="";f&&f.length>0&&(g="xl/comments"+a+"."+r,Be(n,g,MK(f,g)),i.comments.push(g),tt(u,-1,"../comments"+a+"."+r,We.CMNT),p=!0),d["!legacy"]&&p&&Be(n,"xl/drawings/vmlDrawing"+a+".vml",zy(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Be(n,La(o),io(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Be(n,o,IK(t.Strings,o,t)),i.strs.push(o),tt(t.wbrels,-1,"sharedStrings."+r,We.SST)),o="xl/workbook."+r,Be(n,o,PK(e,o)),i.workbooks.push(o),tt(t.rels,1,o,We.WB),o="xl/theme/theme1.xml",Be(n,o,Hg(e.Themes,t)),i.themes.push(o),tt(t.wbrels,-1,"theme/theme1.xml",We.THEME),o="xl/styles."+r,Be(n,o,AK(e,o,t)),i.styles.push(o),tt(t.wbrels,-1,"styles."+r,We.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Be(n,o,e.vbaraw),i.vba.push(o),tt(t.wbrels,-1,"vbaProject.bin",We.VBA)),o="xl/metadata."+r,Be(n,o,_K(o)),i.metadata.push(o),tt(t.wbrels,-1,"metadata."+r,We.XLMETA),Be(n,"[Content_Types].xml",iy(i,t)),Be(n,"_rels/.rels",io(t.rels)),Be(n,"xl/_rels/workbook."+r+".rels",io(t.wbrels)),delete t.revssf,delete t.ssf,n}function tX(e,t){Wn=1024,e&&!e.SSF&&(e.SSF=dt(De)),e&&e.SSF&&(ko(),Mu(e.SSF),t.revssf=Lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ca?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=jy.indexOf(t.bookType)>-1,i=Mg();qg(t=t||{});var n=wg(),o="",a=0;if(t.cellXfs=[],Mi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Be(n,o,ay(e.Props,t)),i.coreprops.push(o),tt(t.rels,2,o,We.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Be(n,o,uy(e.Props)),i.extprops.push(o),tt(t.rels,3,o,We.EXT_PROPS),e.Custprops!==e.Props&&Ft(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Be(n,o,dy(e.Custprops)),i.custprops.push(o),tt(t.rels,4,o,We.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var d={"!id":{}},h=e.Sheets[e.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,Be(n,o,rS(a-1,t,e,d)),i.sheets.push(o),tt(t.wbrels,-1,"worksheets/sheet"+a+"."+r,We.WS[0])}if(h){var p=h["!comments"],g=!1,m="";if(p&&p.length>0){var v=!1;p.forEach(function(w){w[1].forEach(function(C){C.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+a+"."+r,Be(n,m,lz(p,u,t)),i.threadedcomments.push(m),tt(d,-1,"../threadedComments/threadedComment"+a+"."+r,We.TCMNT)),m="xl/comments"+a+"."+r,Be(n,m,Uy(p)),i.comments.push(m),tt(d,-1,"../comments"+a+"."+r,We.CMNT),g=!0}h["!legacy"]&&g&&Be(n,"xl/drawings/vmlDrawing"+a+".vml",zy(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Be(n,La(o),io(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Be(n,o,Ay(t.Strings,t)),i.strs.push(o),tt(t.wbrels,-1,"sharedStrings."+r,We.SST)),o="xl/workbook."+r,Be(n,o,aS(e)),i.workbooks.push(o),tt(t.rels,1,o,We.WB),o="xl/theme/theme1.xml",Be(n,o,Hg(e.Themes,t)),i.themes.push(o),tt(t.wbrels,-1,"theme/theme1.xml",We.THEME),o="xl/styles."+r,Be(n,o,Hy(e,t)),i.styles.push(o),tt(t.wbrels,-1,"styles."+r,We.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Be(n,o,e.vbaraw),i.vba.push(o),tt(t.wbrels,-1,"vbaProject.bin",We.VBA)),o="xl/metadata."+r,Be(n,o,Wy()),i.metadata.push(o),tt(t.wbrels,-1,"metadata."+r,We.XLMETA),u.length>1&&(o="xl/persons/person.xml",Be(n,o,uz(u)),i.people.push(o),tt(t.wbrels,-1,"persons/person.xml",We.PEOPLE)),Be(n,"[Content_Types].xml",iy(i,t)),Be(n,"_rels/.rels",io(t.rels)),Be(n,"xl/_rels/workbook."+r+".rels",io(t.wbrels)),delete t.revssf,delete t.ssf,n}function Xg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Pr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function rX(e,t){return Te.find(e,"EncryptedPackage")?Zq(e,t):dS(e,t)}function sX(e,t){var r,s=e,i=t||{};return i.type||(i.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),r=M1(s,i),Jq(r,i)}function wS(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return qh(e.slice(r),t);default:break e}return vo.to_workbook(e,t)}function iX(e,t){var r="",s=Xg(e,t);switch(t.type){case"base64":r=Pr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=hn(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=ot(r)),t.type="binary",wS(r,t)}function nX(e,t){var r=e;return t.type=="base64"&&(r=Pr(r)),r=Pa.utils.decode(1200,r.slice(2),"str"),t.type="binary",wS(r,t)}function oX(e){return e.match(/[^\x00-\x7F]/)?bs(e):e}function qd(e,t,r,s){return s?(r.type="string",vo.to_workbook(e,r)):vo.to_workbook(t,r)}function Jh(e,t){gg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Jh(new Uint8Array(e),(r=dt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,i=[0,0,0,0],n=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),oo={},r.dateNF&&(oo.dateNF=r.dateNF),r.type||(r.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ve?"buffer":"binary",s=eV(e),typeof Uint8Array<"u"&&!Ve&&(r.type="array")),r.type=="string"&&(n=!0,r.type="binary",r.codepage=65001,s=oX(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=dt(r),r.type="array",Jh(pg(s),r)}switch((i=Xg(s,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return rX(Te.read(s,r),r);break;case 9:if(i[1]<=8)return dS(s,r);break;case 60:return qh(s,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return d7(s,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Py.to_workbook(s,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?sX(s,r):qd(e,s,r,n);case 239:return i[3]===60?qh(s,r):qd(e,s,r,n);case 255:if(i[1]===254)return nX(s,r);if(i[1]===0&&i[2]===2&&i[3]===0)return en.to_workbook(s,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return en.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Kh.to_workbook(s,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Oy.to_workbook(s,r);break;case 10:case 13:case 32:return iX(s,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return u7.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Kh.to_workbook(s,r):qd(e,s,r,n)}function xS(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return tl(t.file,Te.write(e,{type:Ve?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Te.write(e,t)}function aX(e,t){var r=dt(t||{}),s=Qq(e,r);return lX(s,r)}function lX(e,t){var r={},s=Ve?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Te.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Iu(i))}return t.password&&typeof encrypt_agile<"u"?xS(encrypt_agile(i,t.password),t):t.type==="file"?tl(t.file,i):t.type=="string"?ot(i):i}function cX(e,t){var r=t||{},s=oq(e,r);return xS(s,r)}function gs(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return Da(bs(s));case"binary":return bs(s);case"string":return e;case"file":return tl(t.file,s,"utf8");case"buffer":return Ve?ri(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):gs(s,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function uX(e,t){switch(t.type){case"base64":return Da(e);case"binary":return e;case"string":return e;case"file":return tl(t.file,e,"binary");case"buffer":return Ve?ri(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Bl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?Da(r):t.type=="string"?ot(r):r;case"file":return tl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function yS(e,t){gg(),rK(e);var r=dt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=yS(e,r);return r.type="array",Iu(s)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return gs(QK(e,r),r);case"slk":case"sylk":return gs(ky.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return gs(fS(e.Sheets[e.SheetNames[i]],r),r);case"txt":return uX(SS(e.Sheets[e.SheetNames[i]],r),r);case"csv":return gs(Yg(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return gs(Py.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Bl(Kh.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return gs(vo.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return gs(Oy.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return gs(Dy.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return gs(vS(e,r),r);case"wk1":return Bl(en.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Bl(en.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Bl(hS(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),cX(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return aX(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dX(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function pv(e,t,r){var s={};return s.type="file",s.file=t,dX(s),yS(e,s)}function hX(e,t,r,s,i,n,o,a){var l=Pt(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var p=o?e[r][f]:e[s[f]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;n[f]!=null&&(h[n[f]]=c);continue}var g=p.v;switch(p.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(n[f]!=null){if(g==null)if(p.t=="e"&&g===null)h[n[f]]=null;else if(c!==void 0)h[n[f]]=c;else if(u&&g===null)h[n[f]]=null;else continue;else h[n[f]]=u&&(p.t!=="n"||p.t==="n"&&a.rawNumbers!==!1)?g:Js(p,g,a);g!=null&&(d=!1)}}return{row:h,isempty:d}}function nu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,i=1,n=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?s=1:c.header==="A"?s=2:Array.isArray(c.header)?s=3:c.header==null&&(s=0),typeof u){case"string":l=qe(u);break;case"number":l=qe(e["!ref"]),l.s.r=u;break;default:l=u}s>0&&(i=0);var d=Pt(l.s.r),h=[],f=[],p=0,g=0,m=Array.isArray(e),v=l.s.r,w=0,C={};m&&!e[v]&&(e[v]=[]);var y=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(y[w]||{}).hidden)switch(h[w]=xt(w),r=m?e[v][w]:e[h[w]+d],s){case 1:n[w]=w-l.s.c;break;case 2:n[w]=h[w];break;case 3:n[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=Js(r,null,c),g=C[o]||0,!g)C[o]=1;else{do a=o+"_"+g++;while(C[a]);C[o]=g,C[a]=1}n[w]=a}for(v=l.s.r+i;v<=l.e.r;++v)if(!(b[v]||{}).hidden){var F=hX(e,l,v,h,s,n,m,c);(F.isempty===!1||(s===1?c.blankrows!==!1:c.blankrows))&&(f[p++]=F.row)}return f.length=p,f}var mv=/"/g;function fX(e,t,r,s,i,n,o,a){for(var l=!0,c=[],u="",d=Pt(r),h=t.s.c;h<=t.e.c;++h)if(s[h]){var f=a.dense?(e[r]||[])[h]:e[s[h]+d];if(f==null)u="";else if(f.v!=null){l=!1,u=""+(a.rawNumbers&&f.t=="n"?f.v:Js(f,null,a));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===i||g===n||g===34||a.forceQuotes){u='"'+u.replace(mv,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(l=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(mv,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function Yg(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var i=qe(e["!ref"]),n=s.FS!==void 0?s.FS:",",o=n.charCodeAt(0),a=s.RS!==void 0?s.RS:`
`,l=a.charCodeAt(0),c=new RegExp((n=="|"?"\\|":n)+"+$"),u="",d=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],f=s.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(d[p]=xt(p));for(var g=0,m=i.s.r;m<=i.e.r;++m)(f[m]||{}).hidden||(u=fX(e,i,m,d,o,l,n,s),u!=null&&(s.strip&&(u=u.replace(c,"")),(u||s.blankrows!==!1)&&r.push((g++?a:"")+u)));return delete s.dense,r.join("")}function SS(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Yg(e,t);return r}function gX(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var i=qe(e["!ref"]),n="",o=[],a,l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=xt(a);for(var u=i.s.r;u<=i.e.r;++u)for(n=Pt(u),a=i.s.c;a<=i.e.c;++a)if(t=o[a]+n,r=c?(e[u]||[])[a]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}l[l.length]=t+"="+s}return l}function bS(e,t,r){var s=r||{},i=+!s.skipHeader,n=e||{},o=0,a=0;if(n&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var l=typeof s.origin=="string"?yt(s.origin):s.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(n["!ref"]){var d=qe(n["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+t.length-1+i)}else o==-1&&(o=0,u.e.r=t.length-1+i);var h=s.header||[],f=0;t.forEach(function(g,m){Ft(g).forEach(function(v){(f=h.indexOf(v))==-1&&(h[f=h.length]=v);var w=g[v],C="z",y="",b=Ie({c:a+f,r:o+m+i});c=Wa(n,b),w&&typeof w=="object"&&!(w instanceof Date)?n[b]=w:(typeof w=="number"?C="n":typeof w=="boolean"?C="b":typeof w=="string"?C="s":w instanceof Date?(C="d",s.cellDates||(C="n",w=Nt(w)),y=s.dateNF||De[14]):w===null&&s.nullError&&(C="e",w=0),c?(c.t=C,c.v=w,delete c.w,delete c.R,y&&(c.z=y)):n[b]=c={t:C,v:w},y&&(c.z=y))})}),u.e.c=Math.max(u.e.c,a+h.length-1);var p=Pt(o);if(i)for(f=0;f<h.length;++f)n[xt(f+a)+p]={t:"s",v:h[f]};return n["!ref"]=Ne(u),n}function pX(e,t){return bS(null,e,t)}function Wa(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=yt(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wa(e,Ie(t)):Wa(e,Ie({r:t,c:r||0}))}function mX(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Jg(){return{SheetNames:[],Sheets:{}}}function Zg(e,t,r,s){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);i=n&&+n[2]||0;var o=n&&n[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(oS(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function vX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=mX(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function CX(e,t){return e.z=t,e}function FS(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function wX(e,t,r){return FS(e,"#"+t,r)}function xX(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yX(e,t,r,s){for(var i=typeof t!="string"?t:qe(t),n=typeof t=="string"?t:Ne(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=Wa(e,o,a);l.t="n",l.F=n,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,s&&(l.D=!0))}return e}var Bi={encode_col:xt,encode_row:Pt,encode_cell:Ie,encode_range:Ne,decode_col:Tg,decode_row:Eg,split_cell:IV,decode_cell:yt,decode_range:yr,format_cell:Js,sheet_add_aoa:J1,sheet_add_json:bS,sheet_add_dom:gS,aoa_to_sheet:Po,json_to_sheet:pX,table_to_sheet:pS,table_to_book:kq,sheet_to_csv:Yg,sheet_to_txt:SS,sheet_to_json:nu,sheet_to_html:fS,sheet_to_formulae:gX,sheet_to_row_object_array:nu,sheet_get_cell:Wa,book_new:Jg,book_append_sheet:Zg,book_set_sheet_visibility:vX,cell_set_number_format:CX,cell_set_hyperlink:FS,cell_set_internal_link:wX,cell_add_comment:xX,sheet_set_array_formula:yX,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function SX(){const e=tT(),{items:t,loading:r,error:s}=rT(U=>U.inventory),[i,n]=x.useState(!1),[o,a]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),[h,f]=x.useState(""),[p,g]=x.useState("All"),[m,v]=x.useState("All"),[w,C]=x.useState(null),y=["All",...Array.from(new Set(t.map(U=>U.category)))];x.useEffect(()=>{e(zl())},[e]);const b=async U=>{try{U.id?(await e(xc({id:U.id,data:U})).unwrap(),C("Item updated successfully!")):(await e(wc(U)).unwrap(),C("Item added successfully!"))}catch{C("Operation failed")}a(null),setTimeout(()=>C(null),3e3)},F=U=>{a(U),n(!0)},S=async U=>{const j=t.find(ne=>ne.id===U);j&&(d(j),c(!0))},D=async()=>{if(u){try{await e(nh(u.id)).unwrap(),C("Item deleted successfully!")}catch{C("Failed to delete item")}setTimeout(()=>C(null),3e3)}c(!1),d(null)},T=t.filter(U=>{const j=U.name.toLowerCase().includes(h.toLowerCase()),ne=p==="All"||U.category===p,se=m==="All"||m==="In Stock"&&U.quantity_available>U.minimum_stock||m==="Low Stock"&&U.quantity_available<=U.minimum_stock&&U.quantity_available>0||m==="Out of Stock"&&U.quantity_available===0;return j&&ne&&se}),V=()=>{const U=Bi.json_to_sheet(t),j=Bi.book_new();Bi.book_append_sheet(j,U,"Inventory"),pv(j,"inventory.xlsx")},_=()=>{const U=[{product_code:"MPH001",name:"Sample Item",category:"Vegetables",quantity_available:0,unit:"kg",price:0,minimum_stock:0}],j=Bi.json_to_sheet(U),ne=Bi.book_new();Bi.book_append_sheet(ne,j,"Inventory Template"),pv(ne,"inventory_template.xlsx")},I=async U=>{var ne;const j=(ne=U.target.files)==null?void 0:ne[0];if(j){const se=new FileReader;se.onload=async xe=>{var W;try{const fe=new Uint8Array((W=xe.target)==null?void 0:W.result),pe=Jh(fe,{type:"array"}),P=pe.Sheets[pe.SheetNames[0]],B=Bi.sheet_to_json(P);let H=0,G=0;for(const J of B){const ae=J;if(ae.product_code&&ae.name){const ue=t.find(te=>te.product_code===ae.product_code),ce={product_code:ae.product_code,name:ae.name,category:ae.category||"Other",quantity_available:Number(ae.quantity_available)||0,unit:ae.unit||"kg",price:Number(ae.price)||0,minimum_stock:Number(ae.minimum_stock)||0};try{ue?(await e(xc({id:ue.id,data:{...ce,id:ue.id}})).unwrap(),H++):(await e(wc(ce)).unwrap(),H++)}catch{G++}}}C(`Import completed: ${H} items processed, ${G} errors`),setTimeout(()=>C(null),5e3)}catch{C("Failed to import file. Please check the format."),setTimeout(()=>C(null),3e3)}},se.readAsArrayBuffer(j)}U.target.value=""},z=v8(F,S);return r?E.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),E.jsx("p",{className:"text-gray-600",children:"Loading inventory..."})]})}):s?E.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsxs("p",{className:"text-red-600 mb-4",children:["Error: ",s]}),E.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})}):E.jsxs("div",{className:"min-h-screen bg-gray-100",children:[E.jsx(Cn,{successMessage:w,showStats:!0,statsComponent:E.jsx(sT,{inventory:t})}),E.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[E.jsx(oT,{searchQuery:h,setSearchQuery:f,selectedCategory:p,setSelectedCategory:g,selectedStockLevel:m,setSelectedStockLevel:v,categories:y,onAddItem:()=>{a(null),n(!0)},onExport:V,onImport:I,onDownloadTemplate:_}),E.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden p-4",children:E.jsx(m8,{data:T,columnDefs:z,emptyMessage:"No items in inventory. Add your first item to get started.",emptyIcon:"ðŸ“¦",height:"350px",paginationPageSize:5})}),E.jsx(x8,{isOpen:i,onClose:()=>{n(!1),a(null)},onSave:b,editItem:o}),E.jsx(y8,{isOpen:l,onClose:()=>{c(!1),d(null)},onConfirm:D,itemName:(u==null?void 0:u.name)||""})]})]})}function bX(){return E.jsxs("div",{className:"min-h-screen bg-gray-100",children:[E.jsx(Cn,{showStats:!1}),E.jsx("div",{className:"max-w-7xl mx-auto p-6",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Chef Recipe Management"}),E.jsx("p",{className:"text-gray-600",children:"Manage recipes and cooking instructions."})]})})]})}function FX(){return E.jsxs("div",{className:"min-h-screen bg-gray-100",children:[E.jsx(Cn,{showStats:!1}),E.jsx("div",{className:"max-w-7xl mx-auto p-6",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Recipe Calculator"}),E.jsx("p",{className:"text-gray-600",children:"Calculate recipe costs and portions."})]})})]})}function RX(){return E.jsxs("div",{className:"min-h-screen bg-gray-100",children:[E.jsx(Cn,{showStats:!1}),E.jsx("div",{className:"max-w-7xl mx-auto p-6",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"User Management"}),E.jsx("p",{className:"text-gray-600",children:"Manage staff and user accounts."})]})})]})}function EX(){return E.jsxs("div",{className:"min-h-screen bg-gray-100",children:[E.jsx(Cn,{showStats:!1}),E.jsx("div",{className:"max-w-7xl mx-auto p-6",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Billing & Invoicing"}),E.jsx("p",{className:"text-gray-600",children:"Manage customer bills and payments."})]})})]})}function TX(){return E.jsxs("div",{className:"min-h-screen bg-gray-100",children:[E.jsx(Cn,{showStats:!1}),E.jsx("div",{className:"max-w-7xl mx-auto p-6",children:E.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Purchase Management"}),E.jsx("p",{className:"text-gray-600",children:"Manage purchase orders and suppliers."})]})})]})}function kX(){return E.jsx(VF,{store:qR,children:E.jsx(XR,{children:E.jsx(mF,{children:E.jsxs($b,{children:[E.jsx(hs,{path:"/login",element:E.jsx(YE,{})}),E.jsx(hs,{path:"/",element:E.jsx(Lv,{to:"/inventory",replace:!0})}),E.jsx(hs,{path:"/dashboard",element:E.jsx(Oi,{children:E.jsx(eT,{})})}),E.jsx(hs,{path:"/inventory",element:E.jsx(Oi,{children:E.jsx(SX,{})})}),E.jsx(hs,{path:"/recipes",element:E.jsx(Oi,{children:E.jsx(bX,{})})}),E.jsx(hs,{path:"/calculator",element:E.jsx(Oi,{children:E.jsx(FX,{})})}),E.jsx(hs,{path:"/users",element:E.jsx(Oi,{children:E.jsx(RX,{})})}),E.jsx(hs,{path:"/billing",element:E.jsx(Oi,{children:E.jsx(EX,{})})}),E.jsx(hs,{path:"/purchases",element:E.jsx(Oi,{children:E.jsx(TX,{})})})]})})})})}function PX(){return E.jsx(kX,{})}XS.createRoot(document.getElementById("root")).render(E.jsx(PX,{}));
